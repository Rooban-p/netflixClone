"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([["plt.odsp-common"],[,,,function(e,t,n){n.d(t,{a:function(){return p},b:function(){return p},c:function(){return l}});var a=n(45),i=n(158),r="KillSwitchOverrides",o="".concat(r,"_").concat("enableKillSwitches"),s="".concat(r,"_").concat("disableKillSwitches");function c(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function d(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(o,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(s,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function l(){if(u){for(var e=[],t=0,n=Object.keys(u);t<n.length;t++){var a=n[t];e.push(u[a]?a:"!".concat(a))}return e.join(",")}}var u={},f=function(){u=function(e,t,n,a){if(t)for(var r=0,o=t.split(",");r<o.length;r++){var s=o[r];e[i.normalizeUpper(s,!1)]=!0}if(n)for(var c=0,d=n.split(",");c<d.length;c++)s=d[c],e[i.normalizeUpper(s,!1)]=!1;return e}({},c(o),c(s));var e=function(){try{return location.search?location.search.substring(1):""}catch(e){return""}}(),t=(0,a.a)(e);t.enableKillSwitches,t.disableKillSwitches,t.debugKillSwitches,d(u);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0),u[i.normalizeUpper(e,!1)]=!!t,d(u)}}catch(e){}f=function(){}},p=function(){function e(){}return e.initKillSwitches=function(t){e._killSwitch=m({killSwitches:t||{}})},e.isActivated=function(t,n,a){var i;if(f(),e._killSwitch)return e.isActivated=e._killSwitch.isActivated,e._killSwitch.isActivated(t,n,a);try{if(window._spPageContextInfo){var r=m(window._spPageContextInfo);return(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=r.isActivated),r.isActivated(t,n,a)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var s=0,c=Object.keys(window.Flight.KillSwitches);s<c.length;s++){var d=c[s];o[window.Flight.KillSwitches[d]]=!0}}var l=m({killSwitches:o});return o&&(e.isActivated=l.isActivated),l.isActivated(t,n,a)}}catch(e){return!1}return!1},e}();function m(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,a){var r=!1;if(e){var o=i.normalizeUpper(e,!1);o in u?r=!!u[o]:t&&(r=!!t[o])}return r}}}}
,,,function(e,t,n){n.d(t,{a:function(){return h},b:function(){return m},c:function(){return U},d:function(){return v},e:function(){return D},f:function(){return b}});var a=n(0),i=n(212),r=n(160),o=n(129),s=n(491),c=n(3),d=c.a.isActivated("677F4316-6DBD-4FD0-A1CA-92673CFB4423"),l=0,u=16;function f(e){return{get:function(){return new _(this.key,this.flags|e)}}}var p={async:f(17),suspensible:f(32),lazy:f(1),local:f(2),optional:f(4),bypass:f(8)},m=function(){function e(e){this.id=++l,"string"==typeof e?(this.name=e,this.factory=void 0,this.loader=void 0):(this.name=e.name,this.factory=e.factory,this.loader=e.loader)}return Object.defineProperty(e.prototype,"key",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"Resource #".concat(this.id,' "').concat(this.name,'"')},e}();Object.defineProperty(m.prototype,"flags",{value:0}),Object.defineProperties(m.prototype,p);var _=function(){function e(e,t){this.key=e,this.flags=t}return e.prototype.toString=function(){var e=this.flags;return"".concat(this.key).concat(e&u?".async":32&e?".suspensible":1&e?".lazy":"").concat(2&e?".local":"").concat(4&e?".optional":"").concat(8&e?".bypass":"")},e}();Object.defineProperties(_.prototype,p);var h=function(){function e(e){this._value=e,this.dependencies={}}return e.prototype.create=function(){return{instance:this._value}},e}(),b=new m({name:"resources"});function g(e){return e===b}var v=new m({name:"asyncLoadBarrier"}),y=function(){function e(e){this._loader=e,this._cached=void 0}return e.prototype.load=function(){var e=this;return this._cached?this._cached:(this._cached=H(this._loader.load())).then(function(t){return e._loader=void 0,t},function(t){return e._cached=void 0,Promise.reject(t)})},e}(),S=function(){function e(e,t){this.entry=e,this.manager=t,this._resource=void 0}return e.prototype.getInstance=function(e,t){if(this._resource)return this._resource.instance;var n=this.manager,a=this.entry.factory,i=a.create(n.resolve(a.dependencies,t));return this._resource=i,i.disposable&&n.scope.attach(i.disposable),i.instance},e.prototype.promote=function(t){var n=this.entry;return new e({manager:t,loader:n.loader,factory:n.factory})},e}();function D(e,t){var n=function(n){return e.call(this,n,t)||this};return n.prototype=e.prototype,n}function I(e){return e.length<1?" Consumed directly.":(0,a.g)((0,a.g)([],e,!0),[""],!1).reverse().join("\n  Required by ")}function x(e,t){return new Error("".concat(e," is being consumed, but is not available in the current scope.")+"\n  1) Check to ensure that the dependency on this resource (and each step up the chain) is properly declared."+"\n  2) If availability is expected, check to see if the target resource has a dependency that is only available in a child scope.".concat(I(t)))}function C(e,t){return new Error("".concat(e," is being consumed synchronously, but was exposed asynchronously and has not been loaded. Either:")+"\n  1) Ensure that the root call that is requesting this resource is a consumeAsync(). Or"+"\n  2) Ensure that the dependency on this resource is properly declared, so that it can be picked up by an earlier consumeAsync() or load() call.".concat(I(t)))}function O(e,t){return new Error("".concat(e," is being loaded, but has no factory / loader.Check to ensure that either: ")+"\n  1) ".concat(e," is defined with a 'factory' or 'loader' specified.")+"\n  2) A higher - level component calls 'expose', 'exposeFactory', or 'exposeAsync' for ".concat(e,".").concat(function(e){return e.length<2?" Loaded directly.":(0,a.g)([""],e.slice(1),!0).join("\n  Required by ")}(t)))}function w(e){return{handle:e,error:void 0}}function E(e){return{handle:void 0,error:e}}function A(e){var t=e.flags;return t&u?new _(e.key,-18&t):e}var L=function(){function e(t){var n;if(this._handles={},this._isLocked=!1,this._loader=void 0,t instanceof e){if(t.isDisposed)throw new Error("Parent ResourceScope has already been disposed!");n=t.options,this._parent=t,this._level=t._level+1}else n=t||{},this._parent=void 0,this._level=0;this.scope=new r.a,this.options=n}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0}),e.prototype.block=function(e){return this._expose(e)},e.prototype.isDescendantOf=function(e){return this._level>e._level},e.prototype.getHandle=function(e){for(var t=this,n=e.id;!(n in t._handles)&&t._parent;)t=t._parent;var a=t._handles;return a[n]||this.options.useFactoriesOnKeys&&(e.factory&&(a[n]=new S({factory:e.factory,manager:t}))||e.loader&&(a[n]=new S({loader:new y(e.loader),manager:t})))||void 0},e.prototype.expose=function(e,t,n){return this._expose(e,function(e){return new S({factory:t.factory,loader:t.loader,manager:e},n&&e)})},e.prototype.getLoader=function(){return this._loader?this._loader:(this.lock(),this._loader=new P(this))},e.prototype.dispose=function(){this.scope.dispose(),this._handles={},this._loader=void 0,this.consume=this.resolve=k,this.getLoader=M},e.prototype.bind=function(e){var t=this.getHandle(e);return t?this._expose(e,function(e){return t.promote(e)}):this},e.prototype.lock=function(){var e;"allow"!==(null!==(e=this.options.exposeAfterConsumeMode)&&void 0!==e?e:"allow")&&(this._isLocked=!0)},e.prototype.consume=function(e,t){var n=this;this.lock();var a,i=e.flags,r=e.key;if(i&u){var o,s=A(e),c=function(){return n.consume(s,t)};if(g(r))return function(){return o||(o=Promise.resolve(c()))};if((h=this._getValidHandle(e,0,[])).handle)return function(){return o||(o=H(n.getLoader().loadAsync(s,0,[],[]).promise).then(c,T(i)))};if(4&i)return function(){return Promise.resolve(void 0)};throw(v=h.error)[0](v[1],v[2])}if(32&i){var l,f,p=function(e){var t=e.flags;return 32&t?new _(e.key,-33&t):e}(e);return{read:function(){if(g(r))return function(){return n.consume(p,t)};var a=n._getValidHandle(e,0,[]);if(a.handle)return a.handle.getInstance(r,t||{owner:"".concat(r," ")});var o=a.error;if(o[0]===C){var s=n._getValidHandle(new _(e.key,i|u),0,[]);if(!d&&f)throw f.error;if(s.handle)throw l||(l=H(n.getLoader().loadAsync(e,0,[],[]).promise)).catch(function(e){if(!d){var t=e instanceof Error?e:e[0](e[1],e[2]);throw f={error:t},t}});var c=s.error;throw c[0](c[1],c[2])}if(!(4&i))throw o[0](o[1],o[2])}}}if(g(r)){var m;a=function(){return m||(m=n.scope.attach(new U(n,t||{owner:"".concat(r," ")}))),m}}else{var h,b=(h=this._getValidHandle(e,0,[])).handle;if(b)a=function(){return b.getInstance(r,t||{owner:"".concat(r," ")})};else if(!(4&i)){var v;throw(v=h.error)[0](v[1],v[2])}}return 1&i?a:a&&a()},e.prototype.isExposed=function(e){return!!g(e.key)||!!this._getValidHandle(e,0,[]).handle},e.prototype.resolve=function(e,t){for(var n={},a=0,i=Object.keys(e);a<i.length;a++){var r=i[a];e[r]&&(n[r]=this.consume(e[r],t))}return n},e.prototype._getValidHandle=function(e,t,n){var a=e.key,i=a.id;if(n.indexOf(a)>=0)throw new Error("".concat(a," has a circular dependency.").concat(I(n)," "));var r=this._handles[i];if(r&&r.manager)return w(r);var o=this.getHandle(a);if(!o)return E([x,e,n]);var s=e.flags|t,c=o.entry,d=c.factory;if(s&u&&c.loader)return w(o);if(!d)return E([C,e,n]);for(var l=n.push(a)-1,f=o.manager,p=2&s?this:f||c.manager,m=d.dependencies||{},_=0,h=Object.keys(m);_<h.length;_++){var b=m[h[_]];if(b&&!g(b.key)){var v=this._getValidHandle(b,16&s,n),y=v.handle;if(y){var D=y.manager||y.entry.manager;D.isDescendantOf(p)&&(p=D)}else if(!(4&b.flags)||v.error[0]===C&&this.options.errorOnOptionalAsyncOnly)return v}}return n.splice(l),f&&f===p||(o=new S(c,p),p._handles[i]=o),this._handles[i]=o,w(o)},e.prototype._expose=function(t,n){if(this.isDisposed)throw new Error("Cannot expose a resource on a ResourceScope that has been disposed.");if(g(t))throw new Error("It is invalid to expose `resourceScopeKey`");var a=t.id,i=this._isLocked?this.scope.attach(new e(this)):this,r=i._handles;if(r[a]&&this.options.noDoubleExpose)throw new Error("".concat(t," has already been exposed / consumed at this scope."));return r[a]=n?n(i):void 0,i},e}();function k(e){if(e instanceof _||e instanceof m)throw new Error("Cannot consume ".concat(e," from a disposed ResourceScope."));throw new Error("Cannot resolve resources from a disposed ResourceScope.")}function M(){throw new Error("Cannot load a resource from a ResourceScope that has been disposed.")}var P=function(){function e(e){this._handleManager=e,this._loadState={},this._root=e.consume(v.optional)}return e.prototype.loadAsync=function(e,t,n,i){if(g(e.key))return{bypass:R,promise:Promise.resolve(void 0)};var r=this._loadAsync(e,t,(0,a.g)([e],n,!0),i);return{promise:r.promise.catch(T(e.flags,!0)),bypass:r.bypass}},e.prototype.loadAllAsync=function(e,t,n,a){if(e){var i=Object.keys(e),r=i.length;if(r>0){for(var o=[];r--;){var c=e[i[r]];c&&o.push(this.loadAsync(c,t,n,a))}return{bypass:N(function(){for(var e=0,t=o;e<t.length;e++)t[e].bypass()}),promise:(0,s.a)(o.map(function(e){return e.promise}))}}}return{bypass:R,promise:Promise.resolve(void 0)}},e.prototype._loadAsync=function(e,t,n,r){var o=this,s=e.key,d=s.id,l=this._loadState,f=e.flags|t,p=l[d];if(p){if(r&&r.indexOf(s)>=0)throw new Error("".concat(s," has a circular dependency.").concat(I(r)," "));return 8&f&&p.bypass(),p}if(f&u)return{bypass:R,promise:Promise.resolve(void 0)};var m=this._handleManager.getHandle(s);if(!m)return l[d]={bypass:R,promise:Promise.reject([O,e,n])};l[d]={bypass:R,promise:Promise.resolve(void 0)};var _=m.entry,h=_.factory;if(h)return l[d]=this.loadAllAsync(h.dependencies,8&f,n,r?(0,a.g)((0,a.g)([],r,!0),[s],!1):[s]);var b=_.loader;if(!b)return l[d]={bypass:R,promise:Promise.reject([O,e,n])};var g,v=this._root,y=new i.a,S=y.resolve,D=y.reject,x=y.promise;return 8&f||!v?S():v.wait().then(S).catch(D),l[d]={bypass:N(function(){c.a.isActivated("D6B556B6-1D2A-4DC3-A9A2-AC42C0A3127C","06/29/2022","Allow bypass to force-resolve existing loaders")||(f|=8,S(),g&&g())}),promise:x.then(function(){return b.load()}).then(function(e){_.factory=e;var t=e.dependencies;if(t){var i=o.loadAllAsync(t,8&f,n,r?(0,a.g)((0,a.g)([],r,!0),[s],!1):[s]);return g=i.bypass,i.promise}})}},e}();function T(e,t){return function(n){if(Array.isArray(n)&&"function"==typeof n[0]){if("number"==typeof e&&4&e)return;if(t)return Promise.reject(n);throw n[0](n[1],n[2])}return Promise.reject(n)}}var U=function(){function e(t,n){var a,i,o;t instanceof e?(o=t._handleManager,i=t._owner,t._lock()):t instanceof L?o=t:n=t||n;var s=new r.a;if(o){if(o.scope.isDisposed)throw new Error("Parent ResourceScope has already been disposed.");o.lock(),"allow"===(null!==(a=o.options.exposeAfterConsumeMode)&&void 0!==a?a:"allow")&&(this._forkOnWrite=!0)}this._handleManager=o||(o=s.attach(new L(n))),this._scope=s;var c=n?n.owner:"";this._owner=i?"".concat(i," > ").concat(c," "):c}return e.prototype.consume=function(e){if(this._lock(),e)return this._handleManager.consume(e)},e.prototype.consumeAsync=function(e){if(this._lock(),!e)return Promise.resolve(void 0);var t=this._handleManager,n=A(e);return H(t.getLoader().loadAsync(n,0,[],[]).promise).then(function(){return t.consume(n)}).catch(T(n.flags))},e.prototype.load=function(e){return this._lock(),H(this._handleManager.getLoader().loadAllAsync(e,0,[],[]).promise).catch(T(0))},e.prototype.exposeAsync=function(e,t){this._expose(e,{loader:new y(t)})},e.prototype.exposeFactory=function(e,t){this._expose(e,{factory:t})},e.prototype.expose=function(e,t){return this._expose(e,{factory:new h(t)},t),t},e.prototype.block=function(e){this._handleManager=this._prepareWrite().block(e)},e.prototype.bind=function(e){this._handleManager=this._prepareWrite().bind(e)},e.prototype.isDefined=function(e){if(this._lock(),!e)return!1;var t=this._handleManager;return!t.isDisposed&&!!t.getHandle(e)},e.prototype.isExposed=function(e){if(this._lock(),!e)return!1;var t=this._handleManager;return!t.isDisposed&&t.isExposed(e)},e.prototype.injected=function(t,n){void 0===n&&(n={});var a=n.injectChildResourceScope,i={owner:n.owner||t.name},r=a?this._scope.attach(new e(this,i)):this,s=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.resources=r;var i=t.apply(this,e)||this;return a&&(0,o.a)(i,F),i};return s.prototype=t.prototype,s},e.prototype.resolve=function(e){return this._lock(),this._handleManager.resolve(e)},e.prototype.resolveAsync=function(e){var t=this;return this.load(e).then(function(){return t.resolve(e)})},e.prototype.resolved=function(e,t){return D(e,this.resolve((0,a.a)((0,a.a)({},e.dependencies||{}),t||{})))},e.prototype.resolvedAsync=function(e,t){var n=this;return this.load((0,a.a)((0,a.a)({},e.dependencies||{}),t||{})).then(function(){return n.resolved(e,t)})},e.prototype.dispose=function(){this._scope.dispose()},e.prototype._expose=function(e,t,n){if(this._isLocked)throw new Error("This resource scope is locked and cannot have new keys exposed. This means a resource has already been consumed or checked for exposure from this scope");this._handleManager=this._prepareWrite().expose(e,t,n)},e.prototype._prepareWrite=function(){return this._forkOnWrite?(this._forkOnWrite=!1,this._scope.attach(new L(this._handleManager))):this._handleManager},e.prototype._lock=function(){var e;this._isLocked||"reject"!==(null!==(e=this._handleManager.options.exposeAfterConsumeMode)&&void 0!==e?e:"allow")||(this._isLocked=!0)},e}();function F(){this.resources.dispose()}function H(e){var t=new i.a;return e.then(function(e){return t.resolve(e)},function(e){return t.reject(e)}),t.promise}function R(){}function N(e){return function(){if(e){var t=e;e=void 0,t()}}}}
,function(e,t,n){n.d(t,{a:function(){return m},b:function(){return o},c:function(){return _},d:function(){return c},e:function(){return d},f:function(){return p},g:function(){return f},h:function(){return s},i:function(){return g},j:function(){return r},k:function(){return b},l:function(){return u},m:function(){return S},n:function(){return y},o:function(){return h},p:function(){return v},q:function(){return D},r:function(){return l}});var a=/([-*+?.^${}(|)[\]])/g,i=/\{(\d+)\}/g;function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(i,function(e,n){var a=t[Number(n)];return null===a?"":"".concat(a)})}function o(e){return((e||"").match(i)||[]).length}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a,r=[],o=0;a=i.exec(e);){var s=a[0],c=parseInt(s.replace(/\{|\}+/g,""),10),d=t[c];a.index>o&&r.push(e.substring(o,a.index)),o=i.lastIndex,r.push(d)}return o!==e.length&&r.push(e.substring(o,e.length)),r}function c(e,t){return e.substr(e.length-t.length)===t}function d(e,t){return e.substr(0,t.length)===t}function l(e,t){for(var n=e.toString();n.length<t;)n="".concat(n,"0");return n}function u(e,t){for(var n=e.toString();n.length<t;)n="0".concat(n);return n}function f(e,t){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return n;return-1}function p(e,t){return e&&t?e.toUpperCase()===t.toUpperCase():e===t}function m(e){return e?e[0].toUpperCase()+e.substr(1):e}function _(e){return e?e[0].toLowerCase()+e.substr(1):e}function h(e,t,n){return 1===e?t:n}function b(e,t,n){if(n=Number(n),void 0===e||void 0===t||void 0===n)return"";for(var a="",i=-1,r=t.split("||"),o=0,s=r.length;o<s;o++){var c=r[o];if(c){for(var d=0,l=c.split(",");d<l.length;d++){var u=l[d];if(u)if(isNaN(Number(u))){if(-1!==u.indexOf("-")){var f=u.split("-");if(2!==f.length)continue;var p=void 0,m=void 0;if("*"===u[0]){var _=f[0].substring(1),h=f[1];if(isNaN(Number(_))||isNaN(Number(h)))continue;p=parseInt(_,10),m=parseInt(h,10);for(var b=void 0,g=p;g<=m;g++){var v="[0-9]*"+g;if(new RegExp("^".concat(v,"$")).test(n.toString())){b=!0;break}}if(b){i=o;break}}else{if(""===f[0])p=0;else{if(isNaN(Number(f[0])))continue;p=parseInt(f[0],10)}if(n>=p){if(""===f[1]){i=o;break}if(isNaN(Number(f[1])))continue;if(n<=(m=parseInt(f[1],10))){i=o;break}}}}else if(-1!==u.indexOf("*")&&(v=u.trim().replace(/\*/g,"[0-9]*"),new RegExp("^".concat(v,"$")).test(n.toString()))){i=o;break}}else if(n===parseInt(u,10)){i=o;break}}if(-1!==i)break}}if(-1!==i){var y=e.split("||");y[i]&&(a=y[i])}return a}function g(e,t,n){return r(b(e,t,n)||"",n.toString())}function v(e,t){var n="";if(!e||t<1||t>Number.MAX_SAFE_INTEGER)return n;do{t%2&&(n+=e),(t=Math.floor(t/2))&&(e+=e)}while(t);return n}function y(e,t,n,a){return void 0===a&&(a=!1),e.length>t?String(e):(n=n||" ",(t-=e.length)>n.length&&(n+=v("".concat(n),t/n.length)),n=n.slice(0,t),a?"".concat(e).concat(n):"".concat(n).concat(e))}function S(e,t){return e.toLocaleLowerCase()===t.toLocaleLowerCase()}function D(e,t,n){var i=t.replace(a,"\\$1"),r=new RegExp(i,"g");return e.replace(r,n)}}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return K},b:function(){return G}});var a=n(0),i=n(315);function r(e){window.setTimeout(function(){i.c(V,h,{error:e})},0)}var o,s,c,d,l,u,f,p,m,_,h="error",b="Canceled",g=1;function v(){}function y(e,t){e._value=t,e._setState(V.isPromise(t)?c:f)}function S(e,t,n,a,i,r){return{exception:e,error:t,promise:n,handler:r,id:a,parent:i}}function D(e,t,n,a){var i=null==n?void 0:n._isException;return S(i?t:null,i?null:t,e,null==n?void 0:n._errorId,n,a)}function I(e,t,n){var a=null==n?void 0:n._isException,i=null==n?void 0:n._errorId;return e instanceof V&&M(e,i,a),S(a?t:null,a?null:t,e,i,n)}function x(e,t){var n=++g;return e instanceof V&&M(e,n),S(null,t,e,n)}function C(e,t){var n=++g;return e instanceof V&&M(e,n,!0),S(t,null,e,n)}function O(e,t,n){k(e,{c:t,e:n})}function w(e,t,n,a){e._value=t,L(e,t,n,a),e._setState(m)}function E(e,t){var n,a,i=e._value,r=e._listeners;if(r)for(e._listeners=null,n=0,a=r.length;n<a;n++){var o=r[n],s=o.c,d=o.promise;if(d){try{d._setCompleteValue(s?s(i):i)}catch(e){d._setExceptionValue(e)}d._state!==c&&d._listeners&&t.push(d)}else N.prototype.done.call(e,s)}}function A(e,t){var n,a,i=e._value,r=e._listeners;if(r)for(e._listeners=null,n=0,a=r.length;n<a;n++){var o=r[n],s=o.e,d=o.promise;if(d){try{s?(s.handlesOnError||L(d,i,D,e,s),d._setCompleteValue(s(i))):d._setChainedErrorValue(i,e)}catch(e){d._setExceptionValue(e)}d._state!==c&&d._listeners&&t.push(d)}else H.prototype.done.call(e,void 0,s)}}function L(e,t,n,a,r){t instanceof Error&&t.message===b||i.c(V,h,n(e,t,a,r))}function k(e,t){var n=e._listeners;n?n.push(t):n=[t],e._listeners=n}function M(e,t,n){e._isException=n||!1,e._errorId=t}function P(e,t,n,a){e._value=t,L(e,t,n,a),e._setState(_)}function T(e,t){var n;n=V.isPromise(t)?c:p,e._value=t,e._setState(n)}function U(e,t,n){var a=new z(e);return k(e,{promise:a,c:t,e:n}),a}o={name:"created",enter:function(e){e._setState(s)},cancel:v,done:v,then:v,_completed:v,_error:v,_notify:v,_setCompleteValue:v,_setErrorValue:v},s={name:"working",enter:v,cancel:function(e){e._setState(l)},done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},c={name:"waiting",enter:function(e){var t=e._value;if(t instanceof z&&t._state!==_&&t._state!==p)k(t,{promise:e});else{var n=function(a){t._errorId?e._chainedError(a,t):(L(e,a,D,t,n),e._error(a))};n.handlesOnError=!0,t.then(e._completed.bind(e),n)}},cancel:function(e){e._setState(d)},done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},d={name:"waiting_canceled",enter:function(e){e._setState(u);var t=e._value;V.is(t)&&t.cancel()},cancel:v,done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},l={name:"canceled",enter:function(e){e._setState(u),e._cancelAction()},cancel:v,done:O,then:U,_completed:y,_error:w,_notify:v,_setCompleteValue:T,_setErrorValue:P},u={name:"canceling",enter:function(e){var t=new Error(b);t.name=t.message,t._handled=!0,e._value=t,e._setState(m)},cancel:v,done:v,then:v,_completed:v,_error:v,_notify:v,_setCompleteValue:v,_setErrorValue:v},f={name:"complete_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(p)},cancel:v,done:function(e,t,n){return N.prototype.done.call(e,t)},then:function(e,t,n){return N.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:E,_setCompleteValue:v,_setErrorValue:v},p={name:"success",enter:function(e){e._cleanupAction()},cancel:v,done:function(e,t,n){return N.prototype.done.call(e,t)},then:function(e,t,n){return N.prototype.then.call(e,t)},_completed:v,_error:v,_notify:E,_setCompleteValue:v,_setErrorValue:v},m={name:"error_notify",enter:function(e){if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())&&n._state._notify(n,t);e._setState(_)},cancel:v,done:function(e,t,n){return H.prototype.done.call(e,t,n)},then:function(e,t,n){return H.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:A,_setCompleteValue:v,_setErrorValue:v},_={name:"error",enter:function(e){e._cleanupAction()},cancel:v,done:function(e,t,n){return H.prototype.done.call(e,t,n)},then:function(e,t,n){return H.prototype.then.call(e,t,n)},_completed:v,_error:v,_notify:A,_setCompleteValue:v,_setErrorValue:v};var F,H=function(){function e(e,t){void 0===t&&(t=x),this._value=e,L(this,e,t)}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){var n=this._value;if(t)try{t.handlesOnError||L(this,n,D,this,t);var a=t(n);return void(V.is(a)&&a.done())}catch(e){n=e}n instanceof Error&&n.message===b||r(n)},e.prototype.then=function(e,t){if(!t)return this;var n,a=this._value;try{t.handlesOnError||L(this,a,D,this,t),n=new N(t(a))}catch(e){n=e===a?this:new R(e)}return n},e.prototype.catch=function(e){return this.then(void 0,e)},e}(),R=function(e){function t(t){return e.call(this,t,C)||this}return(0,a.d)(t,e),t}(H),N=function(){function e(e){if(V.isPromise(e)){var t=new z(null);return t._setCompleteValue(e),t}this._value=e}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){if(e)try{var n=e(this._value);V.is(n)&&n.done()}catch(e){r(e)}},e.prototype.then=function(t,n){var a;try{var i=t?t(this._value):this._value;a=this._isSameValue(i,this)?this:new e(i)}catch(e){a=new R(e)}return a},e.prototype.catch=function(e){return this.then(void 0)},e.prototype._isSameValue=function(e,t){return e===this._value},e}();function B(e){var t;return new V(function(n){t=window.setTimeout(n,e)},function(){t&&window.clearTimeout(t)})}function j(e){var t=e;return function(){for(var e=0,n=Object.keys(t);e<n.length;e++){var a=n[e];V.as(t[a]).cancel()}}}var V=function(){function e(e,t){this._init(e,t)}return Object.defineProperty(e,"cancel",{get:function(){return F||(F=new H(new Error(b)))},enumerable:!1,configurable:!0}),e.any=function(t){return new e(function(n,a){var i=Object.keys(t),r=i.length;0===r&&n();for(var o=t,s=function(t){var i=e.as(o[t]);i.then(function(){n({key:t,value:i})},function(o){o instanceof Error&&o.name===b?0==--r&&n(e.cancel):a({key:t,value:i})})},c=0,d=i;c<d.length;c++)s(d[c])},j(t))},e.race=function(t){return new e(function(n,a){var i=Object.keys(t),r=i.length;0===r&&n();for(var o=t,s=0,c=i;s<c.length;s++){var d=c[s];e.as(o[d]).then(n,function(t){t instanceof Error&&t.name===b?0==--r&&n(e.cancel):a(t)})}},j(t))},e.as=function(t){return e.is(t)?t:new N(t)},e.is=function(t){return e.isPromise(t)&&"function"==typeof t.cancel},e.isPromise=function(e){return!!e&&"object"==typeof e&&"function"==typeof e.then},e.isCanceled=function(e){return e instanceof Error&&e.name===b},e.all=function(t){return new e(function(n,a){for(var i=Object.keys(t),r=Array.isArray(t)?[]:{},o=Array.isArray(t)?[]:{},s=i.length,c=function(){if(0==--s){var t=Object.keys(r);0===t.length?n(o):t.every(function(t){return e.isCanceled(r[t])})?n(e.cancel):a(r)}},d=function(n){var a=t[n];void 0===a?s--:e.then(a,function(e){o[n]=e,c()},function(e){r[n]=e,c()})},l=0,u=i;l<u.length;l++)d(u[l]);0===s&&n(o)},j(t))},e.then=function(t,n,a){return e.as(t).then(n,a)},e.thenEach=function(t,n,a){for(var i=Array.isArray(t)?[]:{},r=0,o=Object.keys(t);r<o.length;r++){var s=o[r];i[s]=e.then(t[s],n,a)}return e.all(i)},e.serial=function(t){return t.reduce(function(e,t){return e.then(t)},e.wrap())},e.timeout=function(e,t){var n=B(e);return t?function(e,t){var n=function(){e.cancel()};return e.then(function(){t.cancel()}),t.then(n,n),t}(n,t):n},e.wrap=function(e){return new N(e)},e.resolve=function(t){return e.wrap(t)},e.wrapError=function(e){return new H(e)},e.reject=function(t){return e.wrapError(t)},e.prototype.cancel=function(){this._state.cancel(this),this._run()},e.prototype.done=function(e,t){this._state.done(this,e,t)},e.prototype.then=function(e,t){return this._state.then(this,e,t)},e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype._init=function(e,t){this._oncancel=t,this._setState(o),this._run();try{e?e(this._completed.bind(this),this._error.bind(this)):this._setExceptionValue(new Error("No init value for Promise"))}catch(e){this._setExceptionValue(e)}},e.prototype._cancelAction=function(){if(this._oncancel)try{this._oncancel()}catch(e){}},e.prototype._cleanupAction=function(){this._oncancel=void 0},e.prototype._chainedError=function(e,t){var n=this._state._error(this,e,I,t);return this._run(),n},e.prototype._completed=function(e){var t=this._state._completed(this,e);return this._run(),t},e.prototype._error=function(e){var t=this._state._error(this,e,x);return this._run(),t},e.prototype._setState=function(e){this._nextState=e},e.prototype._setCompleteValue=function(e){this._state._setCompleteValue(this,e),this._run()},e.prototype._setChainedErrorValue=function(e,t){var n=this._state._setErrorValue(this,e,I,t);return this._run(),n},e.prototype._setExceptionValue=function(e){var t=this._state._setErrorValue(this,e,C);return this._run(),t},e.prototype._run=function(){for(;this._nextState;)this._state=this._nextState,this._nextState=void 0,this._state.enter(this)},e.prototype._isSameValue=function(e,t){return e===this._value},e}();i.a(V,h);var z=function(e){function t(t){var n=e.call(this)||this;return n._creator=t,n._initThen(),n}return(0,a.d)(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._creator&&this._creator.cancel()},t.prototype._cleanupAction=function(){this._creator=null},t.prototype._initThen=function(){this._setState(o),this._run()},t}(V),G=function(e){function t(t){var n=e.call(this)||this;return n._oncancel=t,n._initSignal(),n}return(0,a.d)(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._oncancel&&this._oncancel()},t.prototype._cleanupAction=function(){this._oncancel=void 0},t.prototype._initSignal=function(){this._setState(o),this._run()},t}(V),K=V;t.c=K}
,,,function(e,t,n){n.d(t,{a:function(){return U},b:function(){return a},c:function(){return i},d:function(){return Oe},e:function(){return xe},f:function(){return we},g:function(){return me},h:function(){return _e},i:function(){return Ue},j:function(){return re},k:function(){return ee},l:function(){return ge},m:function(){return k},n:function(){return J},o:function(){return Y},p:function(){return be},q:function(){return le},r:function(){return ne},s:function(){return pe},t:function(){return ue},u:function(){return ie},v:function(){return Ee},w:function(){return Q},x:function(){return q},y:function(){return fe},z:function(){return Z},A:function(){return te},B:function(){return Te},C:function(){return se},D:function(){return De},E:function(){return ae},F:function(){return Le},G:function(){return Se},H:function(){return V},I:function(){return j},J:function(){return ye},K:function(){return G},L:function(){return K},M:function(){return z},N:function(){return W},O:function(){return X},P:function(){return he},Q:function(){return ce},R:function(){return Ie},S:function(){return B},T:function(){return de},U:function(){return T},V:function(){return M},W:function(){return P},X:function(){return ve},Y:function(){return Pe},_:function(){return ke},Z:function(){return Me},$:function(){return F},eb:function(){return R},tb:function(){return H}});var a,i,r=n(0),o=n(32),s=n(39),c=n(29),d=n(93),l=n(31),u=n(69),f=n(72),p=n(95),m=n(7),_=n(11),h=n(20),b=n(107),g=n(70),v=n(24),y=n(506),S=n(55),D=n(18),I=n(104),x=n(327),C=n(68),O=n(112),w=n(47),E=n(53),A=n(71),L=n(94),k=[_.Fj,_.Me,_.zj,_.ck,_.Bj,_.Ad,_.si],M=[_.uj,_.oj,_.pj,_.mj,_.fj,_.ej,_.dj],P=[_.tj,_.$i,_.ij,_.Ji,_.rj,_.aj,_.nj,_.Xi,_.lj,_.cj,_.sj,_.Zi],T=[_.Yd,_.xd,_.Ie,_.$,_.Ce,_.Xd,_.Jd,_.lb,_.bi,_.Of,_.xf,_.Oc],U="|spo-grid-all-users/";function F(e,t){return N(e,t=t||26)}function H(e,t){return N(e,t=t||25)}function R(e,t){return N(e,t=t||20)}function N(e,t){if(!e)return"";var n=t,a=Math.floor(n/2);if((new E.a).isIE)return e;var i=Array.from(e);if(i&&!v.mb()?i.length<=n:e.length<=n)return e;var r=i.slice(0,a).join(""),o=i.slice(i.length-a).join("");return"".concat(r,"...").concat(o)}function B(e){return e.userRole===o.a.none&&e.defaultLinkKind===s.a.uninitialized}function j(e,t){switch(e){case"anonymous":return t?s.a.anonymousEdit:s.a.anonymousView;case"organization":return t?s.a.organizationEdit:s.a.organizationView;case"users":return s.a.flexible;default:return s.a.direct}}function V(e){switch(e){case"anonymous":return c.a.anyone;case"organization":return c.a.organization;case"users":return c.a.specificPeople;default:return c.a.existing}}function z(e){switch(e){case s.a.anonymousEdit:case s.a.anonymousView:return"anonymous";case s.a.organizationEdit:case s.a.organizationView:return"organization";case s.a.flexible:return"users";default:return"existingAccess"}}function G(e){switch(e){case c.a.anyone:return"anyone";case c.a.organization:return"organization";case c.a.specificPeople:case c.a.specificPeopleFlex:case c.a.customLabeledSpecificPeople:return"specificPeople";case c.a.existing:default:return"existingAccess"}}function K(e){switch(e){case c.a.anyone:return d.a.anyone;case c.a.organization:return d.a.organization;case c.a.specificPeople:case c.a.specificPeopleFlex:case c.a.customLabeledSpecificPeople:return d.a.specificPeople;case c.a.existing:default:return d.a.existing}}function W(e){switch(e){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function q(e,t,n){var a=t.sharingLinkKind,i=t.audience,r=window.require?window.require.toUrl("odsp-media/images/sharedialog"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20240610.001/assets/icons/sharing",o=h.j(e)?"directrecipients.svg":"peopleinchat.svg";switch(a){case s.a.organizationView:case s.a.organizationEdit:return"".concat(r,"/companyonly.svg");case s.a.anonymousView:case s.a.anonymousEdit:return"".concat(r,"/anyone.svg");case s.a.flexible:return t.audience===c.a.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(r,"/").concat(o):"".concat(r,"/specificpeople.svg");default:return i===c.a.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(r,"/").concat(o):window.require?"".concat(r,"/existingaccess.svg"):"".concat(r,"/existingaccess.svg?v2")}}function Q(e){if(e.isCreateOnlyLink)return"FileRequest";if(e.isAddressBarLink)return"Favicon";switch(e.sharingLinkKind){case s.a.requestAccess:return"Mail";case s.a.organizationView:case s.a.organizationEdit:return"Work";case s.a.anonymousView:case s.a.anonymousEdit:return"Globe";case s.a.flexible:return e.audience===c.a.anyone?"Globe":e.audience===c.a.organization?"Work":"AddFriend";default:return"Link"}}function Y(){return{palette:{themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#3AA0F3",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#6CB8F6",themeDarker:"#82c7ff",themeDark:"#82C7FF",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#252423",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},semanticColors:{bodyBackground:"#1b1a19",bodyStandoutBackground:"#3B3A39",buttonText:"#ffffff",buttonTextPressed:"#faf9f8",buttonTextHovered:"#f3f2f1",bodySubtext:"#a19f9d",disabledBackground:"#484644",errorText:"#F1707B",inputBackgroundChecked:"#3AA0F3",menuBackground:"#323130",menuItemBackgroundHovered:"#484644",menuItemBackgroundPressed:"#3b3a39",menuDivider:"#484644",menuIcon:"#6CB8F6",menuHeader:"#ffffff",menuItemText:"#f3f2f1",menuItemTextHovered:"#faf9f8",messageText:"#f3f2f1",primaryButtonBackground:"#0078D4",primaryButtonBackgroundHovered:"#004c87",primaryButtonBackgroundPressed:"#043862",primaryButtonText:"#ffffff",primaryButtonTextHovered:"#ffffff",primaryButtonTextPressed:"#ffffff",primaryButtonTextDisabled:"#605e5c",variantBorder:"#3b3a39",infoBackground:"#323130",infoIcon:"#c8c6c4",errorIcon:"#F1707B",warningIcon:"#c8c6c4",blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"}}}function J(e,t,n,a){var i=h.j(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return _.dg;case"review":return b.a[a]?_.lg:_.ug;default:return _.fg}case"team":switch(t){case"edit":return _.bg;case"review":return b.a[a]?_.gg:_.vg;default:return _.yg}case"recipient":switch(t){case"edit":return _.Ph;case"review":return b.a[a]?_.Th:_.Uh;default:return _.Fh}default:switch(t){case"edit":return _.pg;case"review":return b.a[a]?_.mg:_._g;default:return _.hg}}}function X(){var e=window.require&&window.require.toUrl("plt.resx-plt.js"),t=e&&e.split("/"),n=t&&t.length>2&&t[t.length-2];return n&&1===["ar","arc","dv","he","nqo","fa","ps","sd","syr","ur","yi","ji"].filter(function(e){return n===e}).length}function Z(e){var t=e.sharingLink,n=e.companyName,a=e.clientId,i=e.isListSharing,r=e.customLabeledAudienceConfig,o=e.fileExtension,d=e.isAccessSummaryLink,l=e.isFolder,u=t.sharingLinkKind,f=t.audience;if(t.isAddressBarLink)return _.D;if(t.isCreateOnlyLink)return!t.allowsAnonymousAccess&&n?m.j(l?_.Cd:_.ii,n):l?_.Od:_.ii;if(d)return _.k;switch(u){case s.a.requestAccess:var p=t.invitees[0],h=p.primaryText||p.email||p.id;return m.j(_.qh,h);case s.a.organizationView:return m.j(_.vc,n);case s.a.organizationEdit:return m.j(_.pc,n);case s.a.anonymousView:return _.V;case s.a.anonymousEdit:return _.L;case s.a.direct:return f===c.a.customLabeledSpecificPeople?t.isReview?r&&r.entityName?m.j(_.xc,r.entityName):J(a,"review",r,o):t.isEdit?r&&r.entityName?m.j(_.Dc,r.entityName):J(a,"edit",r):r&&r.entityName?m.j(_.Cc,r.entityName):J(a,"view",r):_.td;case s.a.flexible:return f===c.a.existing?_.td:f===c.a.anyone?t.blockDownload?t.hasPassword?_.X:_.W:t.hasPassword?t.isReview?b.a[o]?_.R:_.S:t.isEdit?_.Q:_.T:t.isManageList?_.M:t.isReview?b.a[o]?_.P:_.U:t.isEdit?i?_.N:_.L:_.V:f===c.a.customLabeledSpecificPeople?t.isManageList?r&&r.entityName?m.j(_.Ic,r.entityName):J(a,"edit",r):t.isReview?r&&r.entityName?m.j(_.xc,r.entityName):J(a,"review",r,o):t.isEdit?r&&r.entityName?m.j(i?_.Ic:_.Dc,r.entityName):J(a,"edit",r):r&&r.entityName?m.j(_.Cc,r.entityName):J(a,"view",r):t.audience===c.a.organization?t.blockDownload?m.j(_.yc,n):t.isManageList?m.j(_.mc,n):t.isReview?b.a[o]?m.j(_.bc,n):m.j(_.gc,n):t.isEdit?m.j(i?_._c:_.pc,n):m.j(_.vc,n):t.blockDownload?_.Ej:t.isManageList?_.Dj:t.isReview?b.a[o]?_.hh:_.bh:t.isEdit?i?_.Ij:_.Sj:_.wj;default:return""}}function $(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function ee(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function te(e){for(var t=[],n=e.principals,a=e.invitees,i=0,r=n;i<r.length;i++){var o=r[i];t.push($(o))}for(var s=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push($(e))},c=0,d=a;c<d.length;c++)s(d[c]);return t}function ne(e){if(!e)return 0;var t=0,n=e.length,a=0,i=!1;if(0===e.length)return 0;for(;a<n;){var r=null,o=e[a];" "===o?r=a+1<n&&" "===e[a+1]||i?"&#160;":" ":"\n"===o?(r="<br />",i=!0):('"'===o?r="&quot;&quot;&quot;":"&"===o?r="&amp;":"'"===o?r="&#39;":"<"===o?r="&lt;":">"===o?r="&gt;":"\r"===o&&(r=" "),i=!1),t+=null!==r?r.length:1,a++}return t}function ae(e,t,n,a){var i,r;switch(e){case o.a.manageList:i="EditListPencil",r=_.gb;break;case o.a.edit:i="Edit",r=t?_.vb:_.Db;break;case o.a.view:i="View",r=_.Pb;break;case o.a.review:i="Feedback",r=_.wb;break;case o.a.owner:i="Signin",r=_.kd;break;case o.a.restrictedview:i="BlockDownloadIcon",r=_.Lb;break;case o.a.submit:i="FileRequest",r=a?_.Eb:_.Cb;break;case o.a.none:i="Delete",r=_.Bc}return{name:i,title:n?r.toLowerCase():r}}function ie(e){var t=o.a.none,n=oe(),a=e.accessMap;return null==a||a.forEach(function(e){var a=se(e);n.indexOf(a)>n.indexOf(t)&&(t=a)}),t}function re(e,t,n){void 0===n&&(n=i.GREATERTHAN_OREQUAL);var a=oe();switch(n){case i.GREATERTHAN:return a.indexOf(e)>a.indexOf(t);case i.GREATERTHAN_OREQUAL:default:return a.indexOf(e)>=a.indexOf(t)}}function oe(){return[o.a.none,o.a.submit,o.a.restrictedview,o.a.view,o.a.review,o.a.edit,o.a.manageList,o.a.owner]}function se(e){var t=e.role,n=e.rawPermission;if(e.isSPO);else if(v.e()||n){if(n.roles){t=o.a.view;for(var a=0,i=n.roles;a<i.length;a++)"write"===i[a]&&(t=o.a.edit)}n.link&&n.link.type&&("edit"===n.link.type?t=o.a.edit:"view"===n.link.type&&(t=o.a.view))}return t}function ce(e){return e===o.a.edit||(0,v.P)()&&e===o.a.manageList}function de(e){return(0,v.H)()&&e===c.a.specificPeople||e===c.a.specificPeopleFlex}function le(e,t){var n=(0,v.P)()&&h.c(e)&&(null==t?void 0:t.sharedObjectType)===g.a.list,a=(null==t?void 0:t.sharedObjectType)===g.a.list&&(t.userRole===o.a.manageList||t.userRole===o.a.owner);return n||a?o.a.manageList:o.a.edit}function ue(e,t){var n=a.none,i=t;if(!e||e.getTime()===new Date(0).getTime())return n;var r=new Date;r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-r.getTime())/864e5);return o<1?n=a.pastDate:o>730?n=a.overMax:o>i&&-1!==i&&(n=a.adminPolicy),n}function fe(e,t){return e===c.a.anyone?t?s.a.anonymousEdit:s.a.anonymousView:e===c.a.organization?t?s.a.organizationEdit:s.a.organizationView:e===c.a.specificPeople||e===c.a.existing?s.a.direct:s.a.flexible}function pe(e,t){switch(e){case a.pastDate:return _.sg;case a.adminPolicy:return m.j(_.F,t);case a.overMax:return m.j(_.xe,730);case a.adminRequired:return _.$h;default:return""}}function me(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function _e(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function he(e,t,n){return h.j(e)||t===l.a.linkSettings&&h.l(e)&&n&&(!!n.entityName||!!n.audienceType)}function be(e){var t=e;if(-1===t)return null;var n=new Date;return n.setDate(n.getDate()+t),n}function ge(e){var t,n;return(0,r.b)(this,void 0,void 0,function(){var a,i,o,s,c,d,f,p,m,_,b,g,E,A,L,k;return(0,r.e)(this,function(M){switch(M.label){case 0:if((0,O.a)())return window.sessionStorage.setItem("copiedLink",(null===(t=e.textField)||void 0===t?void 0:t.value)||e.linkUrl),[2,!0];if(a=!1,h.f(e.clientId))return[3,8];i=null,o=new D.a({name:"shareLinkCopyFromBrowser"}),s=new D.a({name:"shareLinkExecCopyCommandToClipboard"}),c=e.textField,(0,v.w)()&&!c&&((c=document.createElement("textarea")).textContent=e.linkUrl,c.style.top="0",c.style.left="0",c.style.position="absolute",c.style.opacity="0",document.body.appendChild(c));try{c.focus(),c.setSelectionRange(0,c.value.length),a=document.execCommand("copy"),s.end({resultType:D.b.Success})}catch(e){i=e,A=new C.a({code:"exeCopyCommandError",innerError:e}),s.end((0,x.a)((0,I.a)(e),{resultCode:A.code}))}if(!window.navigator||!window.navigator.clipboard)return[3,7];d=new D.a({name:"shareLinkClipboardWrite"}),M.label=1;case 1:return M.trys.push([1,6,,7]),"write"in window.navigator.clipboard&&e.itemName?(f=(null==c?void 0:c.value)||e.linkUrl,p="text/plain",m="text/html",_=new Blob([f],{type:p}),b=new Blob(["<a href=".concat(f,">").concat(y.a.encodeText(e.itemName),"</a>")],{type:m}),g=[new ClipboardItem((k={},k[p]=_,k[m]=b,k))],[4,window.navigator.clipboard.write(g)]):[3,3];case 2:return M.sent(),[3,5];case 3:return[4,window.navigator.clipboard.writeText((null==c?void 0:c.value)||e.linkUrl)];case 4:M.sent(),M.label=5;case 5:return a=!0,d.end({resultType:D.b.Success}),[3,7];case 6:return E=M.sent(),i=E,A=new C.a({code:"clipboardWriteError",innerError:E}),d.end((0,x.a)((0,I.a)(E),{resultCode:A.code})),[3,7];case 7:(0,v.w)()&&!e.textField&&document.body.removeChild(c),L={resultType:D.b.Success},a||(L=(0,x.a)((0,I.a)(i),{resultCode:(null==i?void 0:i.code)||"copyFromBrowserError"})),L.extraData=(0,r.a)((0,r.a)((0,r.a)({},L.extraData),e.extraQosData),{clientId:u.a[e.clientId],mode:l.a[null===(n=e.extraQosData)||void 0===n?void 0:n.mode],isCrossDomainSharePointHosted:(P=new w.a(location.href),P.getPath(!0).indexOf("/_layouts/15/sharedialog.aspx")>=0&&"true"===P.getQueryParameter("crossdomain"))}),o.end(L),M.label=8;case 8:try{a=(0,v.nb)()?(0,S.c)(e.linkUrl)||a:(0,S.c)(e.linkUrl)}catch(e){}return[2,a]}var P})})}function ve(e,t){return e&&e.toLowerCase().indexOf("/_layouts/15/userphoto.aspx")>=0&&location.href.toLowerCase().indexOf("sharedialog.aspx")<0&&(h.h(t)||h.o(t))}function ye(e,t,n){return A.c()&&e.isCreateOnlyLink?o.a.submit:e.isManageList?o.a.manageList:e.isEdit?le(t,n):e.isReview?o.a.review:e.blockDownload?o.a.restrictedview:o.a.view}function Se(e,t){var n=e.sharingLinks,a=e.sharingPrincipals,i=t?n:n.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==s.a.direct&&(!e.expiration||t.getTime()>Date.now())&&(!e.isAddressBarLink||e.isAddressBarLink&&e.principals.length>0)&&!0!==e.isUnhealthy}),r=!!i.length;if(!r&&a.length)for(var c=0,d=a;c<d.length;c++)if(d[c].role!==o.a.owner){r=!0;break}return{shared:r,activeLinks:i,sharingPrincipals:a}}function De(e){var t;switch(e){case f.a.user:t="user";break;case f.a.none:t="none";break;default:t="group"}return t}function Ie(e){var t=new Date(null),n=new Date(0),a=e instanceof Date&&!isNaN(e.getTime()),i=!1;if(a)try{var r=new Date(e),o=r.getFullYear&&r.getFullYear();0!==o&&1!==o||(i=!0)}catch(e){}return!e||e===t||e===n||i||!a}!function(e){e[e.none=0]="none",e[e.pastDate=1]="pastDate",e[e.adminPolicy=2]="adminPolicy",e[e.overMax=3]="overMax",e[e.adminRequired=4]="adminRequired"}(a||(a={})),function(e){e[e.GREATERTHAN=0]="GREATERTHAN",e[e.GREATERTHAN_OREQUAL=1]="GREATERTHAN_OREQUAL"}(i||(i={}));var xe,Ce,Oe=340,we=480,Ee=function(e){var t=e.clientId,n=e.companyName,a=e.currentSettings,i=e.customLabeledAudienceConfig,r=e.sharingInformation,d=e.sharingStore;if(!a||!r)return"";if((null==n?void 0:n.length)>_.zb.length&&(n=_.zb),("video"===(0,L.a)(r.fileExtension)||Me(t,d))&&a.sharingRole===o.a.restrictedview||a.preventDownload){if(a.audience===c.a.anyone)return _.W;if(a.audience===c.a.organization)return m.j(_.yc,n);if(a.audience===c.a.specificPeopleFlex)return _.Ej;if(a.preventDownload&&a.sharingRole===o.a.restrictedview&&a.audience===c.a.specificPeople)return _.Kh}switch(a.sharingLinkKind){case s.a.direct:return a.audience===c.a.specificPeople?r.requiresAccessApproval?_.Kh:a.sharingRole?ce(a.sharingRole)?_.Sj:a.sharingRole===o.a.review?b.a[r.fileExtension]?_.Cj:_.Oj:_.wj:a.isEdit?_.Sj:_.wj:_.td;case s.a.organizationView:return m.j(_.vc,n);case s.a.organizationEdit:return m.j(_.pc,n);case s.a.anonymousView:return _.V;case s.a.anonymousEdit:return _.L;case s.a.flexible:return Ae(t,n,a,i,r);default:return""}},Ae=function(e,t,n,a,i){return n.audience===c.a.existing?_.td:n.audience===c.a.specificPeopleFlex?n.sharingRole?n.sharingRole==o.a.manageList?_.xj:ce(n.sharingRole)?_.Sj:n.sharingRole===o.a.review?b.a[i.fileExtension]?_.Cj:_.Oj:_.wj:n.isEdit?_.Sj:_.wj:n.audience===c.a.customLabeledSpecificPeople?n.sharingRole===o.a.review?a&&a.entityName?m.j(_.xc,a.entityName):J(e,"review",a,i.fileExtension):n.isEdit?a&&a.entityName?m.j(_.Dc,a.entityName):J(e,"edit",a):a&&a.entityName?m.j(_.Cc,a.entityName):J(e,"view",a):n.audience===c.a.organization?n.sharingRole===o.a.review?b.a[i.fileExtension]?m.j(_.bc,t):m.j(_.gc,t):n.sharingRole==o.a.manageList?m.j(_.hc,t):n.isEdit?m.j(_.pc,t):m.j(_.vc,t):n.audience===c.a.anyone?n.sharingRole===o.a.review?b.a[i.fileExtension]?_.P:_.U:n.sharingRole==o.a.manageList?_.O:n.isEdit?_.L:_.V:""};function Le(e){switch(e){case o.a.restrictedview:return _.mb;case o.a.review:return _.ri;case o.a.edit:return _.qc;case o.a.view:return _.ok}return null}function ke(e,t){return t&&t.isCOB&&t.isCOB()}function Me(e,t){return t&&!v.ib()&&!t.isConsumer()&&!(!(0,v.pb)()&&e===u.a.sharePointPages)&&!h.c(e)&&!t.isCOB()}function Pe(e){var t=e.userRole===o.a.owner||e.userRole===o.a.edit;return v.k()&&!v.l()&&t&&e.discoverableByOrganizationEnabled}function Te(e,t,n){var a=e.url;if(t!==p.a.copy&&t!==p.a.outlook)return a;var i=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")}(),r=new w.a(a);(0,O.a)()||r.setQueryParameter("e",i);var o=n.getNavId();o&&r.setQueryParameter("nav",o);var s=n.getInvitationId();return s&&r.setQueryParameter("inviteid",s),r.toString()}function Ue(e){return"loop"===e||"fluid"===e}!function(e){e[e.none=0]="none",e[e.send=1]="send",e[e.copy=2]="copy"}(xe||(xe={})),function(e){e.unseen="unseen",e.seeing="seeing",e.dismissed="dismissed"}(Ce||(Ce={}))}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o.a}});var a=n(0),i=n(103),r=n(26),o=n(58),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t.prototype.end=function(t){return t&&t.extraData&&this.data.extraData&&(t=(0,a.a)((0,a.a)({},t),{extraData:(0,a.a)((0,a.a)({},this.data.extraData),t.extraData)})),e.prototype.end.call(this,t)},t}((0,i.a)({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:r.a.String},startTimeOverride:{isPrefixingDisabled:!0,type:r.a.Number},resultCode:{isPrefixingDisabled:!0,type:r.a.String},resultType:{typeRef:o.a,isPrefixingDisabled:!0,type:r.a.Enum},error:{isPrefixingDisabled:!0,type:r.a.String},extraData:r.a.Object,extraMetrics:{isPrefixingDisabled:!0,type:r.a.Object},privacyClassification:{isPrefixingDisabled:!0,type:r.a.String},objectType:{isPrefixingDisabled:!0,type:r.a.String},persistence:{isPrefixingDisabled:!0,type:r.a.Boolean}}).withData({privacyClassification:r.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}))}
,,function(e,t,n){n.d(t,{a:function(){return m},b:function(){return l},c:function(){return s},d:function(){return h},e:function(){return d},f:function(){return u},g:function(){return o},h:function(){return r},i:function(){return v},j:function(){return c},k:function(){return b},l:function(){return y},m:function(){return g},n:function(){return _},o:function(){return D},p:function(){return f},q:function(){return p},r:function(){return S}});var a=n(69),i=n(24);function r(e){return _(e)||b(e)||h(e)||g(e)||v(e)||function(e){return e===a.a.officemobileIos||e===a.a.officemobileAndroid}(e)}function o(e){return e===a.a.odb||e===a.a.sharePoint||e===a.a.odc||e===a.a.npe||e===a.a.consumerList||e===a.a.oneup||e===a.a.sharePointPages}function s(e){return e===a.a.consumerList}function c(e){return e===a.a.outlookWeb||e===a.a.outlookWindows||e===a.a.outlookMac||e===a.a.outlookAndroid||e===a.a.outlookiOS}function d(e){return e===a.a.odIos||e===a.a.wordIos||e===a.a.excelIos||e===a.a.visioIos||e===a.a.onenoteIos||e===a.a.powerpointIos||e===a.a.teamsIos||e===a.a.officemobileIos||e===a.a.listsIos||e===a.a.streamIos||e===a.a.loopIos||e===a.a.outlookiOS}function l(e){return e===a.a.odAndroid||e===a.a.wordAndroid||e===a.a.excelAndroid||e===a.a.visioAndroid||e===a.a.onenoteAndroid||e===a.a.powerpointAndroid||e===a.a.teamsAndroid||e===a.a.officemobileAndroid||e===a.a.streamAndroid||e===a.a.outlookAndroid}function u(e){return d(e)||l(e)}function f(e){return o(e)||e===a.a.onenoteWeb||e===a.a.outlookWeb||e===a.a.officecom||e===a.a.teams||e===a.a.sample||e===a.a.outlookGroupsWeb||e===a.a.fluid||e===a.a.odcWac||e===a.a.wac||e===a.a.businesscentral||e===a.a.listPart||e===a.a.listsHome||e===a.a.shareDemo||e===a.a.streamOnline||u(e)}function p(e){var t=!!i.D()&&(e===a.a.word||e===a.a.excel||e===a.a.powerpoint);return o(e)||e===a.a.officecom||e===a.a.wac||e===a.a.businesscentral||t}function m(e){return u(e)||y(e)}function _(e){return e===a.a.word||e===a.a.wordAndroid||e===a.a.wordIos}function h(e){return e===a.a.excel||e===a.a.excelAndroid||e===a.a.excelIos}function b(e){return e===a.a.powerpoint||e===a.a.powerpointAndroid||e===a.a.powerpointIos}function g(e){return e===a.a.visio||e===a.a.visioIos||e===a.a.visioAndroid}function v(e){return e===a.a.onenote||e===a.a.onenoteWeb||e===a.a.onenoteUWP||e===a.a.onenoteIos||e===a.a.onenoteAndroid}function y(e){return e===a.a.teams||e===a.a.teamsIos||e===a.a.teamsAndroid}function S(e){return e===a.a.odc||e===a.a.npe||i.Q()&&e===a.a.odcWac}function D(e){return e===a.a.word||e===a.a.excel||e===a.a.powerpoint||e===a.a.ngsc||e===a.a.visio||e===a.a.windowsShare}}
,,function(e,t,n){n.d(t,{a:function(){return l},b:function(){return d},c:function(){return o},d:function(){return s},e:function(){return c},f:function(){return u},g:function(){return f}});var a=n(0),i=n(6),r=n(129),o=function(){function e(e,t){this._type=e,this.dependencies=(0,a.a)((0,a.a)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){var t=new this._type({},e);return{instance:t,disposable:t}},e}(),s=function(){function e(e,t){this._type=e,this.dependencies=(0,a.a)((0,a.a)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){return{instance:(0,i.e)(this._type,e)}},e}(),c=function(){function e(e){this._type=e,this.dependencies={}}return e.prototype.create=function(){var e=new this._type;return{instance:e,disposable:(0,r.b)(e)?e:void 0}},e}(),d=function(){function e(e){this._load=e}return e.prototype.load=function(){var e=this._load().then(function(e){return new l(e)});return this.load=function(){return e},e},e}(),l=function(){function e(e){this.dependencies={value:e.lazy}}return e.prototype.create=function(e){return{instance:e.value()}},e}();function u(e,t,n){return new i.b({name:e,factory:new o(t,n)})}function f(e,t,n){return new i.b({name:e,factory:new s(t,n)})}i.c.prototype.alias=function(e,t){return this.exposeFactory(e,new l(t))}}
,,function(e,t,n){n.d(t,{$:function(){return ne},A:function(){return P},B:function(){return Z},C:function(){return fe},D:function(){return ge},E:function(){return E},F:function(){return v},G:function(){return X},H:function(){return M},I:function(){return g},J:function(){return H},K:function(){return he},L:function(){return ae},M:function(){return O},N:function(){return ee},O:function(){return ue},P:function(){return m},Q:function(){return y},R:function(){return h},S:function(){return Ie},T:function(){return N},U:function(){return _},V:function(){return _e},W:function(){return q},X:function(){return ie},Y:function(){return se},Z:function(){return ce},_:function(){return R},_b:function(){return Q},a:function(){return F},ab:function(){return k},b:function(){return s},c:function(){return pe},cb:function(){return re},d:function(){return l},db:function(){return de},e:function(){return le},eb:function(){return xe},f:function(){return z},fb:function(){return De},g:function(){return C},h:function(){return U},i:function(){return me},ib:function(){return W},j:function(){return b},k:function(){return ve},l:function(){return ye},lb:function(){return S},m:function(){return K},mb:function(){return Se},n:function(){return x},nb:function(){return T},o:function(){return I},ob:function(){return te},p:function(){return $},pb:function(){return V},q:function(){return G},r:function(){return D},rb:function(){return J},s:function(){return p},sb:function(){return f},t:function(){return Y},tb:function(){return Ce},u:function(){return B},ub:function(){return oe},v:function(){return j},w:function(){return A},x:function(){return be},y:function(){return w},z:function(){return L}});var a=n(38),i=n(46),r=n(3),o=window._spPageContextInfo,s=(o&&"21"===o.webTemplate&&o.listBaseTemplate,{ODB:1466}),c=[],d=!1;function l(e,t){c=e,d=t}function u(e){var t=c.filter(function(t){return t.flightStringId===e})[0];return t?t.flightEnabled:e}function f(){return!0}function p(){return a.c.isFeatureEnabled({ODB:1977})}function m(){return a.c.isFeatureEnabled({ODB:60345})}function _(){return a.c.isFeatureEnabled({ODC:!0,ODB:!1,ECS:1081438,OneDrive:!!d||void 0})}function h(){return!a.c.isFeatureEnabled({ODC:u("ODCHideNonPremiumLinkFeatures"),ODB:!1,OneDrive:d?u("ODCHideNonPremiumLinkFeatures"):void 0})}function b(){return!0}function g(){return r.b.isActivated("4429323f-4400-4a98-a83b-4e27f4c42109","04/18/2024","Fix shared with update")||a.c.isFeatureEnabled({ECS:1253990})}function v(){return!r.b.isActivated("a0f6091d-e62c-4e67-b0a6-72bbb134892d","02/10/2023","fixPeoplePickerOdcCustomerPromise")&&!a.c.isFeatureEnabled({ECS:1069468})}function y(){return!a.c.isFeatureEnabled({ODC:r.b.isActivated("12EA7E85-1736-4E83-9E6E-E6F9610A692B","08/15/2023","FamilySharingWacKS"),ODB:!1,OneDrive:d?r.b.isActivated("12EA7E85-1736-4E83-9E6E-E6F9610A692B","08/15/2023","FamilySharingWacKS"):void 0})}function S(){return r.b.isActivated("bdd26309-eb3c-4f4f-9d14-ceef3e92cc6f","04/18/2024","update callout to use tooltip")||a.c.isFeatureEnabled({ECS:1254087})}function D(){return!r.b.isActivated("da13eadb-9185-4fff-895e-e7d4e149be07","01/18/2023","external sharing in people picker")&&!a.c.isFeatureEnabled({ECS:1056503})}function I(){return!r.b.isActivated("46ea7091-d951-4da6-9e2f-b9b5c9296e37","09/19/2023","enable the premium features for M365 basic plan users")&&!a.c.isFeatureEnabled({ECS:1132844})}function x(){return!r.b.isActivated("34614db0-da1b-4a32-8252-3c0fb8f80913","09/19/2023","enable the premium features for M365 basic plan users")&&!a.c.isFeatureEnabled({ECS:1169459})&&a.c.isFeatureEnabled({ODB:60907})}function C(){return!r.b.isActivated("8a705e30-e665-4b70-a48f-be3b5872cdb4","10/22/2021","copyLink shortcut experiment killswitch")&&!a.c.isFeatureEnabled({ECS:108074})}function O(){return!r.b.isActivated("4e2301ca-b8b4-48c0-b35a-006b9c31b18c","12/28/2023","re share the existing link to others")&&!a.c.isFeatureEnabled({ECS:1146219})&&a.c.isFeatureEnabled({ODB:61265})}function w(){return!r.b.isActivated("cb7d2c6b-f7da-457b-aca2-d8b94f0ababb","01/18/2023","fixLinkSettingsOpenLog")&&!a.c.isFeatureEnabled({ECS:1064203})}function E(){return!r.b.isActivated("b94c9c2c-6f5f-4f91-b002-0bd352472576","01/05/2023","fixOnAudienceChange")&&!a.c.isFeatureEnabled({ECS:1061682})}function A(){return!r.b.isActivated("fd9b2be1-792b-4b24-b915-b69e7b79c2cb","04/13/2023","fixCopyToClipboard")&&!a.c.isFeatureEnabled({ECS:1083754})}function L(){return!r.b.isActivated("03fde877-4287-4f2a-9c7f-da996bdcb7a6","04/24/2023","fixLinkSettingsOtherSettings")&&!a.c.isFeatureEnabled({ECS:1083754})}function k(){return!r.b.isActivated("65dd8983-4519-47bf-9156-e7618de4084f","05/14/2023","simplifiedExternalSharingDisabledString")&&!a.c.isFeatureEnabled({ECS:1091332})}function M(){return!r.b.isActivated("3678da5a-a9b1-4dd4-9a03-0f586704406b","05/22/2023","fixRequireSignInAndPSLCreateLink")&&!a.c.isFeatureEnabled({ECS:1093387})}function P(){return!r.b.isActivated("2153f182-6d03-4ca4-909f-8064ad3c3f6f","07/27/2023","fixLinkSettingsPeoplePicker")&&!a.c.isFeatureEnabled({ECS:1113931})}function T(){return!r.b.isActivated("03db8451-92a3-47a5-be55-af82ccce6e39","06/13/2023","simplifiedCopyCommandNotification")&&!a.c.isFeatureEnabled({ECS:1093764})}function U(){return!r.b.isActivated("177e3f91-46d3-41ba-8c8f-8dc1fad68910","02/12/2024","copyPermissionMaxWaitEnabled")&&!a.c.isFeatureEnabled({ECS:1230381})}function F(){return!r.b.isActivated("1dee4d47-8282-45c8-937b-7c1636991a61","02/20/2024","ShareDialogSingleCxP")&&!a.c.isFeatureEnabled({ECS:1233537})&&a.c.isFeatureEnabled({ODB:61483})}function H(){return!r.b.isActivated("70804dcd-05a5-476e-8599-c2a14e37cff7","05/29/2024","graduateCleanUpDefaultLink")&&!a.c.isFeatureEnabled({ECS:1266299})}function R(){return!r.b.isActivated("dcfb2c5d-46bc-4a7f-8970-f5066f36bb16","10/12/2021","Share To Teams in web")}function N(){return!r.b.isActivated("e6dbe5d1-55f9-439b-a975-1931c6bf9c90","02/25/2021","People picker improvements")&&!a.c.isFeatureEnabled({ECS:1005398})}function B(){return a.c.isFeatureEnabled({ODC:!0,ODB:!1,OneDrive:!!d||void 0})}function j(){return a.c.isFeatureEnabled({ODC:"fixAddMetionWithSendingInvitationAndRequiredSignin"})}function V(){return!r.b.isActivated("da505fd8-1316-4d4e-ad83-5f0ed0ef406b","09/28/2023","Enable simplified dialog use in SharePoint pages.")&&i.a.isFeatureEnabled({ODB:61243})}function z(){return!r.b.isActivated("2a092b3f-6729-4a0a-a847-7c2e1dc366e9","1/24/2023","Contextual Sharing Feature")&&!i.a.isFeatureEnabled({ECS:1065461})&&a.c.isFeatureEnabled({ODB:1743})}function G(){return!r.b.isActivated("d685ea9e-632d-414f-9b9c-6982bc1c6eec","01/24/2023","Disables expiration date picker based on get/delete submitOnlyLink status.")}function K(){return!r.b.isActivated("a8176101-afe0-4540-975d-cd326db8ee52","01/23/2023","Allows file request sharelink to be edited from manage access pane.")}function W(){return r.b.isActivated("00ece790-28cb-4228-b947-70c6cf959b9e","6/5/2023","Simplified Sharing Dialog v2")||i.a.isFeatureEnabled({ECS:1098348})}function q(){return r.b.isActivated("5670332e-84d5-4de8-9fe0-a7c915bc6e2b","02/16/2023","KS for removing owner from permission parser because there is owner information already")||i.a.isFeatureEnabled({ECS:1070385})}function Q(){return r.b.isActivated("c34e5556-e4c2-4fa7-b6fe-e5b41dfaa583","06/20/23","KS to make set Address Bar link capability async")}function Y(){return a.c.isFeatureEnabled({ODB:61409})}function J(){return r.b.isActivated("64103F30-0A20-4BC5-9C23-767B39B7E1B0","05/20/2024","Killswitch for simplified Share Dialog for Multi share in COB")||a.c.isFeatureEnabled({ECS:1262035})}function X(){return r.b.isActivated("da9c64d3-7161-4c87-a416-07462746bad2","03/09/2023","KS for fixing premium check issue in COB")||i.a.isFeatureEnabled({ECS:1075055})}function Z(){return r.b.isActivated("6f986fc9-cf86-4f2d-8441-d526e25b5dfa","03/08/2024","KS for fixing ui issue in manage access for COB")||i.a.isFeatureEnabled({ECS:1239525})}function $(){return r.b.isActivated("ccfe8581-04e5-4529-b8c4-d2b8512f0b1a","03/23/2023","KS for showing search directory, and filtering personas based on email to remove duplicates")||i.a.isFeatureEnabled({ECS:1078726})}function ee(){return!r.b.isActivated("b865f69a-5f61-4fe3-a5be-9c7814d4523c","12/04/2023","Kill Switch for odc customer promise 1DS migration")&&!a.c.isFeatureEnabled({ECS:1168516})}function te(){return r.b.isActivated("d87ac6da-0b38-4349-b400-70765ba93cf0","07/30/2023","Skip inheritedFrom information for COB ManageAcess when empty inheritedFrom property is returned")||i.a.isFeatureEnabled({ECS:1114780})}function ne(){return!r.b.isActivated("bb399db8-d12a-41cf-b8ff-842ab535aff2","01/31/2024","Add shield icon to share dialog next sensitivity label")&&!r.b.isActivated("8c0c3ca2-27a1-4644-872e-1ce56e2c8a96","08/25/2023","KS for AugLoop Office text-summarization workflow integration with SWS")&&a.c.isFeatureEnabled({ODB:1695})}function ae(){return!r.b.isActivated("b51e45fe-eb94-43ac-9e79-5767035ba4c1","11/26/2023","Add hover border none for ShareHintDetail")}function ie(){return r.b.isActivated("eace855f-1ff6-4ee2-8bff-a8ae5b055046","12/13/2023","render limited sharing info bar ks")||a.c.isFeatureEnabled({ECS:1174630})}function re(){return!r.b.isActivated("f2c3cdac-6973-4b45-95a8-b7ac158b03e1","12/08/2023","update account type of telemetry context in ODC share dialog")&&!a.c.isFeatureEnabled({ECS:1176045})}function oe(){return r.b.isActivated("2779ce1e-8a4e-44e9-a225-df8f9ed4a16f","03/05/2024","update error dialog UI")||a.c.isFeatureEnabled({ECS:1238386})}function se(){return a.c.isFeatureEnabled({ODB:61570})}function ce(){return r.b.isActivated("1675dcd1-2c70-420e-8f22-53f843cb6405","03/11/2024","Save link settings")||a.c.isFeatureEnabled({ECS:1240512})}function de(){return r.b.isActivated("42ba9856-fb92-429a-9759-8060aeb7197d","03/08/2024","update cob strings")||a.c.isFeatureEnabled({ECS:1239782})}function le(){return r.b.isActivated("fca8d09b-84b0-40e9-bdf0-c4de5894c301","03/15/2024","Check if permission item exists")||a.c.isFeatureEnabled({ECS:1242231})}function ue(){return r.b.isActivated("85AF52C5-8829-475D-A8BE-0691616A127C","03/15/2024","Set Peoplepicker AllowEmailAddress To GSI value")||a.c.isFeatureEnabled({ECS:1241903})}function fe(){return r.b.isActivated("d62a393a-8ba6-48ce-bd61-ce52e7a4597a","03/18/2024","fix People picker non mail SG not showing up for search directory")||a.c.isFeatureEnabled({ECS:1242780})}function pe(){return r.b.isActivated("3d59aad1-8d63-4530-b8db-ef5288f5c3d8","03/20/2024","added RAC status codes and errors")||a.c.isECSFeatureEnabled({ECS:1243679})}function me(){return r.b.isActivated("e7cef9af-92d2-4cfe-8c5e-7714614bb24f","03/25/2024","use direct sharing abilities to determine roles in role selector")||a.c.isFeatureEnabled({ECS:1245091})}function _e(){return r.b.isActivated("a2c4b5c2-b9cd-4ac9-859c-54df4ebc01be","03/31/2024","refactor external sharing to use GSI abilities")||a.c.isFeatureEnabled({ECS:1247103})}function he(){return r.b.isActivated("200f831c-197e-4c85-a49b-6bd14127e4ed","04/03/2024","Hide stop sharing for non owners")||a.c.isFeatureEnabled({ECS:1248778})}function be(){return r.b.isActivated("6967cd22-db4f-4858-884c-3cfb8268a56b","04/03/2024","KS for fixing double owners in sites")||i.a.isFeatureEnabled({ECS:1248688})}function ge(){return r.b.isActivated("804718de-5d0f-41b8-b0cc-e61d1099fd9e","05/31/2024","KS for fixing owa post message")||i.a.isFeatureEnabled({ECS:1266954})}function ve(){return i.a.isFeatureEnabled({ODB:61663})}function ye(){return r.b.isActivated("9e8ce715-6bb4-42b4-806c-ac3e4207b56c","04/11/2024","KS for rendering company wide sharing banner")||i.a.isFeatureEnabled({ECS:1251392})}function Se(){return r.b.isActivated("28149d98-4834-4d96-8379-9357c4244f2b","04/15/2023","KS to use array name to determine length of header")||i.a.isFeatureEnabled({ECS:1252731})}function De(){return r.b.isActivated("fef14f7d-40e9-4d65-9b09-2359315d55c0","04/10/2024","KS for updating isSPO logic")||i.a.isFeatureEnabled({ECS:1251004})}function Ie(){return r.b.isActivated("58cfbb9e-8b61-4f01-b66e-ca40d7566b00","05/22/2024","Use custom config if customLabeledAudience is defined")||a.c.isFeatureEnabled({ECS:1264512})}function xe(){return r.b.isActivated("4afb9cae-d2ee-4bba-99b3-235ddefb13c7","06/06/2024","Show emails in COB")||a.c.isFeatureEnabled({ECS:1269292})}function Ce(){return r.b.isActivated("68a90ae4-829a-417e-8518-549227a0ca16","06/12/2024","Show policy tip for existing guest")||a.c.isFeatureEnabled({ECS:1272118})}}
,,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return s}});var a={};n.r(a),n.d(a,{optionalDiagnostic:function(){return r},requiredDiagnostic:function(){return i},requiredService:function(){return o}});var i="requiredDiagnostic",r="optionalDiagnostic",o="requiredService",s=a,c={String:1,Number:2,Boolean:3,Object:4,Array:5,Enum:6}}
,,,function(e,t){var n;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople",e[e.direct=6]="direct"}(n||(n={})),t.a=n}
,,function(e,t){var n;!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(n||(n={})),t.a=n}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(a||(a={}))}
,,,function(e,t,n){n.d(t,{a:function(){return _},b:function(){return u},d:function(){return p},e:function(){return f}});var a=n(0),i=n(6),r=n(22),o=n(59),s=n(67),c=n(152),d=n(213),l="@ms/odsp-shared/lib/base/BaseModel",u=new i.b({name:"".concat(l,".asyncType"),factory:new i.a(s.a)}),f=new i.b({name:"".concat(l,".observablesFactoryType"),factory:new r.d(c.a,{asyncType:u.optional})}),p=new i.b({name:"".concat(l,".eventGroupType"),factory:new i.a(o.a)}),m=new i.b({name:"".concat(l,".errorHandler")}),_=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.id,r=void 0===i?"":i;return a.id=r,a._BaseModel_dependencies=n,a}return(0,a.d)(t,e),Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})},t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)},t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)},t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)},t.prototype.addDisposable=function(e){return this.scope.attach(e)},t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.wrapObservable=function(e){return this.observables.wrap(e)},t.prototype.peekUnwrapObservable=function(e){return(0,c.c)(e)},t.prototype.createObservable=function(e){return this.observables.create(e)},t.prototype.unwrapObservable=function(e){return(0,c.d)(e)},t.prototype.isObservable=function(e){return(0,c.b)(e)},t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getAsync=function(){return e},e},t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getEvents=function(){return e},e},t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});return this._BaseModel_getObservables=function(){return e},e},t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(u.optional)||s.a},t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.a},t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(f.optional)||(0,i.e)(c.a,{asyncType:this._BaseModel_getAsyncType()}))||c.a},t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(m.optional)},t.dependencies=(0,a.a)((0,a.a)({},d.a.dependencies),{asyncType:u.optional,observablesFactoryType:f.optional,eventGroupType:p.optional,errorHandler:m.optional}),t}(d.a);t.c=_}
,,function(e,t,n){var a=n(126);t.a=a}
,function(e,t,n){n.d(t,{a:function(){return d},b:function(){return c},d:function(){return y}});var a=n(45),i=n(3),r=n(46),o=n(317),s=i.a.isActivated("26b61085-e68c-4a13-a8de-ae84ba2d96d2","1/16/2023","Validate if window object is present or not"),c="enableFeatures",d="disableFeatures",l={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},u={ODB:357,Fallback:!1},f={ODB:342,Fallback:!1},p={ODB:60763,ODC:"AllowFeatureOverrides",Fallback:!1},m="FeatureOverrides",_={},h="".concat(m,"_").concat(c),b="".concat(m,"_").concat(d);function g(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}function v(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(h,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(b,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function y(){if(_){for(var e=[],t=0,n=Object.keys(_);t<n.length;t++){var a=n[t];e.push(_[a]?a:"!".concat(a))}return e.join(",")}}function S(e,t,n,a){if(t)for(var i=0,r=t.split(",");i<r.length;i++)e[l=r[i]]=!0;if(n)for(var o=0,s=n.split(",");o<s.length;o++)e[l=s[o]]=!1;if(a)for(var c=0,d=a.split(",");c<d.length;c++){var l;"!"===(l=d[c])[0]?e[l.slice(1)]=!1:e[l]=!0}return e}var D=function(){function e(){}return Object.defineProperty(e,"Overrides",{get:function(){return _},enumerable:!1,configurable:!0}),e.evaluateCanOverride=function(){s||"undefined"!=typeof window?e.CanOverride=r.a.isFeatureEnabled(l)||r.a.isFeatureEnabled(u)||r.a.isFeatureEnabled(f)||r.a.isFeatureEnabled(p)||!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode):e.CanOverride=!1},e.isFeatureEnabled=function(t,n){return e._isFeatureEnabled(t,n)},e.isECSFeatureEnabled=function(t,n){return e._isECSFeatureEnabled(t,n)},e._isFeatureEnabled=function(t,n){if(e.CanOverride){if(t.ODB in _)return _[t.ODB];if(t.ODC in _)return _[t.ODC]}return n?(0,o.b)(t,n):r.a.isFeatureEnabled(t)},e._isECSFeatureEnabled=function(e,t){return t?(0,o.a)(e,t):r.a.isFeatureEnabled(e)},e.AllowFeatureOverrides=l,e.SPODebugOnlyCookieRedirect=u,e.ClientDebugFeatureOverrides=p,e}();t.c=D,D.evaluateCanOverride(),D.CanOverride&&function(){_=S({},g(h),g(b),void 0);var e=location.search?location.search.substring(1):"",t=(0,a.a)(e),n=t[c],i=t[d],r=t.debugFlights;S(_,n,i,r),v(_);try{window.__debugSetFeature=function(e,t){void 0===t&&(t=!0),_[e]=!!t,v(_)}}catch(e){}}()}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(a||(a={}))}
,,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return d.a},c:function(){return p},d:function(){return u}});var a,i=n(0),r=n(79),o=n(26),s=n(452),c=n(109),d=n(275),l=0;function u(e,t,n,a){(0,c.a)(e,t);var r={};for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var d=n[s],l=r[s]="number"==typeof d?{type:d}:d;l.definedInName=t.shortEventName,l.type===o.a.Number&&(l.isMetric=!0)}e.metadata=a?(0,i.a)((0,i.a)({},a.prototype.metadata),r):r}!function(e){e[e.Consumer=0]="Consumer",e[e.ConsumerAnonymous=1]="ConsumerAnonymous",e[e.Business=2]="Business",e[e.BusinessAnonymous=3]="BusinessAnonymous",e[e.Unknown=4]="Unknown",e[e.ConsumerOnSPO=5]="ConsumerOnSPO"}(a||(a={}));var f=new WeakMap,p=function(){function e(e,t,n){this.context={},this.data={},this.context=(0,i.a)({},this.addContext({})),this.id=l++,n&&(this.parentId=n.id),this.startTime=e&&e.startTimeOverride||r.a.getTime(),this.vector=new s.a(n?n.vector:s.a.RootVector),e&&this._setData(e),this._logEvent(t)}return e.isTypeOf=function(e){return e.eventName?e.eventName.indexOf(this.prototype.shortEventName+",")>=0:!!e.prototype&&e.prototype.shortEventName===this.prototype.shortEventName},e.withManager=function(e){if(!e||e===r.a)return this;var t=f.get(e);t||(t=new WeakMap,f.set(e,t));var n=t.get(this);if(n)return n;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.d)(t,e),t}(this);return a.prototype.manager=e,n=a,t.set(this,n),n},e.withData=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return(0,i.a)((0,i.a)({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,i.d)(n,e),n.prototype.addData=function(n){var a=(0,i.a)((0,i.a)({},n),t(n));return(0,i.a)((0,i.a)({},a),e.prototype.addData.call(this,a))},n}(this);return n},e.withContext=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return(0,i.a)((0,i.a)({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,i.d)(n,e),n.prototype.addContext=function(n){var a=(0,i.a)((0,i.a)({},n),t(n));return(0,i.a)((0,i.a)({},a),e.prototype.addContext.call(this,a))},n}(this);return n},e.from=function(e){return e?this.withManager(e.prototype.manager).withContext(function(t){return e.prototype.addContext(t)}).withData(function(t){return e.prototype.addData(t)}):this},e.prototype.addContext=function(e){return _(this.manager,e,{})},e.prototype.addData=function(e){return e},e.prototype._setData=function(e){var t=(0,i.a)((0,i.a)({},this.addData(this.data)),e);!function(e,t,n,a){for(var i=0,r=Object.keys(n);i<r.length;i++){var o=r[i];o in t&&m(e,n,a,o,t[o])}}(this.manager,this.metadata,t,this.data)},e.prototype._logEvent=function(e){this.manager.logEvent(this,e)},e}();function m(e,t,n,a,i){var r=t[a];switch(typeof r){case"string":var o=e.cleanString(r,a,i);return void(void 0!==o&&(n[a]=o));case"undefined":return;case"object":return void(r&&Object.getPrototypeOf(r)===Object.prototype?n[a]=_(e,r,{}):n[a]=r);default:return void(n[a]=r)}}function _(e,t,n){for(var a=0,i=Object.keys(t);a<i.length;a++)m(e,t,n,i[a]);return n}var h=p.prototype;h.eventName="EventBase,",h.shortEventName="EventBase",h.critical=!1,h.manager=r.a}
,,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(1);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.IconButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.IconButton:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var i=n(28),r=n(27);function o(e){var t=e.iconProps,n=e.onClick,o=e.ariaLabel,s=e.tooltipContent,c=e.menuProps,d=e.menuIconProps,l=e.className,u=e.directionalHint,f=e.disabled,p=e.automationId,m=e.styles,_=e.tooltipStyles,h=a.useState(!1),b=h[0],g=h[1],v={gapSpace:0,calloutMaxWidth:180,hidden:b,styles:{root:{borderRadius:"4px"},beakCurtain:{borderRadius:"4px"}}};return a.createElement(i.a,{content:s,id:s,styles:_,calloutProps:v,directionalHint:u},a.createElement(r.a,{className:l||"IconButton",iconProps:t,onClick:n,onMenuClick:function(){g(!0)},onAfterMenuDismiss:function(){g(!1)},ariaLabel:o,menuProps:c,menuIconProps:d,disabled:f,"data-automationid":p,id:p,styles:m}))}}
,function(e,t,n){function a(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]))}return t}function i(e){return e.substring(e.indexOf("?")+1)}function r(e){return e.substring(0,e.indexOf("?"))}n.d(t,{a:function(){return a},b:function(){return i},c:function(){return r}})}
,function(e,t,n){var a,i,r,o,s,c,d=n(317),l=!1;function u(){var e;a=window.PageContext;var t=window.Flight;i=t&&t.Ramps,r=window.FilesConfig;var n=window.Flighting,d=window._spPageContextInfo;c=null===(e=window.Flight)||void 0===e?void 0:e.ecsRolloutsEnabled,!o&&d&&(!d.ExpFeatures&&n&&n.ExpFeatures&&(d.ExpFeatures=n.ExpFeatures),f.initSPExpFeatures(d.ExpFeatures)),!s&&d&&(null==d?void 0:d.ECSExpFeatures)&&f.initSPECSExpFeatures(d.ECSExpFeatures),l=!0}var f=function(){function e(){}return e.initSPExpFeatures=function(e){o=e},e.initSPECSExpFeatures=function(e){s={ClientFeatures:new Set(null!=e?e:[])}},e.isFeatureEnabled=function(e){l||u();var t=!!e.Fallback,n=e.ODB,f=e.ODC,p=e.ECS,m=e.OneDrive,_=e.ODBECS;return void 0!==n&&o&&(t=(0,d.b)(e,o)),void 0!==f&&r&&("boolean"==typeof f?t=f:(i&&i[f]||r&&r[f])&&(t=!0)),void 0!==p&&c&&c.indexOf(p)>=0&&(t=!0),void 0!==m&&a&&(t=m),void 0!==_&&s&&(t=(0,d.a)(e,s)),t},e.On={Fallback:!0},e.Off={},e}();t.a=f}
,function(e,t,n){n.d(t,{a:function(){return d}});var a,i=n(326),r=n(7);!function(e){e[e.scheme=0]="scheme",e[e.authority=1]="authority",e[e.path=2]="path",e[e.query=3]="query"}(a||(a={}));var o=/[;\/?:@&=$,]/,s=/[\/?]/;function c(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n].toLowerCase());return t}var d=function(){function e(e,t){this._scheme="",this._user="",this._host="",this._port="",this._path="",this._pathSegments=[],this._pathEncoded="",this._query={},this._fragment="",t&&(this._queryCaseInsensitive=!!t.queryCaseInsensitive,this._pathCaseInsensitive=!!t.pathCaseInsensitive),this._parseURI(e)}return e.concatenate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var a="",i=0;i<t.length;i++){var r=t[i];i>0&&(r=e.ensureNoPrecedingSlash(r)),i<t.length-1&&(r=e.ensureTrailingSlash(r)),a+=r}return a},e.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e},e.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e},e.prototype.getScheme=function(){return this._scheme},e.prototype.setScheme=function(e){this._scheme=e},e.prototype.getAuthority=function(){return this._getAuthority(!1)},e.prototype.setAuthority=function(e){this._parseAuthority(e)},e.prototype.getUser=function(){return this._user},e.prototype.getHost=function(){return this._host},e.prototype.getPort=function(){return this._port},e.prototype.getPath=function(e){var t=this._path;return e&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1)),t},e.prototype.getLeftPart=function(e){var t=this._scheme+"://";return e===a.authority&&(t+=this.getAuthority()),e===a.path&&(t+=this.getPath()),e===a.query&&(t+=this.getQuery()),t},e.prototype.setPath=function(e){"mailto"!==this.getScheme().toLowerCase()&&e&&"/"!==e[0]&&(e="/"+e),this._parsePath(e)},e.prototype.getPathSegments=function(){return this._pathSegments},e.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||""},e.prototype.getQuery=function(e){return this._serializeQuery(e)},e.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e))},e.prototype.getQueryAsObject=function(){return this._query},e.prototype.setQueryFromObject=function(e){for(var t in this._query={},e)e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t])},e.prototype.getQueryParameter=function(e){var t=null,n=this._query;if(this._queryCaseInsensitive)for(var a in e=e.toLowerCase(),n)n.hasOwnProperty(a)&&a.toLowerCase()===e&&(t=n[a]);else t=n[e];return t||null},e.prototype.setQueryParameter=function(e,t,n){void 0===n&&(n=!0);var a=this._decodeQueryString(t);(a||n)&&(this._query[this._decodeQueryString(e)]=a)},e.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)]},e.prototype.getFragment=function(){return this._fragment},e.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1)),this._fragment=this._decodeQueryString(e)},e.prototype.equals=function(e){return(0,r.f)(this._scheme,e.getScheme())&&this._user===e.getUser()&&(0,r.f)(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive)},e.prototype.equivalent=function(e){return(0,r.f)(this._scheme,e.getScheme())&&(0,r.f)(this._user,e.getUser())&&(0,r.f)(this._host,e.getHost())&&(0,r.f)(this._port,e.getPort())&&(0,r.f)(this.getPath(!0),e.getPath(!0))&&(0,i.a)(c(this.getQueryAsObject()),c(e.getQueryAsObject()))&&(0,r.f)(this._fragment,e.getFragment())},e.prototype.toString=function(e){return this._getStringInternal(!0,e)},e.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1)},e.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0)},e.prototype._equalsCaseAppropriate=function(e,t,n){return n?(0,r.f)(e,t):e===t},e.prototype._getStringInternal=function(e,t){var n=this._getStringWithoutQueryAndFragmentInternal(e,t),a=this.getQuery(e);return a&&(n+="?"+a),this._fragment&&(n+="#"+(e?encodeURIComponent(this._fragment):this._fragment)),n},e.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var n="";this._scheme&&(n+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var a=this._getAuthority(e,t);return a&&(n+="//"+a),this._pathEncoded&&(n+=e?this._pathEncoded:this._path),n},e.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=0,a=e.split(/[;&]+/);n<a.length;n++){var i=a[n],r=i.indexOf("=");r<0&&(r=i.length),r>0&&(t[i.substr(0,r)]=i.substr(r+1))}return t},e.prototype._serializeQuery=function(e){var t="";for(var n in this._query)if(this._query.hasOwnProperty(n)){var a=n,i=this._query[n];e&&(a=encodeURIComponent(a),i=encodeURIComponent(i)),t+=null===i||""===i?a+"=&":a+"="+i+"&"}return""!==t&&(t=t.slice(0,-1)),t},e.prototype._parseURI=function(e){var t=e,n=t.indexOf("#");if(n>=0){var a=t.substring(n+1);this.setFragment(a),t=t.substring(0,n)}var i=t.search(o);if(i>=0){":"===t[i]&&(this.setScheme(t.substring(0,i)),t=t.substring(i+1));var r="";if(0===t.indexOf("//")){var c=(t=t.substring(2)).search(s);if(c>=0?(r=t.substring(0,c),t=t.substring(c)):(r=t,t=""),this.setAuthority(r),!t)return void this.setPath("")}var d=t.indexOf("?");d>=0&&(this.setQuery(t.substring(d+1)),t=t.substring(0,d)),this.setPath(t)}else this.setPath(t)},e.prototype._parseAuthority=function(e){this._host=e;var t=e.lastIndexOf("@");t>=0&&(this._host=this._host.substring(t+1));var n=this._host.indexOf(":");if(!(t<0&&n<0)){var a=e;t<0?this._host=a:(this._user=a.substring(0,t),this._host=a.substring(t+1)),n>=0&&(this._port=this._host.substring(n+1),this._host=this._host.substring(0,n)),this._user=decodeURIComponent(this._user),this._host=decodeURIComponent(this._host)}},e.prototype._parsePath=function(e){try{this._path=decodeURIComponent(e)}catch(t){this._path=e}var t=this._pathSegments=[];this._pathEncoded=e;for(var n=e.split("/"),a=0;a<n.length;++a)try{t[a]=decodeURIComponent(n[a])}catch(e){t[a]=n[a]}""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()},e.prototype._getAuthority=function(e,t){void 0===t&&(t={});var n,a,i,r=t&&t.doNotPercentEncodeHost,o="";return e?(n=encodeURIComponent(this._user).replace("%3A",":"),a=r?this._host:encodeURIComponent(this._host),i=encodeURIComponent(this._port)):(n=this._user,a=this._host,i=this._port),""!==n&&(o=n+"@"),""!==this._host&&(o+=a),""!==this._port&&(o+=":"+i),o},e.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}return t},e}()}
,,,,function(e,t,n){n.d(t,{a:function(){return d}});var a=n(1),i=n(12);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.Header-width{width:100%}@media screen and (max-width:352px){.Header-width{max-width:294px}}.Header-flex-row{display:flex;flex-direction:row;align-items:center;column-gap:.25rem}.Header-flex-row i{font-size:.875rem}@supports (font:-apple-system-body){.Header-flex-row i{font:-apple-system-body}}.Header-flex-row button:hover{outline:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:4px}.Header-flex-grow{flex-grow:1}.Header-main-text{white-space:nowrap;overflow:hidden;display:flex;flex-direction:column;align-self:center}.Header-filename{margin:0;font-size:1.25rem;font-weight:600;overflow:hidden;text-overflow:ellipsis}@media screen and (max-width:511px){.Header-filename{font-size:1rem}@supports (font:-apple-system-body){.Header-filename{font:-apple-system-body}}}.Header-filename.ie{font-size:1.25rem}@supports (font:-apple-system-title2){.Header-filename{font:-apple-system-title2}}.Header-subheader{font-size:.875rem}@supports (font:-apple-system-body){.Header-subheader{font:-apple-system-body}}.Header-subheader.ie{max-width:320px;overflow:hidden;text-overflow:ellipsis}.Header-odc h1{font-size:1.25rem}.Header-contextual{font-weight:600;font-size:.75rem}.Header-actions{padding-left:5px;gap:5px;flex-shrink:1;row-gap:.5rem}.Header-actions button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.Header-backButton button{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin-right:5px}[dir=rtl] .Header-backButton button{transform:scale(-1,1)}"}]);var r=n(5),o=n(11),s=n(66),c=n(44);function d(e,t){var n=e.actions,i=e.mainHeaderText,d=e.subHeaderText,l=e.className,u=e.fullHeaderText,f=e.isFilenameTruncated,p=e.isSubHeaderTextTruncated,m=e.itemTypePrefix,_=e.renderBackButton,h=e.onBackButtonClicked,b=e.isContextualHeader,g=t.platformDetection,v=g.isIE?"ie":"",y="Header-filename ".concat(g.isMobile?"mobile ":""," ").concat(v),S=m?m+" "+i:i,D=function(){return b?a.createElement("div",{className:y+" Header-contextual","aria-label":f?void 0:S},i):a.createElement("h1",{className:y,"aria-label":f?void 0:S},i)},I=function(){return a.createElement("span",{className:"Header-subheader ".concat(v)},d)};return a.createElement("div",{className:"Header-flex-row Header-width ".concat(v," ").concat(l)},_&&a.createElement("div",{className:"Header-flex-row Header-backButton"},a.createElement(c.a,{iconProps:{iconName:"Back"},ariaLabel:o.ub,onClick:h,tooltipContent:o.ub,automationId:"Header-backButton"})),a.createElement("div",{className:"Header-main-text Header-flex-grow"},f?(0,s.b)(D(),u,{position:r.a.bottomLeftEdge}):D(),p?(0,s.b)(I(),d,{styles:{root:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"320px"}},position:r.a.bottomLeftEdge}):I(),_&&s.a(i,"assertive","alert")),a.createElement("div",{className:"Header-flex-row Header-actions"},n))}d.contextTypes={platformDetection:i.object.isRequired}}
,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0),i=n(41);function r(e,t){return new this(e,i.b.Single,t)}function o(e){return new this(null,i.b.Single,e)}function s(e,t,n){var s=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(n,e),n.logData=t?r:o,n}(i.c);return(0,i.d)(s.prototype,e,t||{},n),s}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0),i=function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,i=e,r=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("(?:edge|edgios)/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(r),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(r),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(r),u=r.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(r),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(r),isWindows10:!d&&r.indexOf("windows nt 10")>-1,isWindows7:!d&&r.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:i})}}
,function(e,t,n){var a=n(14),i=function(){function e(e){var t=this;this.resolve=function(e){t._promise._completed(e)},this.reject=function(e){t._promise._error(e)},this._promise=new a.b(e)}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.getPromise=function(){return this._promise},e.prototype.cancel=function(){this._promise.cancel()},e.prototype.complete=function(e){this._promise._completed(e)},e.prototype.error=function(e){this._promise._error(e)},e}();t.a=i}
,function(e,t,n){n.d(t,{A:function(){return g},B:function(){return O},C:function(){return P},a:function(){return E},b:function(){return _},c:function(){return y},d:function(){return z},e:function(){return h},f:function(){return N},g:function(){return w},h:function(){return B},i:function(){return R},j:function(){return j},k:function(){return S},l:function(){return I},m:function(){return V},n:function(){return H},o:function(){return C},p:function(){return L},q:function(){return A},r:function(){return M},s:function(){return F},t:function(){return T},u:function(){return D},v:function(){return U},w:function(){return x},x:function(){return G},y:function(){return v},z:function(){return b}});var a=n(69),i=n(31),r=n(29),o=n(328),s=n(18),c=n(17),d=n(24),l=n(104),u=n(327),f=n(68),p=n(20),m=!1;function _(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function h(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function b(e,t){try{window.external.ShareCompleted(e)}catch(a){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function g(e,t,n,a){try{window.external.ShareFailed(e,t,n,a)}catch(r){var i={name:"share_failed",shareType:e,rawError:t,errorCategory:n,errorMessage:a};window.parent.postMessage(JSON.stringify(i),"*")}}function v(e){try{window.external.ShareClicked(e)}catch(n){var t={name:"share_clicked",shareType:e};window.parent.postMessage(JSON.stringify(t),"*")}}function y(e){var t=!1,n=!1,a=new s.a({name:"sharingCopyToClipboardInterop"});try{var i=window.external;(0,d.nb)()||(n=!i.CopyToClipboard),t=i.CopyToClipboard(e),n=(0,d.nb)()?null==t||t:t||void 0===t,a.end({resultType:s.b.Success})}catch(t){if(!(i=window.external).CopyToClipboard){var r={name:"share_copyToClipboard",url:e};window.parent.postMessage(JSON.stringify(r),"*")}var o=new f.a({code:"windowExternalCopyToClipboardError",innerError:t});a.end((0,u.a)((0,l.a)(t),{resultCode:o.code}))}return n}function S(){var e=!1;try{e=window.external.IsSendCopyEnabled()}catch(e){}return e}function D(){try{window.external.SendCopy()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_sendCopy"}),"*")}}function I(){var e=!1;try{e=window.external.IsSendPdfEnabled()}catch(e){}return e}function x(){try{window.external.SendPdf()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_sendPdf"}),"*")}}function C(e){try{window.external.SendLinkViaMoreApps(e)}catch(e){}}function O(e,t,n){var a=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,a,n)}catch(i){var r={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:a,body:n};window.parent.postMessage(JSON.stringify(r),"*")}}function w(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function E(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(a){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function A(e,t,n,r,o,c){if(!p.h(t)){m?function(e,t,n,r,o,c){var d=a.a[t]||"unknown";new s.a({name:"ShareV3.".concat(i.a[n],".AfterPageLoad"),startTimeOverride:e||void 0}).end({resultType:o?s.b.Failure:s.b.Success,extraData:{clientId:d,scenario:r,isError:!!o,correlationId:c,error:o}})}(e,t,n,r,o.isStubFile?"file uploading":o.errorMessage||"unknown error",c):(k(e,t,n,r,o.errorMessage||"unknown error",c),m=!0);try{window.external.PageError(o.error,o.errorCategory,o.errorMessage,o.debugErrorMessage)}catch(e){var d={name:"share_error",error:o.error,errorCategory:o.errorCategory,errorMessage:o.errorMessage,debugErrorMessage:o.debugErrorMessage};window.parent.postMessage(JSON.stringify(d),"*")}}}function L(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function k(e,t,n,r,o,c){if(e){var d=a.a[t]||"unknown";new s.a({name:"ShareV3.".concat(i.a[n],".PageLoaded"),startTimeOverride:e}).end({resultType:o?s.b.Failure:s.b.Success,extraData:{clientId:d,scenario:r,isError:!!o,correlationId:c,error:o}})}}function M(e,t,n,a,i){if(m){k(e,t,n,a,void 0,i),r=new s.a({name:"Sharing.post_share_ready_instant_load"});try{o={name:"share_instantLoadReady"},window.parent.postMessage(JSON.stringify(o),"*"),r.end({resultType:s.b.Success})}catch(e){r.end({resultType:s.b.Failure,resultCode:"post_share_ready_instant_load_failure"})}}else{k(e,t,n,a,void 0,i);try{window.external.PageFinishedLoading(),new s.a({name:"Sharing.post_webview_share_ready"}).end({resultType:s.b.Success})}catch(e){var r=new s.a({name:"Sharing.post_iframe_share_ready"});try{var o={name:"share_ready"};window.parent.postMessage(JSON.stringify(o),"*"),r.end({resultType:s.b.Success})}catch(e){r.end({resultType:s.b.Failure,resultCode:"post_share_ready_failure"})}}m=!0}}function P(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function T(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function U(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function F(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function H(e,t,n,a,i){var o,s=(0,c.x)(i,e,n),d={sharingLink:e,companyName:t,clientId:i,isListSharing:a,customLabeledAudienceConfig:n},l=(0,c.z)(d),u=(0,c.K)(e.audience),f=(0,c.N)(e.status),p=e.audience===r.a.existing?"00000000-0000-0000-0000-000000000000":e.shareId,m=!1;try{window.external.LinkSettingsCompleted(p,e.url,s,l,u),m=!0}catch(e){}var _={id:p,expirationDateTime:null===(o=e.expiration)||void 0===o?void 0:o.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:s,localizedDescription:l,webUrl:e.url,scope:u,customLabeledAudience:e.audience===r.a.customLabeledSpecificPeople,status:f,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(_)),m=!0}catch(e){}if(!m){var h={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:p,linkUrl:e.url,iconUrl:s,linkDescription:l,scope:u,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===r.a.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(h),"*"),window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:_}),"*")}}function R(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function N(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function B(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}function j(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}}function V(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}}function z(){try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return o.a.none}}function G(e,t,n,a){try{window.external.SendViaOutlookWithContext(e,t,n,a)}catch(r){var i={name:"share_outlookWithContext",recipients:e,numRecipients:t,body:n,sharingLink:a};window.parent.postMessage(JSON.stringify(i),"*")}}}
,,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(315);function i(e){setTimeout(function(){throw e},0)}var r=function(){function e(t,n){void 0===n&&(n=i),this._id=e._uniqueId++,this._parent=t,this._onError=n,this._eventRecords=[]}return e.raise=function(e,t,n,i){return a.c(e,t,n,i)},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var a in t)this.on(e,a,t[a],n)},e.prototype.on=function(t,n,i,r){var o=this;if(n.indexOf(",")>-1)for(var s=n.split(/[ ,]+/),c=0;c<s.length;c++)this.on(t,s[c],i,r);else{var d=this._parent,l={target:t,eventName:n,parent:d,callback:i,objectCallback:null,elementCallback:null,useCapture:r};if((s=t.__events__=t.__events__||{})[n]=s[n]||{count:0},s[n][this._id]=s[n][this._id]||[],s[n][this._id].push(l),s[n].count++,a.b(t)){var u=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!o._isDisposed){var a;try{if(!1===(a=i.apply(d,t))&&t[0]&&t[0].preventDefault){var r=t[0];r.preventDefault(),e.stopPropagation(r)}}catch(r){o._onError(r)}return a}};l.elementCallback=u,t.addEventListener(n,u,r)}else l.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o._isDisposed)return i.apply(d,e)};this._eventRecords.push(l)}},e.prototype.off=function(e,t,n,a){for(var i=0;i<this._eventRecords.length;i++){var r=this._eventRecords[i];if(!(e&&e!==r.target||t&&t!==r.eventName||n&&n!==r.callback||"boolean"==typeof a&&a!==r.useCapture)){var o=r.target.__events__,s=o[r.eventName],c=s?s[this._id]:null;c&&(1!==c.length&&n?(s.count--,c.splice(c.indexOf(r),1)):(s.count-=c.length,delete o[r.eventName][this._id]),s.count||delete o[r.eventName]),r.elementCallback&&r.target.removeEventListener&&r.target.removeEventListener(r.eventName,r.elementCallback,r.useCapture),this._eventRecords.splice(i--,1)}}},e.prototype.raise=function(t,n,a){return e.raise(this._parent,t,n,a)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0},this._resizeCallback=e,this._callbackDelayMilliseconds=20}return e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)},e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback()),this._cachedRect=n}},e}()}
,,,,,function(e,t,n){n.d(t,{a:function(){return u},b:function(){return l}});var a=n(0),i=n(28),r=n(5),o=n(1),s={gapSpace:0},c={styles:{content:{fontSize:"0.75rem"}},maxWidth:"300px"},d=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-".concat(d);d++;var u=n.targetElementId?(0,a.a)((0,a.a)({},s),{target:"#".concat(n.targetElementId)}):s;return o.createElement(i.a,{id:l,content:t,directionalHint:void 0===n.position?r.a.topCenter:n.position,calloutProps:u,tooltipProps:c,styles:n.styles},e)}function u(e,t,n,a){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!a,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}}
,function(e,t,n){function a(){}function i(e){setTimeout(function(){throw e},0)}n.d(t,{a:function(){return r}});var r=function(){function e(e,t){void 0===t&&(t=i),this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._timeoutIds=null,this._immediateIds=null,this._animationFrameIds=null,this._intervalIds=null}return e.prototype.dispose=function(){if(!this._isDisposed){if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(var e=0,t=Object.keys(this._timeoutIds);e<t.length;e++){var n=t[e];this.clearTimeout(Number(n))}this._timeoutIds=null}if(this._immediateIds){for(var a=0,i=Object.keys(this._immediateIds);a<i.length;a++)n=i[a],this.clearImmediate(Number(n));this._immediateIds=null}if(this._intervalIds){for(var r=0,o=Object.keys(this._intervalIds);r<o.length;r++)n=o[r],this.clearInterval(Number(n));this._intervalIds=null}if(this._animationFrameIds){for(var s=0,c=Object.keys(this._animationFrameIds);s<c.length;s++)n=c[s],this.cancelAnimationFrame(Number(n));this._animationFrameIds=null}}},e.prototype.setTimeout=function(e,t){var n=this,a=0;if(!this._isDisposed){var i=this._timeoutIds||(this._timeoutIds={}),r=this._parent;a=setTimeout(function(){try{delete i[a],e.apply(r)}catch(e){n._logError(e)}},t),i[a]=!0}return a},e.prototype.clearTimeout=function(e){var t=this._timeoutIds;t&&t[e]&&(clearTimeout(e),delete t[e])},e.prototype.setImmediate=function(e){var t=this,n=0;if(!this._isDisposed){var a=this._immediateIds||(this._immediateIds={}),i=this._parent,r=function(){try{delete a[n],e.apply(i)}catch(e){t._logError(e)}};n=window.setImmediate?window.setImmediate(r):window.setTimeout(r,0),a[n]=!0}return n},e.prototype.clearImmediate=function(e){var t=this._immediateIds;t&&t[e]&&(window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e),delete t[e])},e.prototype.setInterval=function(e,t){var n=this,a=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});var i=this._parent;a=setInterval(function(){try{e.apply(i)}catch(e){n._logError(e)}},t),this._intervalIds[a]=!0}return a},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var i=this;if(void 0===n&&(n={}),this._isDisposed)return a;var r,o,s=t||0,c=n.leading,d=void 0===c||c,l=n.trailing,u=void 0===l||l,f=0,p=null,m=this._parent,_=function(t){var n=(new Date).getTime(),a=n-f,c=d?s-a:s;return a>=s&&(!t||d)?(f=n,p&&(i.clearTimeout(p),p=null),r=e.apply(m,o)):null===p&&u&&(p=i.setTimeout(_,c)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,_(!0)}},e.prototype.debounce=function(e,t,n){var i=this;if(void 0===n&&(n={}),this._isDisposed)return a;var r,o,s=t||0,c=n.leading,d=void 0!==c&&c,l=n.trailing,u=void 0===l||l,f=n.maxWait,p=void 0===f?NaN:f,m=0,_=(new Date).getTime(),h=null,b=this._parent,g=function(t){var n=(new Date).getTime(),a=!1;t&&(d&&n-m>=s&&(a=!0),m=n);var c=n-m,l=s-c,f=n-_,v=!1;return isNaN(p)||(f>=p&&h?v=!0:l=Math.min(l,p-f)),c>=s||v||a?(h&&(i.clearTimeout(h),h=null),_=n,r=e.apply(b,o)):null!==h&&t||!u||(h=i.setTimeout(g,l)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,g(!0)}},e.prototype.requestAnimationFrame=function(e){var t=this,n=0;if(!this._isDisposed){var a=this._animationFrameIds||(this._animationFrameIds={}),i=this._parent,r=function(){try{delete a[n],e.apply(i)}catch(e){t._logError(e)}};n=window.requestAnimationFrame?window.requestAnimationFrame(r):window.setTimeout(r,0),a[n]=!0}return n},e.prototype.cancelAnimationFrame=function(e){var t=this._animationFrameIds;t&&t[e]&&(window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e),delete t[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}()}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return c},c:function(){return o},d:function(){return d},e:function(){return r}});var a=n(0),i=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};function r(e){return function(t){return"".concat(e).concat(t?" (".concat(t,")"):"")}}function o(e){return function(t){return t||e}}Object.setPrototypeOf&&(i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(i,Error));var s=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError||void 0,r=i?(0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)({},"string"==typeof i.correlationId?{correlationId:i.correlationId}:{}),"boolean"==typeof i.isExpected?{isExpected:i.isExpected}:{}),"string"==typeof i.name?{code:i.name}:{}),"string"==typeof i.code?{code:i.code}:{}),"object"==typeof i.extraData?{extraData:i.extraData}:{}):{},o=t.correlationId,s=void 0===o?r.correlationId:o,c=t.isExpected,l=void 0===c?r.isExpected:c,u=t.extraData;return n.correlationId=s,n.isExpected=!!l,n.code=d(t.code)?t.code(r.code)||"":t.code||r.code||"",n.extraData=(0,a.a)((0,a.a)({},r.extraData||{}),u||{}),n}return(0,a.d)(t,e),t}(i);function c(e,t){return function(n){return e(t(n))}}function d(e){return"function"==typeof e}}
,function(e,t,n){var a;n.d(t,{a:function(){return o},b:function(){return r}}),function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid",e[e.odcWac=37]="odcWac",e[e.outlookGroupsWeb=38]="outlookGroupsWeb",e[e.fluid=39]="fluid",e[e.modernFileExplorer=40]="modernFileExplorer",e[e.listsHome=41]="listsHome",e[e.listsIos=42]="listsIos",e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp",e[e.officeFeed=44]="officeFeed",e[e.searchUx=45]="searchUx",e[e.consumerList=46]="consumerList",e[e.shareDemo=47]="shareDemo",e[e.onePlayer=48]="onePlayer",e[e.windowsShare=49]="windowsShare",e[e.streamIos=50]="streamIos",e[e.streamAndroid=51]="streamAndroid",e[e.loopIos=52]="loopIos",e[e.outlookAndroid=53]="outlookAndroid",e[e.outlookiOS=54]="outlookiOS",e[e.whiteboard=55]="whiteboard",e[e.businesscentral=56]="businesscentral",e[e.mslens=57]="mslens",e[e.pbidesktop=58]="pbidesktop",e[e.oneup=59]="oneup",e[e.sharePointPages=60]="sharePointPages",e[e.streamOnline=61]="streamOnline",e[e.npe=62]="npe"}(a||(a={}));var i=void 0;function r(e){if(void 0===i)for(var t in i={},a){var n=parseInt(t);if(!isNaN(n)){var r=a[n].toLowerCase();i[r]=n}}var o=e?e.toLowerCase():"";return i[o]||a.unknown}var o=a}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.unknown=0]="unknown",e[e.file=1]="file",e[e.folder=2]="folder",e[e.item=3]="item",e[e.list=4]="list",e[e.web=5]="web",e[e.max=6]="max"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return l},b:function(){return u},c:function(){return _},d:function(){return m},e:function(){return p},f:function(){return f}});var a,i,r,o,s,c=n(206),d=n(24);function l(e){a=(0,c.b)(90076,e),i=(0,c.b)(90022,e),r=(0,c.b)(90128,e),o=(0,c.b)(90058,e),s=(0,c.b)(90222,e)}function u(){try{if(sessionStorage.getItem("externalSharingConfirmationDialog"))return parseInt(sessionStorage.getItem("externalSharingConfirmationDialog"))}catch(e){}return o&&d.r()?(o.logExposure(),o.variantToDisplay):0}function f(){return a&&d.sb()?(a.logExposure(),a.variantToDisplay):0}function p(){return i&&d._()?(i.logExposure(),i.variantToDisplay):0}function m(){return d.T()&&r?(r.logExposure(),r.variantToDisplay):0}function _(){try{if(sessionStorage.getItem("linkReShareExperiment"))return parseInt(sessionStorage.getItem("linkReShareExperiment"))}catch(e){}return d.M()?1:s?(s.logExposure(),s.variantToDisplay):0}}
,function(e,t){var n;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(n||(n={})),t.a=n}
,function(e,t,n){n.d(t,{a:function(){return y},b:function(){return S},c:function(){return D},d:function(){return I},e:function(){return v},f:function(){return b},g:function(){return g},h:function(){return x}});var a=n(330),i=n(29),r=n(93),o=n(39),s=n(220),c=n(110),d=n(7),l=n(1),u=n(82),f=n(11),p=n(72),m=n(24),_=n(17),h=["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"];function b(e){return h.indexOf(e)>-1}function g(e){var t,n;return!("UNVALIDATED_EMAIL_ADDRESS"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function v(e){var t,n;return!(!(null==e?void 0:e.isExternal)||"GUEST_USER"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function y(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===c.a.externalUser}).length:0}function S(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===c.a.linkedinUser}).length:0}function D(e){var t=e.filter(function(e){return e.entityType===c.a.externalUser}),n=t.length,a=t.map(function(e){return e.name});if(n>3)return d.j(f.Cf,n);if(n>1){var i=a.join(", "),r=i.lastIndexOf(",");return"".concat(i.substring(0,r+1)," ").concat(f.K," ").concat(i.substring(r+1)," ").concat(f.Tf)}return 1===n?"".concat(a[0]," ").concat(f.Uf):""}function I(e,t,n){var a=e.filter(function(e){return e.entityType===c.a.group}),i=a.length,r="";if(n){var o=a.filter(function(e){return!e.email}),s=o.length;if(s>3)r=d.j(f.je,o.length);else if(s>1){var l=[];o.map(function(e){return l.push(e.name)});var u=l.join(", "),p=u.lastIndexOf(","),m="".concat(u.substring(0,p+1)," ").concat(f.K," ").concat(u.substring(p+1));r=d.j(f.f,m)}else s>0&&(o[0].email||(r=d.j(f.Lf,a[0].name)))}else 1===i?r=f.Af:i>1&&(r=d.j(f.Be,i));return t>=1e3?r+=" ".concat(f.Rd):t>=25&&(r+=" ".concat(d.j(f.Hd,t))),r}function x(e){var t=e.selectedItems,n=e.sharingLinkKind,d=e.canAddExternalPrincipal,h=e.sharingInformation,b=e.viewPolicyTipCallback,g=e.permissionsMap,y=e.scope;if(!m.V())return function(e){var t,n,i,r,o,s,d,h,b,g,y,S,D,I,x,O,w,E,A=e.selectedItems,L=e.canAddExternalPrincipal,k=e.sharingInformation,M=e.viewPolicyTipCallback,P=l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},f.gh," "),l.createElement(u.a,{onClick:M},f.Mh)),T=k.item.hasDlpPolicy||k.sharingAbilities&&k.sharingAbilities.directSharingAbilities&&k.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason===a.a.documentIsProtectedByDlp;if(m.V())for(var U=(0,_.i)(k.fileExtension),F=0,H=A;F<H.length;F++){if(!(V=H[F]).isResolving&&!V.isResolved)return T&&!L?P:!V.isExternal||L||v(V)?V.rawData?C(V.rawData,k.customizedExternalSharingServiceUrl):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ye):U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.ye):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ig);if(V.isExternal&&T&&!L)return P;if(V.isExternal&&!L&&!v(V))return U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.ye):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ig);if(V.isExternal&&V.principalType===p.a.distributionList&&V.entityType===c.a.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Dg)}else for(var R=(null===(i=null===(n=null===(t=null==k?void 0:k.sharingAbilities)||void 0===t?void 0:t.directSharingAbilities)||void 0===n?void 0:n.canAddNewExternalPrincipal)||void 0===i?void 0:i.enabled)||(null===(s=null===(o=null===(r=null==k?void 0:k.sharingAbilities)||void 0===r?void 0:r.anyoneLinkAbilities)||void 0===o?void 0:o.canAddNewExternalPrincipals)||void 0===s?void 0:s.enabled)||(null===(b=null===(h=null===(d=null==k?void 0:k.sharingAbilities)||void 0===d?void 0:d.peopleSharingLinkAbilities)||void 0===h?void 0:h.canAddNewExternalPrincipals)||void 0===b?void 0:b.enabled),N=(null===(S=null===(y=null===(g=null==k?void 0:k.sharingAbilities)||void 0===g?void 0:g.directSharingAbilities)||void 0===y?void 0:y.canAddExternalPrincipal)||void 0===S?void 0:S.enabled)||(null===(x=null===(I=null===(D=null==k?void 0:k.sharingAbilities)||void 0===D?void 0:D.anyoneLinkAbilities)||void 0===I?void 0:I.canHaveExternalUsers)||void 0===x?void 0:x.enabled)||(null===(E=null===(w=null===(O=null==k?void 0:k.sharingAbilities)||void 0===O?void 0:O.peopleSharingLinkAbilities)||void 0===w?void 0:w.canHaveExternalUsers)||void 0===E?void 0:E.enabled),B=0,j=A;B<j.length;B++){var V=j[B],z=N&&v(V),G=(U=(0,_.i)(k.fileExtension),R||z);if(!V.isResolving&&!V.isResolved)return V.isExternal&&!G?!m.tb()&&T?P:U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.ye):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ig):V.rawData?C(V.rawData,k.customizedExternalSharingServiceUrl):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ye);if(V.isExternal){if(!G)return!m.tb()&&T?P:U?l.createElement("span",{role:"alert","aria-live":"assertive"},f.ye):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ig);if(V.principalType===p.a.distributionList&&V.entityType===c.a.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Dg)}}return k.peoplePickerError?l.createElement("span",{role:"alert","aria-live":"assertive"},k.peoplePickerError):null}({selectedItems:t,canAddExternalPrincipal:d,sharingInformation:h,viewPolicyTipCallback:b,audience:e.audience});var S=l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},f.gh),l.createElement(u.a,{onClick:b},f.Mh)),D=h.item.hasDlpPolicy||h.sharingAbilities&&h.sharingAbilities.directSharingAbilities&&h.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason===a.a.documentIsProtectedByDlp,I=!1,x=e.audience;if(h.sharingAbilities&&e.audience&&t&&t.length)switch(x){case i.a.specificPeople:case i.a.specificPeopleFlex:h.sharingAbilities.peopleSharingLinkAbilities&&h.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals&&(I=h.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported);break;case i.a.anyone:h.sharingAbilities.anyoneLinkAbilities&&h.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals&&(I=h.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported);break;case i.a.organization:h.sharingAbilities.organizationLinkAbilities&&h.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals&&(I=h.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason===a.a.azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported)}for(var O=(0,_.i)(h.fileExtension),w=0,E=t;w<E.length;w++){var A=E[w];if(!A.isResolving&&!A.isResolved)return D&&!d?S:O&&I&&A.isExternal?l.createElement("span",{role:"alert","aria-live":"assertive"},f.ye):A.rawData?C(A.rawData,h.customizedExternalSharingServiceUrl):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ye);if(O&&I&&A.isExternal)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.ye);if(A.isExternal&&D&&!d)return S;if(A.isExternal&&!d&&!v(A))return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Ig);if(A.isExternal&&A.principalType===p.a.distributionList&&A.entityType===c.a.group)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Dg);var L=y===r.a.organization;if(A.isExternal&&L)return l.createElement("span",{role:"alert","aria-live":"assertive"},f.Sg)}if(g&&n===o.a.direct){var k=0;for(var M in g)g[M]===s.a.none&&k++;var P="";1===k?P=f.zd:k>1&&(P=f.Vd);var T=e.onShareHintClick?l.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:function(){return e.onShareHintClick()},href:"javascript:void(0)"},f.Hb):void 0;if(P)return l.createElement("div",null,l.createElement("span",{role:"alert","aria-live":"assertive"},P),T)}return h.peoplePickerError?l.createElement("span",{role:"alert","aria-live":"assertive"},h.peoplePickerError):null}function C(e,t){var n=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===n||607===n?l.createElement("span",{role:"alert","aria-live":"assertive"},e.Description):n>=401&&n<=404?t?l.createElement("div",{role:"alert","aria-live":"assertive"},d.h(f.md,l.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},f.Je))):l.createElement("span",{role:"alert","aria-live":"assertive"},f._d):n>=200&&n<=209||n>=301&&n<=305?t?l.createElement("div",{role:"alert","aria-live":"assertive"},d.h(f.bd,l.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},f.Je))):l.createElement("span",{role:"alert","aria-live":"assertive"},m.ab()?f.hj:f.gd):n>=600&&n<=603?t?l.createElement("div",{role:"alert","aria-live":"assertive"},d.h(f.Ki,l.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},f.Je))):l.createElement("span",{role:"alert","aria-live":"assertive"},f.Wi):802===n?l.createElement("span",{role:"alert","aria-live":"assertive"},f.Qj):void 0}}
,,,,,,function(e,t,n){n.d(t,{a:function(){return f},b:function(){return u}});var a=n(0),i=n(275),r=n(211),o=n(472),s=n(3),c=!s.a.isActivated("115330F7-9AB5-4692-80AB-7401BE3808AA","03/17/2022","Events are stored in a Circular Buffer instead of an array"),d=!s.a.isActivated("1B732EAA-2220-487A-94BA-67B7056D6707"),l=function(){function e(){var e=this;this._onBeforeUnload=function(){try{for(var t=function(t){try{e._startedEvents.forEach(function(e,n){t(n)})}catch(e){}},n=0,a=e._onBeforeUnloadHandlers;n<a.length;n++)t(a[n])}catch(e){}e._startedEvents.clear();for(var i=0,r=e._unloadHandlers;i<r.length;i++){var o=r[i];try{o()}catch(e){}}},this._handlers=[],this._buffer=c?new o.a(500):new o.b(500),this._hasBufferOverflown=!1,this._unloadHandlers=[],this._onBeforeUnloadHandlers=[],this._startedEvents=new Map,d&&"undefined"!=typeof window&&window&&window.addEventListener&&window.addEventListener("beforeunload",this._onBeforeUnload)}return Object.defineProperty(e.prototype,"startDate",{get:function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this.startDate.getTime()},enumerable:!1,configurable:!0}),e.prototype.getTime=function(){return(new Date).getTime()},e.prototype.cleanString=function(e){return e},e.prototype.addLogHandler=function(e){var t=this._handlers,n=this._buffer;return t.push(e),n.getAll()},e.prototype.removeLogHandler=function(e){for(var t=this._handlers,n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}},e.prototype.logEvent=function(e,t){var n=this._buffer,o=this._handlers;if(d){var s=this._startedEvents||new Map;t===i.a.End?s.delete(e):t===i.a.Start&&s.set(e,!0)}var c=Object.freeze({data:(0,r.a)(e.data),context:(0,a.a)({},e.context),id:e.id,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,isEventTypePrefixingDisabled:e.isEventTypePrefixingDisabled}),l=n.isFull;n.push(c),!this._hasBufferOverflown&&l&&(this._hasBufferOverflown=!0,0===o.length&&p(new Error("Logging buffer overflow hit before any logging handler was registered")));for(var u=0;u<o.length;u++)try{o[u](c)}catch(e){p(e)}},e.prototype.isFeatureEnabled=function(e){return!0},e.prototype.addFeatureEnabler=function(e){},e.prototype.removeFeatureEnabler=function(e){},e.prototype.getStack=function(){var e;try{var t=window;t.______ExpectedError______&&t.______ExpectedError______()}catch(t){e=t}return e&&e.stack||void 0},e.prototype.addUnloadHandler=function(e){this._unloadHandlers.push(e)},e.prototype.removeUnloadHandler=function(e){var t=this._unloadHandlers,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype.addOnBeforeUnloadHandler=function(e){this._onBeforeUnloadHandlers.push(e)},e.prototype.removeOnBeforeUnloadHandler=function(e){var t=this._onBeforeUnloadHandlers,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype.registerCustomBeforeUnload=function(e){e.addCallback(this._onBeforeUnload)},e.prototype.dispose=function(){"undefined"!=typeof window&&window&&window.removeEventListener&&window.removeEventListener("beforeunload",this._onBeforeUnload),this._onBeforeUnload()},e}();function u(){return new l}var f="undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||u():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||u():u();function p(e){console.error("Telemetry Manager:",e)}}
,,function(e,t,n){var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={})),t.a=a}
,,function(e,t,n){var a=n(158);t.a=a}
,,,function(e,t,n){n.d(t,{a:function(){return M},b:function(){return L},c:function(){return k},d:function(){return g},e:function(){return v},f:function(){return U},g:function(){return y},h:function(){return R},i:function(){return H},j:function(){return P},k:function(){return I},l:function(){return A},m:function(){return T}});var a,i=n(29),r=n(330),o=n(31),s=n(46),c=n(107),d=n(32),l=n(70),u=n(24),f=n(71),p=n(17),m=n(243),_=n(94);!function(e){e.SharePrivateDraft="SharePrivateDraft",e.ShareSitePage="ShareSitePage",e.ShareSitePageDraft="ShareSitePageDraft",e.ShareSitePageDraftFromLibrary="ShareSitePageDraftFromLibrary",e.ShareSitePageFromLibrary="ShareSitePageFromLibrary"}(a||(a={}));var h={ODB:772},b={ODB:1935};function g(e){return"anyoneLinkAbilities"===e||"anonymousLinkAbilities"===e?i.a.anyone:"organizationLinkAbilities"===e?i.a.organization:"peopleSharingLinkAbilities"===e?i.a.specificPeopleFlex:void 0}function v(e,t){return e===i.a.anyone?t.anyoneLinkAbilities?t.anyoneLinkAbilities:t.anonymousLinkAbilities:e===i.a.organization?t.organizationLinkAbilities:e===i.a.specificPeopleFlex||e===i.a.specificPeople||e===i.a.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}function y(e,t){var n=v(e,t);return(null==n?void 0:n.canManageEditLink)?n.canManageEditLink.enabled:!!(null==n?void 0:n.canAddInternalPrincipal)&&n.canAddInternalPrincipal.enabled}function S(e,t,n){var a,o,s=v(i.a.direct,n.sharingAbilities),c=(null===(a=s.canAddInternalPrincipal)||void 0===a?void 0:a.enabled)||(null===(o=s.canAddExternalPrincipal)||void 0===o?void 0:o.enabled);return!(0,p.Z)(e,t)||!F(i.a.specificPeople,n.sharingAbilities,r.a.forceCheckoutEditLink)&&c}function D(e,t,n,i,r){return i?t.canRequestAccessForGrantAccess:r!==a.ShareSitePageDraft&&r!==a.ShareSitePageDraftFromLibrary&&r!==a.SharePrivateDraft}function I(e,t){var n,a=v(e,t);return!!(null==a?void 0:a.canManageReadLink)&&(null===(n=null==a?void 0:a.canManageReadLink)||void 0===n?void 0:n.enabled)}function x(e){var t=e.sharingRole;return t===d.a.manageList||t===d.a.owner}function C(e,t){return!(c.b!==c.a[e]||!(0,p.j)(t,d.a.review))}function O(e,t,n,a,i){return!(!i||!T(e,t)||!(0,m.b)(n,m.a.AllowMediaTA)&&a!==l.a.folder)}function w(e,t,n,a){return a&&(0,p.j)(n,d.a.restrictedview)&&((0,m.b)(t,m.a.AllowMediaTA)||e===l.a.folder)}function E(e,t){var n=e.sharedObjectType===l.a.list;return t&&n&&e.userRole===d.a.owner}function A(e,t,n){if(s.a.isFeatureEnabled(h)&&!c.a[n]){var a=v(e,t);return(null==a?void 0:a.canManageReviewLink)?a.canManageReviewLink.enabled:!!(null==a?void 0:a.supportsReviewPermission)&&a.supportsReviewPermission.enabled}return!1}function L(e){var t={fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:!1,shouldDisplay:!1},review:{enabled:!1,shouldDisplay:!1},edit:{enabled:!1,shouldDisplay:!1},view:{enabled:!1,shouldDisplay:!1},blockDownload:{enabled:!1,shouldDisplay:!1}};switch(e.role){case d.a.view:t.view.enabled=t.view.shouldDisplay=!0;break;case d.a.restrictedview:t.blockDownload.enabled=t.blockDownload.shouldDisplay=!0;break;case d.a.review:t.review.enabled=t.review.shouldDisplay=!0}return t}function k(e){var t=e.clientId,n=e.sharingStore,a=e.sharingInformation,r=e.audience,s=e.mode,c=e.isPreventDownloadAllowed,u=!1,f=!1,m=!1,h=!1,b=!0,g=!1;if(!(0,p.S)(a)){u=a.sharedObjectType===l.a.list,f=function(e){var t=e.audience,n=e.sharingRole,a=v(t,e.sharingAbilities);return(null==a?void 0:a.canManageManageListLink)?a.canManageManageListLink.enabled:t===i.a.existing&&(n===d.a.manageList||n===d.a.owner)}({audience:r,sharingAbilities:a.sharingAbilities,sharingRole:a.userRole}),h=A(r,a.sharingAbilities,a.fileExtension)||P(r,a.sharingAbilities,a.fileExtension),m=y(r,a.sharingAbilities),b=I(r,a.sharingAbilities);var S="video"===(0,_.a)(a.fileExtension)&&O(r,a.sharingAbilities,a.fileExtension,a.sharedObjectType,c),D=(0,p.Z)(t,n)&&O(r,a.sharingAbilities,a.fileExtension,a.sharedObjectType,c);g=S||D}var x=s===o.a.addPeople||s===o.a.manageAccess||m,C=b;return(r==i.a.specificPeople&&R(r,a.sharingAbilities)||a.requiresAccessApproval)&&(x=C=!0),{fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:f,shouldDisplay:u},review:{enabled:h,shouldDisplay:h},edit:{enabled:x,shouldDisplay:!0},view:{enabled:C,shouldDisplay:C},blockDownload:{enabled:g,shouldDisplay:g}}}function M(e){e.audience;var t,n,a,i,r,s,c=e.clientId,d=e.sharingInformation,f=e.scenarioId,m=e.isPreventDownloadAllowed,h=e.shareMode,b=e.sharingStore,g=!1,v=!1,y=!1,I=!1,O=!1,A=!1,L=!1;if(u.i()){if(!(0,p.S)(d)){g=d.sharedObjectType===l.a.list,v=x({sharingRole:d.userRole}),y=E(d,h===o.a.addPeople||h===o.a.manageAccess),I=!!(0,p.Z)(c,b)&&C(d.fileExtension,d.userRole);var k="video"===(0,_.a)(d.fileExtension)&&w(d.sharedObjectType,d.fileExtension,d.userRole,m),M=(0,p.Z)(c,b)&&w(d.sharedObjectType,d.fileExtension,d.userRole,m);O=k||M,A=S(c,b,d)}L=D(0,d,d.sharingAbilities,d.requiresAccessApproval,f)}else if(!(0,p.S)(d)){var P=null===(t=d.sharingAbilities)||void 0===t?void 0:t.directSharingAbilities;y=E(d,h===o.a.addPeople||h===o.a.manageAccess),g=d.sharedObjectType===l.a.list,v=x({sharingRole:d.userRole})&&(null===(n=P.supportsManageListPermission)||void 0===n?void 0:n.enabled),A=S(c,b,d)&&(null===(a=P.supportsEditPermission)||void 0===a?void 0:a.enabled),I=C(d.fileExtension,d.userRole)&&(null===(i=P.supportsReviewPermission)||void 0===i?void 0:i.enabled),L=D(0,d,d.sharingAbilities,d.requiresAccessApproval,f)&&(null===(r=P.supportsReadPermission)||void 0===r?void 0:r.enabled),k="video"===(0,_.a)(d.fileExtension)&&w(d.sharedObjectType,d.fileExtension,d.userRole,m),M=(0,p.Z)(c,b)&&w(d.sharedObjectType,d.fileExtension,d.userRole,m),O=(k||M)&&(null===(s=P.supportsRestrictedViewPermission)||void 0===s?void 0:s.enabled)}return{fullControl:{enabled:y,shouldDisplay:y},manageList:{enabled:v,shouldDisplay:g},review:{enabled:I,shouldDisplay:I},edit:{enabled:A,shouldDisplay:A},view:{enabled:L,shouldDisplay:L},blockDownload:{enabled:O,shouldDisplay:O}}}function P(e,t,n){if(c.b===c.a[n]){var a=v(e,t);return(null==a?void 0:a.canManageReviewLink)?a.canManageReviewLink.enabled:!!(null==a?void 0:a.supportsReviewPermission)&&a.supportsReviewPermission.enabled}return!1}function T(e,t){var n=v(e,t);return!!(null==n?void 0:n.supportsRestrictedView)&&n.supportsRestrictedView.enabled}function U(e,t){if(f.c())return[];var n=[];if(s.a.isFeatureEnabled(b))for(var a=0,i=t;a<i.length;a++){var r=i[a];if(r.linkDetails&&r.linkDetails.shareId){var o=v(r.linkDetails.audience,e);o.canManageEditLink&&o.canManageEditLink.enabled||o.canManageReviewLink&&o.canManageReviewLink.enabled||o.canManageReadLink&&o.canManageReadLink.enabled||r.linkDetails.expiration&&r.linkDetails.expiration<new Date(Date.now())||n.push(r.linkDetails)}}return n}function F(e,t,n){var a;if(void 0===e||!t)return!1;var i=v(e,t);for(var r in i)if((null===(a=i[r])||void 0===a?void 0:a.disabledReason)==n)return!0;return!1}function H(e,t){return F(e,t,r.a.sharingBlockedByVirusCheckStatus)}function R(e,t){return F(e,t,r.a.irmIsEnabled)}}
,function(e,t,n){n.d(t,{a:function(){return a.a},b:function(){return i.a}});var a=n(45),i=n(204)}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={none:0,link:1,linkV2:2,linkInheritance:3,linkBundle:4,direct:5,participant:6,linkSettings:7,back:8,shareDialogPasswordOnly:9,shareDialogExpirationOnly:10,shareDialogPasswordAndExpiration:11,copyInterruptUpdate:12,copyInterruptRemove:13,addressBarLinkOff:14,shareDialogExternalSharing:15}}
,,function(e,t,n){var a=n(0),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t.prototype.attached=function(e){var t=this,n=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.attach(e.apply(this,n)||this)};return n.prototype=e.prototype,n},t}(n(160).a);t.a=i}
,function(e,t,n){var a=n(92),i=function(){function e(t,n){void 0===n&&(n=a.a.none),e.init(),this.dataStoreKey=t,this.defaultCachingType=n,n===a.a.none?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey])}return e.hasStorageType=function(t){switch(e.init(),t){case a.a.none:case a.a.sharedMemory:return!0;case a.a.session:return!!e._sessionStorage;case a.a.local:return!!e._localStorage;default:return!1}},e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0}},e.testStorage=function(e){var t="BrowserStorageTest",n=!1;try{e.setItem(t,"1"),"1"===e.getItem(t)&&(n=!0),e.removeItem(t)}catch(e){}return n},e.prototype.setValue=function(e,t,n,a){void 0===a&&(a=!0),e=a?this.normalizeKey(e):e,this.dataStore[e]=t;var i=this.getStorage(n);if(i)try{var r=[],o=JSON.stringify(t,function(e,t){if("object"==typeof t&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t});r=null,i.setItem(this.dataStoreKey+e,o)}catch(e){}},e.prototype.getValue=function(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=!1),e=n?this.normalizeKey(e):e;var i=this.dataStore[e],r=this.getStorage(t);if((void 0===i||a)&&r){var o=r.getItem(this.dataStoreKey+e);if(o)try{i=JSON.parse(o),this.dataStore[e]=i}catch(e){i=void 0}}return i},e.prototype.remove=function(e,t,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e;var a=this.getStorage(t);a&&a.removeItem(this.dataStoreKey+e),delete this.dataStore[e]},e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case a.a.none:case a.a.sharedMemory:return null;case a.a.session:return e._sessionStorage;case a.a.local:return e._localStorage;default:return null}},e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||""},e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1,e}();t.a=i}
,function(e,t){var n;!function(e){e[e.none=0]="none",e[e.session=1]="session",e[e.local=2]="local",e[e.sharedMemory=3]="sharedMemory"}(n||(n={})),t.a=n}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o},c:function(){return c}});var a=n(81),i={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],whiteboard:["whiteboard"],fluid:["fluid","loop","note"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},r=void 0;function o(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==a.a.File?a.a[e.itemType].toLowerCase():s(e.extension):"none"}function s(e){return e?(r||(r={},Object.keys(i).map(function(e){i[e].forEach(function(t){r[t]=e})})),r[e.toLowerCase()]||"other"):"none"}function c(e){return"word"===s(e)}}
,function(e,t){var n;!function(e){e[e.share=0]="share",e[e.copy=1]="copy",e[e.outlook=2]="outlook",e[e.nonOutlook=3]="nonOutlook",e[e.moreApps=4]="moreApps",e[e.mobileShareToTeams=5]="mobileShareToTeams",e[e.webShareToTeams=6]="webShareToTeams",e[e.grantAccess=7]="grantAccess"}(n||(n={})),t.a=n}
,,,,,function(e,t,n){n.d(t,{a:function(){return A},b:function(){return C},c:function(){return O},d:function(){return k},e:function(){return x},f:function(){return E},g:function(){return L}});var a=n(0),i=n(360),r=n(543),o=n(142),s=n(542),c=n(232),d=n(3);function l(e){return function(e){return void 0===u&&function(){u={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,a=D;n<a.length;n++){var i=a[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(u[i]=!0)}}catch(e){}}(),!!e&&(e=e.toLowerCase(),u[e])}(e)?"en":e}var u,f,p,m,_,h,b,g,v,y,S,D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","hy-am","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","sq-al","ur-pk","uz-latn-uz","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","mk","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku"];!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(f||(f={}));var I=function(){for(var e,t=0,n=d.b.isActivated("D98FB23B-FE73-4BA3-B3D5-28F1BE7C05C8")?[window.$Config&&window.$Config.mkt,o.b.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,o.b.cultureLCID,o.b.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var a=n[t];try{(new Date).toLocaleDateString(a),e=a;break}catch(e){}}return l(e)}();function x(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),s.c(e,n?I:l(o.b.language),t)}function C(e,t,n,a,d,u){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=!1);var f=Date.now()-e.getTime(),p=P(),m=T(p,-1),_=T(p,-6),h=d||{},b=h.displayMinutesToOneHour,g=void 0===b||b,v=h.displayHoursToOneDay,y=void 0===v||v,S=h.displayHoursInDates,D=void 0===S||S,I=h.displayShortenedWeekday,x=void 0===I||I,C=l(u||o.b.language);if(g&&f<-5*c.c)return e.toLocaleDateString(C,F({month:"short",day:"numeric"},a));if(f<c.g)return n?r.c:r.b;if(g&&f<c.b)return U(f,r.e,c.c);if(c.h(p,e))return y?U(f,r.d,c.b):s.b("Today",n);if(e>=m)return t||!D?s.b("Yesterday",n):s.b("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(C,F({hour:"numeric",minute:"2-digit"},a)));if(e>=_){var O=e.toLocaleDateString(C,F({weekday:"short"},a));return t?O:x||D?i.RelativeDateTime_DayAndTime.replace("{0}",O).replace("{1}",e.toLocaleTimeString(C,F({hour:"numeric",minute:"2-digit"},a))):e.toLocaleDateString(C,F({weekday:"long"},a))}return c.i(p,e)?C.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(C,F({month:"long",day:"numeric"},a)):e.toLocaleDateString(C,F({month:"short",day:"numeric"},a)):e.toLocaleDateString(C,F({month:"short",day:"numeric",year:"numeric"},a))}function O(e,t,n,a){void 0===t&&(t=!1);var s=l(n||o.b.language),d=P(),u={month:"short",day:"numeric"};if(c.i(d,e)||(u.year="numeric"),a){var p=function(e){var t;switch(new Date(e).getDay()){case f.Sunday:t=r.h;break;case f.Monday:t=r.f;break;case f.Tuesday:t=r.j;break;case f.Wednesday:t=r.k;break;case f.Thursday:t=r.i;break;case f.Friday:t=r.a;break;case f.Saturday:t=r.g}return t}(e.getTime());return i.RelativeDateTime_DayAndTime.replace("{0}",p).replace("{1}",e.toLocaleTimeString(s,F({hour:"numeric",minute:"2-digit"},t)))}return i.RelativeDateTime_DayAndTime.replace("{0}",e.toLocaleDateString(s,F(u,t))).replace("{1}",e.toLocaleTimeString(s,F({hour:"numeric",minute:"2-digit"},t)))}function w(){var e=M();if(window.Intl&&window.Intl.DateTimeFormat){var t={},n={hour:"2-digit",minute:"2-digit"};m=new Intl.DateTimeFormat(I,t),_=new Intl.DateTimeFormat(I,n),e&&(t.timeZone="UTC",n.timeZone="UTC"),h=new Intl.DateTimeFormat(I,t),b=new Intl.DateTimeFormat(I,n),g=m.format,v=_.format,y=h.format,S=b.format}else g=y=function(e){return e.toLocaleDateString(I)},v=S=function(e){return e.toLocaleTimeString(I)}}function E(e,t){if(!e)return"";g||w();var n=c.h(new Date,e);return(t?n?S:y:n?v:g)(e)}function A(e,t){return e?(g||w(),(t?y:g)(e).replace(/[:\/\\]/g,"-")):""}function L(e,t,n){return void 0===n&&(n=!1),c.j(e,n?I:l(o.b.language),t)}function k(e){void 0===e&&(e=!1);var t=new Date(2e3,11,22);return t.toLocaleDateString(e?I:l(o.b.language),{day:"numeric",month:"numeric",year:"numeric"}).replace(t.getDate().toString(),"DD").replace((t.getMonth()+1).toString(),"MM").replace(t.getFullYear().toString(),"YYYY")}function M(){if(void 0===p)try{(new Date).toLocaleDateString(I,{timeZone:"UTC"}),p=!0}catch(e){p=!1}return p}function P(){var e=new Date;return e.setHours(0,0,0,0),e}function T(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function U(e,t,n){var a=Math.round(e/n);return t.replace("{0}",String(a))}function F(e,t){return M()&&t&&e?(0,a.a)((0,a.a)({},e),{timeZone:"UTC"}):e}}
,,,function(e,t,n){n.d(t,{a:function(){return p}});var a=n(0),i=n(41),r=n(79),o=n(26),s=n(58),c=n(126),d=n(159),l="GetSchemaException";function u(e,t,n){var a={resultType:e};return t&&(a.resultCode=t),n&&(a.error=n),a}var f=function(e){function t(t,n){return e.call(this,t,i.b.Start,n)||this}return(0,a.d)(t,e),t.instrumentPromise=function(e,t,n,a,i,r,o){var c,f=new this(e,o);i&&f.setTimeout(i,r);try{c=t()}catch(e){throw f.end(u(s.a.Failure,"PromiseCreationFailed",e.toString())),e}return c.then(function(e){var t;if(n)try{t=n(e)}catch(e){t=u(s.a.Failure,l,e.toString())}else t=u(s.a.Success);f.end(t)},function(e){var t;if(a)try{t=a(e)}catch(e){t=u(s.a.Failure,l,e.toString())}else t=e?u(e instanceof Error&&"Canceled"===e.name?s.a.ExpectedFailure:s.a.Failure,void 0,(0,d.a)(e)):u(s.a.Failure);f.end(t)}),c},t.prototype.setTimeout=function(e,t){var n=this;this._clearTimeout(),t||(t=u(s.a.Failure,"Timeout")),this.timeoutId=window.setTimeout(function(){n.end(t)},e)},t.prototype.verbose=function(e){if(!this.endTime&&this._isQosEvent()){var t=this.data;c.verbose(e,t.name)}},t.prototype.end=function(e){if(!this.endTime){this.endTime=e&&e.endTimeOverride||r.a.getTime();var t=(0,a.a)({duration:this.endTime-this.startTime},e);if(this._setData(t),this._logEvent(i.b.End),this._isQosEvent()){var n=this.data;n.error&&c.log(n.error,n.name,n.resultCode,n.resultType)}this._clearTimeout()}},t.prototype._clearTimeout=function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)},t.prototype._isQosEvent=function(){return this.eventName.indexOf("Qos,")>=0},t}(i.c);function p(e,t,n){var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t}(f),s=(0,a.a)((0,a.a)({},t),{duration:{isPrefixingDisabled:!0,type:o.a.Number}});return(0,i.d)(r.prototype,e,s,n),r}}
,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return s}});var a=n(0),i=n(18),r=n(3).a.isActivated("0F8C524D-93DF-45F2-9CBB-64AED06517C5","08/11/2023","Normalize CorrelationId in QoS events");function o(e){var t=e||void 0;return(0,a.a)((0,a.a)({error:e&&(e.message||e.name),resultCode:t&&s(t)||e&&e.name||"Unknown"},t?(0,a.a)({},"boolean"==typeof t.isExpected?{resultType:t.isExpected?i.b.ExpectedFailure:i.b.Failure}:{resultType:i.b.Failure}):{resultType:i.b.Success}),{extraData:(0,a.a)({stack:e&&e.stack},t?(0,a.a)((0,a.a)((0,a.a)({},"object"==typeof t.innerError?{innerError:o(t.innerError)}:{}),"string"==typeof t.correlationId?r?{correlationId:t.correlationId}:{CorrelationId:t.correlationId}:{}),"object"==typeof t.extraData?(0,a.a)({},t.extraData):{}):{})})}function s(e){var t=[];return"object"==typeof e.extraData&&e.extraData&&void 0!==e.extraData.status&&t.push("[".concat(e.extraData.status,"]")),"string"==typeof e.code&&t.push("".concat(e.code)),t.join(" ")}}
,function(e,t,n){n.d(t,{a:function(){return u}});var a=n(0),i=n(103),r=n(26),o=n(58),s=n(79),c=n(196),d=!n(3).a.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),l="Missing Perf Goal",u=function(e){function t(t){var n=e.call(this,t)||this;return t&&t.perfGoalInMs&&n.setTimeout(null==t?void 0:t.perfGoalInMs,{resultType:o.a.Failure,errorCode:l,extraData:(0,a.a)({},t)}),n}return(0,a.d)(t,e),t.prototype.end=function(t){if(t&&t.extraData&&this.data.extraData&&(t=(0,a.a)((0,a.a)({},t),{extraData:(0,a.a)((0,a.a)({},this.data.extraData),t.extraData)})),t&&t.errorCode!==l&&(t=this._assessPerf(t)),!d)try{var n=this._collectExperiments();n&&t&&(t.extraData=(0,a.a)((0,a.a)({},t.extraData),{experiments:n}));var i=window._spPageContextInfo;if(t&&!i&&(i=t.spPageContext),this.data&&!i&&(i=this.data.spPageContext),i){var r=this._collectSPClientFlights(i);r&&t&&(t.extraData=(0,a.a)((0,a.a)({},t.extraData),{flights:r}))}}catch(e){}return e.prototype.end.call(this,t)},t.prototype._assessPerf=function(e){if(!this.endTime){var t=e.perfGoalInMs||this.data.perfGoalInMs;t&&e.resultType!==o.a.Failure&&t<s.a.getTime()-this.startTime&&(e=(0,a.a)((0,a.a)({},e),{resultType:o.a.Failure,errorCode:l,extraData:e.errorCode?(0,a.a)((0,a.a)({},e.extraData),{innerErrorCode:e.errorCode}):void 0}))}return e},t.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t=void 0;for(var n in e)if(e.hasOwnProperty(n)){t=t||{};var a=e[n];a&&a._serverTime&&Date.now()-new Date(a._serverTime).getTime()<1296e6&&(t[n]=e[n])}return t},t.prototype._collectSPClientFlights=function(e){var t=e.ExpFeatures,n=void 0;if(t){n="";for(var a=0,i=t;a<i.length;a++){var r=i[a];n+=this._numberToBinString(r).split("").reverse().join("")}}return n},t.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return"".concat(Array(32-t.length+1).join("0")).concat(t)},t}((0,i.a)({eventName:"CustomerPromise,",shortEventName:"CustomerPromise"},{scenario:{isKey:!0,isPrefixingDisabled:!0,type:r.a.String},errorCode:{isPrefixingDisabled:!0,type:r.a.String},resultType:{typeRef:o.a,isPrefixingDisabled:!0,type:r.a.Enum},resultCategory:{isPrefixingDisabled:!0,type:r.a.String},extraData:r.a.Object,httpStatus:{isPrefixingDisabled:!0,type:r.a.Number},perfGoalInMs:{isPrefixingDisabled:!0,type:r.a.Number},duration:{isPrefixingDisabled:!0,type:r.a.Number},pillar:{isPrefixingDisabled:!0,type:r.a.String},veto:{isPrefixingDisabled:!0,type:r.a.String},isStaging:{isPrefixingDisabled:!0,type:r.a.Boolean},product:{isPrefixingDisabled:!0,type:r.a.String},conversationId:{isPrefixingDisabled:!0,type:r.a.String},ashaFeature:{isPrefixingDisabled:!0,type:r.a.String}})).withManager((0,c.a)())}
,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(47),i=n(6),r=window&&window.FilesConfig||{};r.skyDrivePickerOAuth||(r.skyDrivePickerOAuth="oauth"),!r.oauthToken&&window&&(r.oauthToken=new a.a(window.location.href).getQueryParameter("access_token"));var o=r;new i.b({name:"filesConfig",factory:new i.a(o)})}
,function(e,t,n){var a;n.d(t,{a:function(){return p},b:function(){return f}});var i="ms-word",r="onenote|UsePlain",o="ms-powerpoint",s="ms-excel",c="ms-visio",d="ms-publisher",l="ms-access",u="ms-project",f=i,p={accdb:l,csv:s,doc:i,docm:i,docx:i,dot:i,dotm:i,dotx:i,odp:o,ods:s,odt:i,one:r,onepkg:r,onetoc2:r,mpp:u,notebook:r,pot:o,potm:o,potx:o,ppa:o,ppam:o,pps:o,ppsm:o,ppsx:o,ppt:o,pptm:o,pptx:o,pub:d,vdw:c,vsd:c,vsdm:c,vsdx:c,vsl:c,vss:c,vssm:c,vssx:c,vst:c,vstm:c,vstx:c,xla:s,xlam:s,xll:s,xls:s,xlsb:s,xlsm:s,xlsx:s,xlt:s,xltm:s,xltx:s};(a={})[l]="Access",a[i]="Word",a[r]="OneNote",a[o]="PowerPoint",a[s]="Excel",a[c]="Visio",a[d]="Publisher",a[u]="Project"}
,function(e,t,n){n.r(t),n.d(t,{ConfirmationCode:function(){return m.a},ConfirmationDialog:function(){return h},default:function(){return b}});var a=n(0),i=n(1),r=n(12),o=n(247),s=n(179),c=n(248),d=n(50),l=n(57),u=n(7),f=n(20),p=n(11);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ConfirmationDialog-subText{font-size:.75rem}.od-ConfirmationDialog-subText.large-font{font-size:.875rem}.od-ConfirmationDialog-subText--nowrap{white-space:nowrap}.od-confirmationDialog .ms-Dialog-main.simplified{border-radius:8px;min-height:-moz-fit-content;min-height:fit-content}.od-confirmationDialog .ms-Dialog-main.simplified .ms-Button{border-radius:4px}.od-confirmationDialog .od-confirmationDialog-footer{display:inline-block}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button{min-width:70px;max-width:70px}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button.isIE{padding-left:0;padding-right:0}.od-confirmationDialog .ms-Dialog-title{font-weight:600}[dir=ltr] .od-confirmationDialog-discard{float:left}[dir=rtl] .od-confirmationDialog-discard{float:right}.od-confirmationDialog-saveCancel{display:inline}.od-confirmationDialog-saveCancel .ms-Button{margin:0 4px}[dir=ltr] .od-confirmationDialog-copyLinkInterruptButtons{padding-right:8px}[dir=rtl] .od-confirmationDialog-copyLinkInterruptButtons{padding-left:8px}.od-ConfirmationDialog-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var m=n(88),_=n(17),h=function(e){function t(t,n){var a=e.call(this,t)||this;return a._useSimplifedShareDialog=(0,_._)(n.clientId,n.sharingStore)||(0,_.Z)(n.clientId,n.sharingStore),a._useNewLinkDelete=(n.sharingStore.isConsumer()||a._useSimplifedShareDialog)&&a.props.confirmationCode===m.a.link,a}return(0,a.d)(t,e),t.prototype.render=function(){var e,t,n,a,r=this.props,_=r.confirmationCode,h=r.participant,b="od-confirmationDialog",g=f.o(this.props.clientId)?"isIE":"";switch(this._useNewLinkDelete&&(_=m.a.linkV2),_){case m.a.link:t=p.Uc,n=p.kc,a=p.Tb;break;case m.a.linkV2:t=p.Tc,n=p.Lc,a=p.Tb;break;case m.a.linkBundle:t=p.Mc,n=p.Lc,a=p.Tb;break;case m.a.linkInheritance:t=p.Pc,n=p.Lc,a=p.Tb;break;case m.a.linkSettings:t=p.Fb,n=p.Ub,a=p.Tb;break;case m.a.direct:t=u.j(p.wc,h.name),n=p.Rh,a=p.Tb;break;case m.a.participant:t=u.j(p.Nc,h.name),n=p.Rh,a=p.Tb;break;case m.a.back:t=p.$d,n=p.ci,a=p.Tb;break;case m.a.shareDialogPasswordOnly:t=p.Xj,n=p.ak,a=p.ek,b+=" shareDialog";break;case m.a.shareDialogExpirationOnly:t=p.Xj,n=p.nk,a=p.$j,b+=" shareDialog";break;case m.a.shareDialogPasswordAndExpiration:t=p.Xj,n=p.ik,a=p.tk,b+=" shareDialog";break;case m.a.copyInterruptUpdate:t=p.sc,n=p.tc,a=p.nc,b+=" shareDialog";break;case m.a.copyInterruptRemove:t=p.rc,n=p.tc,a=p.ic,b+=" shareDialog";break;case m.a.addressBarLinkOff:t=p.Lj,n=p.Jj,a=p.Tb;break;case m.a.shareDialogExternalSharing:t=p.hd,n=p.tc,a=p.Tb}var v=this._useSimplifedShareDialog?"simplified":"",y=.85*((null===(e=document.getElementById("od-share"))||void 0===e?void 0:e.offsetWidth)||480);return i.createElement("div",null,i.createElement(o.a,{hidden:!1,className:b,onDismiss:this.props.onCancel,dialogContentProps:{type:s.a.close,title:t,subTextId:"dialogSubtext",styles:{topButton:{width:"2rem",height:"2rem",selectors:{".ms-Dialog-button--close .ms-Button-flexContainer .ms-Icon":{fontSize:"1rem"}}},title:{fontSize:"1.25rem",overflowWrap:"break-word"},innerContent:{},button:{},content:{},subText:{},header:{},inner:{selectors:{".ms-Dialog-action .ms-Button":{height:"2rem"},".ms-Dialog-action .ms-Button-textContainer .ms-Button-label":{fontSize:"0.875rem"}}}}},modalProps:{isDarkOverlay:!0,isBlocking:!0,subtitleAriaId:"dialogSubtext"},styles:{main:[v,{maxWidth:"".concat(y,"px!important")}]}},this._getDialogSubText(),_===m.a.back?i.createElement(c.a,{className:"od-confirmationDialog-footer"},i.createElement(d.a,{className:"od-confirmationDialog-discard ".concat(g),onClick:this.props.onDiscard?this.props.onDiscard:this.props.onCancel,text:p.Vc}),i.createElement("div",{className:"od-confirmationDialog-saveCancel"},i.createElement(l.a,{onClick:this.props.onApply,text:n}),i.createElement(d.a,{className:"".concat(g),onClick:this.props.onCancel,text:a}))):_===m.a.copyInterruptUpdate||_===m.a.copyInterruptRemove?i.createElement(c.a,null,i.createElement(l.a,{className:"od-ConfirmationDialog-copyLinkInterruptButtons","data-automationid":"ConfirmationDialog-InterruptButtons-Apply",onClick:this.props.onApply,text:n}),i.createElement(d.a,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onDiscard||this.props.onCancel,text:a})):i.createElement(c.a,null,i.createElement(l.a,{onClick:this.props.onApply,text:n}),i.createElement(d.a,{onClick:this.props.onCancel,text:a}))))},t.prototype._getDialogSubText=function(){var e,t=this.props.confirmationCode;this._useNewLinkDelete&&(t=m.a.linkV2);var n="";switch(t){case m.a.link:return i.createElement("div",{className:"od-ConfirmationDialog-subText",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,i.createElement("strong",null,p.Rc),p.Fc));case m.a.linkV2:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,p.Fc));case m.a.linkInheritance:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,p.Hc));case m.a.linkBundle:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,p.Ac));case m.a.linkSettings:return i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,p.Z));case m.a.direct:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,p.Ec));case m.a.participant:return;case m.a.shareDialogPasswordOnly:return n=u.j(p.Rf,this.props.linkPasswordSetBy),i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,n));case m.a.shareDialogExpirationOnly:return n=u.j(p.Hf,this.props.linkExpiration),i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,n));case m.a.shareDialogPasswordAndExpiration:return n=u.j(p.Nf,this.props.linkExpiration,this.props.linkPasswordSetBy),i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,n));case m.a.copyInterruptUpdate:return n=p.oc,i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,n));case m.a.copyInterruptRemove:return n=p.ac,i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,n));case m.a.addressBarLinkOff:return n=p.Aj,i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,n));case m.a.shareDialogExternalSharing:var a=null===(e=this.props.participants)||void 0===e?void 0:e.map(function(e){return e.email||e.userId}).join(", "),r=a.lastIndexOf(","),o=this.props.participants.length>1?"".concat(a.substring(0,r+1)," ").concat(p.K," ").concat(a.substring(r+1)," "):"".concat(a," "),s=this.props.participants.length>1?p.Tf:p.Uf;return i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,i.createElement("b",null,o),s))}},t.contextTypes={sharingStore:r.object.isRequired,clientId:r.number.isRequired},t}(i.Component),b=h}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0);function i(e,t){return(0,a.a)(e,t)}}
,function(e,t,n){var a,i,r;n.d(t,{a:function(){return a},b:function(){return i},c:function(){return r}}),function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(a||(a={})),function(e){e.graph="graph",e.sharepointSearch="sharepointSearch",e.substrate="substrate"}(i||(i={})),function(e){e.unified="unifiedGroup",e.securityGroup="securityGroup",e.SPGroup="SPGroup",e.PublicDistributionList="PublicDistributionList",e.family="family"}(r||(r={}))}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){return console.log("No session storage accessible: "+e),!1}}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a,i=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl"}(a||(a={}));var r=function(e,t){var n;void 0===e&&(e="");var r=null!==(n=null==t?void 0:t.allowDataUrl)&&void 0!==n&&n,o=e.indexOf("//"),s=e.indexOf("/"),c=o>-1&&o<=s?o+"//".length:-1,d=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,c),l=d&&d.slice(c),u=e.slice(d.length),f=d?a.absolute:r&&i.test(e)?a.dataUrl:"/"===u[0]?a.serverRelative:a.relative,p=u.split("/");this.authority=d,this.domain=l,this.format=f,this.path=u,this.segments=p,this.value=e}}
,function(e,t,n){n.d(t,{a:function(){return g},b:function(){return i},c:function(){return r},d:function(){return a}});var a,i,r,o=n(0),s=n(73),c=n(32),d=n(69),l=n(31),u=n(95),f=n(29),p=n(39),m=n(87),_=n(121),h=n(218),b="ShareV3";!function(e){e.Opening="Opening",e.Opened="Opened",e.Completed="Completed"}(a||(a={})),function(e){e.MainLinkSettingsHint="MainLinkSettingsHint",e.PeoplePickerErrorLinkSettingsHint="PeoplePickerErrorLinkSettingsHint",e.CopyLinkSettingsHint="CopyLinkSettingsHint",e.RoleSelector="RoleSelector",e.Other="Unknown"}(i||(i={})),function(e){e.People="People",e.Groups="Groups",e.Links="Links",e.Other="Unknown"}(r||(r={}));var g=function(){function e(e,t){this._manager=e,this._extraData=t,this._engagmentCounts={}}return e.prototype.setEngagementExtraData=function(e){this._extraData=(0,o.a)((0,o.a)({},this._extraData),e)},e.prototype.getEngagementExtraData=function(){return this._extraData},e.prototype.linkSettingsOpened=function(e,t){this.log("LinkSettings.Opened",(0,o.a)((0,o.a)({},e),{linkSettingsOpenSource:t||i.Other}))},e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)},e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)},e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)},e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)},e.prototype.linkTrackLinkClicked=function(e){this.log("LinkSettings.TrackLinkClicked",e)},e.prototype.linkSettingsLinkTypeChanged=function(e){this.log("LinkSettings.LinkTypeChanged",e)},e.prototype.manageAccessNumberOfSharingPrincipals=function(e){this.log("ManageAccess.NumberOfSharingPrincipals",e)},e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)},e.prototype.manageAccessAddressBarLinkTypeClicked=function(e){this.log("ManageAccess.AddressBarLinkTypeClicked",e)},e.prototype.manageAccessFacePileClicked=function(e){this.log("ManageAccess.FacePileClicked",e)},e.prototype.manageAccessRemoveDirectAccess=function(e){this.log("ManageAccess.RemoveDirectAccess",e)},e.prototype.manageAccessLinkCopyButtonClicked=function(e){this.log("ManageAccess.LinkCopyClicked",e)},e.prototype.manageAccessLinkDetailsClicked=function(e){this.log("ManageAccess.LinkDetailsClicked",e)},e.prototype.manageAccessLinkInviteesToggled=function(e,t){this.log("ManageAccess.LinkInviteesToggled",(0,o.a)((0,o.a)({},t),{isExpanded:e}))},e.prototype.manageAccessAdvancedLinkClicked=function(e){this.log("ManageAccess.AdvancedLinkClicked",e)},e.prototype.manageAccessLinkSectionShareClicked=function(e){this.log("ManageAccess.LinkSectionShareClicked",e)},e.prototype.manageAccessGrantAccessClicked=function(e){this.log("ManageAccess.DiretAccessSectionGrantAccessClicked",e)},e.prototype.manageAccessV3Opened=function(e){this.log("ManageAccessV3.Opened",e)},e.prototype.manageAccessV3NumberOfSharingPrincipals=function(e){this.log("ManageAccessV3.NumberOfSharingPrincipals",e)},e.prototype.manageAccessV3NumberOfLinks=function(e){this.log("ManageAccessV3.NumberOfLinks",e)},e.prototype.manageAccessV3AdvancedSettingsClicked=function(e){this.log("ManageAccessV3.AdvancedSettingsClicked",e)},e.prototype.manageAccessV3UserDidSearch=function(e){this.log("ManageAccessV3.UserDidSearch",e)},e.prototype.manageAccessV3GrantAccessClicked=function(e){this.log("ManageAccessV3.GrantAccessClicked",e)},e.prototype.manageAccessV3StopSharingClicked=function(e){this.log("ManageAccessV3.StopSharingClicked",e)},e.prototype.manageAccessV3QuickfindHotkeyUsed=function(e){this.log("ManageAccessV3.QuickfindHotkeyUsed",e)},e.prototype.compactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.Clicked",e)},e.prototype.linkSettingsInCompactRoleSelectorClicked=function(e){this.log("RoleSelectorCompact.LinkSettingsClicked",e)},e.prototype.SharingRoleChangedFromCompactRoleSelector=function(e){this.log("SharingRoleChangedFromCompactRoleSelector",e)},e.prototype.SharingRoleChangedFromLargeRoleSelector=function(e){this.log("SharingRoleChangedFromLargeRoleSelector",e)},e.prototype.manageAccessV3NavClicked=function(e,t,n){this.log("ManageAccessV3.NavigationClicked",(0,o.a)((0,o.a)({},n),{sectionName:e||r.Other,sectionItemCount:t}))},e.prototype.manageAccessV3ShareClicked=function(e,t){this.log("ManageAccessV3.ShareClicked",(0,o.a)((0,o.a)({},t),{shareLocation:e}))},e.prototype.manageAccessV3PrincipalDetailsClicked=function(e,t){this.log("ManageAccessV3.PrincipalDetailsClicked",(0,o.a)((0,o.a)({},t),{principalType:e}))},e.prototype.manageAccessV3PrincipalRemoveDirectAccess=function(e,t){this.log("ManageAccessV3.PrincipalRemoveDirectAccess",(0,o.a)((0,o.a)({},t),{principalType:e}))},e.prototype.manageAccessV3CancelPermissionUpdate=function(e){this.log("ManageAccessV3.CancelPermissionUpdate",e)},e.prototype.renderSharingInfoBar=function(e){this.log("SharingInfoBar.Rendered",e)},e.prototype.simplifiedV2TeachingBubbleShown=function(e){this.log("SimplifiedV2TeachingBubble.Shown",e)},e.prototype.simplifiedV2TeachingBubbleDismissed=function(e){this.log("SimplifiedV2TeachingBubble.Dismissed",e)},e.prototype.simplifiedV2TeachingBubbleCompleted=function(e){this.log("SimplifiedV2TeachingBubble.Completed",e)},e.prototype.simplifiedV2TeachingBubbleAbandoned=function(e){this.log("SimplifiedV2TeachingBubble.Abandoned",e)},e.prototype.shareToTeamsTeachingBubbleShown=function(e){this.log("ShareToTeamsTeachingBubble.Shown",e)},e.prototype.linkSettingsInfoMessageClick=function(e){this.log("LinkSettingsInfoMessage.Click",e)},e.prototype.shareCompleted=function(e){e=(0,o.a)((0,o.a)({},e),{compactRoleSelectorClicked:this._engagmentCounts["RoleSelectorCompact.Clicked"]>0,linkSettingsOpened:this._engagmentCounts["LinkSettings.Opened"]>0,sharingRoleChangedFromCompactRoleSelector:this._engagmentCounts.SharingRoleChangedFromCompactRoleSelector>0}),this.log("Completed",e)},e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)},e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)},e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)},e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)},e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)},e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)},e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)},e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)},e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)},e.prototype.copyLinkNotificationAutoCopyFailed=function(e){this.log("copyLinkNotificationAutoCopyFailed",e)},e.prototype.copyButtonClickedAfterAutoCopyFailed=function(e){this.log("copyButtonClickedAfterAutoCopyFailed",e)},e.prototype.shareErrorFileIsUploading=function(e){this.log("shareError.FileUploading",e)},e.prototype.webShareToTeamsTargetClicked=function(e){this.log("ShareToTeams.TeamsTargetClicked",e)},e.prototype.onLinkParticipantOpenDelete=function(e){this.log("ShareLinkParticipants.OpenParticipantDeletionDialog",e)},e.prototype.onLinkParticipantDelete=function(e){this.log("ShareLinkParticipants.ParticipantDeleted",e)},e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",(0,o.a)((0,o.a)({},e),{linkedinSuggestionsCount:s.b(t)}))},e.prototype.onShareLinkDelete=function(e){this.log("ShareLink.Delete",e)},e.prototype.logShareLinkGeneration=function(e,t){this.log("ShareV3.odspShareLink",(0,o.a)((0,o.a)({},t),{allowsAnonymousAccess:e.allowsAnonymousAccess,audience:e.audience,blockDownload:e.blockDownload,createdViaCopyLinkCommand:e.createdViaCopyLinkCommand,hasDescription:!!e.description,hasExpiration:!!e.expiration,hasPassword:e.hasPassword,numOfInvitees:e.invitees?e.invitees.length:0,isActive:e.isActive,isAddressBarLink:e.isAddressBarLink,isCreateOnlyLink:e.isCreateOnlyLink,isEdit:e.isEdit,isManageList:e.isManageList,isReview:e.isReview,isUnhealthy:e.isUnhealthy,shareId:e.shareId,sharingLinkStatus:e.status,trackLinkUsers:e.trackLinkUsers}))},e.prototype.logNumberOfUnhealthyLinks=function(e){this.log("numberOfUnhealthyLinks",{numUnhealthyLinks:e})},e.prototype.logShareObject=function(e,t){this.log("ShareObjectV2",{sharingRole:c.a[t],numOfInvitees:e.length})},e.prototype.showSensitivityLabel=function(e){this.log("showSensitivityLabel",e)},e.prototype.hoverOverSensitivityLabel=function(e){this.log("hoverOverSensitivityLabel",e)},e.prototype.modifiedSummary=function(e){this.log("modifiedSummary",e)},e.prototype.deletedSummary=function(e){this.log("deletedSummary",e)},e.prototype.summarizationCopilotEnabled=function(e,t){this.log("summarizationCopilotEnabled",(0,o.a)((0,o.a)({},e),{copilotFeatureEnabled:t}))},e.prototype.summarizationEnabled=function(e,t){this.log("summarizationEnabled",(0,o.a)((0,o.a)({},e),{summaryEnabled:t}))},e.prototype.summarizationClick=function(e,t){this.log("summarizationClick",(0,o.a)((0,o.a)({},e),{summaryClick:t}))},e.prototype.summarizationStatus=function(e,t){this.log("summarizationStatus",(0,o.a)((0,o.a)({},e),{summaryStatus:t}))},e.prototype.summarizationSent=function(e,t){this.log("summarizationSent",(0,o.a)((0,o.a)({},e),{summarySent:t}))},e.prototype.summarizationFeedback=function(e,t){this.log("summarizationFeedback",(0,o.a)((0,o.a)({},e),{feedbackIsPositive:t}))},e.prototype.summarizationDisabledReasonsMask=function(e,t){this.log("summarizationDisabledReasonsMask",(0,o.a)((0,o.a)({},e),{summaryDisabledReasonMask:t}))},e.prototype.discoverableByOrganizationToggle=function(e){this.log("DiscoverableByOrganization",{enabled:e})},e.prototype.discoverableMessageBarClicked=function(){this.log("DiscoverableByOrganization.MessageBarClicked")},e.prototype.discoverableByOrganizationDoNotShowAgainChecked=function(e){this.log("DiscoverableByOragnization.DoNotShowAgain",{checked:e})},e.prototype.logEvent=function(e,t){this.log(a[e],t)},e.prototype.log=function(e,t){void 0===this._engagmentCounts[e]?this._engagmentCounts[e]=1:this._engagmentCounts[e]++;var n=(0,o.a)((0,o.a)({},this._extraData),t),a=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0,i=location.href.toLowerCase().indexOf("www.odwebp.svc.ms")>=0,r=(0,m.a)(location.search.substring(1)),s="12"===r.p,c=!!r.migratedhosting&&"true"===r.migratedhosting.toLowerCase(),g=(0,o.a)((0,o.a)((0,o.a)({},n),{clientId:d.a[n.clientId],scenarioId:n.scenarioId,mode:l.a[n.mode],shareType:u.a[n.shareType],audience:f.a[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets),sharingLinkKind:p.a[n.sharingLinkKind],isShareDialogASPXHosted:a,isP12:s,isMigratedhosting:c,isMicroServiceHosted:i}),void 0===n.shareViewState?{}:{shareViewState:h.a[n.shareViewState]}),v={name:0===e.indexOf(b)?e:"".concat(b,".").concat(e),webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:g};(this._manager?_.a.withManager(this._manager):_.a).logData(v)},e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,a=e;n<a.length;n++){var i=a[n];t.push(u.a[i])}return t},e}()}
,,,,,,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:1.75rem}.od-ActivityIndicator span{font-size:1rem}"}]);var i=n(1),r=n(42),o=n(80),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t.prototype.render=function(){return i.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},i.createElement("div",null,i.createElement(r.a,{type:o.b.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}})),i.createElement("span",{role:"alert"},this.props.message))},t}(i.Component)}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(52),i=n(26),r=(0,a.a)({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:i.a.String},isIntentional:{isPrefixingDisabled:!0,type:i.a.Boolean},scenario:{isPrefixingDisabled:!0,type:i.a.String},location:{isPrefixingDisabled:!0,type:i.a.String},usageType:{isPrefixingDisabled:!0,type:i.a.String},currentPage:{isPrefixingDisabled:!0,type:i.a.String},previousPage:{isPrefixingDisabled:!0,type:i.a.String},experiment:{isPrefixingDisabled:!0,type:i.a.Object},siteId:{isPrefixingDisabled:!0,type:i.a.String},webId:{isPrefixingDisabled:!0,type:i.a.String},listId:{isPrefixingDisabled:!0,type:i.a.String},groupId:{isPrefixingDisabled:!0,type:i.a.String},docId:{isPrefixingDisabled:!0,type:i.a.String},webTemplateId:{isPrefixingDisabled:!0,type:i.a.String},listTemplateId:{isPrefixingDisabled:!0,type:i.a.String},siteType:{isPrefixingDisabled:!0,type:i.a.String},feature:{isPrefixingDisabled:!0,type:i.a.String},component:{isPrefixingDisabled:!0,type:i.a.String},extraData:i.a.Object,objectType:{isPrefixingDisabled:!0,type:i.a.String},datasource:{isPrefixingDisabled:!0,type:i.a.String},action:{isPrefixingDisabled:!0,type:i.a.String},privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}}).withData({privacyClassification:i.b.optionalDiagnostic,privacyDataTypes:["browsingHistory"]})}
,,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o.a}});var a=n(103),i=n(26),r=n(18),o=n(58),s=(0,a.a)({eventName:"Api,Qos,",shortEventName:"Api"},{url:i.a.String,privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}},r.a).withData({privacyClassification:i.b.requiredService})}
,function(e,t,n){n.d(t,{a:function(){return f},b:function(){return d},c:function(){return l}});var a,i,r=n(106),o=n(199),s=n(194),c=n(429),d=(i=null===r.a||void 0===r.a?void 0:r.a.hcid,a="UnAuth"===i?{viewerId:c.a?i:"",isCurrentViewerUnAuth:!0,loggedInUserDriveId:void 0}:i?{viewerId:i.toUpperCase(),isCurrentViewerUnAuth:!1,loggedInUserDriveId:(0,s.a)(i)}:{viewerId:"",isCurrentViewerUnAuth:!1,loggedInUserDriveId:void 0}).isCurrentViewerUnAuth,l=a.viewerId,u=a.loggedInUserDriveId,f=function(e){return!!(e&&u&&(0,o.a)(e,u))}}
,,function(e,t,n){n.r(t),n.d(t,{getErrorMessage:function(){return b},isExpectedError:function(){return g},log:function(){return h},logError:function(){return _},verbose:function(){return m}});var a=n(52),i=n(26),r=n(284),o=(0,a.a)({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0},{stack:i.a.String,extraData:i.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}},r.a).withData({privacyClassification:i.b.requiredService}),s=n(58),c=(0,a.a)({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:i.a.String},resultCode:i.a.String,resultType:{typeRef:s.a,type:i.a.Enum}},o).withData({privacyClassification:i.b.requiredDiagnostic}),d=n(411),l=n(472),u=n(159),f="Canceled",p=new l.a(50);function m(e,t){p.push({name:t,message:e})}function _(e,t,n){var a;if(!e||function(e){return e===f||(null==e?void 0:e.name)===f||(null==e?void 0:e.message)===f}(e)||"object"==typeof e&&e.isExpected)try{if("true"===sessionStorage.getItem("suppressErrorHandling"))return}catch(e){}else{for(var i,r=b(e),s=null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"";i=p.popOldest();)d.a.logData(i);n&&n.eventName?c.logData({name:n.eventName,resultCode:n.resultCode,resultType:n.resultType,extraData:t||{},message:r,stack:s}):o.logData({extraData:t||{},message:r,stack:s})}}function h(e,t,n,a){_(e,void 0,{eventName:t,resultCode:n,resultType:a})}function b(e){var t,n;return e?"object"==typeof e?null!==(n=null!==(t=e.message)&&void 0!==t?t:e.description)&&void 0!==n?n:(0,u.a)(e):e.toString():""}function g(e,t){if(!0===e.isExpected)return!0;void 0===e.message&&void 0===e.code&&console.error('Error message and code are both undefined. "error" must specify at least message or code');for(var n=function(e,t){return!(!e||!t||0!==e.localeCompare(t,void 0,{sensitivity:"base"})&&e!==t)},a=!1,i=0,r=t;i<r.length;i++){var o=r[i],s=n(o.code,e.code),c=n(o.message,e.message);if(o.code&&e.code&&o.message&&e.message?a=s&&c:o.code&&e.code?a=s:o.message&&e.message&&(a=c),a)return a}return a}}
,,,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i}});var a=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function i(e){return"function"==typeof e.dispose}function r(e,t){var n=e,i=n.dispose,r="function"==typeof i&&i.disposalChain||function(e){var t=new a(e),n=e.dispose,i=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=i,i.disposalChain=t,t}(n);return r.addCallback(t),n}}
,function(e,t){var n=function(){function e(){}return e.encodeURIComponent=function(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i},e.escapeUrlForCallback=function(t){var n=t.indexOf("#"),a=t.indexOf("?");if(n>0&&(-1===a||n<a)){var i=t.substr(0,n);a>0&&(i+=t.substr(a)),t=i}return e.encodeURIComponent(t,!0,!1,!0)},e.encodeRestUriStringToken=function(t,n){return t&&(t=(t=t.replace(/'/g,"''")).replace(/%27/g,"%27%27"),n||(t=e.encodeURIComponent(t))),t},e}();t.a=n}
,function(e,t,n){n.d(t,{a:function(){return F},b:function(){return H}});var a=n(0),i=n(67),r=n(221),o=n(52),s=n(26),c=(0,o.a)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:s.a.String,dictionary:s.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:s.a.String},persistence:{isPrefixingDisabled:!0,type:s.a.String}}).withData({privacyClassification:s.b.requiredService}),d=n(53),l=n(163),u=n(3);function f(e){return(0,a.b)(this,void 0,void 0,function(){var t;return(0,a.e)(this,function(i){switch(i.label){case 0:return t=(0,a.a)({minValue:Math.round(window.performance&&performance.now?Math.round(performance.now()):Date.now()),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},e),[4,n.e("deferred.odsp-common").then(n.bind(n,611))];case 1:return[2,i.sent().getFirstConsistentlyInteractive(t).then(function(e){return(0,a.a)((0,a.a)({},e||{}),{options:t})})]}})})}var p,m=n(47);!function(e){e[e.own=0]="own",e[e.cors=1]="cors"}(p||(p={}));var _,h=function(e,t,n,a,i,r,o){this.url=e,this.duration=t,this.correlationId=n,this.status=a,this.startTime=i,this.endTime=r,this.name=o,this.clientDurationInMilliseconds=new Date(r).getTime()-new Date(i).getTime(),this.origin=e&&new m.a(e).getHost()},b="undefined"==typeof window?self:window,g=function(){function e(){var e;this._requestIdGenerator=(e=0,function(){return(e++).toString()}),this.apis=[],this._apiBuffer={}}return e.prototype.reset=function(){this.apis=[],this._apiBuffer={}},e.prototype.startTracking=function(e){var t=this,n=e.ignore,i=void 0===n?function(e){return!1}:n,r=e.getAPIName,o=void 0===r?function(e){}:r,s=function(e){var n=e.id,a=e.request,i=e.type,r=new h;r.startTime=(new Date).toISOString(),r.startTimeRelative=t._now(),"fetch"===i&&(r.url="string"==typeof a?a:a.url),t._apiBuffer[n]=r};return this._instrument({fetch:{onRequest:s,onResponse:function(e){try{var n=e.response,r=e.id,s=t._apiBuffer[r];if(s&&!i(s.url)){var c=void 0,d=void 0;try{c=n.headers.get("SPClientServiceRequestDuration"),d=n.headers.get("SPSQLQueryCount")}catch(e){}var l=void 0;try{l=n.headers.get("SPRequestGuid")}catch(e){}s.name=o(s.url),s=(0,a.a)((0,a.a)({},s),(0,a.a)((0,a.a)((0,a.a)({endTime:(new Date).toISOString(),endTimeRelative:t._now(),clientDurationInMilliseconds:t._now()-s.startTimeRelative,status:n.status},c?{duration:Number(c)}:{}),d?{sqlRT:Number(d)}:{}),l?{correlationId:l}:{})),t.apis.push(s)}}catch(e){}}},xhr:{onRequest:s,onResponse:function(e){var n,r;try{var s=e.request,c=e.id,d=t._apiBuffer[c],l=s.responseURL||s.requestUrl;if(d&&!i(l)){var u=null!==(r=null===(n=s.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==r?r:"",f=u.indexOf("spclientservicerequestduration:")>=0&&s.getResponseHeader("SPClientServiceRequestDuration"),p=u.indexOf("spsqlquerycount:")>=0&&s.getResponseHeader("SPSQLQueryCount"),m=u.indexOf("sprequestguid:")>=0&&s.getResponseHeader("SPRequestGuid");d.name=o(l),d=(0,a.a)((0,a.a)({},d),(0,a.a)((0,a.a)((0,a.a)((0,a.a)({endTime:(new Date).toISOString(),endTimeRelative:t._now(),clientDurationInMilliseconds:t._now()-d.startTimeRelative,status:s.status},f?{duration:Number(f)}:{}),p?{sqlRT:Number(p)}:{}),m?{correlationId:m}:{}),{url:l})),t.apis.push(d)}}catch(e){}}}}),function(){t.stopTracking()}},e.prototype.stopTracking=function(){b.__RUMOneAPITrackerInstrumented=!1,this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen),this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend),this._originalFetch&&(b.fetch=this._originalFetch)},e.prototype.getData=function(){for(var e=0,t=0,n=[],i=0,r=this.apis;i<r.length;i++){var o=r[i];if(o){e++,t+=o.duration,o.origin||(o.origin=new m.a(o.url).getHost()),o.hostType=new m.a(window.location.href).getHost()===o.origin?p.own:p.cors;var s=(0,a.a)({},o);delete s.url,n.push(s)}}return{count:e,duration:t,calls:JSON.stringify(n)}},e.prototype._instrument=function(e){var t=this;if(!b.__RUMOneAPITrackerInstrumented){b.__RUMOneAPITrackerInstrumented=!0;var n=e.fetch,a=e.xhr;if("XMLHttpRequest"in b&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send,this._originalXhrOpen=XMLHttpRequest.prototype.open;var i=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.requestUrl=e[1],i._originalXhrOpen.apply(this,e)},XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=i._requestIdGenerator();return a.onRequest({request:this,id:r,type:"xhr"}),this.addEventListener("readystatechange",function(){4===e.readyState&&a.onResponse({request:e,id:r,type:"xhr"})}),i._originalXhrSend.apply(this,t)}}"fetch"in b&&void 0!==b.fetch&&(this._originalFetch=b.fetch.bind(b),b.fetch=function(e,a){return new Promise(function(i,r){var o=t._requestIdGenerator();n.onRequest({request:e,id:o,type:"fetch"}),t._originalFetch(e,a).then(function(e){n.onResponse({response:e,id:o,type:"fetch"}),i(e)},function(e){r(e)})})})}},e.prototype._now=function(){return performance&&performance.now?Math.round(performance.now()):NaN},e}(),v=n(222);function y(){return _}n(477);var S=n(59),D=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"];function I(){var e=performance.getEntriesByType("navigation")[0];if(e)return e}function x(e){try{var t=window._spPageContextInfo,n=e.name;if(null==t?void 0:t.cdnPrefix){var a=t.cdnPrefix.replace(/bld$/,"");if(0===n.search(window.location.protocol+"//"+a))return!0}return!(!(null==t?void 0:t.cdnBaseUrl)||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(n)}catch(e){return!1}}function C(e,t){for(var n=[],a=0;a<e.length;a++){var i=e[a];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n}var O={CDN:x,SharePoint:function(e){return 0===e.name.search(window.location.protocol+"//"+window.location.host)},ThirdParty:function(e){return!O.SharePoint(e)&&O.CDN(e)}},w={HTML:function(e){return/html/i.test(e.initiatorType)},ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}};function E(e,t){var n;return t in e?((n={})[t]=Math.round(e[t]),n):{}}var A,L={checkInterval:100,error_timeout:3e4,max_markers:200};function k(e,t){c.logData((0,a.a)({streamName:e,dictionary:t},{persistence:"Critical"}))}!function(e){e[e.Incomplete=1]="Incomplete",e[e.ReadyToUpload=2]="ReadyToUpload",e[e.Uploaded=3]="Uploaded",e[e.TimeOut=4]="TimeOut",e[e.Skipped=5]="Skipped"}(A||(A={}));var M=["EUPL","ScenarioId"],P=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,T=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/;function U(e){return null==e}var F="perftest",H=function(){function e(e,t,n){void 0===n&&(n=L),this._dataStartTime=Date.now(),this._name=e,this._config=n,this._keyMetrics=M.slice(0),this._rumoneData={},this._dataState=A.Incomplete,this._controls=[],this._loggingFunctions=[],this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._settings={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this._async=new i.a,this._apiTracker=new g,this._platformDetection=new d.a,this.registerLoggingFunc(t),this.setPerfDataTimer(),this._hookUnloadEvent()}return e.getRUMOneLogger=function(t){var n=t||{},a=n.name,i=void 0===a?"__default_rumone__":a,r=n.rumOneConfig,o=void 0===r?L:r,s=n.onLog,c=void 0===s?k:s;if(!e._loggers[i])try{var d=new e(i,c,o);e._loggers[i]=d}catch(e){}return e._loggers[i]},e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);return n<0&&this._loggingFunctions.push(e),function(){n>=0&&t._loggingFunctions.splice(n,1)}},Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){return this._TTIMeasurementEnabled()&&this.addExpectedKeyMetric("TTI"),this._FCIMeasurementEnabled()&&this.addExpectedKeyMetric("FCI"),this._keyMetrics},enumerable:!1,configurable:!0}),e.prototype.getPerformanceData=function(){return this._rumoneData},e.prototype.startAPIMeasurement=function(e){return this._apiTracker.startTracking(e)},e.prototype.undoAPIInstrument=function(){this._apiTracker.stopTracking()},e.prototype.resetLogger=function(){this._emergencyUpload(),this._dataStartTime=(new Date).getTime(),this._dataState=A.Incomplete,this._apiTracker.reset(),this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._controls=[],this._tempData={},this._rumoneData={},this._settings={},this._keyMetrics=M.slice(0),this.clearPerfDataTimer(),this.setPerfDataTimer(),this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this.clearResourceTimings(),(0,l.c)(this._getOwnMakers().map(function(e){return e.name})),e._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this._ttiPromise=void 0,this._fciPromise=void 0,u.a.isActivated("61e773f9-e704-460b-9fba-4e534188c42d")||(_=void 0),this.logMessageInConsole("Reset performance Logger Done"),S.a.raise(this,"reset",{})},e.prototype.setSettings=function(e){this._settings=(0,a.a)((0,a.a)({},this._settings),e)},e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})},e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]},e.prototype.setPerformanceDataPropertyValue=function(e,t){return e&&P.test(e)?(this._rumoneData[e]=t,!0):(console.error("key ".concat(e," does not confrim to the Regex ").concat(P)),!1)},e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this._controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this._controls.push(t)},e.prototype.ignoreExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)&&(this._controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=!0)},e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this._controls.filter(function(e){return e.controlId===t.controlId}).length>0},e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e},e.prototype.writeServerUrl=function(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)},e.prototype.writeServerSideLatency=function(e,t){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=e,this._rumoneData.IISLatency=t)},e.prototype.writeControlPerformanceData=function(e){if(e){var t=this._controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this._controls.push(n)}}},e.prototype.writeAPICallPerformanceData=function(e){e&&this._apiTracker.apis.push(e)},e.prototype.readAPICallPerformanceData=function(){return this._apiTracker.apis},e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)},e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==r.a.fullPageLoad&&e!==r.a.none&&e!==r.a.pageToPageNavigation&&e!==r.a.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)},e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)},e.prototype.collectW3CPerfTimings=function(){if(!this._isW3cTimingCollected){var e=function(){var e,t=performance&&performance.timing;if(t){for(var n=[],a=0;a<D.length;a++){var i=t[D[a]];i&&n.push([(e=D[a],"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"),Number(i)])}return n}}();if(e)for(var t=0,n=e;t<n.length;t++){var a=n[t];this._logRUMOneData.apply(this,a)}this._isW3cTimingCollected=!0,u.a.isActivated("74a3bc71-19b9-4c18-abd5-2e47abab2824")||this._logRUMOneData("navigation",function(){var e=I();if(e&&e.toJSON){var t=e.toJSON();return delete t.name,t}}())}},e.prototype.collectW3cResourceTimings=function(e){void 0===e&&(e={});var t=e.logSummery,n=void 0===t||t,i=e.start,r=void 0===i?0:i,o=e.end,s=void 0===o?Math.round(this.now()):o,c=e.columnNameOverride,d=void 0===c?function(e){return e}:c,l="logSummery=".concat(n,"|start=").concat(r,"|end=").concat(s,"|columnNameOverride=").concat(d);if(!this._isW3cResourceTimingCollected[l]){var u=function(e){var t=e.logSummery,n=e.start,i=e.end,r=e.columnNameOverride;if(window.document&&(null===performance||void 0===performance?void 0:performance.getEntriesByType)){for(var o=function(e,t){for(var n=performance.getEntriesByType("resource"),a=document.getElementsByTagName("iframe"),i=0;i<a.length;i++){var r=null;try{r=a[i].contentWindow.performance}catch(e){}r&&r.getEntriesByType&&(n=n.concat(r.getEntriesByType("resource")))}return n.filter(function(n){return n.startTime>=e&&n.startTime<=t})}(n,i),s=[],c=Object.keys(O),d=0;d<c.length;d++){var l=c[d],u=C(o,{from:O[l],requestType:null});t&&s.push({key:r(l+"RequestCountTotal"),value:u.length});for(var f=Object.keys(w),p=0;p<f.length;p++){var m=f[p];t&&s.push({key:r(l+"RequestCount"+m),value:C(u,{from:null,requestType:w[m]}).length})}if(u.length>0&&(t&&s.push({key:r(l+"RequestDownloadTime"),value:Math.round(u.reduce(function(e,t){return e+t.duration},0)/u.length)}),"CDN"===l)){var _=JSON.stringify(u.map(function(e){return(0,a.a)((0,a.a)((0,a.a)((0,a.a)({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0,fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart),connect:Math.round(e.connectEnd-e.connectStart),domainLookup:Math.round(e.domainLookupEnd-e.domainLookupStart),redirect:Math.round(e.redirectEnd-e.redirectStart)},E(e,"workerStart")),E(e,"responseStart")),E(e,"responseEnd")),E(e,"secureConnectionStart"))}));s.push({key:r(l+"RequestNames"),value:_})}}return s}}({columnNameOverride:d,logSummery:n,start:r,end:s});if(u){for(var f=0,p=u;f<p.length;f++){var m=p[f];this._logRUMOneData(m.key,m.value)}this._isW3cResourceTimingCollected[l]=!0}}},e.prototype.saveTempData=function(e,t){this._tempData[e]=t},e.prototype.readTempData=function(e){return this._tempData[e]},e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)},e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)},e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)},e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)},e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)},e.prototype.isRunning=function(){return!(this._dataState===A.Uploaded||this._dataState===A.TimeOut||this._dataState===A.Skipped)},e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this._euplBreakDown,e,t)},e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this._euplBreakDown,e,t,n)},e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this._euplBreakDown,e)},e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this._ttiBreakDown,e,t)},e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this._ttiBreakDown,e,t,n)},e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this._ttiBreakDown,e)},e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var a=e[n];a&&-1===t.indexOf(a)&&t.push(a)}this._rumoneData.Flights=JSON.stringify(t)}},e.prototype.addPerfFlights=function(e){this._rumoneData.PerfFlights=e},e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,a=e.ExpFeatures;n<a.length;n++){var i=a[n];t+=this._numberToBinString(i).split("").reverse().join("")}this._rumoneData.Flights=t},e.prototype.collectODCClientRamps=function(e,t){for(var n=e.Ramps,a=void 0===n?{}:n,i=[],r=0,o=t;r<o.length;r++){var s=o[r];s.ODC&&"boolean"!=typeof s.ODC&&a[s.ODC]&&i.push(s.ODC)}this._rumoneData.Flights=JSON.stringify(i)},e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!U(e[n])&&(U(this._serverMetrics[n])||t)&&(this._serverMetrics[n]=e[n])},e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e},e.prototype.getControls=function(){return this._controls},e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t),(0,l.f)(t)},e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN},e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e},e.prototype.registerErrorHandler=function(e){},e.prototype.getMarkerTime=function(e){return(0,l.e)(e)},e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)},Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{get:function(){return this._settings.waitOnAddingExpectedControl},set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!1,configurable:!0}),e.prototype._measureTTI=function(){var e=this,t=this._settings.TTISettings,i=t.TTIPolyfillSettings,r=i.getAbsoluteEUPL,o=!u.a.isActivated("5fac57dd-fcbb-43af-a336-c9c802b89956"),s=!u.a.isActivated("a784e856-ad62-499d-9329-47185567200d"),c=!u.a.isActivated("d7e56d29-f0bd-4cc5-8482-9ee976acaaad"),d=c&&!u.a.isActivated("313e2047-0d8d-48e3-a0f9-0d77ebbe61c9"),p=r?r(this._rumoneData.EUPL):this.now(),m=c&&t.getStartTime?t.getStartTime():0,_=NaN,h=NaN;if(d){var b=I();b&&(_=Math.round(R([b.redirectStart,b.workerStart,b.fetchStart])),m>0&&_<m&&(_=m),h=Math.round(R([b.redirectStart,b.workerStart,b.unloadEventStart,b.fetchStart])),m>0&&h<m&&(h=m))}var g=0,v=function(){if(g++,o){var e=window.__tti&&window.__tti.e||[];return g>=2&&function(){var e,t;(null===(e=window.__fci)||void 0===e?void 0:e.o)&&window.__fci.o.disconnect(),(null===(t=window.__fci)||void 0===t?void 0:t.e)&&(window.__fci.e=[]);var n=window.__tti&&window.__tti.e,a=window.__tti&&window.__tti.o;n&&(window.__tti.e=[]),a&&a.disconnect()}(),e}};if(this._TTIMeasurementEnabled()&&!this._ttiPromise){if(s){var D=v();this._ttiPromise=f({minValue:p,initialEntries:D})}else this._ttiPromise=f(i.options);this._ttiPromise.then(function(t){var n=t||{},a=n.tti,r=n.longTasks,o=n.options,d=a;if(U(a))a=NaN;else if(c)a=Math.round(a)-m;else{var l=i.calculateTTI;l&&(a=l(Math.round(a),e._rumoneData,"TTI"))}U(e._rumoneData.TTI)?e.addEUPLBreakdown("currentTTI",{data:JSON.stringify(a),needFlatten:!1}):e.addEUPLBreakdown("prevTTI",{data:JSON.stringify(e._rumoneData.TTI),needFlatten:!1}),e._rumoneData.TTI=a,r&&(e._rumoneData.TTILongTasks=JSON.stringify(r),e._rumoneData.TTILongTasksPostFMPCount=r.filter(function(t){return t.end>e._rumoneData.EUPL}).length),e._logLastRequestBeforeTTI(a,r,"TTI"),e.collectW3cResourceTimings({logSummery:!1,start:d-(a-e._rumoneData.EUPL),end:d,columnNameOverride:function(e){return"".concat(e,"OfTTI")}}),!s&&o&&e.addEUPLBreakdown("TTIOptions",{data:JSON.stringify(o),needFlatten:!1});var u=y();u&&(e._rumoneData.CLS=u.cls,e._rumoneData.CLSFullResult=JSON.stringify(u)),S.a.raise(e,"measureTTI",e._rumoneData)})}this._FCIMeasurementEnabled()&&!this._fciPromise&&(D=v(),this._fciPromise=function(e){return(0,a.b)(this,void 0,void 0,function(){var t;return(0,a.e)(this,function(i){switch(i.label){case 0:return t=(0,a.a)((0,a.a)({},e),{requiredMainThreadCPUIdleDurationInMilliseconds:1e3}),[4,n.e("deferred.odsp-common").then(n.bind(n,612))];case 1:return[2,i.sent().getFirstCPUIdle(t)]}})})}({measurementStartTime:p,initialEntries:D}),this._fciPromise.then(function(n){var a=n||{},r=a.fci,o=a.longTasks;if(U(r))r=NaN;else if(c)r=Math.round(r)-m;else{var s=i.calculateTTI;s&&(r=s(Math.round(r),e._rumoneData,"FCI"))}if(e._rumoneData.FCI=r,d){var u=Math.round(n.fci);e._logRUMOneData("adjustedTti1",u-_),e._logRUMOneData("adjustedTti2",u-h),e._logRUMOneData("TtiData",{longTaskMinimum:p,ttiStartTime:m,ttiEndTime:u,adjustedStartTime1:_,adjustedStartTime2:h,isTtiSupported:"PerformanceLongTaskTiming"in window,hasHighResolutionTiming:l.a,isPerformanceNavigationSupported:"PerformanceNavigationTiming"in window})}o&&(e._rumoneData.FCILongTasks=JSON.stringify(o),e._rumoneData.FCILongTasksPostFMPCount=o.filter(function(t){return t.end>e._rumoneData.EUPL}).length),e._logLastRequestBeforeTTI(r,o,"FCI"),t.additionalTTIProcessing&&t.additionalTTIProcessing(e._rumoneData),S.a.raise(e,"measureTTI",e._rumoneData)}))},e.prototype._logLastRequestBeforeTTI=function(e,t,n){var a=performance.getEntriesByType("resource");if(e&&t&&t.length>0&&a&&a.length>0){for(var i=t[t.length-1].start,r=a[0],o=0,s=a;o<s.length;o++){var c=s[o];c.responseEnd<i&&c.responseEnd>r.responseEnd&&(r=c)}var d,l;d=x(r)?r.name:this._processLastNetworkUrl(r.name),l=/\.aspx/i.test(r.name)?"ASPX":/\.js/i.test(r.name)?"JS":/\.css/i.test(r.name)?"CSS":/img/i.test(r.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(r.name)?"IMG":/aria\.microsoft\.com/i.test(r.name)?"Aria":/_api/i.test(r.name)?"API":"Other","TTI"===n?(this._rumoneData.TTILastRequestName=d,this._rumoneData.TTILastRequestType=l,this._rumoneData.TTILastRequestStartTime=r.startTime,this._rumoneData.TTILastRequestEndTime=r.responseEnd):(this._rumoneData.FCILastRequestName=d,this._rumoneData.FCILastRequestType=l,this._rumoneData.FCILastRequestStartTime=r.startTime,this._rumoneData.FCILastRequestEndTime=r.responseEnd)}},e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return"".concat(Array(32-t.length+1).join("0")).concat(t)},e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)},e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()},e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten},e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(a){if(n<e._config.max_markers){var i=a.name.substr(l.b.length)+".mark".concat(n++);t[i]=Math.round(a.startTime)}}),this.writeEUPLBreakdown(JSON.stringify(t))},e.prototype._getOwnMakers=function(){var t=this,n=e._markers,a=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return(0,l.d)().filter(function(e){return-1===a.indexOf(e.name)})},e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)},Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!1,configurable:!0}),e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n="".concat(this._name," ").concat(e)+" : "+JSON.stringify(t);console.log(n)}},e.prototype.isCollected=function(e){return!U(this.getPerformanceDataPropertyValue(e))},e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e},e.prototype.setPerfDataTimer=function(){var e=this;this._perfDataTimer=this._async.setTimeout(function(){e.loopForDataCompleteness()},this._config.checkInterval)},e.prototype.clearPerfDataTimer=function(){U(this._perfDataTimer)||(this._async.clearTimeout(this._perfDataTimer),this._perfDataTimer=null)},e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var a=t.filter(function(e){return"first-paint"===e.name});a&&1===a.length&&(e=a[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=Math.round(e))},e.prototype.collectSupplementaryData=function(){this._setFCP(),this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(),this.setBrowserInfo(),this.setReferrer(),this._collectMemoryData(),this._collectPageServerData(),this._setAppInfo(),this._setTestName(),this._collectExperiments(),this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length,this._rumoneData.ServerMetrics=JSON.stringify(this._serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this._euplBreakDown),this._rumoneData.TTIBreakdown=JSON.stringify(this._ttiBreakDown),this._normalizeTTI()},e.prototype._normalizeTTI=function(){var e;this._rumoneData.PageTransitionType===r.a.fullPageLoad&&((null===(e=this._rumoneData.ScenarioId)||void 0===e?void 0:e.indexOf("SPPages"))>-1||this._rumoneData.ScenarioId.indexOf("VivaHome")>-1)&&(this._rumoneData.TTI=this._rumoneData.FCI||this._rumoneData.TTI)},e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];a&&a._serverTime&&Date.now()-new Date(a._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)},e.prototype._setTestName=function(){var e=new m.a(location.href).getQueryParameter(F);e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)},e.prototype.loopForDataCompleteness=function(){if(this.clearPerfDataTimer(),!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this._dataState))),this.logObjectForDebugging("Controls: ",this._controls),this.logObjectForDebugging("API Performance Data: ",this._apiTracker.apis),this.logObjectForDebugging("Temp Data: ",this._tempData),this.logObjectForDebugging("EUPLBreakdown: ",this._euplBreakDown),this.logObjectForDebugging("TTIBreakdown: ",this._ttiBreakDown),this.logObjectForDebugging("ServerMetrics: ",this._serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;this._updateState()}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer()},e.prototype._updateState=function(){switch(this._dataState){case A.Incomplete:this.processControlRenderTime(),this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI(),0===this._getMissedKeyMetrics().length&&0===e.length&&(this._dataState=A.ReadyToUpload);break;case A.ReadyToUpload:this._uploadPerfData({emergency:!1})}},e.prototype._checkTimeout=function(){if(this.isRunning()&&this._dataState!==A.ReadyToUpload){var e=Date.now();if(!(this._dataState===A.Incomplete&&e-this._dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t),this._dataState=A.TimeOut,this._uploadPerfData({emergency:!1})}}},e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++)U(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t]);return e},e.prototype._getMissedControls=function(){return this._controls.filter(function(e){return!e.data||!e.data.renderTime})},e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})},e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne(),this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData)this._dataState=A.Skipped,this.logMessageInConsole("Uploading perf data skipped as requested by the consumer");else if(n||this._dataState===A.ReadyToUpload||this._dataState===A.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var a=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",a)}),this._dataState=A.Uploaded,this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",a),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this._dataState)))}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state ".concat(this._dataState))}catch(e){t="PerformanceLogger error writing RUMOne data: ".concat(e),"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{this.isRunning()||(this._unhookUnloadEvent(),this.undoAPIInstrument())}},e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)},e.prototype._FCIMeasurementEnabled=function(){return u.a.isActivated("fd4b468d-1cfc-438b-bc4e-52e7e29dffe0")?!(!this._TTIPolyfillEnabled()||this._settings.TTISettings.FCIMeasurementSettings&&this._settings.TTISettings.FCIMeasurementSettings.disabled):this._TTIPolyfillEnabled()},e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()},e.prototype.getReadableDataState=function(e){for(var t in A)if(e===Number(A[t]))return t;return"NaN"},e.prototype.writeControlDataToRUMOne=function(){if(this._controls&&this._controls.length){var e=this._controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++)this._logRUMOneData("Control".concat(t+1,"Id"),e[t].controlId),this._logRUMOneData("Control".concat(t+1,"RenderTime"),e[t].data.renderTime);var n={};this._controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}}),Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}},e.prototype.processControlRenderTime=function(){for(var e=0,t=this._controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(n.data))}},e.prototype.readyToComputeEUPL=function(){for(var e=this._controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,a=e;n<a.length;n++){var i=a[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t},e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this._controls;t<n.length;t++){var a=n[t];!a.ignoreForEUPL&&a.data&&a.data.renderTime&&e<a.data.renderTime&&(e=a.data.renderTime)}this._rumoneData.EUPL=e,"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}},e.prototype.setBrowserInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile},e.prototype._collectMemoryData=function(){this.isCollected("UsedJSHeapSize")||"undefined"==typeof performance||void 0===performance.memory||(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize)},e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})},e.prototype.setAPIDataToRUMOne=function(){var e=this._apiTracker.getData();this._rumoneData.APICallCount=e.count,this._rumoneData.APICallDurationSum=e.duration,this._rumoneData.APICalls=e.calls},e.prototype.setReferrer=function(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)},e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,a=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:a});this._rumoneData.AppInfo=i}}},e.prototype._writeBreakdown=function(e,t,n){if(t)try{var a=JSON.parse(t);for(var i in a)a.hasOwnProperty(i)&&this._addBreakdown(e,i,a[i],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}},e.prototype._addBreakdown=function(e,t,n,a){if(t&&!U(n)){if(U(e[t])||a){var i=this._isBreakdownValue(n)?n.data:n;e[t]=null!=i?i:void 0}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||a)&&this._logRUMOneData(t,n.data)}},e.prototype._readBreakdown=function(e,t){return t?e[t]:e},e.prototype._processEUIIUrl=function(e){var t=new v.a(e||"");return"".concat(t.authority,"/{ length: ").concat(t.path.length,", segments: ").concat(t.segments.length," }")},e.prototype._processLastNetworkUrl=function(e){var t=new v.a(e||"");if(t.authority.indexOf("lpcres")>0)return e;if(t.authority.indexOf("shell.cdn.office")>0)return e;var n=T.exec(e),a="";return n&&n.length>0&&(a="".concat(n[0])),"".concat(t.authority).concat(a)},e._loggers={},e._markers={},e}();function R(e){for(var t=0,n=0,a=e;n<a.length;n++){var i=a[n];i>0&&(0===t||i<t)&&(t=i)}return t}}
,function(e,t,n){function a(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return Ze}});var a=n(0),i=n(1),r=n(4);(0,r.b)([{rawString:".od-Share-LivePeoplePicker{max-height:150px;min-height:32px;overflow-y:auto}.od-Share-LivePeoplePicker-lpp{display:grid;display:-ms-grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;row-gap:0;-ms-grid-columns:1fr auto;-ms-grid-rows:auto auto;-ms-row-gap:0}.od-Share-LivePeoplePicker-Adapter{grid-row:1;grid-column:1;-ms-grid-row:1;-ms-grid-column:1}.od-Share-LivePeoplePicker-RoleSelector{grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;align-self:end;-ms-grid-row-align:end}.od-Share-LivePeoplePicker-ErrorWarnings-wrapper{grid-row:2;grid-column:1;-ms-grid-row:2;-ms-grid-column:1}"}]);var o,s,c=n(72),d=n(110),l=n(173),u=n(115),f=n(12),p=n(39),m=n(220),_=!1,h=i.forwardRef(function(e,t){var a=(0,i.useState)(null),r=a[0],o=a[1];(0,i.useEffect)(function(){r||n.e(28).then(n.t.bind(n,603,23)).then(function(t){_||(t.initializeLivePersonaPicker(e.userPrincipalName,e.options),_=!0),o({LivePersonaPicker:t.getLivePersonaPickerWithRichTextInput(e.userPrincipalName),PersonaPillList:t.PersonaPillList})})},[r]);var s=(0,i.useState)(null),c=s[0],d=s[1],l=(0,i.useState)(!1),u=l[0],f=l[1];if((0,i.useEffect)(function(){u&&c&&(c.focus(),f(!1))},[c,u]),(0,i.useImperativeHandle)(t,function(){return{focus:function(){f(!0)},getCurrentText:function(){return c.getCurrentText()}}}),!r)return e.fallback||null;var p=r.LivePersonaPicker,m=r.PersonaPillList;return i.createElement("div",{className:e.className},i.createElement(m,{personaItems:e.selectedPersonas,onRemoveItem:e.onRemovePersona}),e.entryDisabled||i.createElement(p,{componentRef:function(e){d(e)},strings:e.strings,maxHeight:200,maxWidth:300,onSuggestionSelected:e.onSuggestionSelected,selectedSuggestions:e.selectedPersonas}))}),b=n(42),g=n(80),v=n(20),y=n(11),S=n(61);!function(e){e.Person="Person",e.Group="Group"}(o||(o={})),function(e){e.OrganizationUser="OrganizationUser",e.LinkedIn="LinkedIn",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList"}(s||(s={}));var D=function(e){function t(t,n){var r=e.call(this,t)||this;r._lppAdapterRef=(0,i.createRef)(),r._wrapperDivRef=(0,i.createRef)(),r._getHostAppSuggestions=function(e){return(0,a.b)(r,void 0,void 0,function(){var t,n;return(0,a.e)(this,function(a){switch(a.label){case 0:return t=this.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0},[4,this._peoplePickerProvider.sharePointSearch(e,n)];case 1:return[2,a.sent().map(function(e){return{Id:e.userId,Name:e.name,UserPrincipalName:e.rawPersonData.userPrincipalName||e.email,SuggestionType:e.name,SuggestionSubtype:e.name,EmailAddresses:[e.email||""],HostAppSuggestion:e}})]}})})},r._onSelectedPersonasChanged=function(){var e=r.state.selectedPersonas.map(function(e){return r._personaPillListItemToIPerson(e)});r.props.onChange(e)},r._onRemovePersona=function(e){r.setState(function(t,n){var i=r.state.selectedPersonas.filter(function(t){return t.Id!==e.Id});return(0,a.a)((0,a.a)({},t),{selectedPersonas:i})},r._onSelectedPersonasChanged)},r._onSuggestionSelected=function(e){var t=(0,a.a)((0,a.a)({},e),{validationState:"Pending"});r.setState(function(e){return(0,a.a)((0,a.a)({},e),{selectedPersonas:(0,a.g)((0,a.g)([],e.selectedPersonas,!0),[t],!1)})}),r._validateSuggestion(e).then(function(e){return r._onPersonaValidated(e)})},r._onKeyDown=function(e){"Backspace"===e.key&&r._lppAdapterRef.current&&""===r._lppAdapterRef.current.getCurrentText()&&r.setState(function(e,t){return(0,a.a)((0,a.a)({},e),{selectedPersonas:e.selectedPersonas.slice(0,-1)})},r._onSelectedPersonasChanged)},r._validateSuggestion=function(e){return(0,a.b)(r,void 0,void 0,function(){var t,n,i;return(0,a.e)(this,function(r){switch(r.label){case 0:return e.SuggestionSubtype===s.OrganizationUser?[2,(0,a.a)((0,a.a)({},e),{validationState:"Valid"})]:(t=this.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0},[4,this._peoplePickerProvider.resolve(e.UserPrincipalName,n).then(function(e){return!e.email&&e.rawData&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails),!e.name&&e.rawData&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails),e})]);case 1:return i=r.sent(),e.HostAppSuggestion=i,[2,(0,a.a)((0,a.a)({},e),{validationState:this._shouldShowErrorOnItem(i)?"Error":"Valid"})]}})})},r._peoplePickerProvider=n.peoplePickerProvider,r._resize=n.resize,r._platformDetection=n.platformDetection,r._hasTakenErrorFocus=!1,r._peoplePickerProvider=n.peoplePickerProvider;var c=t.defaultSelectedItems.map(function(e){return{Id:e.email,Name:e.name,UserPrincipalName:e.principalName,EmailAddresses:[e.email],SuggestionType:o.Person,SuggestionSubtype:s.OrganizationUser,HostAppSuggestion:e,Source:"HostApp",validationState:"Valid",SuggestionSource:"HostApp",SuggestionOrigin:"ZeroTerm"}});return r.state={selectedPersonas:c},r._livePeoplePickerHelper=r._peoplePickerProvider._dataSource.getLivePersonaPickerHelper(),r._resizeTracker=new S.a(n.resize),r}return(0,a.d)(t,e),t.prototype.render=function(){var e={emptyResults:y.tf,loading:y.ge,error:y.c,allResults:y.a,limitedResults:y.b,suggestionsCalloutAccessibilityOnShow:y.Sd,useThisAddress:y.d,pickerModePlaceholderText:this._computePlaceholderText()};if(!this.props.pickerSettings||0===Object.keys(this.props.pickerSettings).length)return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp"});var t=(0,a.a)((0,a.a)({},this._livePeoplePickerHelper.getLppOptions()),{getHostAppSuggestions:this._getHostAppSuggestions}),n=this._livePeoplePickerHelper.getUserPrincipalName(),r=this.props.roleSelectorProps.roleSelectorAs;return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp",ref:this._wrapperDivRef,onKeyDown:this._onKeyDown},i.createElement(h,{className:"od-Share-LivePeoplePicker-Adapter",ref:this._lppAdapterRef,userPrincipalName:n,options:t,strings:e,entryDisabled:!1,selectedPersonas:this.state.selectedPersonas,onSuggestionSelected:this._onSuggestionSelected,onRemovePersona:this._onRemovePersona,fallback:i.createElement(b.a,{size:g.a.small})}),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-LivePeoplePicker-RoleSelector"},i.createElement(r,(0,a.a)({},this.props.roleSelectorProps))),i.createElement("div",{className:"od-Share-LivePeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))},t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isValidateInProgress())return v.f(this.props.clientId)||this._hasTakenErrorFocus||(this._focusInput(),this._hasTakenErrorFocus=!0),i.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)},t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error)return this.state.selectedPersonas.length>=this.props.selectionLimit&&n.push(i.createElement(u.a,{key:"peoplePickerLimitMessage",ariaLabel:y.xg},y.xg)),e&&n.push(i.createElement(u.a,{key:"oversharingExternalsWarning",ariaLabel:e},e)),t&&n.push(i.createElement(u.a,{key:"oversharingGroupsWarning",ariaLabel:t},t)),n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0},t.prototype.componentDidUpdate=function(e,t){this._resizeTracker?this._resizeTracker.checkSizeChangeForRef(this._wrapperDivRef):null!==this.props.error&&null===e.error&&this._resize();var n=t.selectedPersonas.length>=this.props.selectionLimit&&this.state.selectedPersonas.length<this.props.selectionLimit;this._hasInitialFocus&&!n||this._focusInput()},t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;v.f(this.props.clientId)||e||this._focusInput()},t.prototype._focusInput=function(){this._lppAdapterRef.current&&(this._lppAdapterRef.current.focus(),this._hasInitialFocus=!0)},t.prototype._shouldShowErrorOnItem=function(e){var t=this._computeAllowExternalUsers(this.props.sharingLinkKind,this.props.sharingInformation.canAddExternalPrincipal),n=this.props.permissionsMap;return e.isExternal&&!t||this.props.sharingLinkKind===p.a.direct&&n&&(n[e.email]===m.a.none||n[e.userId]===m.a.none)||!e.isResolved&&!e.isResolving},t.prototype._computeAllowExternalUsers=function(e,t){var n=e===p.a.organizationView,a=e===p.a.organizationEdit;return!(n||a)&&t},t.prototype._onPersonaValidated=function(e){this.setState(function(t,n){var i=t.selectedPersonas.filter(function(t){return t.Id!==e.Id});return i.push(e),(0,a.a)((0,a.a)({},t),{selectedPersonas:i})},this._onSelectedPersonasChanged)},t.prototype._convertPrincipalType=function(e){if(!e)return c.a.none;for(var t=c.a.none,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i&&(t|=c.a.user),"DL"===i&&(t|=c.a.distributionList),"SecGroup"===i&&(t|=c.a.securityGroup),"SPGroup"===i&&(t|=c.a.sharePointGroup)}return t},t.prototype._lppSuggestionToIPerson=function(e){if(e.HostAppSuggestion&&e.HostAppSuggestion.hasOwnProperty("userId"))return e.HostAppSuggestion;var t=e.EmailAddresses[0],n=e.UserPrincipalName&&l.a.isValidEmailSyntax(e.UserPrincipalName,!1)?e.UserPrincipalName:t,a={Key:n,IsResolved:!1},i=e.SuggestionSubtype===s.OrganizationUser,r=e.SuggestionSubtype===s.LinkedIn,u=e.SuggestionType===o.Group&&e.SuggestionSubtype===s.UnifiedGroup,f=e.SuggestionSubtype===s.PublicDistributionList,p={rawData:a,rawPersonData:a,userId:n,name:e.Name,email:t,isExternal:!i,isResolved:!0};return i?(p.entityType=d.a.regularUser,p.principalType=c.a.user):u?(p.entityType=d.a.group,p.principalType=c.a.securityGroup):r?p.entityType=d.a.linkedinUser:(p.principalType=f?c.a.distributionList:c.a.none,p.entityType=e.SuggestionType===o.Group?d.a.group:d.a.externalUser,p.providerName=void 0),p},t.prototype._personaPillListItemToIPerson=function(e){return(0,a.a)((0,a.a)({},this._lppSuggestionToIPerson(e)),{isResolved:"Pending"!==e.validationState})},t.prototype._isValidateInProgress=function(){for(var e=0,t=this.state.selectedPersonas;e<t.length;e++)if("Pending"===t[e].validationState)return!0;return!1},t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?y.Ag:y.Eg},t.contextTypes={peoplePickerProvider:f.object.isRequired,resize:f.func.isRequired,platformDetection:f.object.isRequired},t}(i.Component);(0,r.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerContainer{display:flex;flex-direction:row;flex-wrap:nowrap}.od-Share-PeoplePickerContainer.space-between{justify-content:space-between}.od-Share-PeoplePickerContainer.normal{justify-content:normal}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-ErrorWarnings-wrapper,.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper{max-width:calc(100% - (1.75rem + 34px));width:100%;flex-grow:1}.od-Share-PeoplePicker-flexGrow{flex-grow:1;height:100%}.od-Share-PeoplePicker-PeoplePickerIcon{font-size:1.5rem;padding-top:10px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker-PeoplePickerIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker-PeoplePickerIcon{padding-right:12px}#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-RoleSelector{align-self:flex-end;grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-grid-row-align:end}[dir=ltr] .od-Share-PeoplePicker.withIcon{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker.withIcon{padding-right:12px}.od-Share-PeoplePicker .ms-Callout{width:100%}.od-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:block}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:.75rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{font:-apple-system-body}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-body}}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem;font:-apple-system-caption1}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body;white-space:nowrap}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:auto}.od-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker{height:100%;padding:12px 6px 12px 0}.od-Simplified-Share-PeoplePicker.smaller-padding{padding:10px 5px 10px 3px}.od-Simplified-Share-PeoplePicker .ms-Callout{width:100%}.od-Simplified-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Simplified-Share-PeoplePicker.inline .ms-Callout-container{position:static}.od-Simplified-Share-PeoplePicker .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%}.od-Simplified-Share-PeoplePicker.isIE.initial-padding{padding-bottom:4px}.od-Simplified-Share-PeoplePicker.isIE .ms-BasePicker-text{min-height:unset;border:none;padding:0;display:block;height:100%;max-width:320px}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%;height:100%;padding:0}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-BasePicker-input{font:-apple-system-body}}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Simplified-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input:-ms-input-placeholder{font:-apple-system-body;white-space:break-spaces}.od-Simplified-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-body;white-space:break-spaces}}@keyframes fadein{0%{opacity:0}100%{opacity:1}}@keyframes fadeout{0%{opacity:1}100%{opacity:0}}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.875rem}.od-Simplified-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem;font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px;height:0;overflow:hidden;opacity:0;align-items:center}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{white-space:nowrap;font:-apple-system-body}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Simplified-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content:focus::after{border-radius:16px;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:";outline-color:transparent;outline:0!important}@media screen and (-ms-high-contrast:active){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content:focus::after{border-radius:16px;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:";outline-color:transparent;outline:0!important}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Simplified-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Simplified-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Simplified-Share-PeoplePicker .ms-SelectionZone{height:100%}@media screen and (min-width:400px){.ms-Suggestions,.ms-Suggestions-none{width:370px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE{width:448px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-none{width:448px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE{width:432px!important}@media screen and (min-width:400px){.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions,.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-none{width:432px!important}.od-Share-PeoplePicker-Suggestions-Simplified-Share.isNotIE .ms-Suggestions-container{max-height:135px!important}}.od-Share-PeoplePicker-Suggestions-Simplified-Share.inline .ms-Suggestions-spinner{position:static}.od-Share-PeoplePicker-Suggestions-Simplified-Share button.ms-SearchMore-button.is-selected{border:1px solid "},{theme:"black",defaultValue:"#000"},{rawString:"}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Persona-primaryText,.od-Share-PeoplePicker-Suggestions-Simplified-Share .ms-Persona-secondaryText{font:-apple-system-body}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px;width:100%}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container button.ms-Suggestions-itemButton{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container div.ms-PeoplePicker-personaContent{font:-apple-system-headline;height:auto}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button{font-size:.75rem;height:2.5rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button i.ms-Button-icon{font-size:1rem;width:1.5625rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button span.ms-Button-label{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font-size:.75rem;line-height:1.875rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner{line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-circle{width:1.25rem;height:1.25rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-error{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir=ltr] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir=rtl] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-selectedItem--warning .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";background-color:RGBA("},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button.is-suggested .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button:hover .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona:hover,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-item:hover{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Persona-secondaryText{color:inherit}}@media (forced-colors:active) and (prefers-color-scheme:dark){:-ms-input-placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){:-ms-input-placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}}.od-RoleSelectorCompact-permissionButton:focus{outline:1px solid}.od-Share-PeoplePicker-selectedItem--error{display:flex}.od-Share-PeoplePicker-height{height:auto}"}]);var I=n(56),x=n(43),C=n(78),O=n(28),w=n(5),E=n(27),A=n(10),L=n(21),k=n(7);(0,r.b)([{rawString:"@media screen and (-ms-high-contrast:active){.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:flex;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_d5c49a3e{flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.itemContent_d5c49a3e>.fui-Persona{vertical-align:bottom}.peoplePickerPill_d5c49a3e{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:inline-flex;align-items:center;margin:4px}.peoplePickerClose_d5c49a3e{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .peoplePickerClose_d5c49a3e{padding-left:4px}html[dir=rtl] .peoplePickerClose_d5c49a3e{padding-right:4px}.peoplePickerClose_d5c49a3e:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}.placeholderUser_d5c49a3e{background-color:unset;outline:1px dashed;outline-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.personDisplayName_d5c49a3e{white-space:nowrap}html[dir=ltr] .personDisplayName_d5c49a3e{padding-left:8px}html[dir=rtl] .personDisplayName_d5c49a3e{padding-right:8px}"}]);const M="itemContent_d5c49a3e",P="placeholderUser_d5c49a3e";var T,U,F=n(522),H=n(46),R=n(205),N=n(3),B=n(2);function j(e){var t,n;return!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}(U=T||(T={}))[U.standalone=0]="standalone",U[U.pill=1]="pill";var V=n(47),z=H.a.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||N.a.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated");function G(e,t,n){var a="3rem";if(t)switch(t){case x.c.size24:a="1.5rem";break;case x.c.size32:a="2rem";break;case x.c.size40:a="2.5rem";break;case x.c.extraSmall:a="1.75rem";break;default:a="3rem"}var r={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:a,height:a,maxWidth:"75px",maxHeight:"75px",flexShrink:0},image:{width:a+"!important",height:a+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:a,height:a,maxWidth:"75px",maxHeight:"75px"},initials:{width:a,height:a,fontSize:"0.625rem",lineHeight:a}}},styles:{root:{height:"auto"},primaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.875rem"},secondaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.75rem"}}};return j(e)&&void 0!==n?(0,R.default)(r,function(e,t){void 0===t&&(t={});var n=(0,B.E)(),a=t.fontSize;return{coinProps:{styles:{initials:e===T.standalone?{border:"1px dashed ".concat(n.palette.themePrimary),boxSizing:"border-box",fontSize:null!=a?a:"16px",fontWeight:"normal",color:n.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:null!=a?a:"12px",color:n.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:x.a.transparent,onRenderInitials:function(){return i.createElement(A.a,{iconName:"Contact",style:{fontWeight:"normal"}})}}}(n)):r}var K=function(e){return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(C.a,(0,a.a)({},e.personaProps,{presence:x.b.none,size:x.c.size40,className:"ms-PeoplePicker-pickerPersona"})),e.person.entityType===d.a.linkedinUser&&i.createElement(A.a,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},W=function(e){var t,n=e.item,r=e.onRemoveItem,o=e.index,s=e.selected,c=e.removeButtonAriaLabel,d=G(n,x.c.extraSmall,T.pill);return z||(d.onRenderPrimaryText=function(){return i.createElement(O.a,{content:n.email||d.text,directionalHint:w.a.topLeftEdge},d.text)}),i.createElement("div",{className:(0,L.a)("ms-PickerPersona-container",(t={"is-selected":!!s},t[P]=j(n),t)),"data-is-focusable":!0,"data-selection-index":o,key:o,role:"listitem"},i.createElement("div",{className:(0,L.a)("ms-PickerItem-content",M)},i.createElement(C.a,(0,a.a)({},d,{presence:x.b.none,size:x.c.extraSmall}))),i.createElement(E.a,{styles:{root:{flexShrink:0}},onClick:r,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=c?c:k.j(F.b,n.name),disabled:e.disabled}))},q=function(e){var t=e.item,n=e.onRemoveItem,r=e.index,o=e.selected,s=G(t,x.c.size40),c="PickerPersonaId"+Math.floor(1e4*Math.random()),d=k.j(F.b,t.name);return i.createElement("div",{className:(0,L.a)("ms-PickerPersona-container is-listbelow",{"is-selected":!!o}),"data-is-focusable":!0,"data-selection-index":r,key:r,"aria-labelledby":c,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(C.a,(0,a.a)({id:c},s,{presence:x.b.none,size:x.c.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(E.a,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":d})))},Q=function(e){var t,n=e.item,r=e.onRemoveItem,o=e.index,s=e.selected,c=e.removeButtonAriaLabel,d=G(n,x.c.extraSmall,T.pill),l=i.useRef(null),u=i.useRef(null);i.useEffect(function(){l.current&&u.current&&(l.current.style.animation="fadein 200ms",l.current.style.transition="height 200ms cubic-bezier(0.33,0.00,0.10,1.00)",l.current.style.height="".concat(u.current.scrollHeight,"px"),l.current.style.opacity="1")},[]);var f=n.email&&n.email!==d.text;return z||(d.onRenderPrimaryText=function(){return i.createElement(O.a,{content:i.createElement("div",null,i.createElement("div",null,d.text&&d.text),f&&i.createElement("div",null,n.email)),directionalHint:w.a.topLeftEdge},d.text)}),i.createElement("div",{className:(0,L.a)("ms-PickerPersona-container",(t={"is-selected":!!s},t[P]=j(n),t)),"data-is-focusable":!0,key:o,role:"listitem",ref:l},i.createElement("div",{ref:u,className:(0,L.a)("ms-PickerItem-content",M)},i.createElement(C.a,(0,a.a)({},d,{presence:x.b.none,size:x.c.extraSmall}))),i.createElement(E.a,{styles:{root:{flexShrink:0}},onClick:r,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=c?c:k.j(F.b,n.name),disabled:e.disabled}))},Y=n(525),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){t.props.inputProps&&t.props.inputProps.onClick&&t.props.inputProps.onClick(e),0!==e.button||e&&e.target&&e.target.value||t.onEmptyInputFocus()},t.onInputFocus=function(e){var n,a;N.b.isActivated("543f1508-f671-478a-9d8e-f38cf68393fd","04/19/2023","Respect the onEmptyResolveSuggestions prop passed to PeoplePicker")||t.props.showDefaultSuggestionOnlyByClick||e&&e.target&&e.target.value||!t.props.onEmptyResolveSuggestions||t.onEmptyInputFocus(),X()||null===(a=null===(n=t.props.inputProps)||void 0===n?void 0:n.onFocus)||void 0===a||a.call(n,e)},t}return(0,a.d)(t,e),t}(Y.b);function X(){return N.b.isActivated("f7dc3d8b-8019-4187-9e11-6dcb2597352b")}var Z=n(14),$=n(531),ee=n(38),te=n(83),ne=n(537),ae=n(535),ie=n(528),re=n(530),oe=n(534),se=n(355),ce=n(156),de=n(18),le=n(536),ue=!N.b.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!ee.c.isFeatureEnabled({ECS:1026572}),fe=!N.b.isActivated("29b79ab1-ae17-42fd-b4e1-39e58a904f55","04/02/2023","enable IB discovery"),pe=!N.b.isActivated("9a20d40f-32c7-4d46-b7e5-ab292ac5809f"),me=!N.b.isActivated("5e644b83-32fa-4e2f-9e2f-4369ae93cf72","05/13/2024","add endpoints for substrate in airgap")&&!ee.c.isFeatureEnabled({ECS:1261410}),_e=function(e){function t(t,n){var a=this,i=he(t)?t:n.pageContext,r=!!(null==n?void 0:n.noRedirect),o=null==n?void 0:n.tokenProvider;(a=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i,noRedirect:r,tokenProvider:o})||this)._isSubstrateAPIWarm=!1;var s=he(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=s||new ie.a({},{itemUrlHelper:new re.a({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return(0,a.d)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return Z.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},a=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(a.Primary),managerChain:a.ManagerChain.results.map(n),directReports:a.DirectReports.results.map(n)};return i.personDetails.profilePage=(0,$.b)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===c.a.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return Z.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return Z.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var i=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,additionalHeaders:i,parseResponse:function(e){var a=JSON.parse(e),i=JSON.parse(a.d.ClientPeoplePickerResolveUser),r=[];r[0]=i,i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||r&&!r[0].DisplayText&&(r[0].DisplayText=i.Key);var o=(r=n._transformData(r,t.filterExternalUsers))[0];return t.filterExternalUsers&&o&&o.entityType===d.a.externalUser?(o.isResolved=!1,o.entityType=d.a.regularUser):t.blockViaPolicy&&!t.filterExternalUsers&&o&&!o.isResolved&&0===o.multipleMatches.length&&(o.isResolved=!0,o.isExternal=!0,o.entityType=d.a.externalUser),t.isGraphDistributionList&&t.useGraph&&o.isExternal&&(o.entityType=d.a.group,o.principalType=c.a.distributionList),o}})})},t.prototype.canUseGraph=function(e){var t,n=e&&e.useGraph&&(null===(t=this._graphPeoplePickerHelper)||void 0===t?void 0:t.canUseGraph());return n&&!this._dataRequestor&&(this._dataRequestor=new se.a({},{})),!!n},t.prototype.canUseSubstrate=function(e){var t,n=e.useSubstrate&&(null===(t=this._substratePeoplePickerHelper)||void 0===t?void 0:t.canUseSubstrate());return n&&!this._dataRequestor&&(this._dataRequestor=new se.a({},{})),!!n},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.init=function(e){var t;this.canUseSubstrate(e)&&!this._isSubstrateAPIWarm&&(null===(t=this._substratePeoplePickerHelper)||void 0===t||t.warmUpInit(e.scenarioName),this._isSubstrateAPIWarm=!0)},t.prototype.search=function(e,t){return fe&&t.enforceIBSegmentFiltering?this.sharePointSearch(e,t):this.canUseSubstrate(t)||t.useNew3Ssearch?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):(0===t.groupID&&(t.useSubstrateSearch=!0),this.sharePointSearch(e,t))},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),Z.c.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var i=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:i,authToken:a,parseResponse:function(a){var i=t.allowSharePointGroups,r=void 0===i||i,o=t.filterExternalUsers,s=JSON.parse(a),l=JSON.parse(s.d.ClientPeoplePickerSearchUser),u=n._transformData(l,o);return o&&(u=u.filter(function(e){return e.entityType!==d.a.externalUser})),u=u.filter(function(e){return e.principalType===c.a.sharePointGroup?r:e.principalType===c.a.securityGroup?r||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),n._handleZeroSearchResult(u,e,t,d.b.sharepointSearch)}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){default:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!this._skypeIntegration){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){var r;if(!i)return a.sharePointSearch(e,n);var o=ue&&a._pageContext&&a._pageContext.msGraphEndpointUrl?null===(r=a._pageContext)||void 0===r?void 0:r.msGraphEndpointUrl:"https://graph.microsoft.com",s=new V.a("".concat(o,"/v1.0/me/people"));if(e)if(s.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),N.b.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&s.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var l=t._getPersonTypeFilter(n);l&&s.setQueryParameter("$filter",l)}var u=new de.a({name:"PeoplePickerGraphSearch"});return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:s.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),t&&t.value&&0!==t.value.length)u.end({resultType:de.b.Success});else if(u.end({resultType:de.b.ExpectedFailure,extraData:{error:"graph search return empty results"}}),e)return a.sharePointSearch(e,n);var i=t.value,r=[];return i.forEach(function(e){if(!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t,i=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",o=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:i;t=be()?{Key:o,IsResolved:!1}:{Key:o,IsResolved:!1,EntityData:{ObjectId:e.id}};var s,l="ImplicitContact"===e.personType.subclass,u="OrganizationUser"===e.personType.subclass,f="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,p="PublicDistributionList"===e.personType.subclass,m=(0,oe.b)(a._webAbsoluteUrl,i);p&&(s=d.c.PublicDistributionList),f&&(s=d.c.unified);var _={department:e.department,email:i,image:l?void 0:m,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||i,name:e.displayName,providerName:u?"Provider":void 0,userId:o,rawData:t,rawPersonData:t,isExternal:!u,aadObjectId:e.id,fromDataSource:d.b.graph,detailedGroupInfo:s};u?(_.entityType=d.a.regularUser,_.principalType=c.a.user,_.isResolved=!0):f?(_.entityType=d.a.group,_.principalType=c.a.securityGroup,_.isResolved=!1,_.userId=e.id):(_.principalType=p?c.a.distributionList:c.a.none,_.entityType="Group"===e.personType.class?d.a.group:d.a.externalUser,_.isResolved=!1,_.providerName=void 0),_.userId&&r.push(_)}}),a._handleZeroSearchResult(r,e,n,d.b.graph)},function(t){var i=(0,ce.e)(t)&&429===t.status||"Canceled"===t.name;if(u.end({resultType:i?de.b.ExpectedFailure:de.b.Failure,extraData:{error:t}}),(0,ce.e)(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(i){if(!i)return n.sharePointSearch(e,t);var r=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(r=t.siteIBSegmentIDs);var o,s=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],l={Authorization:"Bearer "+i},u=t.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"];pe&&t.subTypesToBeFiltered&&t.subTypesToBeFiltered.length>0&&(u=t.subTypesToBeFiltered),t.allowSharePointGroups&&u.push("UniversalSecurityGroup");var f=te.a.isValidGuid(e),p={Or:u.map(function(e){return{Term:{PeopleSubtype:e}}})},m=r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,_=f?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,h=r||f?f?r?{And:[p,m,_]}:{And:[p,_]}:{And:[p,m]}:p;o=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:s,Query:{QueryString:f?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype","Phones"],InformationBarrierMode:t.siteIBMode,Filter:h}],TimeZone:"UTC",Cvid:t.conversationId||(N.b.isActivated("C97249F5-534D-47D5-8545-C79E9ADE0396")?void 0:te.a.generate()),Scenario:{Name:t.scenarioName||"documentshare"}});var b=t.scenarioName?"?scenario=".concat(t.scenarioName):"",g=new de.a({name:"PeoplePickerSubstrateSearch"}),v=new de.a({name:"PeoplePickerAirGapEndpointAvailable"}),y=ae.a;if(me&&(0,le.a)(n._pageContext.env2)){var S=n._pageContext.farmSettings;S&&S.ExternalService_exchangesearchurl?(y=S.ExternalService_exchangesearchurl,v.end({resultType:de.b.Success})):v.end({resultType:de.b.Failure,extraData:{error:"airgap endpoint not available, falling back to default substrate endpoint which doesn not work when user input less than 3 letters"}})}return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:y+"/api/v1/suggestions".concat(b),headers:l,needsAuthorization:!1,requestType:"POST",postData:o}).then(function(i){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var r=i.Groups[0]?i.Groups[0].Suggestions:[];if(0===r.length){if(g.end({resultType:de.b.Failure,extraData:{error:"substrate search return empty results"}}),e)return n.sharePointSearch(e,t)}else g.end({resultType:de.b.Success});var o=[];return r.forEach(function(e){var i,r;if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var s,l,u=e.EmailAddresses[0]||e.QueryText||"",f=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:u;e.Id&&e.Id.indexOf("@")&&(s=e.Id.substring(0,e.Id.indexOf("@"))),t.useNew3Ssearch&&!f&&e.Id&&e.Id.indexOf("@")&&(f=e.Id.substring(0,e.Id.indexOf("@"))),l=be()?{Key:f,IsResolved:!1}:{Key:f,IsResolved:!1,EntityData:{ObjectId:s}};var p,m="ImplicitContact"===e.PeopleSubtype,_="OrganizationUser"===e.PeopleSubtype,h="LinkedIn"===e.PeopleSubtype,b="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,g="PublicDistributionList"===e.PeopleSubtype,v=(0,oe.b)(n._webAbsoluteUrl,u);g&&(p=d.c.PublicDistributionList),b&&(p=d.c.unified);var y=(0,a.a)({department:e.Department,office:e.OfficeLocation,email:u,image:m?void 0:v,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||u,name:e.DisplayName,providerName:"Provider",userId:f,rawData:l,rawPersonData:l,isExternal:!_,detailedGroupInfo:p},pe?{phones:null!==(r=null===(i=e.Phones)||void 0===i?void 0:i.map(function(e){return{type:e.Type,number:e.Number}}))&&void 0!==r?r:void 0}:{});_?(y.entityType=d.a.regularUser,y.principalType=c.a.user,y.isResolved=!0):b?(y.entityType=d.a.group,y.principalType=c.a.securityGroup,y.isResolved=!1,y.providerName=void 0):h?y.entityType=d.a.linkedinUser:(y.principalType=g?c.a.distributionList:c.a.none,y.entityType="Group"===e.PeopleType?d.a.group:d.a.externalUser,y.isResolved=!1,y.providerName=void 0),y.userId&&o.push(y)}}),n._handleZeroSearchResult(o,e,t,d.b.substrate)},function(a){var r=void 0;try{r=JSON.parse(atob(i.split(".")[1])).exp<Date.now()/1e3}catch(e){}var o=void 0;if(a&&(0,ce.e)(a)&&a.status&&(o=a.status),g.end({resultType:de.b.Failure,resultCode:o?o.toString():"unknown",extraData:{error:a,tokenExpired:r}}),(0,ce.e)(a))switch(a.status){case 400:case 401:case 403:case 404:return n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==a.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t));return null})})},t.prototype._handleZeroSearchResult=function(e,t,n,a){if(!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var i={Key:t,IsResolved:!1};e.push({email:t,entityType:d.a.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:i,rawPersonData:i,isExternal:!0,fromDataSource:a})}return e},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&l.a.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){var t="";return e.principalType&c.a.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),e.principalType&c.a.securityGroup&&(t&&(t+=" or "),t+="personType/subclass eq 'UnifiedGroup'"),e.principalType&c.a.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!N.b.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")&&(t&&(t+=" or "),t+="personType/subclass eq 'PublicDistributionList'"),t},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,i={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};i.multipleMatches.length>0&&(i.multipleMatches=n._transformData(i.multipleMatches,t),t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return e.entityType!==d.a.externalUser})));var r=i.email;i.isResolved&&(i.image=r?(0,oe.b)(n._webAbsoluteUrl,r):null);var o=a.PrincipalType||e.EntityType;switch(o){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=d.a.externalUser,i.principalType=c.a.user,i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!N.b.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==o){i.entityType=d.a.group,i.principalType="SharePointGroup"===o?c.a.sharePointGroup:c.a.securityGroup,i.detailedGroupInfo="SharePointGroup"===o?d.c.SPGroup:d.c.securityGroup;break}default:i.entityType=d.a.regularUser,i.principalType=c.a.user}return i})},t}(ne.b);function he(e){return!!e.webAbsoluteUrl}function be(){return N.b.isActivated("3ca1ecbf-ea9f-45eb-bd26-5dfb3924d136","12/4/23","add objectId to rawData")||ee.c.isFeatureEnabled({ECS:1173676})}var ge,ve=n(91),ye=n(92),Se=n(358),De=function(e){function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;if(n._MaxItems=200,n._Version=5,n._buffer=n.getValue(t._StorageKey),n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer(),n._data={},Date.now()<n._buffer.lastCachePrune+6048e5)for(var a=0;a<n._buffer.dataArray.length;a++){var i=n._buffer.dataArray[a],r=n._getItemKey(i);n._data[r]=i}else n.initializeBuffer(),n.setValue(t._StorageKey,n._buffer);return n}return(0,a.d)(t,e),t.clear=function(){new ve.a(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var n=this._getItemKey(e),a=this._data[n];if(a){if(t.isCacheEntryFresh(a,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index],o=this._getItemKey(r);delete this._data[o],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[n]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var n=[],a=0;a<this._buffer.dataArray.length;a++){var i=(this._buffer.index-a+this._MaxItems)%this._MaxItems,r=this._buffer.dataArray[i];!(r.email&&r.email.toLowerCase().indexOf(e.toLowerCase())>=0||r.name&&r.name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&r.entityType===d.a.externalUser||n.push(r)}return n},t.prototype.containsItem=function(e){var t=this._getItemKey(e);return Boolean(this._data[t])},t.prototype.initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()},t.prototype._getItemKey=function(e){return e.email||e.userId||(0,Se.a)(JSON.stringify(e)).toString()},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=ye.a.local,t}(ve.a),Ie=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new _e({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new De,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,a,i=this,r={cached:null,promise:null};return this._mruCache&&!t.groupID&&(a=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(r.cached=a),r.promise=new Z.c(function(r,o){n=i._dataSource.search(e,t).then(function(e){if(e)if(a){a.length>0&&(a=i._removeStaleCacheResults(a,e));var t=a.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()}),r},e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){return n._mruCache&&e.isResolved&&n.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)},e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()},e.prototype.searchMruCache=function(e,t){var n=[],a=this._mruCache;if(a){n=a.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n},e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),a=[];return t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var r=e[i];De.isCacheEntryFresh(r,t)&&a.push(r)}}),a},e}();!function(e){e[e.normal=0]="normal",e[e.listBelow=1]="listBelow"}(ge||(ge={})),(0,r.b)([{rawString:":global(.ms-Suggestions){width:260px}"}]);var xe=N.b.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),Ce=J,Oe=Y.a,we=function(e){function t(t){var n=e.call(this,t)||this;if(n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise&&(n._peoplePickerSearchPromise.cancel(),n._peoplePickerSearchPromise=void 0),!(e=e.trim())&&!n._canCallGraph)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._getPeoplePickerQueryParams(),a=null==t?void 0:t.conversationId;t&&t.conversationId&&delete t.conversationId;var i="peoplePickerSearch_".concat(e.trim(),"_").concat(JSON.stringify(t));t&&a&&(t.conversationId=a);var r=function(){var a=n._dataProvider.search(e.trim(),t);if(!a)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var i=a.cached?a.cached:[];return n._peoplePickerSearchPromise=a.promise,n._peoplePickerSearchPromise.then(function(e){return n._peoplePickerSearchPromise=void 0,e?i.concat(e):[]}).then(function(t){var a=xe?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(a,e):a})};if(!n.props.peoplePickerImprovementsExperiment||!n.props.persistCachePeopleSearch)return r().then(function(e){return n._callRumOneLoggerFromProps(),e});try{return n.props.persistCachePeopleSearch({getData:r,key:i}).then(function(e){var t=!isNaN(e.cacheStats.lastModified);return n._callRumOneLoggerFromProps(t),e.data})}catch(e){return r().then(function(e){return n._callRumOneLoggerFromProps(),e})}},n._callRumOneLoggerFromProps=function(e){void 0===e&&(e=!1),n.props.writeUserInputDataToRumoneLogger&&n.props.writeUserInputDataToRumoneLogger(e)},n._onGetMoreResults=function(e){var t;return n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked(),n.props.peoplePickerQueryParams&&((t=(0,a.a)({},n.props.peoplePickerQueryParams)).useGraph=!1,t.useSubstrate=!1),n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var a=n.props.onResolvedSuggestions(t,e);if(a instanceof Array)return a}return t}):[]},t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new Ie({pageContext:t.context,peoplePickerDataSource:t.dataSource})}return n._canCallGraph=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams)),n._handleGetMoreResultsInBaseClass=n._canCallGraph&&!n.props.onGetMoreResults,n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)},n}return(0,a.d)(t,e),Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.onRenderItem,o=t.onRenderSuggestionsItem,s=t.defaultSelectedItems,c=t.onSelectedPersonasChange,d=t.suggestionsHeaderText,l=t.suggestionsClassName,u=t.suggestionsItemClassName,f=t.noResultsFoundText,p=t.loadingText,m=t.inputProps,_=t.onSuggestionSelected,h=t.suggestionsAvailableAlertText,b=t.enableSelectedSuggestionAlert,g=t.selectedItems,v=t.itemLimit,y=t.onInputChange,S=t.onGetMoreResults,D=t.searchForMoreIcon,I=t.searchForMoreText,C=t.ariaLabel,O=void 0===C?"":C,w=t.pickerCalloutProps,E=t.pickerOverrideStyles,A=t.theme,L=t.disabled,k=t.onGetMoreResultsClicked,M=t.removeButtonAriaLabel,P=t.onEmptyResolveSuggestions,U=t.customizeSuggestionPersonaProps,H=t.showDefaultSuggestionOnlyByClick;this._onGetMoreResultsClicked=k;var R={className:n,onRenderSuggestionsItem:o||function(e){return function(e,t){var n,a=G(e,x.c.size40,T.standalone);if(n=a,t&&(n=t(a)),n&&n.imageUrl){var r=new V.a(n.imageUrl);r.setQueryParameter("fromPeoplePicker","true"),n.imageUrl=r.toString()}return i.createElement(K,{person:e,personaProps:n})}(e,U)},onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:s,selectedItems:g,onChange:c,inputProps:m,enableSelectedSuggestionAlert:b,pickerSuggestionsProps:{suggestionsHeaderText:d,loadingText:p,noResultsFoundText:f,className:l,suggestionsItemClassName:u,suggestionsAvailableAlertText:h,searchForMoreIcon:D,searchForMoreText:I||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:F.a},onItemSelected:_,itemLimit:v,onInputChange:y,onGetMoreResults:S||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:w,styles:E,theme:A,"aria-label":O,disabled:L,removeButtonAriaLabel:M,onEmptyResolveSuggestions:H&&this._canCallGraph?function(){return e.props.initRumone&&e.props.initRumone("",!0),e._onResolveSuggestions("")}:P,showDefaultSuggestionOnlyByClick:H};return this.props.peoplePickerType===ge.listBelow?(R.onRenderItem=r||q,i.createElement(Oe,(0,a.a)({},R,{componentRef:this._resolveRef("_peoplePicker")}))):(R.onRenderItem=r||W,i.createElement(Ce,(0,a.a)({},R,{componentRef:this._resolveRef("_peoplePicker")})))},t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()},t.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:c.a.user|c.a.securityGroup|c.a.sharePointGroup}},t.prototype._dedupeSuggestions=function(e){var t=this,n=[],i=this._peoplePicker&&this._peoplePicker.items||[];i=(0,a.g)([],i,!0);for(var r=function(e){var a=o._getItemKey(e);i.some(function(e){var n=t._getItemKey(e);return a===n})||(n.push(e),i.push(e))},o=this,s=0,c=e;s<c.length;s++)r(c[s]);return n},t.prototype._getItemKey=function(e){return e.email||e.userId||(0,Se.a)(JSON.stringify(e)).toString()},t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})},t.prototype._getSearchForMoreText=function(e){return e?F.c:void 0},t}(I.a),Ee=n(31),Ae=n(55),Le=n(73),ke=n(24),Me=n(66);(0,r.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerErrorContainer{display:flex;padding:8px 32px 8px 12px}.od-Share-PeoplePickerErrorContainer .od-Share-PeoplePickerErrorDiv{padding:0 8px;font-size:.75rem;color:#323130}.od-Simplified-Share-PeoplePickerErrorContainer{display:flex;flex-direction:row;padding:4px 0 0 4px}.od-Simplified-Share-PeoplePickerErrorIcon{padding-top:3px}.od-Simplified-Share-PeoplePickerErrorIcon{padding-right:5px;font-size:.625rem}.od-Simplified-Share-PeoplePickerErrorText{font-size:.75rem}.od-Simplified-Share-primary{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Simplified-Share-warning{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-warning i{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.od-Simplified-Share-info{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-info i{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Simplified-Share-error{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}.PeoplePickerError-moreDetails{display:flex;flex-direction:row;border:none!important;padding:0!important;font-weight:400!important;font-size:.75rem!important;background-color:transparent!important;height:auto!important;padding-top:2px!important}.PeoplePickerError-moreDetails:hover{background-color:transparent!important}.PeoplePickerError-moreDetailsText:hover{text-decoration:underline}.PeoplePickerError-icon{padding-left:5px}.PeoplePickerError-detailsContainer{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var Pe=n(17),Te=n(50),Ue=n(215);function Fe(e,t){var n=i.useState(!1),a=n[0],r=n[1],o=(0,Pe._)(t.clientId,t.sharingStore)||(0,Pe.Z)(t.clientId,t.sharingStore),s=(0,Ue.a)(function(){r(!a)});return o?i.createElement(i.Fragment,null,e.messages.map(function(t){if(t.errorDetails){var n=i.createElement("div",null,i.createElement(Te.a,{className:"PeoplePickerError-moreDetails",onClick:s},i.createElement("div",{className:"PeoplePickerError-moreDetailsText"},"More Details"),i.createElement(A.a,{className:"PeoplePickerError-icon",iconName:"ChevronDown"}))),r=i.createElement("div",null,i.createElement(Te.a,{className:"PeoplePickerError-moreDetails",onClick:s},i.createElement("div",{className:"PeoplePickerError-moreDetailsText"},"Hide Details"),i.createElement(A.a,{className:"PeoplePickerError-icon",iconName:"ChevronUp"})),i.createElement("div",{className:"PeoplePickerError-detailsContainer"},t.errorDetails));return i.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-".concat(e.textColorType)},i.createElement(A.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon ".concat(e.className),iconName:e.iconName}),i.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-".concat(e.textColorType)},t.error,a?r:n))}return i.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorContainer od-Simplified-Share-".concat(e.textColorType)},i.createElement(A.a,{className:"od-Simplified-Share-PeoplePickerErrorIcon ".concat(e.className),iconName:e.iconName}),i.createElement("div",{className:"od-Simplified-Share-PeoplePickerErrorText od-Simplified-Share-".concat(e.textColorType)},t.error))})):i.createElement(i.Fragment,null,e.messages.map(function(t){return i.createElement("div",{className:"od-Share-PeoplePickerErrorContainer",style:{backgroundColor:e.backgroundColor}},i.createElement(A.a,{iconName:e.iconName,className:e.className}),i.createElement("div",{className:"od-Share-PeoplePickerErrorDiv"},t.error))}))}Fe.contextTypes={sharingStore:f.object.isRequired,clientId:f.number.isRequired};var He,Re,Ne=n(331),Be=n(131),je=n(71),Ve=n(523),ze=n(232),Ge=n(350),Ke=n(143);!function(e){e[e.None=0]="None",e[e.Family=1]="Family",e[e.FamilyMember=2]="FamilyMember"}(He||(He={})),(Re=document.createElement("style")).innerHTML="\n  @media screen and (-ms-high-contrast: active) {\n    .ms-Button-flexContainer:hover {\n      font-size: inherit !important;\n      color: inherit !important;\n      forced-color-adjust: none;\n    }\n  }\n  ",document.head.insertAdjacentElement("beforeend",Re);var We="peoplepicker",qe=function(e){function t(t,n){var r=e.call(this,t)||this;return r._inputs=[],r._onItemsChange=function(e){var t=r.state.selectedItems.concat(e);r.setState({selectedItems:t},function(){r.props.onChange(t)}),e.forEach(function(e){r._onAutoResolve(e)})},r._initRumone=function(e,t){void 0===t&&(t=!1),(!r._inputStartTime&&!t&&e.length>1||!r._inputStartTime&&t&&0===e.length)&&(r._inputStartTime=Date.now(),r._rumoneLogger||(r._rumoneLogger=new Ne.a(We)),r._rumoneLogger.resetRumOneApiMeasurement(),r._rumoneLogger.resetRumOne(),Be.b.getRUMOneLogger({name:We}).startAPIMeasurement({ignore:function(e){return e.indexOf("/Collector/3.0/")>=0},getAPIName:function(e){var t=e.toLowerCase();return-1!==t.indexOf("graph.microsoft.com/v1.0/me/people")&&-1!==t.indexOf("search")?"GraphSearch":-1!==t.indexOf("/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface.clientpeoplepickersearchuser")?"SPClientPeoplePickerSearchUser":-1!==t.indexOf("https://outlook.office.com/search/api/v1/suggestions")?"SubstrateSearch":void 0}}))},r._onInputChange=function(e){if(r._inputs.push(e),r._initRumone(e),r._hasTakenErrorFocus=!1,e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);if(t&&t[0]&&(e=t[0].substring(1,t[0].length-1)),e=e.trim())return r._createGenericPerson(e)}).filter(function(e){return e});return r._onItemsChange(t),r.props.onInputChange&&r.props.onInputChange(""),""}var n=/['"].*['"]/g.exec(e);return n&&n[0]?n[0].substring(1,n[0].length-1):(r.props.onInputChange&&r.props.onInputChange(e),e)},r._onGetMoreResults=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!!ke.O()||t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!ke.C()&&!!r.props.allowSPGroups||r._showSimplifiedDialogV2,forceResolve:!0,useSubstrate:!!r.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:r.props.sharingInformation.siteIBSegmentIDs};return ke.p()?r._peoplePickerProvider.sharePointSearch(e,n):r._peoplePickerProvider.sharePointSearch(e,n).then(function(e){return e.filter(function(e){return 0===r.state.selectedItems.filter(function(t){return t.email===e.email}).length})})},r._onSuggestionSelected=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:r._showSimplifiedDialogV2,forceResolve:!0};if(r._store.getEngagementHelper().log("PeoplePicker.SuggestionSelected",{clientId:r.props.clientId,mode:Ee.a.share,detailedGroupInfo:e.detailedGroupInfo,principalType:void 0===e.principalType?"unknown":c.a[e.principalType],entityType:void 0===e.entityType?"unknown":d.a[e.entityType],isDefaultSuggestion:!/\S/.test(r._inputs.join(""))}),ke.u()&&v.r(r.props.clientId)){var a=r._store.getFamily(),i=r._store.getFamilyMembers();a&&i&&(e.userId===a.userId?r._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:He[r.state.familyType],mode:Ee.a.share}):i.some(function(t){return t.userId===e.userId})&&r._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:He[r.state.familyType],mode:Ee.a.share}))}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;e.principalType===c.a.distributionList&&(n.isGraphDistributionList=!0,n.useGraph=!0);var o=(0,Le.g)(e),s=(0,Le.e)(e);return!e.isResolved||o?r._peoplePickerProvider.resolve(e.userId,n).then(function(t){return!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails),!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails),e.entityType===d.a.linkedinUser&&(t.entityType=e.entityType),void 0===t.isExternal&&(o||s)&&(t.isExternal=!0),t}):e},r._onRenderItem=function(e){var t=r.props.permissionsMap,n=r._computeAllowExternalUsers(r.props.sharingLinkKind,r.props.sharingInformation.canAddExternalPrincipal,e.item),o=!r._showSimplifiedDialogV2||r.props.shareTargetClicked===Pe.e.copy,s=!r._showSimplifiedDialog&&r.props.sharingLinkKind===p.a.direct&&t&&(void 0!==t[e.item.email]&&t[e.item.email]===m.a.none||void 0!==t[e.item.userId]&&t[e.item.userId]===m.a.none),c=o&&e.item.isExternal&&!n,d=!r._showSimplifiedDialogV2&&c||o&&s||!e.item.isResolved&&!e.item.isResolving,l=e.item.isExternal,u=e.item.name;if(e.removeButtonAriaLabel=k.j(y.zh,u),e.item.imageAlt=k.j(y.rk,u),d||l){var f=d?"--error":l?"--warning":"";return i.createElement("div",{className:"od-Share-PeoplePicker-selectedItem".concat(f)},r._showSimplifiedDialog?i.createElement(Q,(0,a.a)({},e)):i.createElement(W,(0,a.a)({},e)))}return e.item.isResolving?i.createElement(b.a,{className:"od-Share-PeoplePicker-resolve-spinner"}):r._showSimplifiedDialog?i.createElement(Q,(0,a.a)({},e)):i.createElement(W,(0,a.a)({},e))},r._onToggleGetMoreResults=function(e){ke.p()?r.state&&(e&&!r.state.searchForMoreText||!e&&r.state.searchForMoreText)&&r.setState({searchForMoreText:r._getSearchForMoreText(e)}):r.setState({searchForMoreText:r._getSearchForMoreText(r.props.sharingInformation.isGraphAvailable||e)})},r._writeUserInputDataToRumoneLogger=function(e){if(void 0===e&&(e=!1),r._rumoneLogger){var t=r._rumoneLogger.breakdownData,n={modeName:"peoplePicker",startTime:r._inputStartTime,endTime:Date.now(),breakDownData:{customerInputs:t(r._inputs.length),isSearchFromCache:e}};r._rumoneLogger.logSharingPerformance(n)}r._inputs=[],r._inputStartTime=null},r._peoplePickerProvider=n.peoplePickerProvider,r._resize=n.resize,r._platformDetection=n.platformDetection,r._hasTakenErrorFocus=!1,r._store=n.sharingStore,r._clientId=n.clientId,r._rumoneLogger=null,r._sharingClientMessenger=n.sharingClientMessenger,r._persistentRequestCache=new Ve.a({id:"PeoplePickerSearch"},{pageContext:n}),r._showSimplifiedDialogV1=(0,Pe._)(r._clientId,r._store)&&r.props.mode===Ee.a.share,r._showSimplifiedDialogV2=(0,Pe.Z)(r._clientId,r._store)&&r.props.mode===Ee.a.share,r._showSimplifiedDialog=r._showSimplifiedDialogV1||r._showSimplifiedDialogV2,r.state={selectedItems:t.defaultSelectedItems,searchForMoreText:r._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:He.None,familyResolveEventFired:!1,previousUsers:[]},r._resizeTracker=new S.a(n.resize),r._peoplePickerControl=i.createRef(),r}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,a=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&a.push({name:n[0].name,userId:n[0].userId})}),this.setState({selectedItems:t,addedUsers:a})},t.prototype.componentDidUpdate=function(e,t){var n,a,i,r,o,s,c=this;this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var d=t.addedUsers,l=this.state.addedUsers,u=this.state.removedUsers;(null===(n=e.defaultSelectedItems)||void 0===n?void 0:n.length)!==(null===(a=this.props.defaultSelectedItems)||void 0===a?void 0:a.length)&&this.setState({previousUsers:e.defaultSelectedItems}),this._showSimplifiedDialog&&(null===(i=this._peoplePicker)||void 0===i?void 0:i.scrollHeight)&&this._peoplePicker.scrollHeight!==this.props.height&&this.props.setHeight&&((null===(r=this.state.previousUsers)||void 0===r?void 0:r.length)>this.props.defaultSelectedItems.length?this.props.setHeight(null===(o=this._peoplePicker)||void 0===o?void 0:o.scrollHeight):this.props.setHeight("auto"));var f=this._showSimplifiedDialog?200:0;this._resizeTracker?setTimeout(function(){c._resizeTracker.checkSizeChange(c._peoplePicker)},f):(this._showSimplifiedDialog||null!==this.props.error&&null===e.error)&&setTimeout(function(){c._resize()},f);var p=!1;d.length>l.length?(u=d.filter(function(e){return-1===l.indexOf(e)}),this.setState({removedUsers:u}),p=!0):d.length!==l.length&&u.length>0&&(this.setState({removedUsers:[]}),p=!0);var m=this._platformDetection&&this._platformDetection.isIE;(this._peoplePickerControl&&(!m||this._showSimplifiedDialog)&&this.props.error&&!this._hasTakenErrorFocus||p||this.props.focusPeoplePicker)&&(null===(s=this._peoplePickerControl.current)||void 0===s||s.focusInput(),this.props.error&&(this._hasTakenErrorFocus=!0))},t.prototype.componentDidMount=function(){var e,t=this._platformDetection&&this._platformDetection.isIE;!this._peoplePickerControl||t&&!this._showSimplifiedDialog||null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput()},t.prototype.render=function(){var e,t,n=this,r={placeholder:this._computePlaceholderText(),autoFocus:!0,onFocus:function(e){n._onFocus()},onBlur:function(e){n._onBlur()},"aria-label":this._computePlaceholderText()},o=this.props.pickerSettings,s=!!this.props.sharingInformation.enforceIBSegmentFiltering,c={principalSource:o.PrincipalSource,principalType:this._convertPrincipalType(o.PrincipalAccountType),querySettings:o.QuerySettings,allowEmailAddresses:!!ke.O()||o.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:o.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:s,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:te.a.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,siteIBMode:this.props.sharingInformation.siteIBMode,useNew3Ssearch:o.useNew3Ssearch,enforceIBSegmentFiltering:s},d=this.state.selectedItems.length>0&&"smaller-padding",l=(null===(e=this._platformDetection)||void 0===e?void 0:e.isIE)&&"isIE ".concat(0===this.state.selectedItems.length&&"initial-padding"),u=this.props.renderIcon?"withIcon":"",f=this.props.error&&!this._showSimplifiedDialog?"od-Share-PeoplePicker ms-Share-PeoplePicker--error "+u:this._showSimplifiedDialog?"od-Simplified-Share-PeoplePicker ".concat(l," ").concat(d)+u:"od-Share-PeoplePicker "+u;f+=" inline";var p=v.f(this.props.clientId)||this._platformDetection&&this._platformDetection.isMobile,m={preventDismissOnScroll:p,preventDismissOnResize:!0};this._showSimplifiedDialog&&(m.target=this.props.peoplePickerRef,m.doNotLayer=!0,m.styles={root:(0,a.a)({left:"0 !important"},{top:"".concat(Math.min((null===(t=this._peoplePicker)||void 0===t?void 0:t.scrollHeight)+2,126),"px !important")})});var _,h=p?y.yd:y.Sd,b=this.props.roleSelectorProps&&this.props.roleSelectorProps.roleSelectorAs,g=document.body,S=g?parseInt(getComputedStyle(g).fontSize,10):null;!(S&&S>16)||this._platformDetection&&this._platformDetection.isIE||(_={flexWrap:"wrap"}),this._showSimplifiedDialog&&(_=(0,a.a)((0,a.a)({},_),{width:"100%",height:this.props.height&&this.props.height,transition:"height 200ms cubic-bezier(.33, 0, .1, 1)"}));var D="od-Share-PeoplePicker-Suggestions".concat(this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":"");return this._showSimplifiedDialog&&(D="od-Share-PeoplePicker-Suggestions-Simplified-Share ".concat(this._platformDetection.isIE?"isIE":"isNotIE"," od-Share-PeoplePicker-Suggestions-condensed")),D+=" inline",i.createElement("div",{style:_,ref:this.props.peoplePickerRef},i.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",role:"presentation",className:this._showSimplifiedDialog?"od-Share-PeoplePicker-height":void 0},Me.a(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),i.createElement("div",{className:this._showSimplifiedDialog?"od-Share-PeoplePicker-flexGrow ".concat(this.props.renderIcon?"normal":"space-between"):"od-Share-PeoplePickerContainer ".concat(this.props.renderIcon?"normal":"space-between")},this.props.renderIcon&&i.createElement(A.a,{className:"od-Share-PeoplePicker-PeoplePickerIcon",iconName:"CirclePlus"}),i.createElement("div",{className:"od-Share-PeoplePicker-wrapper",ref:function(e){n._peoplePicker=e}},i.createElement(we,{"aria-describedby":"inputErrorMessage",componentRef:function(e){n._peoplePickerControl.current=e},className:f,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:r,loadingText:y.ge,noResultsFoundText:y.tf,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:c,suggestionsClassName:D,onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store&&this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,customizeSuggestionPersonaProps:this._customizeSuggestionsItem,onGetMoreResults:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:h,enableSelectedSuggestionAlert:this._platformDetection&&this._platformDetection.isIE,role:"presentation",pickerCalloutProps:m,peoplePickerImprovementsExperiment:!!je.d(),persistCachePeopleSearch:function(e){var t=n._persistentRequestCache.getRequestKey(e.key,"POST");return n._persistentRequestCache.getDataUtilizingCache({cachingStrategy:Ge.a.useCacheIfNotExpired,cacheTimeoutTime:ze.a,cacheRequestKey:t,getData:e.getData,returnStatistics:!0})},writeUserInputDataToRumoneLogger:this._writeUserInputDataToRumoneLogger,initRumone:this._initRumone,showDefaultSuggestionOnlyByClick:!0})),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},i.createElement(b,(0,a.a)({},this.props.roleSelectorProps)))),!this._showSimplifiedDialog&&i.createElement("div",{className:"od-Share-PeoplePickerContainer"},i.createElement("div",{id:"inputErrorMessage",className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))))},t.prototype._onResolvedSuggestions=function(e,t){var n=this;if((ke.u()||(0,Ke.d)()&&ke.t())&&v.r(this.props.clientId)){var a=this._store.getFamily(),i=this._store.getFamilyMembers();if(a&&t.length>1){var r=0===y.Id.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),o=!1,s=He.None;r?(s=He.Family,o=!0,e=[a].concat(i,e)):(e.forEach(function(t,n){i.forEach(function(i){(!o&&t.userId===i.userId||t.email===i.email)&&(e.splice(n+1,0,a),o=!0)})}),o&&(s=He.FamilyMember)),this.setState({familyType:s}),o&&!this.state.familyResolveEventFired&&(this.setState({familyResolveEventFired:!0}),this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:Ee.a.share,familySuggestionType:He[s]}))}}var c=[],d=[this._store.getCurrentUserId()],l=[];e.forEach(function(e){(0,Pe.X)(e.image,n._clientId)&&(e.image=void 0),-1===d.indexOf(e.userId)&&-1===c.indexOf(e.email)&&(n.state.addedUsers.some(function(t){return t.name===e.name&&t.userId===e.userId})||l.push(e),e.userId&&d.push(e.userId),e.email&&c.push(e.email))});try{return this.props.onResolvedSuggestions(l)}catch(e){return l}},t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}},t.prototype._customizeSuggestionsItem=function(e){return(0,a.a)((0,a.a)({},e),{"aria-label":"".concat(e.text," ").concat(e.secondaryText)})},t.prototype._onRenderSuggestionsItem=function(e){var t=e.email&&e.email!==e.name?e.email:"";ke.eb()&&(t=e.email||"");var n={text:e.name||"",imageUrl:e.image||"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:t,imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return n["aria-label"]="".concat(n.text," ").concat(n.secondaryText),i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(C.a,(0,a.a)({},n,{presence:x.b.none,size:x.c.size40,className:"ms-PeoplePicker-pickerPersona"})),e.entityType===d.a.linkedinUser&&i.createElement(A.a,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},t.prototype._onAutoResolve=function(e){var t=this,n=this.props.pickerSettings,i={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:n.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:this._showSimplifiedDialogV2,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails),!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var a=[];t.state.selectedItems.forEach(function(t){t.email===e.email?a.push(n):a.push(t)}),t.setState({selectedItems:a},function(){t.props.onChange(a)})}).catch(function(){var n=(0,a.a)((0,a.a)({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(n):i.push(t)}),t.setState({selectedItems:i},function(){t.props.onChange(i)})})},t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++)if(t[e].isResolving)return!0;return!1},t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?y.Ag:y.Eg},t.prototype._computePeopleAddOrRemoveMessage=function(){var e=this.state.previousUsers,t=this.props.defaultSelectedItems,n=function(e,t){var n={};e.map(function(e){return n[e.email]?n:n[e.email]=e}),t.map(function(e){return n[e.email]?n:n[e.email]=e});var a={};e.map(function(e){return a[e.email]=a[e.email]?a[e.email]+1:1});var i=t.filter(function(e){return!a[e.email]||(a[e.email]=a[e.email]-1,!1)});return Object.keys(a).forEach(function(e){for(;a[e];)i.push(n[e]),a[e]=a[e]-1}),i};if((null==e?void 0:e.length)>(null==t?void 0:t.length)){var a=n(e,t);return(i=[]).push(a.map(function(e){return k.j(y.Og,e.name)})),i.length>0?i.join(", "):""}if(null==t?void 0:t.length){var i,r=n(t,e);return(i=[]).push(r.map(function(e){return k.j(y.Cg,e.name)})),i.length>0?"".concat(i.join(", "),". ").concat(y.Eg):""}},t.prototype._convertPrincipalType=function(e){if(!e)return c.a.none;for(var t=c.a.none,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i&&(t|=c.a.user),"DL"===i&&(t|=c.a.distributionList),"SecGroup"===i&&(t|=c.a.securityGroup),"SPGroup"===i&&(t|=c.a.sharePointGroup)}return t},t.prototype._computeAllowExternalUsers=function(e,t,n){var a=e===p.a.organizationView,i=e===p.a.organizationEdit,r=a||i,o=!t&&(0,Le.e)(n);return!r&&(t||o)},t.prototype._renderError=function(){var e,t=this.props.error;if(t&&!this._isResolveInProgress()){this._peoplePickerControl&&!this._hasTakenErrorFocus&&(null===(e=this._peoplePickerControl.current)||void 0===e||e.focusInput(),this._hasTakenErrorFocus=!0);var n={error:t};return i.createElement(Fe,{messages:[n],backgroundColor:"#FDE7E9",className:"od-Simplified-Share-PeoplePickerErrorIcon",iconName:"Blocked2",textColorType:"error"})}},t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[],a={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}};if(!this.props.error)return this.state.selectedItems.length===this.props.selectionLimit&&n.push(i.createElement(u.a,{ariaLabel:y.xg,styles:a},y.xg)),e&&n.push(i.createElement(u.a,{ariaLabel:e,styles:a},e)),t&&n.push(i.createElement(u.a,{ariaLabel:t,styles:a},t)),n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0},t.prototype._getSearchForMoreText=function(e){return e?y.ui:void 0},t.prototype._onFocus=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendPeoplePickerFocused():Ae.s(),this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!0)},t.prototype._onBlur=function(){this.props.setPeoplePickerFocused&&this.props.setPeoplePickerFocused(!1)},t.contextTypes={peoplePickerProvider:f.object.isRequired,resize:f.func.isRequired,platformDetection:f.object.isRequired,sharingStore:f.object.isRequired,clientId:f.number.isRequired,sharingClientMessenger:f.object},t}(I.a),Qe=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return(0,a.d)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?this.props.fallback?this.props.fallback:null:i.createElement(i.Fragment,null,this.props.children)},t.prototype.componentDidCatch=function(e,t){this.props.onError&&this.props.onError(e,t)},t}(i.PureComponent),Ye=n(37),Je=n(58);function Xe(e){e.onError;var t=e.componentName,n=(0,Ue.a)(function(e,n){Ye.a.logError(e,{"react.componentStack":n.componentStack,"react.component":t},{eventName:"ReactRenderError",resultCode:"",resultType:Je.a.Failure})});return i.createElement(Qe,(0,a.a)({},e,{onError:n}))}var Ze=function(e){function t(t,n){var a=e.call(this,t)||this;return a._peoplePickerProvider=n.peoplePickerProvider,a}return(0,a.d)(t,e),t.prototype.render=function(){var e,t;return(null===(e=this._peoplePickerProvider)||void 0===e?void 0:e.getLivePersonaPickerHelper)&&(null===(t=this._peoplePickerProvider)||void 0===t?void 0:t.getLivePersonaPickerHelper())?i.createElement(D,(0,a.a)({},this.props,{selectionLimit:100})):i.createElement(Xe,{componentName:"peoplePicker.peoplePickerWrapper"},i.createElement(qe,(0,a.a)({},this.props,{selectionLimit:100})))},t.contextTypes={peoplePickerProvider:f.object.isRequired},t}(i.Component)}
,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){function e(){}return e.invalidate=function(t){"undefined"!=typeof window&&(e.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir"),e.safeLeft=e.isRightToLeft?"right":"left",e.safeRight=e.isRightToLeft?"left":"right",t=t||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName,e.language=t||window.document&&(document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang"))||"en-us",e.cultureLCID=window._spPageContextInfo&&window._spPageContextInfo.currentCultureName||e.language)},e}();a.invalidate(),t.b=a}
,function(e,t,n){n.d(t,{a:function(){return u},b:function(){return p},c:function(){return f},d:function(){return m}});var a=n(39),i=n(29),r=n(32),o=n(45),s=n(3),c=n(46),d=s.b.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","KS for COB simplified ShareDialog")||c.a.isFeatureEnabled({ECS:1131341}),l=c.a.isFeatureEnabled({ODB:61327,ODC:"COBNewShareDialog"}),u="https://my.microsoftpersonalcontent.com";function f(e,t,n){return e===a.a.anonymousEdit||e===a.a.anonymousView?i.a.anyone:e===a.a.organizationEdit||e===a.a.organizationView?i.a.organization:e===a.a.direct?i.a.specificPeople:e===a.a.flexible?t?i.a.anyone:!1===n?i.a.organization:i.a.specificPeopleFlex:void 0}function p(e,t){var n=!!e.filter(function(e){var t=new Date(e.expiration);return e.isActive&&e.sharingLinkKind!==a.a.direct&&(!e.expiration||t.getTime()>Date.now())&&!0!==e.isUnhealthy}).length;if(!n&&t.length)for(var i=0,o=t;i<o.length;i++)if(o[i].role!==r.a.owner){n=!0;break}return n}function m(){var e=window.location.search.substring(1),t=(0,o.a)(e),n=t.itemMigrated&&"true"===t.itemMigrated.toLowerCase(),a=function(e){if(e&&"ConsumerTenant"===e.tenantDisplayName&&0===e.webAbsoluteUrl.indexOf(u)){var t=e.webAbsoluteUrl.match(new RegExp("".concat(u,"/personal/(\\w+)")));if(t&&2===t.length)return t[1]}}(window._spPageContextInfo);return!n&&a&&(n=!0),!d&&(!!window.FilesConfig&&l||!!n)}}
,,,,,,function(e,t,n){function a(e,t){return e===t}function i(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(n!==t.length)return!1;for(;n;)if(e[--n]!==t[n])return!1;return!0}n.d(t,{a:function(){return i},b:function(){return a}})}
,,,function(e,t,n){n.d(t,{a:function(){return p},b:function(){return f},c:function(){return l},d:function(){return u}});var a=n(0),i=(n(190),n(37)),r=n(25);r.onError=function(e){i.a.log(e)};var o=n(90),s=n(67),c=n(149),d=n(109);function l(e){return f(e)?e.peek():e}function u(e){return r.unwrap(e)}function f(e){return r.isObservable(e)}var p=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this._owner=e.owner,this._asyncType=t.asyncType}return Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.a)},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t,n){var a,i=(void 0===n?{}:n).isBeforeChange;return void 0!==i&&i&&(a="beforeChange"),this.scope.attach(e.subscribe(t,this._owner,a))},e.prototype.create=function(e,t){var n=r.observable(e),a=null==t?void 0:t.equalityComparer;return a&&(n.equalityComparer=a),n},e.prototype.createArray=function(e){return r.observableArray(e)},e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,r=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return r(e,u(t))},u(i))},{equalityComparer:c.b});return(0,d.a)(o,{register:function(e){var i,r="".concat(++t);return n((0,a.a)((0,a.a)({},n.peek()),((i={})[r]=e,i))),{dispose:function(){var e=n.peek(),t=r,i=(e[t],(0,a.f)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})},e.prototype.compute=function(e,t){var n=this;void 0===t&&(t={});var i=function(e){return"object"==typeof e}(e)?e:{read:e},o=(0,a.a)((0,a.a)({owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i),t),s=o.equalityComparer,c=(0,a.f)(o,["equalityComparer"]),d=r.computed(c);return s&&(d.equalityComparer=s),this.scope.attach(d)},e.prototype.pureCompute=function(e,t){return void 0===t&&(t={}),this.compute(e,(0,a.a)({pure:!0},t))},e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};return t&&r.utils.extend(n,t),this._setupBackgroundTask(this.compute(e,n))},e.prototype.wrap=function(e,t){return f(e)?e:this.create(e,t)},e.prototype.peekUnwrap=function(e){return f(e)?e.peek():e},e.prototype.unwrap=function(e){return u(e)},e.prototype.isObservable=function(e){return f(e)},e.prototype.ignore=function(e){return function(e){return r.ignoreDependencies(e)}(e)},e.prototype.dispose=function(){this._scope&&this._scope.dispose()},e.prototype._setupBackgroundTask=function(e){var t=this;return this._backgroundTasks||(this._backgroundTasks=[]),this._backgroundTasks.push(e),this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()})),e},e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId,delete this._backgroundTasks},e.prototype._getAsync=function(){var e=this._asyncType||s.a,t=this.scope.attach(new e(this));return this._getAsync=function(){return t},t},e}()}
,,,,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return c},c:function(){return r},d:function(){return s},e:function(){return o}});var a=n(0),i=function(e){function t(t,n){var i=this,r=n.response,o=(void 0===r?{}:r).error,s=(void 0===o?{}:o).innerError,d=(void 0===s?{}:s).stackTrace,l=void 0===d?"":d,u=n.response,f=n.request,p=n.status,m=n.code,_=void 0===m?c(u,p,function(e){return"".concat(e)})||"unhandled":m,h=(0,a.a)({innerError:t,code:_},n);return(i=e.call(this,h)||this).name="GraphError",i.response=u,i.status=p,i.serverStack=l,i.request=f,i.error=t,i}return(0,a.d)(t,e),t}(n(68).a);function r(e){var t={};if(t.errorMessage=e.message,o(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function o(e){return!!e&&e instanceof i}function s(e){return function(e,t){if(e&&o(e))return c(e.response,e.status,function(e){return function(e){return"".concat(e)}(e)})}(e)||"unhandled"}function c(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}}
,,function(e,t,n){function a(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function i(){return crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}n.r(t),n.d(t,{Empty:function(){return r},_guidRegEx:function(){return o},cryptoRandom:function(){return i},generate:function(){return s},isValidGuid:function(){return u},normalizeDashes:function(){return l},normalizeLower:function(){return c},normalizeUpper:function(){return d}});var r="00000000-0000-0000-0000-000000000000",o=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;function s(e){var t=[];t.push(a(8,e)),t.push(a(4,e));var n="4"+a(3,e);t.push(n);var i=a(4,e),r=parseInt(i[0],16);return r&=3,i=(r|=8).toString(16)+i.substr(1),t.push(i),t.push(a(12,e)),t.join("-")}function c(e,t){return void 0===t&&(t=!1),e?f(e.toLowerCase(),t):""}function d(e,t){return void 0===t&&(t=!1),e?f(e.toUpperCase(),t):""}function l(e,t){if(void 0===t&&(t=!1),e){var n=e.replace(/[^A-Fa-f0-9]/g,"");if(32===n.length)return f("".concat(n.slice(0,8),"-").concat(n.slice(8,12),"-").concat(n.slice(12,16),"-").concat(n.slice(16,20),"-").concat(n.slice(20)),t)}return""}function u(e){return!(!e||!o.test(c(e)))}function f(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}}
,function(e,t,n){function a(e){var t;try{var n=[];t=JSON.stringify(e,function(e,t){return t===window?"[window]":t instanceof HTMLElement?"[HTMLElement]":"function"==typeof t?"[function]":"object"==typeof t?null===t?t:-1===n.indexOf(t)?(n.push(t),t):"[circular]":t})}catch(e){t=JSON.stringify("[object]")}return t}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(129),i=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),i=(0,a.a)(e,function(){delete t._disposables[n]});return this._disposables[n]=i,i},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],r=e[i];r&&(0,a.b)(r)&&r.dispose(),delete e[i]}},e}()}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return l},c:function(){return c},d:function(){return u}});var a=n(0),i=n(68),r=n(212),o="Canceled",s=function(e){function t(t){void 0===t&&(t={message:o});var n=this,r=(0,i.c)(o);return(n=e.call(this,(0,a.a)({code:(0,i.d)(t.code)?(0,i.b)(t.code,r):r,isExpected:!0},t))||this).name=o,n}return(0,a.d)(t,e),t}(i.a);function c(e){if(e instanceof s)return!0;if(e&&"object"==typeof e){if(e.code===o)return!0;if(e.name===o)return!0}return!1}var d=function(e){var t,n=e.catch(function(e){return t=e,Promise.reject(e)});this.subscribe=function(e){var t=e;return n.then(function(){t=void 0},function(e){if(t){var n=t;t=void 0,n(e)}}),function(){t=void 0}},this.isCanceled=function(){return!!t},this.throwIfCanceled=function(){if(t)throw new s(t)}},l=function(){var e=new r.a,t=e.reject,n=e.resolve,a=e.promise;this.cancel=function(e){return t(e||new s)},this.dispose=function(){return n()},this.token=new d(a)};function u(e,t){return(0,a.b)(this,void 0,void 0,function(){var n,i,o=this;return(0,a.e)(this,function(s){switch(s.label){case 0:return t?[3,2]:[4,e];case 1:case 3:return[2,s.sent()];case 2:return n=new r.a,i=t.subscribe(function(e){n.reject(e)}),(0,a.b)(o,void 0,void 0,function(){var t,r,o;return(0,a.e)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,3,4]),r=(t=n).resolve,[4,e];case 1:return r.apply(t,[a.sent()]),[3,4];case 2:return o=a.sent(),n.reject(o),[3,4];case 3:return i(),[7];case 4:return[2]}})}),[4,n.promise]}})})}}
,function(e,t,n){n.d(t,{a:function(){return h}});var a=n(52),i=n(26),r=(0,a.a)({eventName:"PLT,",shortEventName:"PLT"},{name:{isKey:!0,type:i.a.String},w3cResponseEnd:i.a.Number,w3cResponseStart:i.a.Number,prefetchStart:i.a.Number,deferredListDataRender:i.a.Number,appStart:i.a.Number,preRender:i.a.Number,dataFetch:i.a.Number,dataFetchServerTime:i.a.Number,postRender:i.a.Number,render:i.a.Number,plt:i.a.Number,pltWithUnload:i.a.Number,httpRequests:i.a.Number,appCacheHit:i.a.Boolean,dns:i.a.Number,tcpConnect:i.a.Number,sslConnect:i.a.Number}),o=(0,a.a)({eventName:"PLTHttpRequest,",shortEventName:"PLTHttpRequest"},{startTime:i.a.Number,url:i.a.String,duration:i.a.Number}),s=n(123),c=n(41),d=n(37),l=n(79),u=n(163),f=window.performance,p="EUPL.AppStart",m="EUPL.DataManager.FirstDataFetch.GetItem.Start",_="EUPL.DataManager.FirstDataFetch.GetItem.End",h=function(){function e(){}return e.getResponseEnd=function(){return f&&f.timing?window.g_responseEnd&&(f.timing.responseEnd&&Number(window.g_responseEnd)<f.timing.responseEnd||!f.timing.responseEnd)?Number(window.g_responseEnd):f.timing.responseEnd:NaN},e.getNavigationStart=function(){try{return f.timing.navigationStart}catch(e){return}},e.appStart=function(){try{f&&f.timing&&(e.mark(p),l.a.addLogHandler(this.eventLogHandler),this.summary.w3cResponseEnd=e.getResponseEnd()-f.timing.fetchStart,this.summary.w3cResponseStart=f.timing.responseStart-f.timing.fetchStart,this._times.appStart=Date.now(),this.summary.appStart=this._times.appStart-e.getResponseEnd(),this.summary.prefetchStart=-1,this.summary.deferredListDataRender=-1,this.summary.dns=f.timing.domainLookupEnd-f.timing.domainLookupStart,this.summary.tcpConnect=f.timing.connectEnd-f.timing.connectStart,this.summary.sslConnect=f.timing.secureConnectionStart?f.timing.connectEnd-f.timing.secureConnectionStart:-1)}catch(e){d.a.log(e)}},e.plt=function(t){try{if(f&&f.timing&&void 0===e._times.plt){var n=Date.now(),a=Math.round(f.now());l.a.removeLogHandler(this.eventLogHandler);var i=(0,u.e)("EUPL.OnePageNavigation.Start");this._times.plt=isNaN(i)?n-f.timing.fetchStart:a-i,this.summary.preRender=(0,u.e)(m)-(0,u.e)(p),this.summary.dataFetch=(0,u.e)(_)-(0,u.e)(m),this.summary.postRender=e.now()-(0,u.e)(_),this.summary.render=this.summary.preRender+this.summary.postRender,this.summary.plt=this._times.plt,this.summary.pltWithUnload=n-f.timing.navigationStart,this.summary.name=t,this.summary.appCacheHit=this.summary.w3cResponseEnd<=40&&Boolean(window.applicationCache)&&Boolean(window.applicationCache.status!==window.applicationCache.UNCACHED),this.getHttpRequests();var s=r.logData(this.summary);if(this.httpRequestCollection)for(var c=0,h=this.httpRequestCollection;c<h.length;c++){var b=h[c];o.logData(b,s)}e.mark("EUPL.glass")}}catch(e){d.a.log(e)}},e.mark=function(e,t){(0,u.f)(e,t)},e.pageLoaded=function(){return void 0!==this._times.plt},e.getMarkerTime=function(e){return(0,u.e)(e)},e.now=function(){return u.a?Math.round(f.now()):Date.now()},e.eventLogHandler=function(t){s.a.isTypeOf(t)&&(void 0===e._times.appDataFetchStart?e._times.appDataFetchStart=t.startTime:t.eventType!==c.b.End&&t.eventType!==c.b.Single||(e._times.appDataFetchEnd=e._times.appDataFetchEnd?Math.max(e._times.appDataFetchEnd,t.endTime):t.endTime))},e.getHttpRequests=function(){if(f&&f.getEntriesByType){for(var e=[],t=f.getEntriesByType("resource"),n=t.length,a=0;a<n;a++){var i={startTime:Math.round(t[a].startTime),url:t[a].name,duration:Math.round(t[a].duration)};e.push(i)}var r=document.getElementsByTagName("iframe");n+=r.length;for(var o=0;o<r.length;o++){try{t=r[o].contentWindow.performance.getEntriesByType("resource")}catch(e){t=null}if(t){var s=t.length;for(n+=s,a=0;a<s;a++){var c={startTime:Math.round(t[a].startTime),url:t[a].name,duration:Math.round(t[a].duration)};e.push(c)}}}this.summary.httpRequests=n,this.httpRequestCollection=e}},e.summary={},e._times={},e}()}
,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return r},c:function(){return l},d:function(){return u},e:function(){return d},f:function(){return c}});var a=window.performance,i=void 0!==typeof a&&!!a&&"function"==typeof a.mark&&"function"==typeof a.clearMarks&&"function"==typeof a.now,r="EUPL.",o=0,s=window._perfMarks=window._perfMarks||[];function c(e,t){var n=f(e);(null==t||o<t)&&(i?a.mark(n):s.push({name:n,startTime:Date.now()}),o++)}function d(e,t){void 0===t&&(t=!0);var n=t?f(e):e;if(i){var r=a.getEntriesByName(n,"mark");return r&&r.length>0?Math.round(r[0].startTime):NaN}var o=s.filter(function(e){return e.name===n})[0];return o&&o.startTime}function l(e){var t=[];e&&(t=e.map(f)),i?a.getEntriesByType("mark").filter(function(e){return t.length>0?t.indexOf(e.name)>=0:0===e.name.lastIndexOf(r,0)}).forEach(function(e){a.clearMarks(e.name)}):s=[]}function u(){return i?a.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(r,0)}):s}function f(e){return 0===e.lastIndexOf(r,0)?e:r+e}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};t.b={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}}
,,,,,,,,,function(e,t){var n=function(){function e(t){var n;if(this._raw=t,t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var a,i,r=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,s=e.EmailMatchTypes.None;null!==(i=r.exec(t));){var c=i[0],d=c.charAt(0),l=c.charAt(c.length-1);if((s="<"===d&&">"===l?e.EmailMatchTypes.Bracketed:'"'===d&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o&&(a=i,o=s,s===e.EmailMatchTypes.Bracketed))break}var u=t;if(a){n=a[0];var f=a.index,p=f+n.length,m=f>0?t.substr(0,f).trim():"",_=p<t.length?t.substr(p):"";"'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&_&&"'"===_.charAt(0)&&(n=n.slice(1),_=_.slice(1).trim()),u=""===m?_:m,this._email=n.trim()}(u=u.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==u.charAt(u.length-2)&&(u=u.replace(/\s*"$/,"")),""!==(u=u.replace(/\//g,""))&&u!==n&&(this._name=u)}}return e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())},e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),a=[],i=0,r=n.length;i<r;i++)a.push(new e(n[i]));return a},e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1},e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),a=n.length-1;a>=0;a--)n[a]=n[a].trim(),0===n[a].length&&n.splice(a,1);return n},e.prototype.getEmail=function(){return this._email},e.prototype.getName=function(){return this._name},e.prototype.getRaw=function(){return this._raw},e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?",e.EmailRegex=new RegExp(e.EmailRegexPattern,"i"),e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)",e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i"),e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/,e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3},e}();t.a=n}
,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(1);function i(){return a.createElement("div",{className:"separator"})}(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.separator{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}"}])}
,function(e,t){t.a={anyone:0,workGroup:1,specificPeople:2,onlyYou:3,existing:4,chat:5,mail:6}}
,function(e,t){var n;!function(e){e[e.button=0]="button",e[e.link=1]="link",e[e.copyLink=2]="copyLink"}(n||(n={})),t.a=n}
,,,,function(e,t,n){n.d(t,{a:function(){return c}});var a=n(0),i=n(35),r=n(25),o=n(258),s=n(6),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.element=t.element,a.valueAccessor=t.valueAccessor,a.allBindingsAccessor=t.allBindingsAccessor,a.bindingContext=t.bindingContext,a.controlsDescendantBindings=!1,a}return(0,a.d)(t,e),t.init=function(e,t,n,a,i){var c=new s.c(o.a(i)),d=new(this.supportsDependencies?c.resolved(this):c.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});return r.utils.domNodeDisposal.addDisposeCallback(e,function(){return d.dispose()}),{controlsDescendantBindings:d.controlsDescendantBindings}},t.dependencies=(0,a.a)({},i.c.dependencies),t.supportsVirtualElements=!1,t.supportsDependencies=!1,t}(i.c);t.b=c}
,function(e,t,n){n.d(t,{a:function(){return m},b:function(){return _}});var a=n(0),i=n(35),r=n(7),o=n(442),s=n(25),c="__automationTypeBinding$elements",d={init:function(e,t,n,a,i){if(s.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i),i){var r=i.$component;if(r){var o=s.utils.unwrapObservable(t());if(o){var d=r[c];d||(d=r[c]={});var l=d[o];l||(l=d[o]=[]),l.push(e),s.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=l.indexOf(e);-1!==t&&(delete l[t],l.splice(t,1))})}}}}},l=n(182),u=n(2),f=function(e){function t(t){var n=e.call(this,t)||this,a=n.element.getAttribute("class");return n.element.setAttribute("class",n._expandIconClassNames(a)),n}return(0,a.d)(t,e),t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),a=[],i=0,r=n;i<r.length;i++){var o=r[i];if(this._lastClassesAdded&&this._lastClassesAdded[o]||a.push(o),0===o.indexOf("ms-Icon--")){var s=o.substring(9),c=(0,u.z)(s);c&&-1===n.indexOf(c)&&(t[c]=!0,a.push(c))}}return this._lastClassesAdded=t,a.join(" ")}return e},t.after=["css","class"],t}(l.a),p=n(109),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.bindingHandlers={},a.automationId=t&&t.automationId||void 0,a.addBindingHandlers({automation:o.a,automationType:d,icon:f}),a}return(0,a.d)(t,e),t.prototype.getAutomationElement=function(e){return(0,o.b)(this,e)},t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return(0,r.j)(e,t)},t.prototype.addBindingHandlers=function(e){(0,p.a)(this.bindingHandlers,e)},t}(i.c),_=m}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return o}});var a=n(25),i=n(493);function r(e){var t=e.tagName,n=e.template,i=e.viewModel,r=e.synchronous,o=void 0!==r&&r;return a.components.register(t,{viewModel:i,template:n,synchronous:o}),e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html"),n.id=e,i.a.setText(n,t),document.head.appendChild(n)}}
,,,,function(e,t,n){n.d(t,{a:function(){return s}});var a,i=n(3),r={Undefined:0,MinorWithoutParentalConsent:1,MinorWithParentalConsent:2,Adult:3,NotAdult:4,MinorNoParentalConsentRequired:5},o=!i.a.isActivated("38D86CF3-2E1E-46FA-B44B-5C4A4E6B4774");window.FilesConfig&&window.FilesConfig.SuiteNavConfig&&window.FilesConfig.SuiteNavConfig.Urls&&!window.FilesConfig.SuiteNavConfig.Urls.SignOut&&(window.FilesConfig.SuiteNavConfig.Urls.SignOut="/_layouts/15/SignOut.aspx"),function(e){function t(e){switch("".concat(e)){case"NotAdult":case r.NotAdult.toString():return r.NotAdult;case"MinorWithParentalConsent":case r.MinorWithParentalConsent.toString():return r.MinorWithParentalConsent;case"MinorWithoutParentalConsent":case r.MinorWithoutParentalConsent.toString():return r.MinorWithoutParentalConsent;case"Adult":case r.Adult.toString():return r.Adult;case"MinorNoParentalConsentRequired":case r.MinorNoParentalConsentRequired.toString():return r.MinorNoParentalConsentRequired;case r.Undefined.toString():default:return r.Undefined}}e.FilesConfig=window.FilesConfig||{},e.$Config=window.$Config||{},e.cookieToss=window.cookieToss||{},e.urlHost=e.$Config.urlHost||window.location.host,e.ANON_ID_COOKIE_KEY="ANON",e.getUpsellUserId=function(){return o&&e.$Config.upsellUserId?e.$Config.upsellUserId.toUpperCase():e.$Config.upsellUserId},e.getAgeGroup=function(){return function(e){switch(e){case r.NotAdult:return"NotAdult";case r.MinorWithParentalConsent:return"MinorWithParentalConsent";case r.MinorWithoutParentalConsent:return"MinorWithoutParentalConsent";case r.Adult:return"Adult";case r.MinorNoParentalConsentRequired:return"MinorNoParentalConsentRequired";default:return"Undefined"}}(t(e.$Config.ageGroup))},e.getAgeGroupEnum=function(){return t(e.$Config.ageGroup)},e.getAnid=function(){return e.$Config.anonId},e.getCid=function(){return e.$Config.cid},e.getHcid=function(){return e.$Config.hcid},e.getMarket=function(){return e.$Config.mkt},e.getCountry=function(){return e.$Config.country},e.getLanguage=function(){return e.$Config.lang},e.getLanguagePreference=function(){return e.$Config.langPref},e.getAuthSessionId=function(){return e.$Config.authSessionId},e.isNewUser=function(){return 0===e.FilesConfig.freRenderIndex},e.isAuthenticated=function(){return e.$Config.isAuthenticated||e.FilesConfig&&!e.FilesConfig.si},e.isUserMinor=function(){switch(t(e.$Config.ageGroup)){case r.NotAdult:case r.MinorWithParentalConsent:case r.MinorWithoutParentalConsent:return!0;case r.Adult:case r.MinorNoParentalConsentRequired:default:return!1}},e.convertAgeGroupStringToEnum=t,e.getUserEmail=function(){return e.$Config.email}}(a||(a={}));var s=a}
,,function(e,t,n){n(270)}
,function(e,t,n){n.d(t,{a:function(){return a.a}});var a=n(278)}
,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=!n(3).a.isActivated("682BEBB8-F1C8-486D-8B3F-0C75B53F6DC3","12/01/2022","Skip convert if driveId/cid is from sharepoint");function i(e){return a&&new RegExp("^b!").test(e)?e:e?e.replace(/^0+/,"").toLowerCase():void 0}}
,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(79);function i(){return window.CUSTOMERPROMISE_MANAGER=window.CUSTOMERPROMISE_MANAGER||(0,a.b)()}}
,,function(e,t,n){n.d(t,{a:function(){return m}});var a=n(0),i=n(41),r=n(53),o=n(384),s=n(3);function c(e,t){void 0===t&&(t=new r.a);var n=(0,o.a)(t),c=(0,a.a)((0,a.a)({AccountType:void 0!==e.accountType?i.a[e.accountType]:void 0,CloudType:e.cloudType,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:void 0===e.isAuthenticated?void 0:e.isAuthenticated?1:0,IsNucleus:void 0===e.isNucleus?void 0:e.isNucleus?1:0,Market:e.market,Manifest:e.manifest,OneDriveDeviceId:e.oneDriveDeviceId,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId,UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId,pageCorrelationId:e.pageCorrelationId,originalSession:e.originalSession,listId:e.listId,Product:e.product,HomeTenantId:e.homeTenantId,ResourceTenantId:e.resourceTenantId,SessionId:e.session,TenantId:e.siteSubscriptionId,UserAgent:n.BrowserUserAgent,ServerGU:e.sideBySideToken},n||{}),e.context||{});return s.b.isActivated("77CA8BC5-1900-4DEF-82E1-A00FB0F3B0E4")||(void 0===window.__debugLoggerContext&&(window.__debugLoggerContext=[]),window.__debugLoggerContext.push({session:c.SessionId||"",workload:c.Workload||"",product:c.Product||"None"})),c}function d(){return n.e(39).then(n.bind(n,638))}function l(e){var t;try{return null===(t=null===window||void 0===window?void 0:window.sessionStorage)||void 0===t?void 0:t.getItem(e)}catch(e){return null}}var u=n(38),f={ODB:-990,ODC:"ForceEnableAria"},p=function(e){var t;return"true"===(null===(t=l(e))||void 0===t?void 0:t.toLowerCase())&&"undefined"!=typeof console&&!!console},m=function(){function e(e){var t=this;this._getOneDS=d,this._handlerDisposers=[],this.logEvent=function(e){Promise.all((0,a.g)([t._logger],t._updateContextPromises,!0)).then(function(n){var a=n[0],i=t._params,r=i.onLogEvent,o=i.shouldLogEvent;r&&(e=r(e)),o&&!o(e)||(a.logEvent(e),t._updateContextPromises=[])})},this._params=e;var n,i,r,o,m,_,h,b,g,v,y,S,D,I,x,C,O=c(e.context);this._loggerConfig=(0,a.a)({endpointUrl:e.context.oneDsCollectorUrl,isDebug:"true"===l("enableTelemetryDebug")||"true"===l("EnableConsoleTelemetryDebug"),disableTelemetry:(r=e.context,b=s.a.isActivated("B099672B-6B9E-4F3D-A376-12C2671C0F7A"),g=s.a.isActivated("CEFA0648-FD0C-4287-AF84-A3D92077DBD3"),v=s.a.isActivated("FE9CEDDB-EF22-4A2D-AE69-97B16F63912C"),y=g?"dev"===(null==r?void 0:r.version):!!(null===(o=null===window||void 0===window?void 0:window._spModuleLink)||void 0===o?void 0:o.usingRedirectCookie),S=!b&&"onebox"===(null==r?void 0:r.env2),D=p("_isRunningTABTest"),I=/[?&]debug=true/.test((null===(m=null===window||void 0===window?void 0:window.location)||void 0===m?void 0:m.href)||""),x=!!l("spfx-debug"),C=!v&&/[?&]alTest=/.test((null===(_=null===window||void 0===window?void 0:window.location)||void 0===_?void 0:_.href)||""),!(!(y||D||I||x||S||C)||(h=s.a.isActivated("B099672B-6B9E-4F3D-A376-12C2671C0F7A"),p("enableTelemetryUpload")||p("enableAriaUpload")||!h&&u.c.isFeatureEnabled(f)))),enableStorageChannel:!!e.offlineDetection,propertyConfiguration:{scrubIpOnly:!0},enablePrivacyGuard:(n=e.tenantToken,i=s.a.isActivated("FAE1CF3A-D031-498D-9CDE-EA1151B19F0F"),("3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977"===n||"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189"===n||"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718"===n)&&!i)},e.loggerConfig),this._logger=this._getOneDS().then(function(n){return new n._OneDSLogger(e.tenantToken,O,t._loggerConfig)}),this._initOfflineDetection(),this._updateContextPromises=[]}return e.prototype.updateContext=function(e){var t=c(e);this._updateContextPromises.push(this._logger.then(function(e){e.updateContext(t)}))},e.prototype.flush=function(){return this._logger.then(function(e){e.flush()})},e.prototype.attach=function(e){var t=this.logEvent;e.addLogHandler(t).forEach(t);var n=function(){e.removeLogHandler(t)};return this._handlerDisposers.push(n),n},e.prototype.dispose=function(){this._handlerDisposers.forEach(function(e){return e()}),this._handlerDisposers=[]},e.prototype._initOfflineDetection=function(){var e=this._params.offlineDetection;e&&this._logger.then(function(t){t.setOffline(e.offline),e.onChange(function(e){t.setOffline(e)})})},e}()}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(194);function i(e,t){return!e&&!t||(0,a.a)(e)===(0,a.a)(t)}}
,,,function(e,t,n){n.d(t,{a:function(){return S}});var a=n(0),i=n(14),r=n(532),o=n(123),s=n(68),c=n(47),d=n(234),l=n(156),u=n(83),f=n(126),p=n(222),m=n(533),_=n(38),h=n(3),b=n(142),g=window&&window.performance,v={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},y="Bearer",S=function(){function e(e,t){this._sendUrlToGetFormDigestKSActive=h.a.isActivated("2F2E0E27-606F-4542-90E2-56D10E78DC5B","03/24/2023","send url to getFormDigest"),this._sendSyncClientHeadersKs=h.b.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,s=t.apiEvent,c=void 0===s?o.a:s,d=t.cookieOrigin,l=t.isOffline,u=t.dataSyncClient;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=c,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._urlDataSource=r,this._cookieOrigin=d,this._isOffline=l,this._dataSyncClient=u,this._encodingFixEnabled=!h.b.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!_.c.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._driveIdUrlCheckEnabled=!h.b.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(n){var _,S,I=e.headers,x=void 0===I?{}:I,C=e.driveUrl,O=e.driveId,w=e.apiName,E=e.disableLogging,A=void 0!==E&&E,L=e.timeout,k=e.onProgress,M=e.onUploadProgress,P=e.qosExtraData,T=e.apiVersion,U=void 0===T?"v2.0":T,F=e.needsAuthorization,H=void 0===F||F,R=e.postProcessQos,N=e.breakCache,B=e.allowCookies,j=e.hasContentType,V=void 0===j||j,z=e.useMultiPart,G=void 0!==z&&z,K=e.getErrorAsMessage,W=void 0!==K&&K,q=e.expectedErrors,Q=e.endpoint,Y=n.path,J=n.accessToken,X=n.forceContentType,Z=void 0!==X&&X,$=n.useExactAuthToken,ee=void 0!==$&&$,te=n.headers;if(!Q){var ne="v2.1"===U?U:void 0;Q=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:ne,driveId:O}):null===(S=(_=t._urlDataSource).getVroomApiBaseUrl)||void 0===S?void 0:S.call(_):void 0}if(t._driveIdUrlCheckEnabled&&C&&O&&("me"!==O?"".concat(Q,"/drives/").concat(O):C)!==C)throw new s.a({code:"DriveIdAndDriveUrlMismatch"});var ae=(0,a.a)((0,a.a)({},v),e.expectedErrorCodes||{}),ie=e.requestType,re=void 0===ie?"GET":ie,oe=t._cookieOrigin,se=new p.a(Y).authority?Y:"".concat(Q).concat(Y),ce=function(n){var s,_,v="",y={};G?(v=u.a.generate(),y={"Content-Type":"multipart/form-data;boundary=".concat(v)}):y=(0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&V||Z?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),W?{prefer:"rich-error-as-message"}:{}),h.a.isActivated("99EE4BC8-A7CF-47FA-9104-3CBB7479E126","01/10/2024","Killswitch to enable locale for accept language")?{}:{"Accept-Language":b.b.language}),x),t._sendSyncClientHeadersKs?{}:te),n.sessionToken&&n.sessionToken.tokenUrl&&0===Y.indexOf("/drive/")?_=new c.a("".concat(n.sessionToken.tokenUrl,"/").concat(Y.substring(7))):(_=new c.a(Y),Q&&!_.getScheme()&&(_=new c.a(Q+Y))),G&&(_.setQueryParameter("ump","1"),"POST"!==re&&(x["X-HTTP-Method-Override"]=re),re="POST");var S,D,I=_.toString();if(!G&&n.sessionToken){var C=n.sessionToken,O=C.accessToken,E=C.proofToken,T=C.wlidToken,U=C.isBadger;if(T)y=(0,a.a)((0,a.a)({},y),{Authorization:"wlid1.1 ".concat(T)});else{if(O){var F=U?"badger":"bearer",H=ee?O:"".concat(F," ").concat(O);y=(0,a.a)((0,a.a)({},y),{Authorization:H})}E&&(y=(0,a.a)((0,a.a)({},y),{"X-PROOF_TOKEN":E}))}}if(G){if(S="",S+="--".concat(v,"\r\n"),S+="Content-Disposition: form-data;name=data\r\n",x)for(var B=0,j=Object.keys(x);B<j.length;B++){var z=j[B];S+="".concat(z,": ").concat(x[z],"\r\n")}S+="Content-Type: application/json\r\n";var K=n.sessionToken||{};O=K.accessToken,U=K.isBadger,O&&(S+="Authorization: ".concat(F=U?"badger":"bearer"," ").concat(O,"\r\n")),W&&(S+="prefer: rich-error-as-message\r\n"),S+="\r\n",S+="".concat(void 0!==e.postData?e.postData:"","\r\n"),S+="--".concat(v,"--")}if(N&&_.setQueryParameter("r",Math.random().toFixed(8)),(null===(s=n.sessionToken)||void 0===s?void 0:s.authKey)&&_.setQueryParameter("authKey",n.sessionToken.authKey),!A){var J=new p.a(I),X={url:"".concat(J.authority,"/{ length: ").concat(J.path.length,", segments: ").concat(J.segments.length," }"),name:"".concat(t._apiName,"DataRequest.").concat(w),extraData:P};D=new t._apiEvent(X)}var $=_.toString(),ne=g&&g.now();return r.a.start({url:$,headers:y,method:re,json:S||e.postData||"",requestTimeoutInMS:L,withCredentials:n.useCookies,onProgress:k,onUploadProgress:M,responseType:e.responseType||void 0}).then(function(t){var n,a,i=(0,d.a)($,ne);if(D){var r=null!==(a=null===(n=t.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==a?a:"",s={resultType:o.b.Success,extraData:{rawRequestDuration:i.duration,performanceEntry:JSON.stringify(i),requestId:r.indexOf("sprequestguid:")>=0?t.getResponseHeader("sprequestguid"):r.indexOf("request-id:")>=0?t.getResponseHeader("request-id"):null,MSCorrelationVector:r.indexOf("ms-cv:")>=0?t.getResponseHeader("MS-CV"):null}};D.end(s)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var r,s,c=function(e,t){return R&&(e=R(e,t)),D&&D.end(e),i.c.reject(t)},u=(0,d.a)($,ne);if(e instanceof Error){var p=i.c.isCanceled(e),h=p?o.b.ExpectedFailure:o.b.Failure,b={error:e.message,resultCode:p?"Canceled":"",resultType:h,extraData:{rawRequestDuration:u.duration,performanceEntry:JSON.stringify(u)}};return c(b,e)}if(e.responseText)try{s=JSON.parse(e.responseText)}catch(e){}if(W)try{var g=null===(r=null==s?void 0:s.error)||void 0===r?void 0:r.message;if("string"==typeof g){var v=t._encodingFixEnabled?JSON.parse((0,m.a)(g)):JSON.parse(atob(g));s={error:v}}}catch(e){}var y=e.status,S=e.statusText,I=(s||{}).error,x=void 0===I?{}:I,C=x.message,O=void 0===C?"":C,w=x.innerError,E=void 0===w?{}:w,A=E.stackTrace,L=void 0===A?"":A,k=E.debugMessage,M=void 0===k?"":k;return(y||!t._isOffline?i.c.resolve(!1):t._isOffline()).then(function(t){var i,r,d,p=t?"Offline":"",m=null!==(r=null===(i=e.getAllResponseHeaders())||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"",h=m.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||m.indexOf("request-id")>=0&&e.getResponseHeader("request-id")||void 0,b=t||!!(0,l.b)(s,y,function(e){return ae[e]}),g=O;d="string"!=typeof g&&g.value?g.value:O;var v=new l.a(new Error(d||p),{response:s,status:y,request:e,correlationId:h,isExpected:b});q&&(0,f.isExpectedError)({code:v.code,message:O},q)&&(b=!0);var D={resultType:b?o.b.ExpectedFailure:o.b.Failure,error:O,resultCode:v.code,extraData:(0,a.a)((0,a.a)((0,a.a)({},P||{}),(0,l.c)(v)),{stack:L,httpStatus:y,httpStatusText:S,requestId:h,correlationId:h,MSCorrelationVector:m.indexOf("ms-cv:")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:M,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:_.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:u.duration,performanceEntry:JSON.stringify(u)})};return c(D,v)})})},de=t._sessionManagementProvider;if(H){if(J)return ce({sessionToken:J});var le=new p.a(se).authority;if(B&&le&&oe&&le===oe){if("GET"===re)return ce({useCookies:!0});if(de&&de.getFormDigest)return de.getFormDigest(t._sendUrlToGetFormDigestKSActive?void 0:se).then(function(e){return ce({digestValue:e,useCookies:!0})})}if(de&&de.getSessionToken){var ue={apiVersion:U,endpoint:Q,driveUrl:C,path:se};return i.c.resolve(de.getSessionToken(ue)).then(function(e){return ce({sessionToken:e}).catch(function(t){return de.getSessionToken&&e&&function(e){if(e instanceof l.a){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,y.length)===y&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?de.getSessionToken((0,a.a)((0,a.a)({},ue),{claimsChallenge:{sessionToken:e,claims:D(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?ce({sessionToken:n}):i.c.reject(t)}):i.c.reject(t)})})}if(de&&de.getToken)return de.getToken(U,se).then(function(e){return ce({sessionToken:e})})}return ce({})},_=(0,a.a)({},e);return!h.a.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,r=e.getData,o=function(){return r(n)};return i.c.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t,n){var i=(0,a.a)((0,a.a)({},e.options),{path:t.url,accessToken:{accessToken:t.authToken},forceContentType:!0,useExactAuthToken:!0,headers:n});return r(i)},o)}(t):o()})}({dataSyncClient:this._dataSyncClient,options:_,getData:n}):n(_)},e}();function D(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return h.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}}
,function(e,t,n){n.r(t),n.d(t,{Error:function(){return D},default:function(){return I}});var a=n(0),i=n(10),r=n(82),o=n(136),s=n(5),c=n(1),d=n(11),l=n(50),u=n(57),f=n(7);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-error-container{display:flex;padding:24px;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:';border-radius:12px}.od-Share-error-technicalDetails{font-size:.625rem;font-weight:600}.od-Share-error-icon{width:120px}.od-Share-error-icon .ms-Image-image{width:84px;height:84px}.od-Share-error-main{padding-left:16px;width:100%}.od-Share-error{padding:16px;font-size:.875rem;font-weight:400;word-break:break-word;outline:transparent;position:relative;margin-bottom:30px}.od-Share-error::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share-error:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-Share-error-copy{margin-top:10px}[dir=ltr] .od-Share-error-copy{float:right}[dir=rtl] .od-Share-error-copy{float:left}.od-Share-error-clear{clear:both;display:block}.od-Share-error-message{min-height:3.125rem}.od-Share-error-message.office{width:280px}.od-Share-error-message.new{width:284px}[dir=ltr] .od-Share-error-report{float:right}[dir=rtl] .od-Share-error-report{float:left}[dir=ltr] .od-Share-error-report{margin-right:5px}[dir=rtl] .od-Share-error-report{margin-left:5px}.od-Share-error-chevron{font-size:.625rem}[dir=ltr] .od-Share-error-chevron{margin-left:5px}[dir=rtl] .od-Share-error-chevron{margin-right:5px}.od-Share-error-content{width:284px}.od-Share-error-technical{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding:0 10px 10px 10px;margin-bottom:10px;word-wrap:break-word}[dir=rtl] .od-Share-error-technical{padding:0 10px 10px 10px}.od-Share-error-technical.updated{border-radius:4px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";padding:10px 10px 10px 10px;font-size:.625rem}[dir=rtl] .od-Share-error-technical.updated{padding:10px 10px 10px 10px}.od-Share-error-technical button.od-Share-error-copy{font-size:.875rem;padding:0 1rem;border-radius:.125rem;min-width:5rem;height:2rem}.od-Share-error-technical button.od-Share-error-copy.updated{padding:0;min-width:unset;height:inherit;font-size:.625rem}.od-Share-error-button{display:flex;justify-content:flex-end}.od-Share-error-message-paragraph{word-break:break-word}"}]);var p=n(12),m=n(44),_=n(51),h=n(24),b=n(20),g=n(55),v=n(17),y=window.require.toUrl("odsp-media/images/sharedialog/lightwarning.svg"),S=window.require.toUrl("odsp-media/images/sharedialog/darkwarning.svg"),D=function(e){function t(t,n){var a=e.call(this,t)||this;return a._errorMessage=(0,c.createRef)(),a._dismissComponent=function(e){e.stopPropagation(),e.preventDefault(),a._onDismiss()},a._onToggleDetailsClicked=function(){a.setState({areDetailsVisible:!a.state.areDetailsVisible})},a._onCopyToClipboardClicked=function(){var e,t=function(e,t){var n=document.createElement("input");n.setAttribute("type","text"),n.setAttribute("value",e),n.style.top="0",n.style.left="0",n.style.position="absolute",n.style.opacity="0",document.body.appendChild(n);var a=!1;try{n.focus(),n.select(),a=document.execCommand("copy")}catch(e){}if(!a&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(n.value),a=!0}catch(e){}return document.body.removeChild(n),a}((null===(e=a.props.sharingInformation)||void 0===e?void 0:e.debugErrorMessage)||"");h.ub()||(a.setState({isCopied:t}),setTimeout(function(){a.setState({isCopied:!1})},3e3))},a.getErrorHeaderTitle=function(){var e,t;return"geoLocInvalidRequest"===(null===(e=a.props.sharingInformation)||void 0===e?void 0:e.error)?d.qi:(null===(t=a.props.sharingInformation)||void 0===t?void 0:t.isStubFile)?d.Yi:d.$c},a._resize=n.resize,a.state={areDetailsVisible:!1,isErrorPageGotError:!1,isCopied:!1},a._onDismiss=n.onDismiss,a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){var e=this;this.context.sharingClientMessenger?this.context.sharingClientMessenger.sendShareReady():g.r(this.context.clickTime,this.props.clientId,this.props.mode),setTimeout(function(){e._resize()},0)},t.prototype.componentDidCatch=function(e,t){this.setState({isErrorPageGotError:!0})},t.prototype.componentDidUpdate=function(e,t){this._errorMessage.current&&this._errorMessage.current.focus(),this._resize()},t.prototype.render=function(){var e,t,n,a=(null===(e=this.props.sharingInformation)||void 0===e?void 0:e.errorMessage)||this.props.genericErrorMessage||"unknown Error";if(this.state.isErrorPageGotError)return c.createElement("div",null,a);h.ub();var r=this.props.showReportProblem?c.createElement("div",{className:"od-Share-error-report"},d.Jc):null,o=h.ub()?{root:{border:"none"}}:{root:{border:"none",padding:"0",fontSize:".75rem"}},s=this.state.areDetailsVisible?d.Yc:d.Xc,u=(null===(t=this.props.sharingInformation)||void 0===t?void 0:t.debugErrorMessage)?c.createElement(l.a,{onClick:this._onToggleDetailsClicked,tabIndex:0,"aria-label":s,styles:o},s,c.createElement(i.a,{iconName:this.state.areDetailsVisible?"ChevronUp":"ChevronDown",className:"od-Share-error-chevron"})):null;(null===(n=this.props.sharingInformation)||void 0===n?void 0:n.isStubFile)&&(a=d.Tj);var f={errorMessage:a,errorDetailsToggle:u,reportProblem:r,btnStyle:{label:{fontSize:"0.875rem"},root:{height:"2rem",padding:"0 1rem",borderRadius:"0.25rem"}}};return h.ub()?this._classicErrorDialog(f):this._updatedErrorDialog(f)},t.prototype._classicErrorDialog=function(e){var t,n,a,i,r,o,s,f=e.errorMessage,p=e.errorDetailsToggle,m=e.reportProblem,_=e.btnStyle,h=null===(n=null===(t=this.props.sharingInformation)||void 0===t?void 0:t.item)||void 0===n?void 0:n.name,g=(0,v.$)(h,22),y=this._getHeaderText(this.getErrorHeaderTitle(),g),S=this._getHeaderText(this.getErrorHeaderTitle(),h),D=g.length>22,I=this.state.areDetailsVisible&&(null===(a=this.props.sharingInformation)||void 0===a?void 0:a.debugErrorMessage)?c.createElement("div",{className:"od-Share-error-technical"},c.createElement("h4",null," ",d.Zc," "),c.createElement("div",null,null===(i=this.props.sharingInformation)||void 0===i?void 0:i.debugErrorMessage),c.createElement(l.a,{className:"od-Share-error-copy",onClick:this._onCopyToClipboardClicked},d.Qc),c.createElement("span",{className:"od-Share-error-clear"})):null;return c.createElement("div",{className:"od-ShareMain-section new",role:"alert",tabIndex:0,ref:this._errorMessage},this._renderHeader(y,S,D),c.createElement("div",{className:"od-Share-error-message ".concat(b.h(this.props.clientId)?"office":"")},c.createElement("p",null," ",f," "),(null===(r=this.props.sharingInformation)||void 0===r?void 0:r.fixItUrl)&&c.createElement("a",{href:null===(o=this.props.sharingInformation)||void 0===o?void 0:o.fixItUrl,target:"_blank",rel:"noreferrer"},d.wd),I),c.createElement("div",null,p,m),this._onDismiss&&!(null===(s=this.props.sharingInformation)||void 0===s?void 0:s.isStubFile)&&(0,b.p)(this.props.clientId)&&c.createElement("div",{className:"od-Share-error-button"},c.createElement(u.a,{onClick:this._dismissComponent,styles:_},d.Vb)))},t.prototype._updatedErrorDialog=function(e){var t,n,a,i,s,l=e.errorMessage,u=e.errorDetailsToggle,f=e.reportProblem,p=d.Gj,m=this.state.areDetailsVisible&&(null===(t=this.props.sharingInformation)||void 0===t?void 0:t.debugErrorMessage)?c.createElement("div",{className:"od-Share-error-technical updated"},c.createElement("div",{className:"od-Share-error-technicalDetails"}," ",d.Zc," "),c.createElement("div",null,null===(n=this.props.sharingInformation)||void 0===n?void 0:n.debugErrorMessage),c.createElement(r.a,{className:"od-Share-error-copy updated",onClick:this._onCopyToClipboardClicked},this.state.isCopied?d.$b:d.Qc),c.createElement("span",{className:"od-Share-error-clear"})):null,_=this.props.theme,h=(null==_?void 0:_.isInverted)||g.i()||(null===(a=this.props.hostOptions)||void 0===a?void 0:a.isDarkMode)?S:y;return c.createElement("div",{className:"od-Share-error-container",role:"alert",tabIndex:0,ref:this._errorMessage},c.createElement(o.a,{className:"od-Share-error-icon",src:h}),c.createElement("div",{className:"od-Share-error-main"},this._renderHeader(p,"",!1),c.createElement("div",{className:"od-Share-error-content"},c.createElement("div",{className:"od-Share-error-message new ".concat(b.h(this.props.clientId)?"office":"")},c.createElement("p",{className:"od-Share-error-message-paragraph"}," ",l," ")),c.createElement("div",null,u,f),(null===(i=this.props.sharingInformation)||void 0===i?void 0:i.fixItUrl)&&c.createElement("a",{href:null===(s=this.props.sharingInformation)||void 0===s?void 0:s.fixItUrl,target:"_blank",rel:"noreferrer"},d.wd),m)))},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:b.p(this.props.clientId))&&c.createElement(m.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:d.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a._onDismiss()},tooltipContent:d.Vb,directionalHint:s.a.bottomAutoEdge})},t.prototype._getHeaderText=function(e,t){return(0,f.j)(e,t)},t.prototype._renderHeader=function(e,t,n){return c.createElement(_.a,{actions:this._getHeaderActions(),mainHeaderText:e,fullHeaderText:t,isFilenameTruncated:n})},t.contextTypes={resize:p.func.isRequired,onDismiss:p.func,shareClickTime:p.number,sharingClientMessenger:p.object},t}(c.Component),I=D}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(214);function r(e,t,n){var r="",o=!0;for(var s in t&&(e=(0,a.a)((0,a.a)({},t),e)),e){var c,d=e[s];if(!n||"object"!=typeof d&&d||"object"==typeof d&&d&&d.uriValue||"number"==typeof d||"boolean"==typeof d)o?o=!1:r+="&",c="object"==typeof d&&d&&d.uriValue?d.uriValue:(0,i.b)("".concat(d)),r+="".concat(s,"=").concat(c)}return r}}
,function(e,t,n){n.r(t),n.d(t,{GraftOperationType:function(){return i},backup:function(){return s},default:function(){return d},optional:function(){return o},remove:function(){return r},replace:function(){return c}});var a=n(0),i={none:0,replace:1,optional:2,remove:3,backup:4};function r(){return{graftOperationType:i.remove}}function o(e){return{graftOperationType:i.optional,value:e}}function s(e){return{graftOperationType:i.backup,value:e}}function c(e){return{graftOperationType:i.replace,value:e}}function d(e,t){if(!l(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!l(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],s=t[o],c=e[o];if(s!==c){var _=s;if(p(_))if(_.graftOperationType===i.replace)c=void 0,s=h=_.value;else if(_.graftOperationType===i.backup){var h=_.value;if(void 0!==e[o])continue;s=h}else{if(_.graftOperationType!==i.optional){if(m(_)){delete e[o];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(h=_.value))continue;s=h}var b=void 0;if(u(s))b=new Date(s.getTime());else if(f(s)){var g=c;f(g)||(g=[]),g.splice.apply(g,(0,a.g)([0,g.length],s,!1)),b=g}else if(l(s)){var v=c;l(v)||(v={}),d(v,s),b=v}else b=s;e[o]=b}}return e}function l(e){return"object"==typeof e&&!!e}function u(e){return e instanceof Date}function f(e){return Array.isArray(e)}function p(e){return l(e)&&!!e.graftOperationType}function m(e){return e.graftOperationType===i.remove}}
,function(e,t,n){n.d(t,{a:function(){return v},b:function(){return g},c:function(){return b},d:function(){return y}});var a=n(45),i=n(3),r=n(52),o=n(26),s=(0,r.a)({eventName:"ExperimentFlight,",shortEventName:"ExperimentFlight"},{experimentId:{isPrefixingDisabled:!0,type:o.a.Number},variant:{isPrefixingDisabled:!0,type:o.a.Number},isAATest:{isPrefixingDisabled:!0,type:o.a.Boolean},isOverride:{isPrefixingDisabled:!0,type:o.a.Boolean},isLoggedAtExposure:{isPrefixingDisabled:!0,type:o.a.Boolean},serverTime:{isPrefixingDisabled:!0,type:o.a.String}});function c(e){var t=e.charCodeAt(0);return t>=65&&t<=90?t-65:t>=97&&t<=122?t-71:t>=48&&t<=57?t+4:43===t?62:63}function d(e,t){var n=t.toString(36);n=Array(4-n.length).join("0")+n;for(var a=0;a<e.length;a++)for(var i=0;i<e[a].length-2;i+=3)if(e[a].substring(i,i+3)===n)return a+4;return 0}function l(e,t){if(t>Math.floor(3*e.length/2)-1)return 0;var n=Math.floor(t/3*2);switch(t%3){case 0:return c(e[n])>>2;case 1:return(3&c(e[n]))<<2|c(e[n+1])>>4;case 2:return 15&c(e[n])}return 0}var u=n(650),f=9e4,p="experimentLogCacheTime",m="experimentLogCache",_=!i.a.isActivated("4F6F5B50-178E-40E9-B992-A49FC5B41195"),h=function(){function e(e,t,n){var i;if(this._isAATest=!1,this._isOverride=!1,this._serverTime="",this._shouldLogVariantPropertyAccess=!1,this._loggedPropertyAccess=!1,this._loggedExposure=!1,this._variantToDisplay=0,this._experimentId=e,this._shouldLogVariantPropertyAccess=n,this._serverTime=null!==(i=null==t?void 0:t.serverTime)&&void 0!==i?i:"",_)for(var r=0,o=u.b.experimentOverrides;r<o.length;r++){var s=o[r];if(s[0]===e)return void this._setProperties(s[1],s[1],!1,!0)}else if(window&&window.location&&window.location.search){var c=(0,a.a)(window.location.search.substr(1))[u.a];if(c){var p=void 0;try{p=JSON.parse(c)}catch(e){p=[]}for(var m=0,h=p;m<h.length;m++){var b=h[m];if(b&&2===b.length&&b[0]===e)return void this._setProperties(b[1],b[1],!1,!0)}}}if(!t||void 0===t.experimentData||void 0===t.experimentDataLookup||void 0===t.serverTime||this._experimentId<f)return this._variantToDisplay=0,void(this._variantToLog=void 0);var g=e-f,v=l(t.experimentData,g);if(0===v)this._setProperties(0,void 0,!1,!1);else if(v>=1&&v<=4)this._setProperties(v-1,v-1,!1,!1);else if(5===v){var y=d(t.experimentDataLookup,g);this._setProperties(y,y,!1,!1)}else v>=6&&v<=9?this._setProperties(0,v-6,!0,!1):10===v?this._setProperties(0,d(t.experimentDataLookup,g),!0,!1):v>=11&&v<=14?this._setProperties(v-11,v-11,!1,!0):(y=d(t.experimentDataLookup,g),this._setProperties(y,y,!1,!0));this._saveExperiments()}return Object.defineProperty(e.prototype,"variantToDisplay",{get:function(){return this._shouldLogVariantPropertyAccess&&this._logInternal(!1),this._variantToDisplay},enumerable:!1,configurable:!0}),e.getExperimentTags=function(e){if(void 0===e.experimentData||void 0===e.experimentDataLookup||void 0===e.serverTime)return[];for(var t=[],n=f;n<=90499;n++){var a=n-f,i=l(e.experimentData,a),r=void 0;if(0!==i){if(i>=1&&i<=4)r=(i-1).toString();else{if(5!==i)continue;r=d(e.experimentDataLookup,a).toString()}if(void 0!==r){var o="".concat(n.toString(),"-").concat(r);-1===t.indexOf(o)&&t.push(o)}}}return t},e._getItemFromSessionStorageNoThrow=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}},e._setItemInSessionStorageNoThrow=function(e,t){try{sessionStorage.setItem(e,t)}catch(e){}},e.prototype.logExposure=function(){this._logInternal(!0)},e.prototype._saveExperiments=function(){window.ODSP_EXPERIMENTS=window.ODSP_EXPERIMENTS||{},window.ODSP_EXPERIMENTS[this._experimentId]=this},e.prototype._logInternal=function(t){var n=void 0!==this._variantToLog&&(t&&!this._loggedExposure||!t&&!this._loggedPropertyAccess),a=null,i=null;if(n&&(a=e._getItemFromSessionStorageNoThrow(p),i=e._getItemFromSessionStorageNoThrow(m),n=a!==this._serverTime||!i||-1===i.indexOf(this._experimentId.toString()+t)),n&&void 0!==this._variantToLog){var r={experimentId:this._experimentId,variant:this._variantToLog,isAATest:this._isAATest,isOverride:this._isOverride,isLoggedAtExposure:t,serverTime:this._serverTime};s.logData(r),t?this._loggedExposure=!0:this._loggedPropertyAccess=!0,a===this._serverTime?e._setItemInSessionStorageNoThrow(m,(null!=i?i:"")+this._experimentId.toString()+t):(e._setItemInSessionStorageNoThrow(p,this._serverTime),e._setItemInSessionStorageNoThrow(m,this._experimentId.toString()+t))}},e.prototype._setProperties=function(e,t,n,a){this._variantToDisplay=e,this._variantToLog=t,this._isAATest=n,this._isOverride=a},e}();function b(e,t){var n=new h(e,t,!1);return n.logExposure(),n.variantToDisplay}function g(e,t){return new h(e,t,!0)}function v(e,t){return new h(e,t,!1).variantToDisplay}function y(e){if(!e)return!1;if(!window.ODSP_EXPERIMENT_TAGS||0===window.ODSP_EXPERIMENT_TAGS.length){var t=h.getExperimentTags(e);if(0===t.length)return!1;window.ODSP_EXPERIMENT_TAGS=t}return!0}}
,function(e,t,n){n.r(t),n.d(t,{ShareNotification:function(){return C},default:function(){return O}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareNotification{text-align:inherit;position:inherit;display:inherit;align-items:inherit;flex-direction:inherit}.od-ShareNotification-successPadding{padding-top:4px}.od-ShareNotification-failPadding{padding-top:50px}[dir=ltr] .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:left}[dir=rtl] .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:right}[dir=ltr] .od-ShareNotification-failPadding .ms-TextField{margin-right:8px}[dir=rtl] .od-ShareNotification-failPadding .ms-TextField{margin-left:8px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;transform:translateX(-50%) scale(.5,.5);transform-origin:50% 50%;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.3125rem;border-radius:50%;width:2.75rem;height:2.75rem;animation:bounce .45s;animation-fill-mode:both;display:flex;align-items:center;justify-content:center;margin-left:2.75rem;background-color:"},{theme:"shareSuccessIcon",defaultValue:"#498205"},{rawString:"}.od-ShareNotification-content{padding:0;width:100%}.od-ShareNotification-content .ms-font-l{font-weight:500;font-size:1.25rem}.od-ShareNotification-section{padding:24px}.od-ShareNotification-section.copy{padding-top:0}.od-ShareNotification-content-tooltip{margin:5px;word-wrap:break-word}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{display:flex;padding:0}.od-ShareNotification-urlText .ms-TextField{padding-right:4px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:"}[dir=ltr] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir=rtl] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:2rem}.od-ShareNotification-close{position:absolute;top:16px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.75rem;width:.75rem;height:.75rem;cursor:pointer}[dir=ltr] .od-ShareNotification-close{right:12px}[dir=rtl] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{padding:0;width:90%;margin-top:0}@keyframes bounce{0%{transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;animation-timing-function:ease-out}100%{transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:0;padding:6px;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareNotification .od-ShareHint.new{padding:0}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:.75rem}.od-ShareNotification-copyButton{height:2rem;min-width:-moz-fit-content;min-width:fit-content;width:auto;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:"}[dir=ltr] .teams .od-ShareNotification-copyButton{margin-left:5px}[dir=rtl] .teams .od-ShareNotification-copyButton{margin-right:5px}.od-ShareNotification-urlTextField{width:100%;font-size:.875rem}.od-ShareNotification-accessRequestIcon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:1.25rem;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 8px 24px 8px;text-align:left}.od-ShareNotification-SharedWith{align-self:stretch;display:flex;flex-direction:column;padding:0}.od-ShareNotification-SharedWith .od-SharedWith-List>:not(:last-child){margin-right:4px}"}]);var i=n(51),r=n(95),o=n(539),s=n(236),c=n(99),d=n(1),l=n(12),u=n(7),f=n(17),p=n(50),m=n(5),_=n(10),h=n(11),b=n(20),g=n(237),v=n(176),y=n(651),S=n(44),D=n(42),I=n(545),x={root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}},C=function(e){function t(t,n){var i=e.call(this,t)||this;return i._isSucceed=function(e){return e===r.a.share||e===r.a.moreApps||e===r.a.copy&&i.state.successfullyCopied},i._copySharingLinkToClipboard=function(){return(0,a.b)(i,void 0,void 0,function(){var e,t=this;return(0,a.e)(this,function(n){return e={clientId:this.props.clientId,textField:this._textField,linkUrl:this.props.linkUrl,itemName:this.props.itemName,extraQosData:this.props.engagementExtraData},f.l(e).then(function(e){t.setState((0,a.a)((0,a.a)({},t.state),{successfullyCopied:e}))}),[2]})})},i.state={successfullyCopied:!1,isNameTooltipVisible:!1},i._resize=n.resize,i._sharingStore=n.sharingStore,i._platformDetection=n.platformDetection,i._loadFloodgateDataSource=n.loadFloodgateDataSource,i}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this._platformDetection,n=t.isEdge,a=t.isIE,i=this.props.shareType===r.a.copy&&this.props.shouldCopyLinkToClipboard,o=a&&!b.o(this.props.clientId);i&&!o&&this._copySharingLinkToClipboard(),(n||o)&&setTimeout(function(){e._textField.focus()},500),this.props.onRenderComplete&&this.props.onRenderComplete()},t.prototype.componentDidUpdate=function(){this._loadFloodgateDataSource&&this._isSucceed(this.props.shareType)&&this._loadFloodgateDataSource("ShareNotification").then(function(e){e&&e.recordUserAction("ShareComplete","logData")}),this._resize()},t.prototype.render=function(){var e=this,t=this._getNotificationLabel(),n=(this._getNotificationLabel(!0),this._getNotificationAriaLabel()),a=this.props.shareType===r.a.copy,i=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),o=this.props.generatedFromTargetClick?"assertive":"off";if(i)return d.createElement("div",{className:"od-ShareNotification"},this._renderHeader(""),d.createElement("div",{className:"od-ShareNotification-content ms-font-su"},d.createElement(_.a,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon",styles:x}),d.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},h.h),d.createElement("div",{className:"od-ShareNotification-accessRequestBody"},h.g)));var s=[],l=null;a&&(s.push(d.createElement("div",{className:"od-ShareNotification-urlText"},d.createElement(c.a,{autoFocus:!0,"aria-live":"polite",ariaLabel:n,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",value:this.props.linkUrl,className:"od-ShareNotification-urlTextField",styles:{field:{fontSize:"0.875rem"}}}),d.createElement(p.a,{className:"od-ShareNotification-copyButton",text:h.ec,onClick:this._copySharingLinkToClipboard,styles:{label:{fontSize:"0.875rem"},root:{padding:"0px 1rem"}}}))),this.props.sharingHintProps&&s.push(this._renderShareHint()));var u=this._renderSharedWith();return u&&s.push(u),this.props.shouldWaitForSharingInfoBarInformation&&s.push(this._renderSharingInfoBar()),s.length&&(l=d.createElement(d.Fragment,null,!a&&d.createElement(v.a,null),d.createElement("div",{className:"od-ShareNotification-section"+(a?" copy":"")},s))),d.createElement("div",{className:"od-ShareNotification","aria-live":o},d.createElement("div",{className:"od-ShareNotification-content"},d.createElement("div",{className:"od-ShareNotification-section"},this._renderHeader(t)),l))},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:b.p(this.props.clientId))&&d.createElement(S.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:h.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a.context.onDismiss()},tooltipContent:h.Vb,directionalHint:m.a.bottomAutoEdge})},t.prototype._renderHeader=function(e){return d.createElement(i.a,{actions:this._getHeaderActions(),mainHeaderText:e})},t.prototype._renderSharingInfoBar=function(){return d.createElement(d.Suspense,{fallback:d.createElement(D.a,null)},d.createElement(y.c,{sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId,parentCssClass:"ShareNotification"}))},t.prototype._renderSharedWith=function(){if(this.props.sharingHintProps&&this.props.sharingHintProps.linkRecipients){var e=this.props.sharingHintProps.linkRecipients.map(function(e){return{email:e.email,loginName:e.email,primaryText:e.name,type:e.principalType,imageUrl:e.image,id:e.userId}});if(e&&e.length)return d.createElement("div",{className:"od-ShareNotification-SharedWith"},d.createElement(s.a,{label:h.Ui,getPhotoUrl:(0,g.b)(this.props.webUrl),sharingLinks:[],sharingPrincipals:e,isNotification:!0}))}return null},t.prototype._renderShareHint=function(){var e=this.props.sharingHintProps;return d.createElement("div",{className:"od-ShareNotification-footer"},d.createElement(o.a,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,linkRecipients:e.linkRecipients,customLabeledAudienceConfig:e.customLabeledAudienceConfig}))},t.prototype._getNotificationLabel=function(e){var t=e?this.props.itemName:f.eb(this.props.itemName),n=this.props.shareType,a=u.j(h.sf,t),i={sharingStore:this._sharingStore,fallback:a},o=(0,I.a)(i),s=t?u.j(h.df,t):h.cf,c=t?u.j(h.uf,t):h.lf;return n===r.a.copy?this.state.successfullyCopied?o:s:n===r.a.share?c:n===r.a.moreApps?s:""},t.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===r.a.copy?this.state.successfullyCopied?h.of:h.cf:e===r.a.share?h.lf:e===r.a.moreApps?h.cf:""},t.contextTypes={resize:l.func.isRequired,sharingStore:l.object.isRequired,platformDetection:l.object.isRequired,loadFloodgateDataSource:l.func,onDismiss:l.func.isRequired},t}(d.Component),O=C}
,function(e,t,n){n.d(t,{a:function(){return f}});var a=n(0),i=n(41),r=n(3),o=n(570),s=n(7),c=n(569);function d(e,t){var n=t.Session,i=t.Version,r=t.OSName,o=t.OSVersion,d=t.Market,l=t.UserId,u=t.Manifest,f=(0,a.f)(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),p=e.getSemanticContext();if(n&&e.setContext("AppInfo.Session",n),u&&e.setContext("AppInfo.Manifest",u),i&&p.setAppVersion(i),p.setUserLanguage(d||""),l){var m=(0,c.a)(l);p.setUserId(m)}for(var _ in r&&p.setDeviceOsName(r),o&&p.setDeviceOsVersion(o),f)if(Object.prototype.hasOwnProperty.call(f,_)){if(null==f[_])continue;var h=(0,s.a)(_);e.setContext(h,f[_])}}var l=n(126),u=n(654),f=function(){function e(e){var t=this;this.logEvent=function(e){var n=t._onLogEvent?t._onLogEvent(e):e;t._createLogHandler().then(function(e){return e(n)})},this._getAria=p(function(){return e.ariaLoader().then(function(t){return function(e,t){e.LogManager.isInitialized()||(e.LogManager.initialize(t.tenantToken,(0,a.a)((0,a.a)({disableCookies:t.disableCookies},t.offlineCache?{browserOverrides:{onGetData:t.offlineCache.getData,onSaveData:t.offlineCache.saveData}}:{}),t.ariaLogConfiguration||{})),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(){e.LogManager.flush()})),e.LogManager.addCallbackListener(function(e,n,a,i){a===t.tenantToken&&t.ariaQos&&t.ariaQos.reportQos({result:e,statusCode:n,events:i})})}(t,e),t})}),this._getLogger=p(function(){return t._getAria().then(function(a){var i=function(e,t,n){void 0===n&&(n={});var a=new e.Logger(t);return d(a,n),a}(a,e.tenantToken,e.context),r=e.offlineDetection;return u.a&&r?n.e(40).then(n.bind(n,639)).then(function(n){return t._offlineEventQueue=n.makeOfflineAriaEventQueue(i,e.tenantToken,r),[i,a]}):Promise.resolve([i,a])})}),this._createLogHandler=p(function(){return t._getLogger().then(function(n){var a=n[0],s=function(e,t,n,a,s){return void 0===n&&(n=!0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),function(c){try{if((c.eventType!==i.b.Start||n)&&(!a||!a.isQosEvent(c))){var d=function(e,t,n){var a,i=(0,o.a)(t),s=i.name,c=i.values,d=new e.EventProperties;return d.name=s,r.b.isActivated("2657d5a5-7313-42a0-ab20-287781f44d1b")||("AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"===(a=c.Name)||"SPO.DashboardWebPart.Load"===a||"AdaptiveCardExtension.CardAction"===a||"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"===a||"TeamsSiteHeader.RefreshButtonClicked"===a||"TeamsSiteHeader.CopyLinkButtonClicked.successful"===a||"TeamsSiteHeader.GoToBrowserButtonClicked"===a)&&(d.eventType="VivaAnalytics"),function(e,t,n,a){var i;try{for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i=r,t.setProperty(r,n[r]))}catch(t){var o=void 0,s=void 0;throw t instanceof e.Exception&&(o=t.ErrorCode(),s=new Error("Aria error: ".concat(t.toString()))),s&&(t.handled=!0,a&&a.logError(s,{errorCode:o,propertyKey:i})),t}}(e,d,c,n),d}(e,c,l);u.a&&(null==s?void 0:s.storeEventIfNecessary(d))||t.logEvent(d)}}catch(t){var f=void 0;t instanceof e.Exception&&(f=new Error("Aria error: ".concat(t.toString()))),t&&t.handled||l.log(f||t)}}}(n[1],a,e.logStartEvents,e.ariaQos,t._offlineEventQueue);return s})}),this._onLogEvent=e.onLogEvent}return e.prototype.attach=function(e){this._createLogHandler();var t=this.logEvent;return e.addLogHandler(t).forEach(t),function(){return e.removeLogHandler(t)}},e.prototype.updateContext=function(e){this._getLogger().then(function(t){return d(t[0],e)})},e.prototype.flush=function(){return this._getAria().then(function(e){e.LogManager.flush()})},e}();function p(e){var t=void 0;return function(){return t||(t=e()),t}}}
,,,function(e,t,n){function a(e){var t=[];return"object"!=typeof e?e:function e(n){var a=null;return n&&(a=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n)),Object.keys(n).forEach(function(i){var r=n[i];if("object"==typeof r){if(-1!==t.indexOf(r))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: ".concat(n,", ")+"property: ".concat(i));t.push(r),a[i]=e(r),t.pop()}else a[i]=r})),a}(e)}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=function(){var e,t;this.promise=new Promise(function(n,a){e=n,t=a}),this.resolve=e,this.reject=t}}
,function(e,t,n){var a=n(90),i=n(6),r=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this.resources,r=void 0===n?t.resources?new i.c(t.resources):e.resources:n;this.resources=r,this._Component_scope=new a.a}return Object.defineProperty(e.prototype,"scope",{get:function(){return this._Component_scope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._Component_scope.dispose()},e.prototype.managed=function(e){return this.resources&&(e=this.resources.injected(e)),this.scope.attached(e)},e.prototype.child=function(e){var t;return t=e instanceof i.b?this.resources.consume(e):this.resources?this.resources.injected(e,{injectChildResourceScope:!0}):e,this.scope.attached(t)},e.dependencies={resources:i.f},e}();t.a=r}
,function(e,t,n){function a(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i}function i(e){return e&&(e=a(e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27"))),e}n.d(t,{a:function(){return i},b:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(1);function i(e){var t=a.useRef(e);t.current=e;var n=a.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.current;return a.apply(null,e)})}}
,,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return l},c:function(){return p},d:function(){return u},e:function(){return f}});var a,i=n(0),r=n(476),o=n(18),s=n(11),c=n(164),d=n(501);function l(e,t,n,r){var o=e?(0,i.a)({},e):null,d=n;switch(t){case a.generic:case a.render:o.error=d.message,o.errorCategory=c.a.generic,o.errorMessage=s.Kj,o.rawError=n,o.debugErrorMessage=r?r.toString():(d.stack?d.stack:d.toString()).substring(0,1024);break;case a.api:if(!e){var l=c.b.generic,u=null==n?void 0:n.code,f=null==n?void 0:n.status,p=s.Md,m=JSON.stringify(n||{});u?u.indexOf("-2147024809")>-1&&m&&m.indexOf("Item does not exist")>-1&&(l=c.b.invalidItem):f&&parseInt(f,10)>=500&&(l=c.b.serverFailure),o={error:l,errorCategory:c.a.getSharingInformation,errorMessage:p,debugErrorMessage:m,rawError:n,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0}}}return o}function u(e){var t=e.customerPromise,n=e.rawErrorMessage,s=e.engagementExtraData,c=e.errorType,d=e.sharingStore;if(t){var l=n,u=(0,r.b)(l),f=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}(u.resultCode),p=window._sharingContextInfo,m={sharingContext:{clientId:p.clientId,scenarioId:p.scenarioId,listUrl:p.listUrl,serverRelativeItemUrl:p.serverRelativeItemUrl,resourceId:p.resourceId,webAbsoluteUrl:p.webAbsoluteUrl,listId:p.listId,listItemId:p.listItemId,uniqueId:p.uniqueId,correlationId:p.correlationId,hostSessionId:p.hostSessionId,userId:p.userId},url:location.href},_=u.resultType;(function(e){var t,n;if((null===(t=null==e?void 0:e.code)||void 0===t?void 0:t.indexOf("Microsoft.SharePoint.SPSharingResourceOverBudgetException"))>=0)return!0;if(503===(null==e?void 0:e.status)&&(null==e?void 0:e.retryAfter))return!0;if(-1===(null==e?void 0:e.status)&&(null===(n=null==e?void 0:e.code)||void 0===n?void 0:n.indexOf("NoConnection"))>=0)return!0;var a=null==e?void 0:e.message;if(a){if("string"!=typeof a&&(a=JSON.stringify(a)),a.indexOf("The invited user already exists in the directory")>=0)return!0;if(a.indexOf("This invitation is blocked by cross-tenant access settings.")>=0)return!0;if(a.indexOf("Creating multi-file sharing bundle is not supported.")>=0)return!0}return!1})(l)&&(_=o.b.ExpectedFailure),t.end({resultType:_,errorCode:f,extraData:(0,i.a)((0,i.a)((0,i.a)((0,i.a)({},null==d?void 0:d.getEngagementHelper().getEngagementExtraData()),s),u.extraData),{error:u.error,rawErrorMessage:n,errorType:c||a.generic,debuggingInfo:m})})}}function f(e){var t=e.customerPromise,n=e.engagementExtraData,a=e.sharingStore;t&&t.end({resultType:o.b.Success,extraData:(0,i.a)((0,i.a)({},null==a?void 0:a.getEngagementHelper().getEngagementExtraData()),n)})}function p(e){var t;return((t={})[d.a.SharingToBlockedUserOnODB]=s.Di,t[d.a.SharingToBlockedBySiteRAC]=s.Ii,t[d.a.ObjectNotSupported]=s.Qi,t)[e]||""}!function(e){e[e.render=0]="render",e[e.api=1]="api",e[e.generic=2]="generic"}(a||(a={}))}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.default=0]="default",e[e.shareShimmer=1]="shareShimmer",e[e.modifyPermissions=2]="modifyPermissions",e[e.permissionsList=3]="permissionsList",e[e.linkSuccess=4]="linkSuccess",e[e.grantPermissions=5]="grantPermissions",e[e.policyDetails=6]="policyDetails",e[e.error=7]="error",e[e.linkSettings=8]="linkSettings",e[e.notify=9]="notify",e[e.addPeople=10]="addPeople",e[e.linksFromTemplateList=12]="linksFromTemplateList",e[e.atMention=13]="atMention",e[e.spinner=14]="spinner",e[e.copyLinkShortcut=15]="copyLinkShortcut",e[e.permissionsPivot=16]="permissionsPivot",e[e.shareToTeams=17]="shareToTeams"}(a||(a={}))}
,function(e,t,n){function a(e){return e}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={none:1,pending:2,hasAccess:3}}
,function(e,t){var n;!function(e){e[e.none=0]="none",e[e.viewChange=1]="viewChange",e[e.inPageNavigation=2]="inPageNavigation",e[e.pageToPageNavigation=3]="pageToPageNavigation",e[e.fullPageLoad=4]="fullPageLoad",e[e.onePageAppNavigation=5]="onePageAppNavigation"}(n||(n={})),t.a=n}
,function(e,t,n){var a=n(113);t.a=a.a}
,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return r},c:function(){return a},d:function(){return d},e:function(){return c},f:function(){return o},g:function(){return i},h:function(){return l},i:function(){return u},j:function(){return f}});var a=6e4,i=2*a,r=60*a,o=2*r,s=24*r,c=2*s,d=32*s;function l(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<s}function u(e,t){return e.getFullYear()===t.getFullYear()}function f(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}}}
,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(113);function i(e,t,n){var i,r,o=n||window;if(!(o&&o.performance&&e&&t))return{duration:-1};try{var s=performance.getEntriesByType("resource");new a.a(e).authority||(e=(o.location&&new a.a(o.location.href).authority)+e);for(var c=void 0,d=s.length-1;d>=0;d--){var l=s[d];if(l.startTime<t)break;decodeURIComponent(l.name)===decodeURIComponent(e)&&(c=l)}return c?{connectEnd:(i=c).connectEnd,connectStart:i.connectStart,decodedBodySize:i.decodedBodySize,domainLookupend:i.domainLookupend,domainLookupStart:i.domainLookupStart,duration:void 0===(r=i.duration)?-1:r,encodedBodySize:i.encodedBodySize,fetchStart:i.fetchStart,nextHopProtocol:i.nextHopProtocol,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,secureConnectionStart:i.secureConnectionStart,startTime:i.startTime,transferSize:i.transferSize,workerStart:i.workerStart}:{duration:-1}}catch(e){return{duration:-1}}}}
,,function(e,t,n){n.d(t,{a:function(){return b}});var a=n(0),i=n(1);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharedWith{align-items:center;display:flex}.od-SharedWith .label{font-size:.875rem;font-weight:600;font:-apple-system-body;margin:0}[dir=ltr] .od-SharedWith .label{padding-right:4px}[dir=rtl] .od-SharedWith .label{padding-left:4px}.od-SharedWith-Facepile{display:flex;position:relative}.od-SharedWith-Facepile button.compact{height:auto;padding:2px;width:auto}.od-SharedWith-Facepile button.compact:hover{background-color:transparent}.od-SharedWith-Facepile li{display:flex}.od-SharedWith-List{display:flex}.od-SharedWith-List li{flex-shrink:0}.od-SharedWith-List:focus-visible{outline:1px solid}.od-SharedWith-Link--simplified{display:flex}.od-SharedWith-Link--simplified li{flex-shrink:0}.od-SharedWith-Link--simplified .ms-Button-flexContainer{align-items:flex-end}.od-SharedWith-Link--simplified,.od-SharedWith-More--simplified,.od-SharedWith-Persona--simplified{position:relative}.od-SharedWith-Link--simplified .ms-Button-flexContainer,.od-SharedWith-More--simplified .ms-Button-flexContainer,.od-SharedWith-Persona--simplified .ms-Button-flexContainer{align-items:center}.od-SharedWith-Link--simplified .ms-Image,.od-SharedWith-More--simplified .ms-Image,.od-SharedWith-Persona--simplified .ms-Image{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-SharedWith-Persona--simplified .ms-Persona-initials{position:relative;top:2px;right:-2px}.od-SharedWith-More--simplified .ms-Persona-initials{border:2px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.od-SharedWith-More--simplified .ms-Persona-initials{box-sizing:unset;color:WindowText}}.od-SharedWith-Persona{display:flex;position:relative}.od-SharedWith-Persona-measure{left:0;position:absolute;visibility:hidden}.od-SharedWith-Persona .od-SharedWith-Persona-measure{margin-left:0}.od-SharedWith-Link .ms-Persona-initials{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharedWith-Link .ms-Persona-initials i{font-weight:400}@media screen and (-ms-high-contrast:active){.od-SharedWith-Link .ms-Persona-initials{color:WindowText}}.od-SharedWith-More .ms-Persona-initials{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-SharedWith-More .ms-Persona-initials{color:WindowText}}.ms-Tooltip-subtext{font-size:.75rem}@supports (font:-apple-system-body){.ms-Tooltip-subtext{font:-apple-system-body}}.od-SharedWith-facepile-button{width:100%!important;height:auto}.od-SharedWith-facepile-button:hover{background-color:transparent!important}.od-SharedWith-facepile-button:active{background-color:transparent!important}.od-SharedWith-facepile-button:focus{outline:unset!important}.od-SharedWith-facepile-padding{padding:2px}"}]);var r=n(72),o=n(11),s=n(7),c=n(122),d=n(27),l=n(5),u=n(43),f=n(10),p=n(78),m=n(28),_=n(17),h=n(12);function b(e,t){var n=e.ariaLabel,a=e.label,u=e.getPhotoUrl,f=e.onClick,p=e.isDiscoverable,h=e.isAccessRequest,b=e.isNotification,v=e.sharingPrincipals,S=e.sharingLinks,D=e.personaSizeInPixels,I=void 0===D?24:D,x=e.renderOverlap,C=(0,_._)(t.clientId,t.sharingStore)||(0,_.Z)(t.clientId,t.sharingStore),O=i.useRef(null),w=i.useRef(null),E=i.useRef(null),A=i.useRef(null),L=i.useState(!0),k=L[0],M=L[1],P=i.useState(0),T=P[0],U=P[1],F=i.useRef(0),H=i.useRef(0),R=i.useMemo(function(){var e=[],a={},c=0;if(S.length)for(var d=0,l=S;d<l.length;d++){var p=l[d];if(p.principals.length||p.invitees.length){for(var m=0,h=p.principals;m<h.length;m++)a[(P=h[m]).loginName||P.email]=P;var b=new Date(p.expiration);if(p.isActive&&(!p.expiration||b.getTime()>Date.now()))for(var D=0,O=p.invitees;D<O.length;D++)a[(P=O[D]).loginName||P.email]=P}c++}for(var w=0,E=v;w<E.length;w++)a[(P=E[w]).loginName||P.email]=P;if(F.current=y(a,r.a.user),H.current=y(a,r.a.securityGroup,r.a.sharePointGroup),c&&!C){var A=1===c?o.Ri:(0,s.j)(o.Hi,c),L=A+(n?", "+n:"");e.push(i.createElement(g,{ariaLabel:L,className:"".concat(C&&x?"od-SharedWith-Link--simplified":"od-SharedWith-Link"),iconName:"Link",key:".link",onClick:f,title:A,personaSizeInPixels:I,renderOverlap:x}))}for(var k=0,M=Object.keys(a);k<M.length;k++){var P,T=M[k],U=void 0;U=(P=a[T]).imageUrl?P.imageUrl:P.type===r.a.user&&u?u(T):void 0,(0,_.X)(U,t.clientId)&&(U=void 0);var R=P.primaryText+(n?", "+n:""),N=P.email&&P.email!==P.primaryText?"".concat(P.primaryText," <").concat(P.email,">"):P.primaryText;e.push(i.createElement(g,{ariaLabel:R,imageUrl:U,className:"".concat(C&&x?"od-SharedWith-Persona--simplified":""),key:P.primaryText,onClick:f,text:P.primaryText,title:N,personaSizeInPixels:I,renderOverlap:x}))}return e},[v,S]);i.useEffect(function(){return O.current=new IntersectionObserver(G,{root:A.current,threshold:1}),function(){return O.current.disconnect()}},[]),i.useEffect(function(){if(O.current&&w.current){for(var e=[],n=0;n<w.current.children.length;n++){var a=w.current.children[n];O.current.observe(a),e.push(a)}return function(){for(var n,a=0,i=e;a<i.length;a++){var r=i[a];O.current.unobserve(r)}null===(n=t.resize)||void 0===n||n.call(t)}}});var N=b?function(e,t,n,a){var i="",c="";if(1===t)i=o.bj;else if(t>1)i=s.j(o.He,t);else if(e>0&&e<=3)for(var d=0;d<n.length;d++)n[d].type===r.a.user&&(c+="".concat(n[d].primaryText)),e>=2&&(d===n.length-2?c+=s.j(o.J):d<n.length-2&&(c+=", "));else e>3?c=s.j(o.Ne,e):1===e&&(c=o.vj);return 0!==t&&(e>1?c=s.j(o.Ne,e):1===e&&(c=o.vj)),s.j(a?o.Zh:o.ji,c,t>0&&e>0?o.J:"",i)}(F.current,H.current,v,h):function(e,t,n,a){var i="",r="",c="",d="";1===e?c=o.vj:e>1&&(c=s.j(o.Ne,e)),1===t?r=o.bj:t>1&&(r=s.j(o.He,t)),1===n?i=o.gj:n>1&&(i=s.j(o.Re,n)),a&&(d=o.zc);var l=[d,c,r,i].filter(function(e){return""!==e}).join(", ");return""===l?o.if:s.j(o.Bi,l)}(F.current,H.current,S.length,p),B="".concat(N," ").concat(o.fi),j=o.Ni+(n?" "+n:""),V=!k&&i.createElement(d.a,{className:"od-SharedWith-facepile-button",onClick:f,tabIndex:0,"data-is-focusable":!0,"aria-label":B},i.createElement("ul",{className:"od-SharedWith-List",ref:E,tabIndex:-1,id:"od-SharedWith-List"},R.slice(0,T<R.length-1?T:void 0),T<R.length-1?i.createElement(g,{ariaLabel:j,className:"".concat(C&&x?"od-SharedWith-More--simplified":"od-SharedWith-More"),iconName:"More",key:".more",onClick:f,title:o.Ni,personaSizeInPixels:I,renderOverlap:x}):null)),z=i.createElement("div",{"aria-label":a,className:"od-SharedWith-Facepile"},V,i.createElement("ul",{"aria-hidden":!0,className:"od-SharedWith-List od-SharedWith-Persona-measure",ref:w,role:"presentation"},R));return i.useEffect(function(){if((null==E?void 0:E.current)&&(null==w?void 0:w.current))if(C&&x){for(var e=(0,_.O)(),t=0;t<E.current.children.length;t++){var n=E.current.children[t];e?n.style.left="".concat(6*t,"px"):n.style.right="".concat(6*t,"px")}for(t=0;t<w.current.children.length;t++)n=w.current.children[t],e?n.style.left="".concat(6*t,"px"):n.style.right="".concat(6*t,"px");for(t=0;t<w.current.children.length;t++)(a=w.current.children[t].firstChild).setAttribute("data-is-focusable","false"),a.setAttribute("tabindex","-1")}else for(t=0;t<w.current.children.length;t++){var a;(a=w.current.children[t].firstChild.firstChild).setAttribute("data-is-focusable","false"),a.setAttribute("tabindex","-1")}}),C?i.createElement("div",{className:"od-SharedWith",ref:A},a&&i.createElement("h2",{className:"label"},a),i.createElement(m.a,{hostClassName:"od-SharedWith-tooltip",calloutProps:{gapSpace:0,directionalHint:e.isNotification?l.a.topCenter:l.a.topLeftEdge},content:"".concat(N," ").concat(e.isNotification?o.fi:"")},z)):i.createElement("div",{className:"od-SharedWith",ref:A},a&&i.createElement("h2",{className:"label"},a),z);function G(e){var t=0,n=1e3;if(w.current){for(var a=0,i=e;a<i.length;a++)for(var r=i[a],o=0;o<w.current.children.length;o++)if(w.current.children[o]===r.target){r.intersectionRect.width===r.boundingClientRect.width?t=Math.max(t,o):n=Math.min(n,o);break}0===t&&1e3!==n&&(t=Math.max(0,n-1)),(0,c.unstable_batchedUpdates)(function(){U(function(e){return e!==t?t:e}),M(!1)})}}}function g(e,t){var n=e.ariaLabel,r=e.className,o=e.iconName,s=e.imageUrl,c=e.onClick,d=e.text,h=e.title,b=e.personaSizeInPixels,g=(e.renderOverlap,v(b)),y=b/16,S=(0,_._)(t.clientId,t.sharingStore)||(0,_.Z)(t.clientId,t.sharingStore),D={styles:{coin:{width:"".concat(y,"rem"),height:"".concat(y,"rem")},image:{width:"".concat(y,"rem!important"),height:"".concat(y,"rem !important")},imageArea:{width:"".concat(y,"rem"),height:"".concat(y,"rem")},initials:{width:"".concat(y,"rem"),height:"".concat(y,"rem"),fontSize:"0.625rem",lineHeight:"".concat(y,"rem")}}},I={className:!S&&"od-SharedWith-facepile-padding",text:d,imageUrl:s,hidePersonaDetails:!0,showInitialsUntilImageLoads:!0,size:g||u.c.size24,onRenderInitials:o?function(){return i.createElement(f.a,{iconName:o})}:void 0,coinProps:D,styles:{root:{height:"1.5rem",minWidth:"".concat(b,"px")},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},x=i.createElement(p.a,(0,a.a)({},I));return x=c?i.createElement("span",{tabIndex:-1,"aria-label":n,"data-is-focusable":!1,role:"img"},x):i.createElement("span",{className:"od-SharedWith-noninteractivePersona",tabIndex:0,"aria-label":n,"data-is-focusable":!0,role:"img"},x),S?i.createElement("li",{className:r},x):i.createElement("li",{className:r},i.createElement(m.a,{hostClassName:"od-SharedWithPersona-tooltip",calloutProps:{gapSpace:0},content:h,directionalHintForRTL:l.a.topLeftEdge},x))}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t}(),t=[],n=null,a=null,i=function(e){this.time=e.time,this.target=e.target,this.rootBounds=l(e.rootBounds),this.boundingClientRect=l(e.boundingClientRect),this.intersectionRect=l(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,a=this.intersectionRect,i=a.width*a.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0},r=function(){function r(e,t){this.THROTTLE_TIMEOUT=100,this.POLL_INTERVAL=null,this.USE_MUTATION_OBSERVER=!0;var n,a,i,r=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType&&9!=r.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),a=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},a))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}return r.prototype._setupCrossOriginUpdater=function(){return n||(n=function(e,n){a=e&&n?u(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach(function(e){e._checkForIntersections()})}),n},r.prototype._resetCrossOriginUpdater=function(){n=null,a=null},r.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},r.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},r.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},r.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},r.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})},r.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},r.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var a=this._checkForIntersections,i=null,r=null;this.POLL_INTERVAL?i=n.setInterval(a,this.POLL_INTERVAL):(s(n,"resize",a,!0),s(t,"scroll",a,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(r=new n.MutationObserver(a)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push(function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),c(e,"resize",a,!0)),c(t,"scroll",a,!0),r&&r.disconnect()});var d=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=d){var l=o(t);l&&this._monitorIntersections(l.ownerDocument)}}},r.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var a=this.root&&(this.root.ownerDocument||this.root)||e,i=this._observationTargets.some(function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=a;){var i=o(n);if((n=i&&i.ownerDocument)==t)return!0}return!1});if(!i){var r=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),r(),t!=a){var s=o(t);s&&this._unmonitorIntersections(s.ownerDocument)}}}},r.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},r.prototype._checkForIntersections=function(){if(this.root||!n||a){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(a){var r=a.element,o=d(r),s=this._rootContainsTarget(r),c=a.entry,l=e&&s&&this._computeTargetAndRootIntersection(r,o,t),u=null;this._rootContainsTarget(r)?n&&!this.root||(u=t):u={top:0,bottom:0,left:0,right:0,width:0,height:0};var f=a.entry=new i({time:window.performance&&performance.now&&performance.now(),target:r,boundingClientRect:o,rootBounds:u,intersectionRect:l});c?e&&s?this._hasCrossedThreshold(c,f)&&this._queuedEntries.push(f):c&&c.isIntersecting&&this._queuedEntries.push(f):this._queuedEntries.push(f)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},r.prototype._computeTargetAndRootIntersection=function(t,i,r){if("none"!=window.getComputedStyle(t).display){for(var o,s,c,l,f,m,_,h,b=i,g=p(t),v=!1;!v&&g;){var y=null,S=1==g.nodeType?window.getComputedStyle(g):{};if("none"==S.display)return null;if(g==this.root||9==g.nodeType)if(v=!0,g==this.root||g==e)n&&!this.root?!a||0==a.width&&0==a.height?(g=null,y=null,b=null):y=a:y=r;else{var D=p(g),I=D&&d(D),x=D&&this._computeTargetAndRootIntersection(D,I,r);I&&x?(g=D,y=u(I,x)):(g=null,b=null)}else{var C=g.ownerDocument;g!=C.body&&g!=C.documentElement&&"visible"!=S.overflow&&(y=d(g))}if(y&&(o=y,s=b,c=Math.max(o.top,s.top),l=Math.min(o.bottom,s.bottom),f=Math.max(o.left,s.left),h=l-c,b=(_=(m=Math.min(o.right,s.right))-f)>=0&&h>=0&&{top:c,bottom:l,left:f,right:m,width:_,height:h}||null),!b)break;g=g&&p(g)}return b}},r.prototype._getRootRect=function(){var t;if(this.root&&!m(this.root))t=d(this.root);else{var n=m(this.root)?this.root:e,a=n.documentElement,i=n.body;t={top:0,left:0,right:a.clientWidth||i.clientWidth,width:a.clientWidth||i.clientWidth,bottom:a.clientHeight||i.clientHeight,height:a.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)},r.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3],height:0,width:0};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},r.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,a=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==a)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==a||r<n!=r<a)return!0}},r.prototype._rootIsInDom=function(){return!this.root||f(e,this.root)},r.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return f(n,t)&&(!this.root||n==t.ownerDocument)},r.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},r.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},r}();window.IntersectionObserver=r,window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function s(e,t,n,a){"function"==typeof e.addEventListener?e.addEventListener(t,n,a||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function c(e,t,n,a){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,a||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function d(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function l(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function u(e,t){var n=t.top-e.top,a=t.left-e.left;return{top:n,left:a,height:t.height,width:t.width,bottom:n+t.height,right:a+t.width}}function f(e,t){for(var n=t;n;){if(n==e)return!0;n=p(n)}return!1}function p(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?o(t):(n&&n.assignedSlot&&(n=n.assignedSlot.parentNode),n&&11==n.nodeType&&n.host?n.host:n)}function m(e){return e&&9===e.nodeType}}(),b.contextTypes={clientId:h.number.isRequired,resize:h.func.isRequired,sharingStore:h.object.isRequired},g.contextTypes={sharingStore:h.object.isRequired,clientId:h.number.isRequired};var v=function(e){switch(e){default:return u.c.size24;case 28:return u.c.size28;case 48:return u.c.size48}},y=function(e,t,n){var a=0;for(var i in e)(e[i].type===t||n&&e[i].type===n)&&a++;return a}}
,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return r}});var a=n(0),i=n(357);function r(e,t){return function(n){var a=(0,i.b)(n,t||i.a.Small);return 0===a.indexOf("https://")||0===a.indexOf("http://")?a:a&&e?e+a:void 0}}function o(e){!e||window._spPageContextInfo&&window._spPageContextInfo.userPhotoCdnBaseUrl||(window._spPageContextInfo=(0,a.a)((0,a.a)({},window._spPageContextInfo),{userPhotoCdnBaseUrl:e}))}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a,i=n(177),r=((a={})[i.a.anyone]="Globe",a[i.a.onlyYou]="Lock",a[i.a.specificPeople]="AddFriend",a[i.a.workGroup]="Work",a[i.a.existing]="ReminderPerson",a[i.a.chat]="Chat",a[i.a.mail]="Mail",a)}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:.75rem}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:.75rem;display:flex;flex-direction:column;padding:10px;width:250px}@supports (font:-apple-system-caption1){.od-InfoButton-content{font:-apple-system-caption1}}"}]);var i=n(77),r=n(5),o=n(10),s=n(1),c=n(12),d=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onShowCallout=function(){i.setState((0,a.a)((0,a.a)({},i.state),{isCalloutVisible:!0}))},i._onDismissCallout=function(){i.setState((0,a.a)((0,a.a)({},i.state),{isCalloutVisible:!1}))},i._onInfoButton=function(e){i._infoButton=e},i.state={isCalloutVisible:!1},i}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",{style:{display:"inline"}},s.createElement("div",{className:"od-InfoButton-button ".concat(e.className),onClick:this._onShowCallout,ref:this._onInfoButton,onFocus:e.disableKeyboard?void 0:this._onShowCallout,onBlur:e.disableKeyboard?void 0:this._onDismissCallout,role:"button",tabIndex:e.disableKeyboard?-1:0,"aria-label":e.ariaLabel||e.message},s.createElement(o.a,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,styles:{root:{fontSize:"0.75rem"}}})),t.isCalloutVisible&&s.createElement(i.a,{directionalHint:r.a.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},s.createElement("div",{className:"od-InfoButton-content"},s.createElement("span",{className:"od-InfoButton-message"},e.message))))},t.contextTypes={strings:c.object.isRequired},t}(s.Component)}
,,function(e,t,n){n.d(t,{a:function(){return p}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton{font-size:.875rem;font:-apple-system-title1;margin:0;padding:0;border-radius:.25rem;min-height:2rem;height:-moz-fit-content;height:fit-content}.od-SendButton .ms-Button-label{font:-apple-system-body}@media screen and (-ms-high-contrast:active){.od-SendButton.send:focus,.od-SendButton.send:hover{background:highlight}}"}]);var i=n(1),r=n(57),o=n(50),s=n(82),c=n(29),d=n(178),l=n(17),u=n(12),f=n(2),p=function(e){function t(t,n){var a=e.call(this,t)||this;return a._buttonRef=i.createRef(),a._onSendLinkClicked=function(){a.props.onSendLinkClicked(a.props.messageText,a.props.subjectText)},a._platformDetection=n.platformDetection,a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._buttonRef&&this.props.shouldBeFocused&&this._buttonRef.current.focus()},t.prototype.render=function(){if(!this.props.ctaLabel)return null;var e=!1;if(this.props.currentSettings.audience===c.a.existing&&this.props.linkRecipients)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var a=n[t];if(void 0===this.props.permissionsMap[a.email]&&void 0===this.props.permissionsMap[a.userId]){e=!0;break}}var u=!!this.props.errorMessage||(0,l.S)(this.props.sharingInformation)||e||(0,l.r)(this.props.messageText)>this.props.maximumMessageLength||(0,l.r)(this.props.subjectText)>this.props.maximumSubjectLength;switch(this.props.sendButtonType){case d.a.button:return i.createElement(r.a,{className:"od-SendButton send",disabled:u,onClick:this._onSendLinkClicked,componentRef:this._buttonRef},this.props.ctaLabel);case d.a.link:return i.createElement("div",{className:"od-SendButton link"},i.createElement(s.a,{disabled:u,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel));case d.a.copyLink:var p=(0,f.E)(),m={color:p.palette.themeDarker,backgroundColor:p.palette.neutralLighter,borderColor:p.palette.neutralSecondary},_={root:{color:p.palette.themePrimary,backgroundColor:p.palette.white,borderColor:p.palette.neutralTertiary},rootHovered:m,rootFocused:m,rootDisabled:{color:p.palette.themeTertiary,backgroundColor:p.palette.white,borderColor:p.palette.neutralTertiary}};return this.context.sharingStore.isConsumer()&&this.props.currentSettings.audience!==c.a.specificPeople&&(u=!1),i.createElement(o.a,{className:"od-SendButton copy",onClick:this._onSendLinkClicked,styles:_,disabled:u},this.props.ctaLabel)}},t.contextTypes={platformDetection:u.object.isRequired,sharingStore:u.object.isRequired},t}(i.Component)}
,function(e,t,n){var a,i;n.d(t,{a:function(){return a},b:function(){return i}}),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.Error=2]="Error"}(a||(a={})),function(e){e[e.UnshareLink=0]="UnshareLink",e[e.ShareLink=1]="ShareLink",e[e.FetchSharingInformation=2]="FetchSharingInformation",e[e.GrantAccess=3]="GrantAccess"}(i||(i={}))}
,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return s}});var a={"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bmp:1,cbl:1,cfg:1,cool:1,cr2:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,dwg:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},i={"3fr":1,"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,ari:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mef:1,mkv:1,mos:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mpeg:1,mpg:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},r=n(3),o={None:0,AllowMediaTA:1,OfficeOnly:2};function s(e,t){return!!e&&(e=("."===e[0]?e.slice(1):e).toLowerCase(),r.b.isActivated("3B12E0BA-483A-4E92-B6EC-89DC316832D6","01/25/2022","Update BlockDownloadSupported")?a[e]>=t:i[e]>=t)}}
,,function(e,t,n){n.d(t,{a:function(){return h}});var a=n(0),i=n(1),r=n(12),o=n(368),s=n(246),c=n(10),d=n(32),l=n(17),u=n(11),f=n(7);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorLarge-wrapper{position:relative;display:flex;align-items:center;width:100%}.od-RoleSelectorLarge-wrapper .ms-TooltipHost{position:absolute;top:9px;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{right:0}[dir=rtl] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{left:0}@supports (font:-apple-system-caption1){.od-RoleSelectorLarge-wrapper .ms-TooltipHost{font:-apple-system-caption1}}.od-RoleSelectorLarge-wrapper .ms-Dropdown-container{width:100%}.od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{margin:0;height:auto}[dir=ltr] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-left:0}[dir=rtl] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-right:0}.od-RoleSelectorLarge-rolesDropdownOptionsCallout.grantAccess{width:auto}.od-RoleSelectorLarge-rolesDropdown{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.fui-Dropdown{border:none}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:-moz-fit-content;height:fit-content;min-height:2rem;line-height:1.875rem}[dir=ltr] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-left:0}[dir=rtl] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-right:0}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent{display:flex}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-size:.875rem}@supports (font:-apple-system-body){.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font:-apple-system-body}}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title.ms-Dropdown-titleIsPlaceHolder{text-align:center}[dir=ltr] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title.ms-Dropdown-titleIsPlaceHolder{padding-left:20px}[dir=rtl] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title.ms-Dropdown-titleIsPlaceHolder{padding-right:20px}[dir=ltr] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title.ms-Dropdown-titleIsPlaceHolder{padding-right:40px}[dir=rtl] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title.ms-Dropdown-titleIsPlaceHolder{padding-left:40px}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown:focus::after{border:none;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-open,.od-RoleSelectorLarge-rolesDropdown:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-open .ms-Dropdown-title,.od-RoleSelectorLarge-rolesDropdown.is-open:hover .ms-Dropdown-title{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{right:32px}[dir=rtl] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{left:32px}@media screen and (-ms-high-contrast:active){.od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:window;color:GrayText;border-color:GrayText}}[dir=ltr] .manageAccessV3 .od-RoleSelectorLarge-roleDropdownOptionText{padding-left:10px}[dir=rtl] .manageAccessV3 .od-RoleSelectorLarge-roleDropdownOptionText{padding-right:10px}.od-RoleSelector-infoTooltipContent{font-size:.75rem}@supports (font:-apple-system-caption1){.od-RoleSelector-infoTooltipContent{font:-apple-system-caption1}}.od-changePermissions--info i{vertical-align:middle}.od-changePermissions--info i.disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";cursor:default}.od-RoleSelectorLarge-roleDropdownOption{display:flex;align-items:center;margin:8px 0 8px 12px}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent{display:flex;flex-direction:column}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent.od-RoleSelectorLarge-option-0{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-weight:600;font-size:.875rem;line-height:1.3}@supports (font:-apple-system-body){.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font:-apple-system-body}}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{font-size:.75rem;line-height:1.3}[dir=ltr] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:left}[dir=rtl] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:right}@supports (font:-apple-system-body){.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{font:-apple-system-body}}.od-RoleSelectorLarge-settingIcon{font-size:.875rem;display:flex;align-self:center}[dir=ltr] .od-RoleSelectorLarge-settingIcon{padding-left:4px}[dir=rtl] .od-RoleSelectorLarge-settingIcon{padding-right:4px}[dir=ltr] .od-RoleSelectorLarge-settingIcon{padding-right:12px}[dir=rtl] .od-RoleSelectorLarge-settingIcon{padding-left:12px}@supports (font:-apple-system-body){.od-RoleSelectorLarge-settingIcon{font:-apple-system-body}}.od-RoleSelectorLarge-settingIcon svg{width:1.125rem;height:1.125rem}.ms-Dropdown .ms-Dropdown-title:focus{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper{position:relative;display:table;align-items:center;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:4px;width:auto}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper .od-RoleSelectorLarge-rolesDropdown{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border-radius:4px;font-weight:600}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper.disabled{border:none}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper.disabled .ms-Dropdown-title{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper.disabled .ms-Dropdown-title{background-color:window;color:GrayText;border-color:GrayText}}@media screen and (-ms-high-contrast:active){.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper.disabled .ms-Dropdown-title:active,.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper.disabled .ms-Dropdown-title:hover{background-color:window;color:GrayText}}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper:focus .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown{padding:2px}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-wrapper:focus .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}[dir=ltr] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent{padding-left:6px}[dir=rtl] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent{padding-right:6px}.od-PrincipalDetails-cellRoleSelector .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-weight:600}[dir=ltr] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{padding-left:6px}[dir=rtl] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{padding-right:6px}[dir=ltr] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{padding-right:10px}[dir=rtl] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{padding-left:10px}.od-PrincipalDetails-cellRoleSelector .ms-Dropdown-caretDownWrapper{line-height:1.875rem}[dir=ltr] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-caretDownWrapper{right:1.125rem}[dir=rtl] .od-PrincipalDetails-cellRoleSelector .ms-Dropdown-caretDownWrapper{left:1.125rem}.od-PrincipalDetails-cellRoleSelector .ms-Dropdown-caretDownWrapper i{font-size:.75rem}@supports (font:-apple-system-caption1){.od-PrincipalDetails-cellRoleSelector .ms-Dropdown-caretDownWrapper i{font:-apple-system-caption1}}.od-PrincipalDetails-cellRoleSelector .od-RoleSelectorLarge-roleDropdownOptionMainContent i{position:relative;left:12px}.od-ShareLinkDetails--changePermissions .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border-bottom:none}@supports (font:-apple-system-body){.od-ShareLinkDetails--changePermissions .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{height:auto;line-height:normal}}.fui-Listbox .od-RoleSelectorLarge-checkedIcon{display:none}.od-RoleSelectorLarge-checkedIcon{padding-right:8px}.od-RoleSelectorLarge-checkedIcon.visible{visibility:visible}.od-RoleSelectorLarge-checkedIcon.hidden{visibility:hidden}"}]);var p=n(97),m=n(28),_=n(71),h=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onRenderTitle=function(e){var t=(0,l.E)(e[0].key,a._isListSharing);return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOptionMainContent"},i.createElement(c.a,{iconName:t.name,"aria-hidden":"true",title:t.name,className:"od-RoleSelectorLarge-settingIcon"}),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e[0].text," "))},a._onRenderOption=function(e){var t=(0,l.E)(e.key,a._isListSharing);e.key==d.a.review&&a.props.showDropdownWithOfficeReview&&(t.title=u.xb);var n={maxWidth:"300px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},t.title)}},r="od-RoleSelectorLarge-roleDropdownOptionMainContent od-RoleSelectorLarge-option-".concat(e.key),o=a.props.showGrantAccess?void 0:a._defaultRole;return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOption"},i.createElement(c.a,{className:"od-RoleSelectorLarge-checkedIcon ".concat(e.key===o?"visible":"hidden"),iconName:"CheckMark"}),i.createElement(m.a,{calloutProps:{gapSpace:0},tooltipProps:n},i.createElement(c.a,{className:"od-RoleSelectorLarge-settingIcon",iconName:t.name})),i.createElement("div",{className:r},i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e.text," "),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionSubtext"},e.data)))},a._onAllowRoleChange=function(e,t){a.props.onRoleChange(t.key,a.props.permissionId||"")},a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props,n=e.menuPermissionOptions,a=e.showStopSharing,r=e.showRemoveDirectAccess,f=e.sharingRole,h=e.showGrantAccess,b=e.isGrantAccess,g=e.componentRef;this._isListSharing=n.manageList.shouldDisplay&&n.manageList.enabled;var v=!this.props.showCollapsedRoleIcon||this.props.showCollapsedRoleIcon,y=(0,l.E)(f,this._isListSharing);this._defaultRole=f,this._defaultRole!==d.a.review||n.review.enabled||(this._defaultRole=d.a.edit),this._defaultRole!==d.a.owner||n.fullControl.enabled||(this._defaultRole=d.a.edit),this._defaultRole!==d.a.restrictedview||n.blockDownload.enabled||(this._defaultRole=d.a.view);var S={key:"divider_1",text:"-",itemType:o.a.Divider},D=[];if(n.fullControl.shouldDisplay){var I=t._fullControlDropdownOption;I.disabled=!n.fullControl.enabled,D.push(I)}if(n.manageList.shouldDisplay){var x=t._manageListDropdownOption;x.disabled=!n.manageList.enabled,D.push(x)}if(this._isListSharing)D.push(t._editDropDownOptionForLists);else{var C=t._editDropDownOption;C.disabled=!n.edit.enabled,_.c()&&C.disabled||D.push(C)}if(n.review.shouldDisplay){var O=this.props.showDropdownWithOfficeReview?t._officeReviewDropdownOption:t._reviewDropdownOption;O.disabled=!n.review.enabled,D.push(O)}if(n.manageList.shouldDisplay&&n.manageList.enabled?D.push(t._viewDropdownOptionForLists):n.view.shouldDisplay&&n.view.enabled&&D.push(t._viewDropdownOption),n.blockDownload.shouldDisplay){var w=t._blockDownloadDropdownOption;D.push(w)}if(a){var E=t._stopSharingDropdownOption;D.push(S,E)}if(r){var A=t._removeDirectAccessDropdownOption;D.push(S,A)}var L={maxWidth:"300px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},y.title)}};return i.createElement("div",{className:"od-RoleSelectorLarge-wrapper ".concat(this.props.disabled?"disabled ":""," ").concat(this._isListSharing?"lists ":"")},v&&i.createElement(m.a,{calloutProps:{gapSpace:0},tooltipProps:L},i.createElement(c.a,{className:"od-RoleSelectorLarge-settingIcon",iconName:y.name})),i.createElement(s.a,{componentRef:g,className:"od-RoleSelectorLarge-rolesDropdown",disabled:this.props.disabled,label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChange:this._onAllowRoleChange,defaultSelectedKey:h?void 0:this._defaultRole,calloutProps:{className:"od-RoleSelectorLarge-rolesDropdownOptionsCallout\n            ".concat(b?"grantAccess ":"")},responsiveMode:p.a.large,options:D,ariaLabel:this.props.ariaLabel,placeholder:h?u._j:""}),this.props.children)},t.contextTypes={sharingStore:r.object.isRequired},t._editDropDownOption={key:d.a.edit,text:u.Db,data:u.Sb,ariaLabel:f.j(u.oi,u.Db,u.Sb)},t._blockDownloadDropdownOption={key:d.a.restrictedview,text:u.fb,data:u.pb,ariaLabel:f.j(u.oi,u.fb,u.pb)},t._editDropDownOptionForLists=(0,a.a)((0,a.a)({},t._editDropDownOption),{text:u.vb,data:u.yb,ariaLabel:f.j(u.oi,u.vb,u.yb)}),t._reviewDropdownOption={key:d.a.review,text:u.wb,data:u.Ob,ariaLabel:f.j(u.oi,u.wb,u.Ob)},t._officeReviewDropdownOption={key:d.a.review,text:u.xb,data:u.Ib,ariaLabel:f.j(u.oi,u.xb,u.Ib)},t._viewDropdownOption={key:d.a.view,text:u.Pb,data:u.Mb,ariaLabel:f.j(u.oi,u.Pb,u.Mb)},t._viewDropdownOptionForLists=(0,a.a)((0,a.a)({},t._viewDropdownOption),{data:u.kb,ariaLabel:f.j(u.oi,u.Pb,u.kb)}),t._fullControlDropdownOption={key:d.a.owner,text:u.kd,data:u.Ld,ariaLabel:f.j(u.oi,u.kd,u.Ld)},t._manageListDropdownOption={key:d.a.manageList,text:u.gb,data:u.bb,ariaLabel:f.j(u.oi,u.gb,u.bb)},t._stopSharingDropdownOption={key:d.a.none,text:u.Pj,ariaLabel:u.Pj},t._removeDirectAccessDropdownOption={key:d.a.none,text:u.Nh,ariaLabel:u.Nh},t}(i.Component)}
,,,,function(e,t,n){n.d(t,{a:function(){return _}});var a=n(0),i=n(1),r=n(32),o=n(334),s=n(5),c=n(27),d=n(7),l=n(11);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir=rtl] .od-RoleSelectorCompact-permissionButton{margin-right:8px}.od-RoleSelectorCompact-permissionButton svg{height:1.125rem;width:1.125rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.simplified-share{height:100%;align-self:center;border-radius:0 4px 4px 0}[dir=ltr] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-permissionButton.simplified-share{margin-right:0}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:flex;flex-direction:column;margin:8px}[dir=ltr] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir=rtl] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:2.25rem;height:3.25rem;font-size:.875rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{font:-apple-system-body;height:auto!important}}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link.is-disabled{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent;font-size:1rem;width:1rem;max-height:unset}@supports (font:-apple-system-body){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{font:-apple-system-body}}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.blockdownload{height:1rem}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-itemText{font-size:.875rem;line-height:1.25rem;font:-apple-system-body}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{font-size:.75rem;line-height:1rem;font:-apple-system-caption1;max-width:160px;white-space:normal}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem.selected{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem.selected .ms-ContextualMenu-link{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}.od-RoleSelectorCompact-simplifiedPermissionsButton{height:100%!important;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"!important;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:0 4px 2px 0!important;height:100%;align-self:center;padding:2px}[dir=ltr] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-left:0}[dir=rtl] .od-RoleSelectorCompact-simplifiedPermissionsButton{margin-right:0}.od-RoleSelectorCompact-simplifiedPermissionsButton svg{height:1.125rem;width:1.125rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-simplifiedPermissionsButton:focus{outline:unset}.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{height:100%;padding-left:10px;padding-right:10px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-simplifiedPermissionsButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-AddPeople-Edit-Section button.od-RoleSelectorCompact-simplifiedPermissionsButton{border-radius:2px!important}.od-AddPeople-Edit-Section span.ms-Button-flexContainer{padding:0}.od-RoleSelectorCompact-checkmarkIcon{font-size:.75rem;max-height:unset}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-checkmarkIcon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-itemText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-secondaryText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link.is-checked i.ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-checkmarkIcon,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-itemText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover .od-RoleSelectorCompact-menuItem-textWrapper .ms-ContextualMenu-secondaryText,.od-RoleSelectorCompact-menuItem button.ms-ContextualMenu-link:hover i.ms-ContextualMenu-icon{background-color:highlight;border-color:highlight;color:highlighttext!important}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-simplifiedPermissionsButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron{color:highlighttext;font-weight:600;forced-color-adjust:none}}"}]);var u,f=n(12),p=n(66),m=n(17);!function(e){e.edit="edit",e.view="view",e.review="comment",e.fullControl="full-control",e.manageList="manage-list",e.restrictedView="restricted-view",e.divider="divider",e.stopSharing="stop-sharing",e.linkSettings="linkSettings"}(u||(u={}));var _=function(e){function t(t,n){var a=e.call(this,t)||this;return a._linkSettingsClickedInRoleSelector=function(){a.context.sharingStore.getEngagementHelper().linkSettingsInCompactRoleSelectorClicked({clientId:a.props.clientId,scenarioId:"",mode:a.props.mode}),a.props.onLinkSettingsClicked()},a._onItemClicked=function(e,t){var n,i;switch(t.key){case u.fullControl:i=r.a.owner;break;case u.manageList:i=r.a.manageList;break;case u.edit:i=r.a.edit;break;case u.view:i=r.a.view;break;case u.review:i=r.a.review;break;case u.restrictedView:i=r.a.restrictedview;break;default:i=r.a.none}a._selectedRole!==i&&a.props.onRoleChange(i,a.props.permissionId||""),null===(n=a._roleSelectorRef.current)||void 0===n||n.focus()},a._selectedRole=a._parseRole(t.sharingRole),a._menuOpen=!1,a._showSimplifiedDialogV2=(0,m.Z)(a.props.clientId,n.sharingStore),a._showSimplifiedDialog=(0,m._)(a.props.clientId,n.sharingStore),a._useSimplifiedDialog=a._showSimplifiedDialog||a._showSimplifiedDialogV2,a._roleSelectorRef=i.createRef(),a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this;this._selectedRole=this._parseRole(this.props.sharingRole);var n,a=this.props,u=a.menuPermissionOptions,f=a.showLinkSettings,m=a.showStopSharing,_=this._getMenuItems({menuPermissionOptions:u,showLinkSettings:f,showStopSharing:m,sharingRole:this.props.sharingRole}),h=_.filter(function(e){return e.itemType!==o.a.Divider}).length,b=u.manageList.shouldDisplay,g=void 0!==b&&b;switch(this.props.sharingRole){case r.a.owner:n=l.kd;break;case r.a.edit:n=g?l.vb:l.Db;break;case r.a.review:n=l.wb,this.props.showDropdownWithOfficeReview&&(n=l.xb);break;case r.a.view:n=l.Pb;break;case r.a.restrictedview:n=l.fb;break;case r.a.manageList:n=l.gb;break;case r.a.none:n="";break;default:return null}var v={directionalHint:s.a.bottomRightEdge,shouldFocusOnMount:!0,items:_,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){e._logRoleSelectorClicked(e.context.sharingStore),e._menuOpen=!0},onMenuDismissed:function(){e._menuOpen=!1},styles:t.menuItemStyles},y={iconName:"ChevronDown",className:"od-RoleSelectorCompact-permissionButton-Chevron"};if(this.props.shimmer)return i.createElement(c.a,{menuIconProps:y,iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:v,disabled:!0,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}});var S=this._menuOpen?d.j(l.oe,this.props.ariaLabel,n,h):d.j(l.re,this.props.ariaLabel,n,h);return p.b(i.createElement(c.a,{componentRef:this._roleSelectorRef,menuIconProps:y,iconProps:this.getRoleIconName(this.props.sharingRole),className:this._useSimplifiedDialog&&!this.props.isGrantAccess?"od-RoleSelectorCompact-simplifiedPermissionsButton":"od-RoleSelectorCompact-permissionButton",menuProps:v,disabled:this.props.disabled,ariaLabel:S,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}),n,{position:s.a.bottomRightEdge,styles:this._useSimplifiedDialog&&{root:{height:"100%",display:"flex"}}})},t.prototype._renderContent=function(e,t){return i.createElement(i.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),i.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},t.renderItemName(e),t.renderSecondaryText(e)),t.renderSubMenuIcon(e))},t.prototype._parseRole=function(e){return e===r.a.review&&!this.props.menuPermissionOptions.review.enabled||e===r.a.owner&&!this.props.menuPermissionOptions.fullControl.enabled?r.a.edit:e===r.a.restrictedview?this.props.menuPermissionOptions.blockDownload.enabled?r.a.restrictedview:r.a.view:e},t.prototype._addRenderContent=function(e){var t=this;return e.map(function(e){return(0,a.a)((0,a.a)({},e),{onRenderContent:t._renderContent})})},t.prototype._getMenuItems=function(e){var t=[],n=e.menuPermissionOptions,a=e.showLinkSettings,i=e.showStopSharing,s=e.sharingRole,c=n.fullControl,f=(c.enabled,c.shouldDisplay),p=void 0!==f&&f,m=n.review,_=(m.enabled,m.shouldDisplay),h=void 0!==_&&_,b=n.edit,g=b.enabled,v=void 0===g||g,y=b.shouldDisplay,S=void 0===y||y,D=n.view,I=(D.enabled,D.shouldDisplay),x=void 0===I||I,C=n.manageList,O=C.enabled,w=void 0!==O&&O,E=C.shouldDisplay,A=void 0!==E&&E,L=n.blockDownload,k=(L.enabled,L.shouldDisplay),M=void 0!==k&&k,P={key:u.edit,text:A?l.vb:l.Db,disabled:!v,secondaryText:A?l.yb:l.Sb,ariaLabel:d.j(l.oi,A?l.vb:l.Db,A?l.yb:l.Sb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Edit"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.edit},T=e.menuPermissionOptions.blockDownload.enabled||this._showSimplifiedDialogV2?s===r.a.view:this._showSimplifiedDialog&&(s===r.a.view||s===r.a.restrictedview),U={key:u.view,text:l.Pb,secondaryText:A?l.kb:l.Mb,ariaLabel:d.j(l.oi,l.Pb,A?l.kb:l.Mb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"View"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:T},F={key:u.fullControl,text:l.kd,secondaryText:l.Ld,ariaLabel:d.j(l.oi,l.kd,l.Ld),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Signin"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.owner},H={key:u.manageList,text:l.gb,disabled:!w,secondaryText:l.bb,ariaLabel:d.j(l.oi,l.gb,l.bb),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"EditListPencil"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.manageList},R={key:u.review,text:l.wb,secondaryText:l.Ob,ariaLabel:d.j(l.oi,l.wb,l.Ob),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.review},N={key:u.review,text:l.xb,secondaryText:l.Ib,ariaLabel:d.j(l.oi,l.xb,l.Ib),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"},itemProps:{styles:{checkmarkIcon:["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:!0,isChecked:s===r.a.review},B={key:u.divider,itemType:o.a.Divider},j={key:u.stopSharing,text:l.Pj,ariaLabel:l.Pj,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing",iconProps:{iconName:"Delete"}},V={key:"linkSettings",text:l.ke,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:l.ke},z={key:u.restrictedView,text:l.fb,secondaryText:l.pb,ariaLabel:d.j(l.oi,l.fb,l.pb),className:"od-RoleSelectorCompact-menuItem blockdownload ".concat(this._useSimplifiedDialog||s!==r.a.restrictedview?"":"selected"),iconProps:{iconName:"BlockDownloadIcon"},itemProps:{styles:{checkmarkIcon:this._useSimplifiedDialog&&["od-RoleSelectorCompact-checkmarkIcon"]}},role:"menuitemradio",canCheck:this._useSimplifiedDialog,isChecked:this._useSimplifiedDialog&&s===r.a.restrictedview};return p&&t.push(F),A&&t.push(H),S&&t.push(P),x&&t.push(U),M&&t.push(z),h&&(this.props.showDropdownWithOfficeReview?t.push(N):t.push(R)),i&&t.push(B,j),a&&t.push(B,V),this._addRenderContent(t)},t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().compactRoleSelectorClicked({clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})},t.prototype.getRoleIconName=function(e){var t;switch(e=this._parseRole(e)){case r.a.owner:t="Signin";break;case r.a.edit:t="Edit";break;case r.a.view:t="View";break;case r.a.review:t="Feedback";break;case r.a.manageList:t="EditListPencil";break;case r.a.restrictedview:t="BlockDownloadIcon";break;case r.a.none:t="";break;default:throw new Error("Sharing role does not exist")}return{iconName:t}},t.contextTypes={sharingStore:f.object.isRequired},t.menuItemStyles={subComponentStyles:{callout:{root:{maxHeight:"160px !important",overflowY:"auto"}},menuItem:{root:{height:"auto !important"},label:{margin:"0",fontSize:"0.875rem",fontWeight:"600",lineHeight:"1.3"},secondaryText:{paddingLeft:"0",fontSize:"0.75rem",lineHeight:"1.3",textAlign:"left",whiteSpace:"normal"}}}},t}(i.Component)}
,,,,,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return i}});var a,i={queued:0,started:1,completed:2,aborted:3,failed:4,none:5};!function(e){e[e.none=0]="none",e[e.other=1]="other",e[e.general=2]="general",e[e.conflict=3]="conflict",e[e.similarNameExists=4]="similarNameExists",e[e.invalidName=5]="invalidName",e[e.fileSize=6]="fileSize",e[e.emptyFileOrFolder=7]="emptyFileOrFolder",e[e.emptyFileOrFolderForDocLib=8]="emptyFileOrFolderForDocLib",e[e.overQuota=9]="overQuota",e[e.accessDenied=10]="accessDenied",e[e.lockMismatch=11]="lockMismatch",e[e.overQuotaSharedFolder=12]="overQuotaSharedFolder",e[e.folderUploadNotSupported=13]="folderUploadNotSupported",e[e.versionMismatch=14]="versionMismatch",e[e.authFailure=15]="authFailure",e[e.fileHashMismatch=16]="fileHashMismatch",e[e.targetFolderMissing=17]="targetFolderMissing",e[e.itemNotFound=18]="itemNotFound",e[e.malwareDetected=19]="malwareDetected",e[e.throttled=20]="throttled",e[e.pathTooLong=21]="pathTooLong",e[e.disconnected=22]="disconnected",e[e.noConnection=23]="noConnection",e[e.unlockRequired=24]="unlockRequired",e[e.insufficientVaultQuota=25]="insufficientVaultQuota",e[e.canceled=26]="canceled"}(a||(a={}))}
,,,,function(e,t,n){n.d(t,{a:function(){return c}});var a=n(0),i=n(25);"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var r=n(6),o=n(129),s=n(648);function c(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var d={loadViewModel:function(e,t,n){n(function(n,d){void 0===n&&(n={});var l,u=i.contextFor(d.element),f=i.utils.unwrapObservable(n.resources)||c(u),p={owner:e,useFactoriesOnKeys:!0},m=f?new r.c(f,p):new r.c(p);n=(0,a.a)((0,a.a)({},n),{resources:m}),l=function(e){return"function"==typeof e.createViewModel}(t)?t.createViewModel(n,d):new(m.injected(t))(n);var _=new s.a({name:e,viewModel:l,element:d.element,bindingContext:u});return(0,o.a)(l,function(){_.dispose(),m.dispose()})})}};i.components.loaders.unshift(d)}
,function(e,t,n){var a=n(25),i=function(){function e(){this._originalProvider=new a.bindingProvider,this._bindingHandlers={},this._bindingContexts=[]}return e.getInstance=function(){return e._instance},e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)},e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}},e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}},e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||a.bindingHandlers[e]},e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,r=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;return this._bindingHandlers[r]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)},this._bindingHandlers[r].after=t.after,t.supportsVirtualElements&&(a.virtualElements.allowedBindings[r]=!0),r},e.prototype._remapKeys=function(e,t){var n=e,a=this._getLocalBindingHandlers(t);if(a)for(var i in n={},e){var r=a[i];n[r&&this.getUniqueKeyForBindingHandler(r,i)||i]=e[i]}return n},e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t},e._instance=new e,e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey",e._lastUniqueKeyOrdinal=0,e}().getInstance();a.getBindingHandler=i.getBindingHandler.bind(i),a.bindingProvider.instance=i}
,,,,,,,,,,,,,,,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End"}(a||(a={}))}
,,function(e,t,n){n.r(t),n.d(t,{getAriaContext:function(){return x},getAriaEnvironment:function(){return C},getAriaInfo:function(){return O}});var a=n(41),i=n(83),r=n(3),o=n(131),s=n(278),c=n(188),d=!r.a.isActivated("A28D9CDA-AA8D-44B4-81D2-2998F77C2A75","11/22/2023","Adds _SPO to the App Environment for ODC Aria telemetry"),l=!r.a.isActivated("D92FA3AE-5404-4D53-82A0-377266835D7F","11/22/2023","Adds a MigrationCache state to rumone"),u=!r.a.isActivated("5B75D07E-70EB-499C-BA9D-C0B17631B28B","01/04/2024","Shims some ODC telemetry properties from SPO config objects"),f=window.Flight||{};d&&!f.UserGroup&&(f.UserGroup="PROD");var p=window._spModuleLink,m=window._spPageContextInfo;u&&p&&(f.version=p.buildNumber,f.manifest=p.manifestName,f.cid=c.a.getCid(),f.session=i.a.generate());var _,h=f.UserGroup&&f.UserGroup.toLowerCase(),b="dev"!==f.version&&("df"===h||"prod"===h),g=f.version,v=f.manifest,y="ODC_".concat(d&&p?"SPO_":"").concat(f.UserGroup),S=b?"prod":"ppe";if(_=c.a.isAuthenticated()?(0,s.a)(c.a.getHcid())?a.a.ConsumerOnSPO:a.a.Consumer:a.a.ConsumerAnonymous,l){var D=o.b.getRUMOneLogger();D.isRunning()&&D.addTTIBreakdown("MigrationCache",{data:_===a.a.ConsumerOnSPO?"warm":"cold",needFlatten:!0},!0)}var I={isAuthenticated:c.a.isAuthenticated(),market:c.a.getMarket(),session:f.session,version:g,manifest:v,userId:c.a.isAuthenticated()&&"0"!==f.cid?f.cid:f.xid,accountType:_,environment:y,workload:"ODC",disableCookies:!c.a.isAuthenticated()};function x(){return I}function C(){return S}function O(){return{version:g,manifest:v,appEnvironment:y,ariaEnvironment:S,ariaContext:I}}u&&m&&(I.pageCorrelationId=m.CorrelationId,I.siteSubscriptionId=m.siteSubscriptionId)}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(194),i=n(464);function r(e){if(!e)return!1;if(e.indexOf("b!")>=0)return!0;e=(0,a.a)(e);var t=i.b.getValue(e);if(t){if(t.version===i.a)return t.isMigrated;i.b.remove(e)}return!1}}
,function(e,t,n){n.r(t),n.d(t,{ODCTenantTokens:function(){return a}});var a={ppe:"3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977",prod:"a23e4f242c9c4097a968f28c62633e19-62d0d830-5afd-4df3-8e40-351c8711cf5c-7157"}}
,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return o},c:function(){return i},d:function(){return r}});var a=n(0),i={unknown:0,subject:1,intent:2,component:3,event:4,error:5},r=function(){function e(e,t,n){void 0===n&&(n={}),this.name=e,this.type=t;var a=n.getEngagementData;a&&(this.getEngagementData=a)}return e.prototype.matches=function(e){return e.part===this},e.prototype.getEngagementData=function(e){return{}},e}(),o=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=t.engagementSource,a=(void 0===n?{contexts:[]}:n).contexts.slice(0);this.contexts=a}return e.prototype.fromSource=function(e){return e?this.clone((0,a.g)((0,a.g)([],e.contexts,!0),this.contexts,!0)):this},e.prototype.withPart=function(e,t){if(void 0===t&&(t={}),e){var n=(0,a.a)((0,a.a)({},t||{}),{part:e});return this.clone((0,a.g)((0,a.g)([],this.contexts,!0),[n],!1))}return this},e.prototype.clone=function(t){return new e({},{engagementSource:{contexts:t}})},e}(),s=new o}
,,,,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(52),i=n(26),r=(0,a.a)({eventName:"Trace,",shortEventName:"Trace"},{message:i.a.String,privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}}).withData({privacyClassification:i.b.requiredService,privacyDataTypes:["browsingHistory"]})}
,,function(e,t,n){n.d(t,{a:function(){return f}});var a=n(91),i=n(92),r=n(52),o=n(26),s=(0,r.a)({eventName:"RequireJSError,",shortEventName:"RequireJSError",critical:!0},{message:o.a.String,requireModules:o.a.Array,requireType:o.a.String,stack:o.a.String}),c=n(37),d=new a.a("RequireJS",i.a.session),l="error",u=function(){function e(){}return e.log=function(e){s.logData(e);var t=d.getValue(l)||[];t.push(e.message),d.setValue(l,t),e&&("define"===e.requireType||"require"===e.requireType)&&e.stack&&e.requireModules&&c.a.log(e)},e.registerRequireOnError=function(){if(window.requirejs&&"function"==typeof window.requirejs){var t=window.requirejs.onError;window.requirejs.onError=function(n){e.log(n),t&&!n.isTest&&t(n)}}},e}(),f=u;u.registerRequireOnError()}
,,,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(0),i=n(18),r=n(104);function o(e,t){var n;void 0===t&&(t=void 0);var s=e||void 0,c="object"==typeof(null==s?void 0:s.extraData)?s.extraData:void 0,d=e?s&&(0,r.b)(s)||e&&e.name||"Unknown":void 0,l=t||{},u=l.computeVeto,f=l.qosEndSchema,p=e?u?u(null!=f?f:(0,r.a)(e)):"None":void 0;return(0,a.a)((0,a.a)((0,a.a)({errorCode:d,httpStatus:(null==c?void 0:c.status)?Number(null==c?void 0:c.status):void 0,resultCategory:null===(n=null==c?void 0:c.resultCategory)||void 0===n?void 0:n.toString()},s?(0,a.a)({},"boolean"==typeof s.isExpected?{resultType:s.isExpected?i.b.ExpectedFailure:i.b.Failure}:{resultType:i.b.Failure}):{resultType:i.b.Success}),{extraData:(0,a.a)({},s?(0,a.a)((0,a.a)((0,a.a)({},"object"==typeof s.innerError?{innerError:o(s.innerError)}:{}),"string"==typeof s.correlationId?{correlationId:s.correlationId}:{}),s.extraData||{}):{})}),p?{veto:p}:{})}}
,,function(e,t,n){(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:1.25rem;height:1.25rem}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:1rem;line-height:1.25rem;width:1.25rem}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding:0;margin:0}.od-PermissionsSettings-section.other-settings{padding-top:24px}.od-PermissionsSettings-section .od-PermissionsSettings-sharedWithSection{width:50%}@media screen and (-ms-high-contrast:active),(-ms-high-contrast:none){.od-PermissionsSettings-section .od-PermissionsSettings-sharedWithSection{overflow:hidden}}.od-PermissionsSettings-section .od-PermissionsSettings-InfoMessageSection{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";display:flex;padding:1rem 0}.od-PermissionsSettings-section .od-PermissionsSettings-InfoMessageSection i{padding-top:3px;padding-right:5px;font-size:.625rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:'}.od-PermissionsSettings-description.header{font-size:.875rem;font-weight:600;font:-apple-system-body;padding:0 0 8px 0;margin:0}.od-PermissionsSettings-description.header.od-PermissionsSettings-otherSettings{padding-top:24px}[dir=ltr] .od-PermissionsSettings-description.header .od-PermissionsSettings-description-textpart{margin-right:3px}[dir=rtl] .od-PermissionsSettings-description.header .od-PermissionsSettings-description-textpart{margin-left:3px}.od-PermissionsSettings-linksFromTemplateHeader{font-weight:400}.od-PermissionsSetting-specificPeople-container{margin-top:5px;font-size:.875rem}[dir=ltr] .od-PermissionsSetting-specificPeople-container{margin-left:27px}[dir=rtl] .od-PermissionsSetting-specificPeople-container{margin-right:27px}[dir=ltr] .od-PermissionsSetting-specificPeople-container{margin-right:10px}[dir=rtl] .od-PermissionsSetting-specificPeople-container{margin-left:10px}.od-PermissionsSetting-specificPeople-list{max-height:60px;overflow-y:auto;padding-bottom:2px}.od-PermissionsSetting-specificPeople-list a{text-decoration:none;outline:transparent;position:relative}.od-PermissionsSetting-specificPeople-list a::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-PermissionsSettings-setting{margin-bottom:12px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-expirationError{font-size:.625rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:'}.od-PermissionsSettings-PeoplePicker{margin-top:6px}.od-PermissionsSettings-prompt{font:-apple-system-body}[dir=ltr] .od-PermissionsSettings-prompt{padding-right:.25em}[dir=rtl] .od-PermissionsSettings-prompt{padding-left:.25em}#od-PermissionsSettings-learnMore{text-decoration:underline;outline:transparent;position:relative;white-space:nowrap;font:-apple-system-caption2}#od-PermissionsSettings-learnMore::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible #od-PermissionsSettings-learnMore:focus:after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}#od-PermissionsSettings-learnMore i{font-size:.875rem;width:.875rem;height:.875rem;margin:0 5px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir=ltr] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir=rtl] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}.od-PermissionsSettings-changePermission{margin-bottom:12px;display:flex;align-items:center}.od-PermissionsSettings-setting--RequireVerification{width:100%;height:2rem}[dir=ltr] .od-PermissionsSettings-setting--RequireVerification{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--RequireVerification{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--RequireVerification{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--RequireVerification{padding-left:0}.od-RequireVerificationToggle{vertical-align:top;height:100%;display:flex;line-height:2rem}.od-RequireVerificationToggle .ms-Toggle{width:100%}.od-RequireVerificationToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir=ltr] .od-RequireVerificationToggle .ms-Toggle-slider{right:30px}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-slider{left:30px}[dir=ltr] .od-RequireVerificationToggle .ms-Toggle-slider{float:right}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-slider{float:left}.od-RequireVerificationToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 12px;font-size:.875rem;cursor:pointer;width:calc(100% - 4.4rem)}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-RequireVerificationToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:400}.od-RequireVerificationToggle .ms-Toggle-innerContainer{line-height:2rem;margin-top:.25rem}[dir=ltr] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:right}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:left}.od-PermissionsSettings-setting--RequireVerification-Icon{display:inline-block;font-size:1rem}.od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir=rtl] .od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--PreventDownload{width:100%;height:2rem}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{padding-left:0}.od-PermissionsSettings-setting--PreventDownload-Icon{display:inline-block;font-size:1rem}.od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--PreventDownload-Icon svg{height:1.125rem;width:1.125rem}.od-PermissionsSettings-saveLinkSettingsToggle{font-weight:400}.od-PermissionsSettings-saveLinkSettingsToggle .od-PermissionsSettings-saveLinkSettings{display:flex}.od-PermissionsSettings-saveLinkSettingsToggle .od-PermissionsSettings-saveLinkSettingsText{font-weight:400}.od-PermissionsSettings-saveLinkSettingsToggle .od-PermissionsSettings-saveLinkSettingsIcon{align-self:center;padding-right:10px}.od-PermissionsSettings-saveLinkSettingsToggle .od-PermissionsSettings-saveLinkSettingsTooltip{margin-left:5px}.od-PermissionsSettings-saveLinkSettingsToggle .od-PermissionsSettings-saveLinkSettingsTooltip .saveLinkSettingsTooltipIcon{font-size:.625rem}.od-PermissionsSettings-saveLinkSettingsToggle .ms-Toggle-innerContainer{align-self:center}.od-PermissionsSettings-saveLinkSettingsToggle .ms-Toggle{display:flex;justify-content:space-between}.od-PermissionsSettings-setting--OfficeReviewMode{width:100%;height:2rem}[dir=ltr] .od-PermissionsSettings-setting--OfficeReviewMode{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--OfficeReviewMode{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--OfficeReviewMode{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--OfficeReviewMode{padding-left:0}.od-PermissionsSettings-setting--OfficeReviewMode-Icon{display:inline-block;font-size:1rem}.od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir=rtl] .od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-wrapper{width:100%;outline:transparent;position:relative}.od-PermissionsSettings-wrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-wrapper:focus:after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-PermissionsSettings-wrapper :hover{cursor:pointer}.od-PermissionsSettings-blocker{pointer-events:none}.ms-Callout-container .od-PermissionsSettings-teachingBubble{max-width:300px}.od-PermissionsSettings-teachingBubbleIcon{font-size:1.5rem;position:absolute;top:1.5625rem;z-index:1}[dir=ltr] .od-PermissionsSettings-teachingBubbleIcon{padding-left:.3125rem}[dir=rtl] .od-PermissionsSettings-teachingBubbleIcon{padding-right:.3125rem}.od-PermissionsSettings-teachingBubble .ms-TeachingBubble-headline{padding-top:3.125rem}@media screen and (-ms-high-contrast:active){.ms-TeachingBubble-primaryButton:focus,.ms-TeachingBubble-primaryButton:hover{outline:2px solid #fff;background:highlight}}"}])}
,,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return r}});var a=n(106).a.env,i={Prod:0,Dogfood:1,Dev:2,Soak2:3,Soak3:4};function r(){switch(a&&a.toLowerCase()){case"soak3":return i.Soak3;case"soak2":return i.Soak2;case"dev":return i.Dev;case"df":return i.Dogfood;default:return i.Prod}}}
,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a=-6}
,function(e,t,n){n.r(t),n.d(t,{Notify:function(){return j},default:function(){return V}});var a=n(0);(0,n(4).b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Notify{padding:0 4px}.od-Notify.blocker{position:relative}.od-Notify.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Notify .ms-Checkbox-label{align-items:center}.od-Notify-message{display:inline-flex;font-size:15px;padding:6px 0 4px 0;text-overflow:ellipsis;margin:0 3px 0 0}[dir=rtl] .od-Notify-message{margin:0 0 0 3px}.od-Notify-horizontalLine{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding-top:10px}.od-Notify-show-link{display:block;font-size:14px;margin:8px 0 0 auto}[dir=rtl] .od-Notify-show-link{margin:8px auto 0 0}.od-Notify-sendNotification-button{margin:24px auto 6px 0}[dir=ltr] .od-Notify-sendNotification-button{text-align:right}[dir=rtl] .od-Notify-sendNotification-button{text-align:left}[dir=rtl] .od-Notify-sendNotification-button{margin:24px 0 6px auto}.od-Notify-group-recipient{display:flex}.od-Notify-group-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox{margin:0 0 0 auto}[dir=rtl] .od-Notify-PickerPersona-checkbox{margin:0 auto 0 0}.od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{height:14px;width:14px;margin:0 10px 0 0;font-size:13px}[dir=rtl] .od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{margin:0 0 0 10px}.od-Notify-recipientWarning-container{height:38px}.od-Notify-recipientWarning{position:absolute;background-color:rgba(255,185,0,.3)}[dir=ltr] .od-Notify-recipientWarning{left:0}[dir=rtl] .od-Notify-recipientWarning{right:0}.od-Notify-recipientWarning .ms-MessageBar-content{height:43px;align-items:center}.ms-PickerItem-content{max-width:250px}.od-Notify-PickerPersona-container{display:flex;align-items:center}.od-Notify-PickerPersona{border-radius:16px;position:relative;display:inline-flex;vertical-align:top;white-space:nowrap;cursor:default}.od-Notify-PickerPersona .ms-Persona-secondaryText{font-size:11px}.od-Notify-PickerPersona.is-listbelow{width:100%}.od-Notify-groupLabel{font-weight:600;font-size:13px}.od-Notify-totalGroupsMembersCount{font-size:11px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:0 0 12px}.od-Notify-totalMembersCount{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:6px 0;margin:0 0 0 auto}[dir=ltr] .od-Notify-totalMembersCount{text-align:right}[dir=rtl] .od-Notify-totalMembersCount{text-align:left}[dir=rtl] .od-Notify-totalMembersCount{margin:0 auto 0 0}.od-Notify-groups-expand{height:26px;display:flex;align-items:flex-start;margin:14px 0 0}.od-Notify-group-expand-icon .ms-Button-icon{font-size:12px}.od-Notify-groups-listItem{margin:5px 1px}.od-Notify-groups-recipient-container{max-height:145px;overflow-x:hidden}.od-Notify-groups-recipient-container.expanded{margin-bottom:15px}.od-Notify-groups-recipient-container.expanded.scroll{overflow-y:scroll}.od-Notify-group-checkbox .ms-Checkbox-text{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-Notify-peopleLabel{padding:5px 0 14px;font-weight:600;font-size:13px}.od-Notify-people-recipient-container{max-height:190px;overflow-x:hidden;padding:8px 0 10px;margin-top:6px}.od-Notify-people-recipient-container.scroll{overflow-y:scroll}.od-Notify-PeoplePicker .ms-Persona-primaryText{max-width:150px;overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-Notify-PickerPersona-container{margin:8px 0}.od-Notify-groupMembersCount{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:11px}[dir=ltr] .od-Notify-groupMembersCount{margin-left:28px}[dir=rtl] .od-Notify-groupMembersCount{margin-right:28px}.od-Notify-groupMembersCount .ms-Spinner-circle{margin:0}"}]);var i=n(1),r=n(12),o=n(95),s=n(31),c=n(207),d=n(120),l=n(27),u=n(11),f=n(133),p=n(73),m=n(72),_=n(7),h=n(21),b=n(175),g=n(82),v=n(235),y=n(28),S=n(5),D=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onCheckboxChange=function(e,t){var n=a.props.group;n.checked=t,a.setState({group:n},function(){a._sharingStore.getEngagementHelper().log("Notify.GroupCheckboxClicked",a.props.engagementExtraData),a.props.updateCountCallback(),a.props.updateCheckboxForGroup(n)})},a._sharingStore=n.sharingStore,a.state={group:t.group},a}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._sharingStore.fetchMemberCount(this.props.group)},t.prototype.componentDidMount=function(){this._sharingStore.addListener(this.props.updateCountCallback)},t.prototype._renderGroup=function(){var e=this.state.group,t=e.disabled;return i.createElement(v.a,{id:e.email,boxSide:"start",label:t?e.name+" ("+u.ff+")":e.name,checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:(0,h.a)("od-Notify-group-checkbox"),disabled:e.disabled})},t.prototype.render=function(){var e=this.state.group,t=e.disabled;return i.createElement(y.a,{className:(0,h.a)("od-Notify-group-recipient"),id:e.email,content:t?e.name+" ("+u.ff+")":e.name,directionalHint:S.a.bottomCenter},this._renderGroup())},t.contextTypes={sharingStore:r.object.isRequired,strings:r.object.isRequired},t}(i.Component),I=n(78),x=n(43),C=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onCheckboxChange=function(e,t){var n=a.props.person;n.checked=t,a.setState({person:n}),a.context.sharingStore.getEngagementHelper().log("Notify.PersonCheckboxClicked",a.props.engagementExtraData),a.props.updateCheckboxForPerson(n)},a.state={person:t.person},a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.state.person;return i.createElement("div",{className:(0,h.a)("od-Notify-PickerPersona-container")},i.createElement(I.a,{imageUrl:e.image,text:e.name,secondaryText:e.job,showSecondaryText:!!e.job,size:x.c.extraSmall,className:(0,h.a)("od-Notify-PickerPersona")}),i.createElement(v.a,{id:e.email,boxSide:"end",checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:(0,h.a)("od-Notify-PickerPersona-checkbox")}))},t.contextTypes={sharingStore:r.object.isRequired,strings:r.object.isRequired},t}(i.Component),O=n(241),w=n(17),E=n(178),A=n(39),L=n(220),k=n(218),M=n(55),P=n(20),T=n(115),U=n(167),F=n(61),H=n(132),R=n(44),N=n(51),B=100,j=function(e){function t(t,n){var r=e.call(this,t)||this;return r._topLevelDivRef=i.createRef(),r._onExpandClick=function(){r.setState(function(e){return(0,a.a)((0,a.a)({},e),{isExpanded:!e.isExpanded})},function(){r._sharingStore.getEngagementHelper().log("Notify.ExpandLinkClicked",r.props.engagementExtraData)})},r._onStoreUpdate=function(){var e=r._sharingStore.getPermissionsMap(),t=p.h({selectedItems:r.state.peoplePickerRecipients,sharingLinkKind:A.a.direct,canAddExternalPrincipal:r.props.sharingInformation.canAddExternalPrincipal,sharingInformation:r.props.sharingInformation,viewPolicyTipCallback:r._sharingStore.getPolicyTipInformation,permissionsMap:e});t&&r._sharingStore.getEngagementHelper().log("Notify.AddedUserWhoDoesNotHaveAccess",r.props.engagementExtraData),e=(0,a.a)((0,a.a)({},r.state.permissionsMap),e),r.setState(function(n){return(0,a.a)((0,a.a)({},n),{peoplePickerError:t,permissionsMap:e})})},r._onPeoplePickerSelected=function(e){r._sharingStore.checkPermissions(e),e.filter(function(e){return e.principalType!==m.a.user}).forEach(function(e){r._sharingStore.fetchMemberCount(e)}),r._sharingStore.getEngagementHelper().log("Notify.AddedUserFromPeoplePicker",r.props.engagementExtraData);var t=r._sharingStore.getPermissionsMap(),n=p.h({selectedItems:r.state.peoplePickerRecipients,sharingLinkKind:A.a.direct,canAddExternalPrincipal:r.props.sharingInformation.canAddExternalPrincipal,sharingInformation:r.props.sharingInformation,viewPolicyTipCallback:r._sharingStore.getPolicyTipInformation,permissionsMap:t});t=(0,a.a)((0,a.a)({},r.state.permissionsMap),t),r.setState(function(i){return(0,a.a)((0,a.a)({},i),{peoplePickerRecipients:e,peoplePickerError:n,permissionsMap:t})})},r._onResolvedSuggestions=function(e){return r._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(r.props.engagementExtraData,e),e},r._updateGroupCount=function(){for(var e=r._sharingStore.getMembersCounts(),t=r.state.groups.slice(0),n=0;n<t.length;n++){var i=r.state.groups[n];e[i.email]!==i.memberCount&&(i.memberCount=e[i.email],i.checked=!1,i.disabled=i.memberCount>=B,t[n]=i)}r.setState(function(e){return(0,a.a)((0,a.a)({},e),{groups:t})})},r._updateCheckboxForGroup=function(e){var t=r.state.groups;t.map(function(t){return t.email===e.email?e:t}),r.setState({groups:t})},r._updateCheckboxForPerson=function(e){var t=r.state.people;t.map(function(t){return t.email===e.email?e:t}),r.setState({people:t})},r._sendNotification=function(){var e=r._allRecipients();r.setState({showActivityIndicator:!0},function(){r._sharingClientMessenger?r._sharingClientMessenger.sendShareSendClicked():M.v(),r._sharingStore.shareLink({settings:r.props.currentSettings,recipients:e,allRecipientsHaveAccess:!0}),r._sharingStore.getEngagementHelper().shareCompleted((0,a.a)((0,a.a)({},r.props.engagementExtraData),{recipientsCount:e.length})),r._sharingClientMessenger?r._sharingClientMessenger.sendShareCompleted():M.z(o.a.share),r._showSuccessMessage()})},r._onGroupsExpandClick=function(){var e=r.state.groupsIsExpanded;r.setState(function(t){return(0,a.a)((0,a.a)({},t),{groupsIsExpanded:!e})},function(){r._sharingStore.getEngagementHelper().log("Notify.GroupsExpandClicked",r.props.engagementExtraData)})},r._selectAllPeopleCheckbox=function(e,t){var n=r.state.people;n.map(function(e){return e.checked=t,e}),r.setState({people:n})},r._sharingStore=n.sharingStore,r._shareClickTime=n.shareClickTime,r._resize=n.resize,r._sharingClientMessenger=n.sharingClientMessenger,r.state={isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:[],people:[],peoplePickerError:null,showActivityIndicator:!1,permissionsMap:{},viewState:k.a.notify},r._resizeTracker=new F.a(n.resize),r}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillMount=function(){var e=this,t=this.props;this._sharingStore.addListener(this._onStoreUpdate);var n=t.sharingInformation.sharingPrincipals,i=t.sharingInformation.sharingLinks.reduce(function(e,t){return e.concat(t.principals)},[]).concat(n).map(function(e){return{userId:e.loginName,name:e.primaryText,job:e.secondaryText,email:""!==e.email?e.email:e.loginName,principalType:e.type,image:e.imageUrl,rawPersonData:{Key:e.loginName,EntityData:{SPGroupID:e.id}}}}),r=i.filter(function(e){return e.principalType!==m.a.user}).map(function(e){return(0,a.a)((0,a.a)({},e),{checked:!1,expanded:!1,disabled:!0,groupId:e.rawPersonData.groupId,memberCount:null})});r.forEach(function(t){e._sharingStore.fetchMemberCount(t)});var o=i.filter(function(e){return e.principalType===m.a.user}),s={};o.concat(r).forEach(function(e){s[e.email]=L.a.hasAccess}),this.state.peoplePickerRecipients.filter(function(e){return e.principalType!==m.a.user}).forEach(function(t){e._sharingStore.fetchMemberCount(t)}),this.setState({isExpanded:!0,groupsIsExpanded:!0,count:0,peoplePickerRecipients:[],groups:r,people:o,peoplePickerError:null,permissionsMap:s,viewState:k.a.notify})},t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():M.r(this._shareClickTime,this.props.clientId,s.a.notify,this.props.scenarioId,this.props.correlationId),this.setState({groupsIsExpanded:!1,isExpanded:!1}),this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._renderPeoplePicker=function(){var e=this.state,t=this.props;return i.createElement("div",{className:(0,h.a)("od-Notify-PeoplePicker")},i.createElement(f.a,{defaultSelectedItems:e.peoplePickerRecipients,onChange:this._onPeoplePickerSelected,onResolvedSuggestions:this._onResolvedSuggestions,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:t.currentSettings.sharingLinkKind,error:e.peoplePickerError,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),sharingInformation:t.sharingInformation,permissionsMap:e.permissionsMap,clientId:t.clientId}))},t.prototype._computeTotalGroupsMembersCount=function(){var e=this.state,t=this._sharingStore.getMembersCounts();return e.groups.filter(function(e){return e.checked&&t[e.email]}).map(function(e){return t[e.email]}).reduce(function(e,t){return e+t},0)},t.prototype._computeTotalMemberCount=function(){var e=this._sharingStore.getMembersCounts(),t={};return this._allRecipients().forEach(function(e){t[e.email]||(t[e.email]=e)}),Object.keys(t).map(function(n){return t[n].principalType===m.a.user?1:e[n]||0}).reduce(function(e,t){return e+t},0)},t.prototype._allRecipients=function(){var e=this.state;return e.peoplePickerRecipients.concat(e.people.filter(function(e){return e.checked})).concat(e.groups.filter(function(e){return e.checked}))},t.prototype._showSuccessMessage=function(){this.setState(function(e){return(0,a.a)((0,a.a)({},e),{viewState:k.a.linkSuccess,showActivityIndicator:!1})})},t.prototype._renderGroup=function(e){return i.createElement(D,{clientId:this.props.clientId,group:e,updateCountCallback:this._updateGroupCount,updateCheckboxForGroup:this._updateCheckboxForGroup,engagementExtraData:this.props.engagementExtraData})},t.prototype._renderGroups=function(e){var t=this,n=this.state,a=n.groupsIsExpanded?" expanded ":"",r=n.groups.length>5?" scroll ":"";if(0!==e.length)return i.createElement("div",{className:(0,h.a)("od-Notify-groups-container")},i.createElement("div",{className:(0,h.a)("od-Notify-groups-expand")},i.createElement(b.a,{className:(0,h.a)("od-Notify-groupLabel")},u.pf),i.createElement(l.a,{className:"od-Notify-group-expand-icon",iconProps:{iconName:a?"ChevronUp":"ChevronDown"},onClick:this._onGroupsExpandClick})),this._displayTotalGroupsMembersCount(),i.createElement("div",{className:(0,h.a)("od-Notify-groups-recipient-container"+a+r)},a&&e.map(function(e){return i.createElement("div",{key:e.email,className:(0,h.a)("od-Notify-groups-listItem")},t._renderGroup(e))})))},t.prototype._renderPerson=function(e){return i.createElement(C,{clientId:this.props.clientId,person:e,updateCheckboxForPerson:this._updateCheckboxForPerson,engagementExtraData:this.props.engagementExtraData})},t.prototype._renderPeople=function(e){var t=this,n=this.state,a=n.people.length>5?" scroll ":"";return i.createElement("div",{className:(0,h.a)("od-Notify-people-container")},i.createElement(b.a,{className:(0,h.a)("od-Notify-peopleLabel")},u.yf),n.people.length>0&&i.createElement(v.a,{label:u.Df,onChange:this._selectAllPeopleCheckbox,defaultChecked:!1,className:(0,h.a)("od-Notify-people-selectAll-checkbox")}),i.createElement("div",{className:(0,h.a)("od-Notify-people-recipient-container"+a)},e.map(function(e){return t._renderPerson(e)})))},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return i.createElement(d.a,{message:u.s})},t.prototype._renderNotification=function(){var e=this.props,t=e.sharingInformation,n=e.currentSettings,r={companyName:this._sharingStore.getCompanyName(),currentSettings:n,sharingInformation:t,clientId:e.clientId,onShareHintClick:null,linkRecipients:this._allRecipients(),customLabeledAudienceConfig:e.customLabeledAudienceConfig};return i.createElement(c.ShareNotification,(0,a.a)({},(0,H.a)(this.props),{shareType:o.a.share,itemName:t.item.name,linkUrl:null,sharingHintProps:r,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,shouldWaitForSharingInfoBarInformation:this.props.shouldWaitForSharingInfoBarInformation,sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId,engagementExtraData:this.props.engagementExtraData}))},t.prototype._displayTotalMemberCountString=function(){var e=this._computeTotalMemberCount();return this.state.groups.filter(function(e){return e.checked}).length>0?_.j(u.bf,e):1===e?_.j(u.hf):0===e?"":_.j(u.gf,e)},t.prototype._tooManyRecipientsErrorString=function(){return u.xg},t.prototype._displayTotalMembersCountOrError=function(){return i.createElement(b.a,{className:(0,h.a)("od-Notify-totalMembersCount")},this._computeTotalMemberCount()>=B?this._tooManyRecipientsErrorString():this._displayTotalMemberCountString())},t.prototype._displayTotalGroupMemberCountString=function(){var e=this._computeTotalGroupsMembersCount();return 0===e?"":_.j(u.mf,e)},t.prototype._displayTotalGroupsMembersCount=function(){return i.createElement(b.a,{className:(0,h.a)("od-Notify-totalGroupsMembersCount")},this._displayTotalGroupMemberCountString())},t.prototype._renderWarning=function(){var e=this._computeTotalMemberCount(),t=_.j(u._f,e);return e>20&&e<B&&i.createElement("div",{className:"od-Notify-recipientWarning-container"},i.createElement(T.a,{className:(0,h.a)("od-Notify-recipientWarning"),messageBarType:U.a.severeWarning,isMultiline:!0},t))},t.prototype._sendButtonError=function(){return i.createElement(b.a,null,u.If)},t.prototype._renderNotifyMain=function(){var e=this.state,t=this.props,n=e.showActivityIndicator?" blocker":"",a=w.eb(this.props.sharingInformation.item.name,10);return i.createElement("div",{className:"od-Notify"+n},i.createElement("div",{className:"od-Notify-headerAndMessage"},this._renderHeader(),i.createElement(b.a,{className:(0,h.a)("od-Notify-message"),"aria-label":this.props.sharingInformation.item.name},_.j(u.vf,a))),this._renderWarning(),!e.isExpanded&&i.createElement("div",null,i.createElement("div",{className:(0,h.a)("od-Notify-horizontalLine")}),i.createElement(g.a,{onClick:this._onExpandClick,className:(0,h.a)("od-Notify-show-link")},u._i)),e.isExpanded&&i.createElement("div",null,this._renderGroups(e.groups),this._renderPeople(e.people),this._renderPeoplePicker(),i.createElement("div",{className:(0,h.a)("od-Notify-sendNotification-button")},i.createElement(O.a,{ctaLabel:u.mi,currentSettings:t.currentSettings,errorMessage:this._allRecipients().length<1||this._computeTotalMemberCount()>=B?this._sendButtonError():e.peoplePickerError,linkRecipients:this._allRecipients(),maximumMessageLength:1,maximumSubjectLength:1,messageText:"",subjectText:"",onSendLinkClicked:this._sendNotification,permissionsMap:e.permissionsMap,sendButtonType:E.a.button,sharingInformation:t.sharingInformation})),this._displayTotalMembersCountOrError()))},t.prototype._renderViews=function(){return this.state.viewState===k.a.linkSuccess?this._renderNotification():this._renderNotifyMain()},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:P.p(this.props.clientId))&&i.createElement(R.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:u.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a.context.onDismiss()},tooltipContent:u.Vb,directionalHint:S.a.bottomAutoEdge})},t.prototype._renderHeader=function(){return i.createElement(N.a,{actions:this._getHeaderActions(),mainHeaderText:""})},t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return i.createElement("div",{className:"od-Notify"+e},this._renderViews(),this._renderActivityIndicator())},t.contextTypes={resize:r.func.isRequired,strings:r.object.isRequired,sharingStore:r.object.isRequired,shareClickTime:r.number,sharingClientMessenger:r.object.isRequired},t}(i.Component),V=j}
,,,function(e,t,n){n.r(t),n.d(t,{AtMention:function(){return C},default:function(){return O}});var a=n(0),i=n(95),r=n(31);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{box-sizing:border-box;display:inline-flex;padding-bottom:8px}[dir=ltr] .od-AtMention li{padding-right:4px}[dir=rtl] .od-AtMention li{padding-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:';bottom:0;content:"";left:0;opacity:.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-section{padding:24px}.od-AtMention .od-AtMention-headerPadding{padding:16px 16px 0 16px}.od-AtMention .od-AtMention-container{display:inline-block;padding:24px;padding-top:0;box-sizing:border-box;background-color:'},{theme:"menuBackground",defaultValue:"#fff"},{rawString:";width:100%}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.ms-Persona-primaryText{font-size:.875rem;font-weight:600}@supports (font:-apple-system-headline){.od-AtMention .od-AtMention-recipients li>.ms-Persona-primaryText{font:-apple-system-headline}}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-body){.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{font:-apple-system-body}}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';border-radius:16px;font-size:.875rem}@supports (font:-apple-system-body){.od-AtMention .od-AtMention-recipient{font:-apple-system-body}}.od-AtMention div.od-AtMention-message{margin-bottom:16px;font-size:.875rem}@supports (font:-apple-system-body){.od-AtMention div.od-AtMention-message{font:-apple-system-body}}.od-AtMention .od-AtMention-button{margin-bottom:16px;height:auto}.od-AtMention .od-AtMention-button .ms-Button-label{font-weight:600;font-size:.875rem}@supports (font:-apple-system-body){.od-AtMention .od-AtMention-button .ms-Button-label{font:-apple-system-body;height:auto;padding:8px}}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font-size:.875rem;font-weight:600;height:2.75rem;border-radius:8px}@supports (font:-apple-system-body){.od-AtMention .od-AtMention-button-rounded .ms-Button-label{font:-apple-system-body;height:auto;padding:8px}}.od-AtMention .od-AtMention-spinnerHolder{align-items:center;display:flex;height:150px;justify-content:center}.od-AtMention .od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}@media screen and (-ms-high-contrast:active){.od-AtMention .od-AtMention-button:hover{color:window;background-color:highlight;border-color:highlight}.od-AtMention .od-AtMention-button:active,.od-AtMention .od-AtMention-button:focus{color:window;background-color:highlight;border-color:highlight;outline:transparent;position:relative}.od-AtMention .od-AtMention-button:active::-moz-focus-inner,.od-AtMention .od-AtMention-button:focus::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-AtMention .od-AtMention-button:active:focus:after,.ms-Fabric--isFocusVisible .od-AtMention .od-AtMention-button:focus:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}"}]);var o=n(120),s=n(115),c=n(167),d=n(43),l=n(78),u=n(57),f=n(42),p=n(80),m=n(11),_=n(20),h=n(1),b=n(12),g=n(55),v=n(66),y=n(61),S=n(51),D=n(5),I=n(44),x={root:{height:"unset",minHeight:"2rem",padding:"0 1rem"},label:{fontSize:"0.875rem"}},C=function(e){function t(t,n){var a=e.call(this,t)||this;a._topLevelDivRef=h.createRef(),a._onShareClicked=function(){g.y(i.a.grantAccess),a.setState({isSharing:!0},function(){a._store.getEngagementHelper().shareCompleted({clientId:a.props.clientId,scenarioId:a.props.scenarioId,mode:r.a.atMention}),a._store.grantAccess(a.props.recipients,a.props.canGrantEditPermissions)})},a._onOkayClicked=function(){a._notifyGrantAccessCompleted(!1),a._sharingClientMessenger?a._sharingClientMessenger.sendDismiss():a._dismiss()},a._dismiss=n.onDismiss,a._resize=n.resize,a._store=n.sharingStore,a._platformDetection=n.platformDetection,a._shareClickTime=n.shareClickTime,a._sharingClientMessenger=n.sharingClientMessenger;var o=0===t.recipients.length;return o||a._notifyReady(),a.state={canShare:a._canShare(t.recipients),isLoading:o,isSharing:!1},a._resizeTracker=new y.a(n.resize),a}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady(),this.setState({canShare:this._canShare(e.recipients),isLoading:t})},t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()},t.prototype.componentDidMount=function(){var e=this;this._notifyReadyForRecipients(),this._store.addListener(function(){var t=e._store.getGrantAccessResult();null!==t&&(e._notifyGrantAccessCompleted(t),e.props.onComplete&&e.props.onComplete(!!t),e._sharingClientMessenger?e._sharingClientMessenger.sendDismiss():e._dismiss())}),this._resizeIfNeeded()},t.prototype.render=function(){var e,t=this.state,n=t.canShare,a=t.isLoading,i=t.isSharing;return e=a?this._renderLoadingSpinner():n?this._renderHappyPath():this._renderSadPath(),h.createElement("div",{ref:this._topLevelDivRef,className:"od-AtMention ".concat(i?"od-AtMention--isSharing":"")},h.createElement("div",{className:"od-AtMention-section"},!a&&this._renderHeader()),e,this._renderSharingActivityIndicator(),v.a(this._getScreenReaderAlertMessage(),"assertive","alert",!0))},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:_.p(this.props.clientId))&&h.createElement(I.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:m.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a._dismiss()},tooltipContent:m.Vb,directionalHint:D.a.bottomAutoEdge})},t.prototype._renderHeader=function(){return h.createElement(S.a,{mainHeaderText:m.Ud,actions:this._getHeaderActions()})},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._renderLoadingSpinner=function(){return h.createElement("div",{className:"od-AtMention-spinnerHolder"},h.createElement(f.a,{className:"od-AtMention-spinner",label:m.Gb,type:p.b.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))},t.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return h.createElement(o.a,{message:m.Td})},t.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button",t=this._getHappyMessage();return h.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),h.createElement("div",{className:"od-AtMention-message"},t),h.createElement(u.a,{autoFocus:!0,className:e,onClick:this._onShareClicked,"aria-label":m.Si,styles:x},m.Si))},t.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return h.createElement("div",{className:"od-AtMention-container"},h.createElement(s.a,{messageBarType:c.a.warning,styles:{icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}}},this._getSadMessage()),this._renderRecipients(!0),h.createElement(u.a,{autoFocus:!0,className:e,onClick:this._onOkayClicked,"aria-label":m.Si,styles:x},m.Ef))},t.prototype._renderRecipients=function(e){var t=this,n=this.props.recipients.map(function(e){var n=t._isRecipientInvalid(e),i={imageUrl:e.image,primaryText:e.name,size:d.c.extraSmall,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},initials:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px",lineHeight:"2.5rem"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"},details:{paddingLeft:t._platformDetection.isIE?"24px":"8px"}}};return h.createElement("li",null,h.createElement(l.a,(0,a.a)({},i,{className:"od-AtMention-recipient ".concat(n?"od-AtMention-recipient--error":"")})))});return h.createElement("ul",{className:"od-AtMention-recipients ".concat(e?"od-AtMention-recipients--error":""),"aria-label":m.Fd},n)},t.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?m.Td:m.Ud},t.prototype._canShare=function(e){var t=this,n=this.props.sharingInformation;return!!n.canManagePermissions&&!!n.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)})},t.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName},t.prototype._notifyReady=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():g.r(this._shareClickTime,this.props.clientId,r.a.atMention,this.props.scenarioId,this.props.correlationId)},t.prototype._notifyReadyForRecipients=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReadyForRecipients():g.t()},t.prototype._notifyGrantAccessCompleted=function(e){this._sharingClientMessenger?this._sharingClientMessenger.sendGrantAccessCompleted(e):g.g(e)},t.prototype._getHappyMessage=function(){return this._store.isConsumer()?m.tb:this._store.isListItem()?m.eb:_.i(this.props.clientId)?m.nb:m.ab},t.prototype._getSadMessage=function(){if(this._store.isConsumer())return m.sb;var e=this.props.sharingInformation,t=_.i(this.props.clientId)?m.ib:m.rb;return e.canManagePermissions&&e.canAddInternalPrincipal?m.ob:t},t.contextTypes={onDismiss:b.func.isRequired,resize:b.func.isRequired,sharingStore:b.object.isRequired,platformDetection:b.object.isRequired,shareClickTime:b.number,sharingClientMessenger:b.object},t}(h.Component),O=C}
,function(e,t,n){n.r(t),n.d(t,{ModifyPermissions:function(){return se},default:function(){return ce}});var a=n(0),i=n(4);(0,i.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ModifyPermissions{overflow-x:hidden;overflow-y:auto}.od-ModifyPermissions.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}.od-ModifyPermissions.wide{min-width:480px}@media (max-width:480px){.od-ModifyPermissions.wide{min-width:320px}}.od-ModifyPermissions.simplified{overflow-x:hidden;overflow-y:auto}.od-ModifyPermissions.simplified .Header-actions{flex-wrap:wrap}#od-ModifyPermissions-apply-id.ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}@supports (font:-apple-system-body){.od-ModifyPermissions-actions button{height:auto;padding:8px}}.od-ModifyPermissions-actions button .flexContainer{height:2rem}@supports (font:-apple-system-body){.od-ModifyPermissions-actions button .flexContainer{height:1rem}}@supports (font:-apple-system-headline){.od-ModifyPermissions-actions .ms-Button-label{font:-apple-system-headline}}#od-ModifyPermissions-actions-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}.teams .od-ModifyPermissions-actions{padding-bottom:32px}[dir=ltr] .teams .od-ModifyPermissions-actions.old{padding-right:0}[dir=rtl] .teams .od-ModifyPermissions-actions.old{padding-left:0}.od-ModifyPermissions-section{padding:24px!important}.od-ModifyPermissions-section.permissionsSettings{padding-top:0!important;padding-bottom:0!important}.od-ModifyPermissions-section.sharingInfoBar{padding-bottom:12px!important}.teams .od-ModifyPermissions-section{padding-top:10px}.od-ModifyPermissions-section-noAudienceMod{padding-top:0}.od-ModifyPermissions-actions{padding:24px;padding-top:1.5rem}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-margins{margin:0 14px 0 10px;padding:0 6px}[dir=rtl] .od-ModifyPermissions-margins{margin:0 10px 0 14px}.od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{width:100%;margin-top:4px;margin-bottom:4px}[dir=ltr] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-left:-4px}[dir=rtl] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-right:-4px}@media screen and (-ms-high-contrast:active){.od-ModifyPermissions-apply:focus,.od-ModifyPermissions-apply:hover{background:highlight}}.od-ModifyPermissions-Header{padding:16px}.od-ModifyPermissions-sharingInfoBar{padding-left:24px!important;padding-right:24px!important;padding-bottom:20px!important;padding-top:12px!important}"}]);var r=n(31),o=n(29),s=n(32),c=n(39),d=n(93),l=n(548),u=n(120),f=n(88),p=n(108),m=n(132),_=(n(292),n(366)),h=n(16),b=n(244),g=n(370),v=n(371),y=n(17),S=n(238),D=n(177),I=n(367),x=n(73),C=n(1),O=n(12),w=n(86),E=n(7),A=n(133),L=n(11),k=n(372),M=n(20),P=n(482),T=n(10),U=n(82),F=n(243);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .teams .od-LinkTemplateChoiceGroup-row{padding-left:0}[dir=rtl] .teams .od-LinkTemplateChoiceGroup-row{padding-right:0}.teams .od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{font-weight:700}.od-LinkTemplateChoiceGroup-row{background:0 0;border:none;cursor:pointer;margin-top:4px;font:-apple-system-caption1;padding:0;width:calc(100% - 24px)}.od-LinkTemplateChoiceGroup-row .od-ShareHintDetail{padding-top:2px}.od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:';font-weight:600}.od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{content:"\\e73e";font-family:FabricMDL2Icons;color:'},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin-top:10px;font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:"},{theme:"smallFontWeight",defaultValue:"400"},{rawString:"}[dir=ltr] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir=rtl] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:left}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareHintDetail-statusText{color:#a19f9d}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast:active){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast:black-on-white){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast:active){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{box-shadow:0 0 0 1px #37006e inset}}.teams .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.od-LinkTemplateChoiceGroup-description{align-items:center;display:inline-flex;overflow:hidden;width:90%}[dir=ltr] .od-LinkTemplateChoiceGroup-description{float:left}[dir=rtl] .od-LinkTemplateChoiceGroup-description{float:right}"}]);var H=n(65),R=n(74),N=n(100),B=n(28),j=n(239),V=n(107),z=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onActiveElementChanged=function(e){if(!a._platformDetection.isMobile&&!M.f(a.props.clientId)&&e&&e.hasAttribute("data-key")){var t=e.getAttribute("data-key");"true"===e.getAttribute("aria-disabled")||a._onRowClick(t,null)}},a.state={selectedKey:a._getSelectedIndex(t)},a._platformDetection=n.platformDetection,a}return(0,a.d)(t,e),t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var a=n[t];if(a.isChecked)return a.key}return null},t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return C.createElement("div",{"aria-label":L.eh,role:"radiogroup"},C.createElement(H.a,{direction:R.a.vertical,defaultActiveElement:".od-LinkTemplateChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))},t.prototype._renderItem=function(e){var t=e.key,n=e.isDisabled&&e.disabledText?e.disabledText:"",a=this.state.selectedKey===t,i=S.a[e.permissionsType],r=e.iconUrl?C.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:e.iconUrl,alt:e.label}):C.createElement(T.a,{"aria-hidden":"true",iconName:i});return C.createElement("div",{key:t},C.createElement("button",{role:"radio","aria-checked":a,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:a,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":"".concat(e.label," ").concat(n),"data-key":t},C.createElement("span",{tabIndex:-1,role:"status","aria-live":"polite","aria-label":a?E.j(L.db,e.label):"",className:"od-Share-screenReaderOnly"},a?E.j(L.db,e.label):""),C.createElement("div",{className:"od-LinkTemplateChoiceGroup-description"},C.createElement("div",{className:"od-ShareLinkDescription"},C.createElement("div",{className:"od-ShareLinkDescription-icon icon-".concat(i),"aria-hidden":"true"},r),this._renderLabel(e))),C.createElement("div",{className:"tickIcon","aria-hidden":!0})),C.createElement("div",{className:"od-LinkTemplateChoiceGroup-bottomBorder"}))},t.prototype._renderLabel=function(e){var t=e.isDisabled&&e.disabledText?e.disabledText:"";return t&&C.createElement(j.a,{message:t}),C.createElement("div",{className:"od-ShareHintDetail"},C.createElement("div",{className:"od-ShareHintDetail-description"},C.createElement("div",{className:"od-ShareHintDetail-status"},C.createElement("span",{className:"od-ShareHintDetail-statusText"},e.label),this._renderStatusIcons(e.link))))},t.prototype._renderStatusIcons=function(e){if(e){var t=e.expiration,n=e.hasPassword,a=e.blockDownload,i=[];t&&t.getTime()!==new Date(0).getTime()&&i.push({icon:"Calendar",tooltip:"".concat(E.j(L.fd,(0,N.f)(t)))}),n&&i.push({icon:"Lock",tooltip:L.Ei}),a&&i.push({icon:"BlockDownloadIcon",tooltip:L.lh}),e.audience!==o.a.existing&&e.isReview&&V.a[this.props.sharingInformation.fileExtension]&&i.push({icon:"Feedback",tooltip:L.wf});var r=i.map(function(e,t){return C.createElement("span",{className:"od-ShareHintDetail-item"},C.createElement(B.a,{content:e.tooltip,id:e.icon},C.createElement(T.a,{iconName:e.icon,"aria-label":e.tooltip,"tab-index":0})))});return C.createElement("div",{className:"od-ShareHintDetail-iconsList"},r)}},t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-LinkTemplateChoiceGroup-row";return this.state.selectedKey===e.key&&(t+=" is-selected"),e.isDisabled&&(t+=" is-disabled"),t},t.prototype._onRowClick=function(e,t){var n=this.props;this.setState({selectedKey:e}),n.onChange(e),n.onLinkTemplateChange(e)},t.contextTypes={platformDetection:O.object.isRequired},t}(C.Component),G=n(71),K=n(24),W=n(70),q=n(236),Q=n(237),Y=n(94),J=n(176),X=n(5),Z=function(e){function t(t,n){var i,c,d=e.call(this,t)||this;d._allowEditCheckbox=(0,C.createRef)(),d._pickerUpsellDiv=(0,C.createRef)(),d._passwordUpsellDiv=(0,C.createRef)(),d._isLinkReShareEnabled=!!G.c(),d._onSharedWithClicked=function(){d.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(d.props.engagementExtraData),d.props.onShowPermissionsListClicked()},d._learnMoreClicked=function(){d.context.sharingStore.getEngagementHelper().linkSettingsLearnMoreClicked(d.props.engagementExtraData)},d._onPeoplePickerChange=function(e){d.setState((0,a.a)((0,a.a)({},d.state),{externalRecipientWarning:x.c(e),groupRecipientWarning:x.d(e,d.props.groupsMemberCount)}),function(){d.props.onPeoplePickerChange(e)})},d._setSpecificPeopleReadOnlyExpanded=function(){d.setState({isSpecificPeopleReadOnlyExpanded:!0})},d._renderInfoMessageSection=function(){if(d._isLinkReShareEnabled&&d.props.sharingInformation.requiresAccessApproval){var e=E.j(L.th,(0,y.F)(d.props.selectedPermissions.sharingRole)),t=C.createElement(U.a,{onClick:d.props.onLinkSettingsInfoMessageClick},L.ah);return d.props.mode===r.a.share&&(t=C.createElement(C.Fragment,null,L.ah)),C.createElement("div",{className:"od-PermissionsSettings-section"},d.props.selectedPermissions.audience===o.a.existing&&C.createElement(J.a,null),C.createElement("div",{className:"od-PermissionsSettings-InfoMessageSection"},C.createElement(T.a,{iconName:"InfoSolid"}),C.createElement("div",null,e,C.createElement("br",null),L.nh,t)))}},d._onAllowRoleChange=function(e){var t=!1,n=!1;e===s.a.edit&&(t=!0),e===s.a.review&&(n=!0);var i=!n;d.setState((0,a.a)((0,a.a)({},d.state),{preventDownloadDisabled:t||n,officeReviewModeDisabled:i}),function(){d.props.onRoleChange(e)})},d._onResolvedSuggestions=function(e){return d.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(d.props.engagementExtraData,e),e},d._resize=n.resize;var l=t.selectedPermissions.specificPeople;return d.state={expirationErrorCode:y.b.none,externalRecipientWarning:x.c(l),groupRecipientWarning:x.d(l,t.groupsMemberCount),preventDownloadDisabled:d.props.selectedPermissions.isEdit||d.props.selectedPermissions.isReview,officeReviewModeDisabled:!1===d.props.selectedPermissions.isEdit&&!1===d.props.selectedPermissions.isReview,showPickerTeachingBubble:!1,showPasswordTeachingBubble:!1,isSpecificPeopleReadOnlyExpanded:!1,shouldSaveLinkSettings:!1},d._onAllowEditChange=d._onAllowEditChange.bind(d),d._onTrackableChange=d._onTrackableChange.bind(d),d._onLinkTemplateChoiceChange=d._onLinkTemplateChoiceChange.bind(d),d._onSelectDate=d._onSelectDate.bind(d),d._renderExpirationDatePicker=d._renderExpirationDatePicker.bind(d),d._renderExpirationDatePickerErrorMessage=d._renderExpirationDatePickerErrorMessage.bind(d),d._renderPeoplePicker=d._renderPeoplePicker.bind(d),d._linkTemplateOptions=d._getLinkTemplateOptions(),d._supportedAudienceOptions=n.sharingStore.getSupportedAudienceOptions(),d._hiddenAudienceOptions=(null===(i=t.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],d._disabledAudienceOptions=(null===(c=t.hostOptions)||void 0===c?void 0:c.disabledAudienceOptions)||[],d._showSimplifiedShareDialogV2=(0,y.Z)(d.props.clientId,n.sharingStore),d}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.context.platformDetection.isMobile;this._isConsumer=this.context.sharingStore.isConsumer(),this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed(),this._disablePremiumFeatures&&(this._pickerUpsellDiv.current&&(this._pickerUpsellDiv.current.addEventListener("click",function(t){e._togglePickerTeachingBubble()}),this._pickerUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==h.a.enter&&t.keyCode!==h.a.space||e._togglePickerTeachingBubble()}),t&&this._pickerUpsellDiv.current.addEventListener("focus",function(t){e._togglePickerTeachingBubble()})),this._passwordUpsellDiv.current&&(this._passwordUpsellDiv.current.addEventListener("click",function(t){e._togglePasswordTeachingBubble()}),this._passwordUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==h.a.enter&&t.keyCode!==h.a.space||e._togglePasswordTeachingBubble()}),t&&this._passwordUpsellDiv.current.addEventListener("focus",function(t){e._togglePasswordTeachingBubble()})));var n,a,i=document.getElementsByClassName("od-PermissionsSettings-allowEdit")[0];i&&(n=i.getElementsByClassName("ms-Checkbox-text")[0],a=i.children[0]),n&&n.setAttribute("aria-hidden","true"),a&&(a.setAttribute("aria-label",L.H),this.context.sharingStore.isPremiumExperienceAllowed()||a.focus())},t.prototype.componentDidUpdate=function(e,t){this._resize()},t.prototype.render=function(){var e=this.props;return this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed(),this._getLinkTemplateOptions().length>0?C.createElement("div",{className:"od-PermissionsSettings"},C.createElement("div",{className:"od-PermissionsSettings-section"},C.createElement("h2",{className:"od-PermissionsSettings-description header od-ModifyPermissions-margins"},C.createElement("span",{className:"od-PermissionsSettings-linksFromTemplateHeader"},L._e)),C.createElement(z,{items:this._getLinkTemplateOptions(),onChange:this._onLinkTemplateChoiceChange,onLinkTemplateChange:e.onLinkTemplateChange,companyName:e.companyName,clientId:e.clientId,sharingInformation:e.sharingInformation}),this._renderPeoplePicker())):this._getAudienceOptions().length>=1?C.createElement("div",{className:"od-PermissionsSettings"},C.createElement("div",{className:"od-PermissionsSettings-section"},C.createElement("h2",{className:"od-PermissionsSettings-description header od-ModifyPermissions-margins"},C.createElement("span",{className:"od-PermissionsSettings-prompt",id:"od-PermissionsSettings-prompt-id"},this._isLinkReShareEnabled?L.$g:L.eh)),C.createElement(_.a,{items:this._getAudienceOptions(),onAudienceChange:e.onAudienceChange,companyName:e.companyName,clientId:e.clientId,engagementExtraData:e.engagementExtraData}),this._renderPeoplePicker()),this._renderOtherSettings(),this._renderInfoMessageSection(),this._renderSaveLinkSettings()):C.createElement("div",{className:"od-PermissionsSettings"},C.createElement("div",{className:"od-PermissionsSettings-section"}),this._renderOtherSettings(),this._renderSaveLinkSettings())},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,n=e.selectedPermissions,i=n.specificPeople;K.A()||0===i.length&&e.recipients.length>0&&this._onPeoplePickerChange(e.recipients);var r=y.b.none;K.n()?n.audience===o.a.anyone&&(r=(0,y.t)(n.expiration,e.sharingInformation.anonymousLinkExpirationRestrictionDays)):r=(0,y.t)(n.expiration,e.sharingInformation.anonymousLinkExpirationRestrictionDays),this.setState((0,a.a)((0,a.a)({},this.state),{expirationErrorCode:r,externalRecipientWarning:x.c(i),groupRecipientWarning:x.d(i,e.groupsMemberCount),preventDownloadDisabled:n.isEdit||n.isReview,officeReviewModeDisabled:!n.isEdit&&!n.isReview}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})},t.prototype._togglePickerTeachingBubble=function(){this.setState({showPickerTeachingBubble:!this.state.showPickerTeachingBubble})},t.prototype._togglePasswordTeachingBubble=function(){this.setState({showPasswordTeachingBubble:!this.state.showPasswordTeachingBubble})},t.prototype._renderSaveLinkSettings=function(){var e=this,t=L.li,n={maxWidth:"300px",onRenderContent:function(){return C.createElement("div",{className:"od-PermissionsSettings-saveLinkSettingsTooltipContent"},t)}},a=C.createElement("div",{className:"od-PermissionsSettings-saveLinkSettings"},C.createElement(T.a,{className:"od-PermissionsSettings-saveLinkSettingsIcon",iconName:"SingleBookmark"}),C.createElement("div",{className:"od-PermissionsSettings-saveLinkSettingsText"},L.di),C.createElement(B.a,{hostClassName:"od-PermissionsSettings-saveLinkSettingsTooltip",directionalHint:X.a.topCenter,calloutProps:{gapSpace:0},tooltipProps:n},C.createElement(T.a,{className:"ms-Icon ms-Icon--Info saveLinkSettingsTooltipIcon",iconName:"Info",tabIndex:0,role:"img","aria-label":t})));return K.Y()&&!K.Z()&&C.createElement("div",{className:"od-PermissionsSettings-section"},C.createElement("h2",{className:"od-PermissionsSettings-description header od-PermissionsSettings-otherSettings"},L.Fe),C.createElement("div",{className:"od-PermissionsSettings-saveLinkSettingsToggle"},C.createElement(b.a,{label:a,styles:{label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}},role:"switch",onChanged:function(){e.setState({shouldSaveLinkSettings:!e.state.shouldSaveLinkSettings})},checked:this.state.shouldSaveLinkSettings,onText:L.lk,offText:L.Qe})))},t.prototype._renderOtherSettings=function(){var e=!this._disablePremiumFeatures||!this.context.sharingStore.disablePremiumUpsell(),t=L.Fe,n=!this.props.sharingInformation.requiresAccessApproval&&this.props.selectedPermissions.audience!==o.a.existing;if(this._isLinkReShareEnabled&&(n=this.props.selectedPermissions.audience!==o.a.existing),n)return C.createElement("div",{className:"od-PermissionsSettings-section"},C.createElement("h2",{className:"od-PermissionsSettings-description header od-PermissionsSettings-otherSettings"},t),C.createElement("div",{role:"group","aria-label":t},this._renderRolesDropDown(),e&&this._renderExpirationDatePicker(),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),e&&this._renderPasswordField(),this._renderPreventDownloadToggle()))},t.prototype._getSpecificPeopleOption=function(){var e=this.props.sharingInformation.requiresAccessApproval,t=e?L.Zg:this._getSpecificPeopleLabel(),n=!this.props.createPeopleSharingLinks||e?[c.a.direct]:[c.a.flexible],a=this.props.createPeopleSharingLinks?o.a.specificPeopleFlex:o.a.specificPeople,i={disabledText:L.jc,icon:S.a[D.a.specificPeople],isChecked:!1,isDisabled:!1,key:a,label:t,linkKinds:n,permissionsType:D.a.specificPeople,detailText:L.Wg};return this.props.selectedPermissions.audience!==o.a.specificPeople&&this.props.selectedPermissions.audience!==o.a.specificPeopleFlex||!this.props.copyLinkShortcut&&this.props.mode!==r.a.linkSettings||(i.subComponent=C.createElement(A.a,{defaultSelectedItems:this.props.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:this.state.externalRecipientWarning,oversharingGroupsWarning:this.state.groupRecipientWarning,pickerSettings:this.props.sharingInformation.peoplePickerSettings,error:this.props.peoplePickerError,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:this.props.onPeoplePickerInputChange||null})),i},t.prototype._renderPeoplePicker=function(){var e=this.props,t=e.selectedPermissions,n=e.copyLinkShortcut,a=e.mode,i=(e.peoplePickerError,e.sharingInformation,e.onPeoplePickerInputChange,e.clientId,e.currentSettings);if(this.state,(t.audience===o.a.specificPeople||t.audience===o.a.specificPeopleFlex)&&(n||a===r.a.linkSettings)&&M.j(this.props.clientId))return C.createElement("div",{className:"od-PermissionsSetting-specificPeople-container"},i.specificPeople.length>0?this._renderReadOnlySpecificPeople():void 0)},t.prototype._renderReadOnlySpecificPeople=function(){for(var e="",t=this.props.currentSettings.specificPeople,n=this.state.isSpecificPeopleReadOnlyExpanded?t.length:5,a=t.length-n,i=0;i<Math.min(t.length,n);i++)e+=t[i].name+(t.length-1>i?", ":"");var r=a>0&&!this.state.isSpecificPeopleReadOnlyExpanded?C.createElement("a",{href:"javascript:void(0)",onClick:this._setSpecificPeopleReadOnlyExpanded}," +"+a):void 0;return C.createElement("div",{className:"od-PermissionsSetting-specificPeople-list"},e,r)},t.prototype._renderRolesDropDown=function(){var e=this.props,t=!this.context.sharingStore.isConsumer()&&w.j(e.selectedPermissions.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension),n=!0;return this._isLinkReShareEnabled&&e.sharingInformation.requiresAccessApproval&&(n=!1),C.createElement("div",{className:"od-PermissionsSettings-setting"},C.createElement("div",{className:"od-PermissionsSettings-changePermission"},C.createElement(I.a,{mode:e.mode,clientId:e.clientId,selectedPermissions:e.selectedPermissions,onRoleChange:this._onAllowRoleChange,canChangePermission:n,sharingInformation:this.props.sharingInformation,showDropdownWithOfficeReview:t})))},t.prototype._renderRequireVerificationToggle=function(){var e=this.props,t=e.selectedPermissions,n=this.props.sharingInformation.anyoneLinkTrackUsers,a=M.c(e.clientId),i=!a,r=!1;return t.audience===o.a.anyone?(r=!(!n||a)||t.trackLinkUsers,C.createElement("div",{className:"od-PermissionsSettings-setting"},C.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification"},C.createElement("div",{className:"od-RequireVerificationToggle"},C.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification-Icon"},C.createElement(T.a,{iconName:"ReminderPerson"})),C.createElement(b.a,{"aria-disabled":i,role:"checkbox",checked:r,disabled:i,label:a?L.ti:L.ai,onChange:this._onTrackableChange,styles:{label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}}}))))):void 0},t.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions,n=this.context.sharingStore.isExpirationDateModificationAllowed(),a=!1,i=e.sharingInformation.anonymousLinkExpirationRestrictionDays;return this._showSimplifiedShareDialogV2&&K.n()&&(a=t.audience!==o.a.existing,t.audience!==o.a.anyone&&(i=-1)),n&&a||t.audience===o.a.anyone||this.context.sharingStore.isSpecificPeopleExpirationAllowed()&&t.audience===o.a.specificPeople?this._disablePremiumFeatures?C.createElement("div",{ref:this._pickerUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0,role:"tab","aria-label":"".concat(L.ad)},C.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},C.createElement("div",{className:"od-PermissionsSettings-setting"},C.createElement("div",{className:"od-PermissionsSettings-datePicker"},C.createElement(g.a,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:i,disableAutoFocus:!0,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures,tabIndex:-1})),this._renderExpirationTeachingBubble(),C.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())))):C.createElement("div",{className:"od-PermissionsSettings-setting"},C.createElement("div",{className:"od-PermissionsSettings-datePicker"},C.createElement(g.a,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:i,disableAutoFocus:!0,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures})),this._renderExpirationTeachingBubble(),this._renderExpirationDatePickerErrorMessage()):void 0},t.prototype._renderExpirationTeachingBubble=function(){var e=this;if(this.state.showPickerTeachingBubble){var t={targetElement:this._pickerUpsellDiv.current,onDismiss:function(t){return e.setState({showPickerTeachingBubble:!1})},headline:L.cd,mainText:L.dd};return this._renderUpsellTeachingBubble(t)}},t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=(0,y.s)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return C.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},t)},t.prototype._renderPasswordField=function(){var e=this.props,t=this.context.sharingStore.isPasswordModificationAllowed(),n=e.selectedPermissions;if(t&&n.audience===o.a.anyone){if(this._disablePremiumFeatures)return C.createElement("div",{ref:this._passwordUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0,role:"tab","aria-label":"".concat(L.Kf)},C.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},C.createElement("div",{className:"od-PermissionsSettings-setting"},C.createElement(v.a,{onPasswordChange:this.props.onPasswordChange,readOnly:!0,showGleam:!0,tabIndex:-1,engagementExtraData:this.props.engagementExtraData}),this._renderPasswordTeachingBubble())));var a=!1;return K.z()&&(a=!!this.props.selectedPermissions.password),C.createElement("div",{className:"od-PermissionsSettings-setting"},C.createElement(v.a,{onPasswordChange:this.props.onPasswordChange,engagementExtraData:this.props.engagementExtraData,detailsPane:a}))}},t.prototype._renderPasswordTeachingBubble=function(){var e=this;if(this.state.showPasswordTeachingBubble){var t={targetElement:this._passwordUpsellDiv.current,onDismiss:function(t){return e.setState({showPasswordTeachingBubble:!1})},headline:L.rg,mainText:L.og};return this._renderUpsellTeachingBubble(t)}},t.prototype._getLinkTemplateOptions=function(){if(this._isLinkReShareEnabled)return[];var e=[],t=this.props.sharingInformation,n=t.sharingLinkTemplates,a=t.sharingAbilities,i=w.f(a,n);if(i.length>0){for(var r=0,s=i;r<s.length;r++){var d=s[r];e.push(this._getLinkTemplateOption(d))}var l={icon:S.a[D.a.workGroup],isChecked:this.props.currentSettings.audience===o.a.existing,isDisabled:!1,key:o.a.existing.toString(),label:L.Ng,linkKinds:[c.a.direct],permissionsType:D.a.existing};e.push(l);var u=this.props.sharingInformation.requiresAccessApproval?L.Zg:this._getSpecificPeopleLabel(),f={icon:S.a[D.a.specificPeople],isChecked:this.props.currentSettings.audience===o.a.specificPeople,isDisabled:!1,key:o.a.specificPeople.toString(),label:u,linkKinds:[c.a.direct],permissionsType:D.a.specificPeople};e.push(f)}return e},t.prototype._getLinkTemplateOption=function(e){var t={icon:S.a[D.a.anyone],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[c.a.anonymousView,c.a.anonymousEdit],permissionsType:D.a.anyone,link:e},n={icon:S.a[D.a.workGroup],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[c.a.organizationView,c.a.organizationEdit],permissionsType:D.a.workGroup,link:e},a={sharingLink:e,companyName:this.props.companyName,clientId:this.props.clientId,isListSharing:this.props.sharingInformation.sharedObjectType===W.a.list,customLabeledAudienceConfig:null,fileExtension:this.props.sharingInformation.fileExtension,isFolder:this.props.sharingInformation.sharedObjectType===W.a.folder},i=(0,y.z)(a);switch(e.audience){case o.a.anyone:return t.key=e.shareId,t.label=i,t;case o.a.organization:return n.key=e.shareId,n.label=i,n}},t.prototype._getAudienceOptions=function(){var e=this,t=this.props.sharingInformation.sharingAbilities,n=this.props.sharingInformation,a=[],i=this.props.currentSettings,s=void 0;for(var d in t)if(t.hasOwnProperty(d)){var l=t[d];if(null!==l){var u=w.d(d),f=a.map(function(e){return e.key}).indexOf(u)>-1;if(!u||f)continue;if(u===o.a.specificPeopleFlex&&!this.props.createPeopleSharingLinks){if(this._isLinkReShareEnabled&&n.requiresAccessApproval)continue;s=this._getSpecificPeopleOption(),n.canManagePermissions&&!n.blockPeoplePickerAndSharing?s.isChecked=s.key===i.audience||o.a.specificPeopleFlex===i.audience:s.isDisabled=!0,this._supportedAudienceOptions.indexOf(o.a.specificPeople)>-1&&a.push(s);continue}(A=this._getAudienceOption(u))&&(A.isDisabled=!(l.canManageEditLink.enabled||l.canManageReadLink.enabled),A.isDisabled&&this._isLinkReShareEnabled&&n.requiresAccessApproval&&this.context.sharingStore.getReShareLink(u)&&(A.isDisabled=!1),A.isChecked=A.key===i.audience,this._isLinkReShareEnabled&&A.isDisabled||a.push(A))}}var p={icon:S.a[D.a.workGroup],isChecked:i.audience===o.a.existing,isDisabled:!1,key:o.a.existing,label:L.Ng,linkKinds:[c.a.direct],permissionsType:D.a.existing,detailText:L.Rg};this._isLinkReShareEnabled&&(p.label=L.zg),-1!==this._supportedAudienceOptions.indexOf(o.a.existing)&&a.splice(2,0,p);var m=(0,y.G)(n,this._isConsumer),_=m.shared,h=m.activeLinks,b=m.sharingPrincipals;_&&!M.l(this.props.clientId)&&(p.subComponent=C.createElement("div",{className:"od-PermissionsSettings-sharedWithSection"},C.createElement(q.a,{ariaLabel:L.De,label:null,getPhotoUrl:(0,Q.b)(n.webUrl),onClick:this._onSharedWithClicked,sharingLinks:h,sharingPrincipals:b,renderOverlap:!0})));var g=a.filter(function(e){return e.key===o.a.specificPeople&&!e.isDisabled||e.key===o.a.specificPeopleFlex&&!e.isDisabled?e:null})[0],v=!this.props.omitCustomLabeledAudience&&(0,y.P)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig);if(g&&v){var I=this._getAudienceOption(o.a.customLabeledSpecificPeople);a.splice(2,0,I),I.isDisabled=!(this.props.sharingInformation.canAddInternalPrincipal||this.props.sharingInformation.canAddExternalPrincipal),I.isChecked=i.audience===o.a.customLabeledSpecificPeople||this.props.preferCustomLabeledAudience&&i.audience===o.a.specificPeopleFlex}this.props.mode!==r.a.linkSettings||!M.j(this.props.clientId)||this.props.shareId&&i.audience===o.a.specificPeopleFlex||!g||a.splice(a.indexOf(g),1);for(var x=[],O=0,E=a;O<E.length;O++){var A=E[O];-1!==this._hiddenAudienceOptions.indexOf(A.key)&&i.audience!==A.key||(-1!==this._disabledAudienceOptions.indexOf(A.key)&&i.audience!==A.key&&(A.isDisabled=!0),x.push(A))}return this._isLinkReShareEnabled&&x.sort(function(t,n){return e._supportedAudienceOptions.indexOf(t.key)-e._supportedAudienceOptions.indexOf(n.key)}),x},t.prototype._renderPreventDownloadToggle=function(){var e,t=this.props.selectedPermissions,n=!!t.preventDownload,a=this.context.sharingStore.isPreventDownloadAllowed(),i=(0,Y.a)(this.props.sharingInformation.fileExtension);return e=!this._showSimplifiedShareDialogV2&&"video"!==i,a&&e&&w.m(t.audience,this.props.sharingInformation.sharingAbilities)&&((0,F.b)(this.props.sharingInformation.fileExtension,F.a.AllowMediaTA)||this.props.sharingInformation.sharedObjectType===W.a.folder)?C.createElement("div",{className:"od-PermissionsSettings-setting"},C.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload"},C.createElement(k.a,{onToggleChange:this.props.onToggleChange,isToggled:n,clientId:this.props.clientId,mode:this.props.mode,disablePreventDownload:this.state.preventDownloadDisabled,isRolesDropDown:t.isReview}))):void 0},t.prototype._renderUpsellTeachingBubble=function(e){var t,n=function(){return window.open("https://onedrive.live.com/about/plans/")};if(this.context.goPremium)n=this.context.goPremium;else try{var a=window.external;a.IsGoPremiumAvailable()&&(n=function(){try{a.GoPremium("https://onedrive.live.com/about/plans/")}catch(e){}})}catch(e){}if(this.context.premiumLearnMore)t={children:L.Hj,onClick:this.context.premiumLearnMore};else try{var i=window.external;i.IsPremiumLearnMoreAvailable()&&(t={children:L.Hj,onClick:function(){try{i.PremiumLearnMore()}catch(e){}}})}catch(e){}return C.createElement(P.a,{targetElement:e.targetElement,onDismiss:e.onDismiss,hasCloseIcon:!0,closeButtonAriaLabel:L.Vb,headline:e.headline,primaryButtonProps:{children:L.Rj,onClick:n},secondaryButtonProps:t,calloutProps:{className:"od-PermissionsSettings-teachingBubble"},hasSmallHeadline:!0,styles:{headline:{fontSize:"0.875rem"},bodyContent:{fontSize:"0.875rem"},subText:{fontSize:"0.875rem"},primaryButton:{fontSize:"0.875rem",height:"2rem",padding:"0 1rem",selectors:{".ms-Button-label":{fontSize:"0.875rem"},"&:hover":{backgroundColor:"#005A9E",color:"#FFFFFF"},"&:focus":{backgroundColor:"#005A9E",color:"#FFFFFF"}},backgroundColor:"#FFFFFF",color:"#005A9E"},closeButton:{fontSize:"0.75rem",width:"2rem",height:"2rem",selectors:{".ms-Button-icon":{fontSize:"0.75rem"}}}}},C.createElement(T.a,{iconName:"Diamond",className:"od-PermissionsSettings-teachingBubbleIcon"}),e.mainText)},t.prototype._getAudienceOption=function(e){if(e===o.a.anyone&&this._supportedAudienceOptions.indexOf(o.a.anyone)>-1){var t={disabledText:L.jc,icon:S.a[D.a.anyone],isChecked:!1,isDisabled:!1,key:o.a.anyone,linkKinds:[c.a.anonymousView,c.a.anonymousEdit],permissionsType:D.a.anyone,detailText:L.kg,label:L.Mg};return this.props.selectedPermissions.trackLinkUsers&&(t.detailText=L.Lg),t}if(e===o.a.organization&&this._supportedAudienceOptions.indexOf(o.a.organization)>-1)return{disabledText:L.jc,icon:S.a[D.a.workGroup],isChecked:!1,isDisabled:!1,key:o.a.organization,linkKinds:[c.a.organizationView,c.a.organizationEdit],permissionsType:D.a.workGroup,detailText:E.j(L.Ug,this.props.companyName),label:E.j(L.Fg,this.props.companyName)};if(e===o.a.specificPeopleFlex&&this._supportedAudienceOptions.indexOf(o.a.specificPeopleFlex)>-1){var n={disabledText:L.jc,icon:S.a[D.a.specificPeople],isChecked:!1,isDisabled:!1,key:o.a.specificPeopleFlex,linkKinds:[c.a.flexible],permissionsType:D.a.specificPeople,detailText:E.j(L.qg,this.props.companyName),label:L.Yg};return this.props.sharingInformation.canAddExternalPrincipal||(n.detailText=E.j(L.Qg,this.props.companyName)),this.props.selectedPermissions.audience!==o.a.specificPeople&&this.props.selectedPermissions.audience!==o.a.specificPeopleFlex||!this.props.copyLinkShortcut&&this.props.mode!==r.a.linkSettings||(n.subComponent=C.createElement(A.a,{defaultSelectedItems:this.props.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:this.state.externalRecipientWarning,oversharingGroupsWarning:this.state.groupRecipientWarning,pickerSettings:this.props.sharingInformation.peoplePickerSettings,error:this.props.peoplePickerError,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:this.props.onPeoplePickerInputChange||null})),n}if(e===o.a.customLabeledSpecificPeople&&this._supportedAudienceOptions.indexOf(o.a.customLabeledSpecificPeople)>-1){var a,i=M.j(this.props.clientId),s=i?D.a.mail:D.a.chat,d=this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.audienceType;return a=i||"recipient"===d?L.Xg:"channel"===d?L.Gg:"team"===d?L.Jg:L.Kg,{disabledText:L.jc,icon:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&S.a[s],iconUrl:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl,isChecked:!1,isDisabled:!1,key:o.a.customLabeledSpecificPeople,label:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?E.j(L.Vg,this.props.customLabeledAudienceConfig.entityName):a,linkKinds:[c.a.flexible],permissionsType:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&s}}},t.prototype._getSpecificPeopleLabel=function(){if(K.sb()){var e=void 0;switch(G.f()){default:e=L.oh;break;case 1:e=E.j(L.ih,this.props.companyName);break;case 2:e=E.j(L.rh,this.props.companyName)}return e}return L.oh},t.prototype._onLinkTemplateChoiceChange=function(e){for(var t=0,n=this._linkTemplateOptions;t<n.length;t++){var a=n[t];a.isChecked=e===a.key}},t.prototype._onSelectDate=function(e){var t=this,n=y.b.none;K.n()?this.props.selectedPermissions.audience===o.a.anyone&&(n=(0,y.t)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)):n=(0,y.t)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),this.context.sharingStore.getEngagementHelper().log("ShareV3.expirationChange",this.props.engagementExtraData),this.setState((0,a.a)((0,a.a)({},this.state),{expirationErrorCode:n}),function(){t.props.updateExpirationErrorCode(n),t.props.onExpirationChange(e)})},t.prototype._onTrackableChange=function(e,t){this.props.onTrackableChange(t),this.context.sharingStore.getEngagementHelper().linkTrackLinkClicked(this.props.engagementExtraData)},t.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t),this.context.sharingStore.getEngagementHelper().linkSettingsOnAllowEditingClicked(this.props.engagementExtraData),this.setState((0,a.a)((0,a.a)({},this.state),{preventDownloadDisabled:t,officeReviewModeDisabled:!!t}))},t.contextTypes={resize:O.func.isRequired,sharingStore:O.object.isRequired,goPremium:O.func,platformDetection:O.object.isRequired,premiumLearnMore:O.func},t}(C.Component),$=n(50),ee=n(57),te=n(55),ne=n(61),ae=n(51),ie=n(44),re=n(653),oe={root:{height:"2rem",borderRadius:"0.25rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:["flexContainer"],label:{fontSize:"0.875rem",paddingBottom:"2px"}},se=function(e){function t(t,n){var a=e.call(this,t)||this;return a._currentPassword="",a._matchingTemplate=null,a._peoplePickerHasUnresolvedText=!1,a._topLevelDivRef=C.createRef(),a._onPeoplePickerInputChange=function(e){a._peoplePickerHasUnresolvedText=""!==e},a._currentPassword="",a.state=a._initializeState(),a._preventDownloadToggle=!!a.state.selectedPermissions.preventDownload,a._officeReviewModeToggle=!!a.state.selectedPermissions.isReview,a._showSimplifiedShareDialog=(0,y._)(a.props.clientId,n.sharingStore),a._platformDetection=n.platformDetection,a._onApplyClicked=a._onApplyClicked.bind(a),a._onCancel=a._onCancel.bind(a),a._onPeoplePickerChange=a._onPeoplePickerChange.bind(a),a._updateExpirationErrorCode=a._updateExpirationErrorCode.bind(a),a.onAudienceChange=a.onAudienceChange.bind(a),a.onLinkTemplateChange=a.onLinkTemplateChange.bind(a),a.onEditChange=a.onEditChange.bind(a),a.onRoleChange=a.onRoleChange.bind(a),a.onExpirationChange=a.onExpirationChange.bind(a),a.onTrackableChange=a.onTrackableChange.bind(a),a._getShareLinkTemplate=a._getShareLinkTemplate.bind(a),a._findMatchingShareLinkTemplate=a._findMatchingShareLinkTemplate.bind(a),a._calculateRole=a._calculateRole.bind(a),a._onPasswordChange=a._onPasswordChange.bind(a),a._onPreventDownloadToggleChange=a._onPreventDownloadToggleChange.bind(a),a._onOfficeReviewModeToggleChange=a._onOfficeReviewModeToggleChange.bind(a),a._onConfirmationUseExisting=a._onConfirmationUseExisting.bind(a),a._onConfirmationUseNew=a._onConfirmationUseNew.bind(a),a._shareClickTime=n.shareClickTime,a._resizeTracker=new ne.a(n.resize),a._showSimplifiedShareDialogV2=(0,y.Z)(a.props.clientId,n.sharingStore),a._useSimplifiedDialog=a._showSimplifiedShareDialog||a._showSimplifiedShareDialogV2,a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():te.r(this._shareClickTime,this.props.clientId,r.a.linkSettings,this.props.scenarioId,this.props.correlationId),this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()},t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=M.a(this.props.clientId),n="od-ModifyPermissions-section "+(this.props.shouldRenderSharingInfoBar?"sharingInfoBar ":""),i="od-ModifyPermissions-section permissionsSettings";this.context.sharingStore&&this.context.sharingStore.getSupportedAudienceOptions().length<=1&&(i+=" od-ModifyPermissions-section-noAudienceMod");var r="od-ModifyPermissions-actions";return C.createElement("div",{ref:this._topLevelDivRef,className:"od-ModifyPermissions ".concat(e," ").concat(this._useSimplifiedDialog&&"simplified"),style:{maxHeight:this.props.maxHeight}},C.createElement("div",{className:n},this._renderHeader()),this._renderSharingInfoBar(),C.createElement("div",{className:i},C.createElement(Z,(0,a.a)({},(0,m.a)(this.props),{mode:this.props.mode,shareId:this.props.shareId,companyName:y.tb(this.props.companyName),currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onLinkTemplateChange:this.onLinkTemplateChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onTrackableChange:this.onTrackableChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut,onPasswordChange:this._onPasswordChange,onToggleChange:this._onPreventDownloadToggleChange,onOfficeReviewModeToggleChange:this._onOfficeReviewModeToggleChange,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onShowPermissionsListClicked:this.props.onShowPermissionsListClicked,onLinkSettingsInfoMessageClick:this.props.onLinkSettingsInfoMessageClick}))),t?C.createElement("div",{className:r,id:"od-ModifyPermissions-actions-id"},this._renderDefaultButton(),this._renderPrimaryButton()):C.createElement("div",{className:r},this._renderPrimaryButton(),this._renderDefaultButton()),this._renderActivityIndicator(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype.onLinkTemplateChange=function(e){var t=this.props.sharingInformation.sharingLinkTemplates.find(function(t){return!!t.linkDetails&&t.linkDetails.shareId===e}),n={allowEditing:!0,audience:o.a.existing,expiration:null,isEdit:!1,isReview:!1,sharingRole:s.a.view,preventDownload:!1,sharingLinkKind:c.a.direct,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:"",sharingScope:d.a.existing};if(t){var i=t.linkDetails;n.shareId=i.shareId,n.fetchLinkOnly=!0,n.audience=i.audience,n.expiration=i.expiration,n.isEdit=i.isEdit,n.isReview=i.isReview,n.hasPassword=i.hasPassword,n.sharingRole=i.isEdit?(0,y.q)(this.props.clientId,this.props.sharingInformation):i.isReview?s.a.review:s.a.view,n.trackLinkUsers=i.trackLinkUsers,n.preventDownload=i.blockDownload,n.sharingLinkKind=i.sharingLinkKind}else e===o.a.existing.toString()?(n.audience=o.a.existing,n.sharingScope=d.a.existing):e===o.a.specificPeople.toString()&&(n.audience=o.a.specificPeople,n.sharingScope=d.a.specificPeople);this.setState((0,a.a)((0,a.a)({},this.state),{peoplePickerError:null,selectedPermissions:n}))},t.prototype.onAudienceChange=function(e){var t,n=y.L(e);if(!K.E()||e!==this.state.selectedPermissions.audience||n!==this.state.selectedPermissions.sharingScope){var i=this.state.selectedPermissions,r=this._isAllowEditingEnabled(e),d=i.isEdit&&r,l=i.isReview&&(w.l(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)||w.j(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)),u=l?c.a.flexible:(0,y.y)(e,d),f=i.expiration;this._showSimplifiedShareDialogV2&&K.n()?f||e!==o.a.anyone||(f=(0,y.p)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)):f=e===o.a.anyone||e===o.a.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?i.expiration:(0,y.p)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);var p=s.a.view;l?p=s.a.review:d?p=(0,y.q)(this.props.clientId,this.props.sharingInformation):G.c()&&this.props.sharingInformation.requiresAccessApproval&&(p=this.props.sharingInformation.userRole||p);var m=[];K.A()&&(m=i.specificPeople);var _="video"===(0,Y.a)(null===(t=this.props.sharingInformation)||void 0===t?void 0:t.fileExtension)||this._showSimplifiedShareDialogV2?i.preventDownload&&!d&&!l&&p===s.a.restrictedview:i.preventDownload&&!d&&!l,h={allowEditing:this._isEditingToggleEnabled(e),audience:e,expiration:f,isEdit:d,isReview:l,sharingRole:p,preventDownload:_,sharingLinkKind:u,specificPeople:m,updatePassword:!1,hasPassword:!1,password:"",shareId:"",trackLinkUsers:i.trackLinkUsers,requireSignIn:i.audience===o.a.specificPeople,sharingScope:y.L(e)};h.requireSignIn=e===o.a.specificPeople,this.setState((0,a.a)((0,a.a)({},this.state),{peoplePickerError:null,selectedPermissions:h}))}},t.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,n=(0,y.y)(t.audience,e),i=s.a.view;e&&(i=t.isReview?s.a.review:(0,y.q)(this.props.clientId,this.props.sharingInformation)),this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},t),{isEdit:e,isReview:i===s.a.review,sharingRole:i,sharingLinkKind:n,preventDownload:!1}),preventDownloadDisabled:e,officeReviewModeDisabled:!!e})),this._preventDownloadToggle=!1,this._officeReviewModeToggle=!1},t.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,n=s.a.review==e,i=e==s.a.manageList,r=n||i?c.a.flexible:(0,y.y)(t.audience,y.Q(e)),d=t.expiration||(0,y.p)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this._showSimplifiedShareDialogV2&&K.n()&&((d=t.expiration)||t.audience!==o.a.anyone||(d=(0,y.p)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays))),K.z()||(d=(0,y.p)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)),this.state.selectedPermissions.sharingRole!==e&&this.context.sharingStore.getEngagementHelper().SharingRoleChangedFromLargeRoleSelector({isReview:n,isManageList:i}),this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},t),{sharingRole:e,isEdit:y.Q(e),isReview:n,expiration:d,sharingLinkKind:r,preventDownload:!1}),preventDownloadDisabled:e!==s.a.view})),this._preventDownloadToggle=!1,this._officeReviewModeToggle=!1},t.prototype.onExpirationChange=function(e){e||K.n()&&this.state.selectedPermissions.audience!==o.a.anyone||(e=(0,y.p)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)),this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},this.state.selectedPermissions),{expiration:e})}))},t.prototype.onTrackableChange=function(e){this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},this.state.selectedPermissions),{trackLinkUsers:e})}))},t.prototype._renderDefaultButton=function(){if(!G.c())return C.createElement($.a,{id:"od-ModifyPermissions-cancel-id",onClick:this._onCancel,styles:oe},L.Tb)},t.prototype._renderPrimaryButton=function(){return C.createElement(ee.a,{id:"od-ModifyPermissions-apply-id",className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked,styles:oe},L.Y)},t.prototype._getHeaderActions=function(){var e,t,n,a=this,i=null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:M.p(this.props.clientId);return C.createElement(C.Fragment,null,!this._platformDetection.isMobile&&C.createElement(ie.a,{className:"od-ModifyPermissions-learnMore",ariaLabel:L.Zd,tooltipContent:L.Zd,iconProps:{iconName:"Info"},directionalHint:X.a.bottomAutoEdge,onClick:function(e){a.context.sharingStore.getEngagementHelper().linkSettingsLearnMoreClicked(a.props.engagementExtraData),window.open("https://go.microsoft.com/fwlink/?linkid=846149")}}),i&&C.createElement(ie.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:L.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a.context.onDismiss()},tooltipContent:L.Vb,directionalHint:X.a.bottomAutoEdge}))},t.prototype._renderHeader=function(){var e,t,n=null===(t=null===(e=this.props.sharingInformation)||void 0===e?void 0:e.item)||void 0===t?void 0:t.name;return C.createElement(ae.a,{actions:this._getHeaderActions(),mainHeaderText:L.pe,isSubHeaderTextTruncated:n&&n.length>26,subHeaderText:n,renderBackButton:this.props.renderBackButton,onBackButtonClicked:this.props.onCancel})},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return C.createElement(u.a,{message:L.r})},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,n=e.sharingInformation,i=t.isReview&&(w.l(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)||w.j(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)),r=x.h({selectedItems:t.specificPeople,sharingLinkKind:c.a.direct,canAddExternalPrincipal:n.canAddExternalPrincipal,sharingInformation:n,viewPolicyTipCallback:e.onViewPolicyTipClicked,scope:t.sharingScope}),s=t.expiration||(0,y.p)(n.anonymousLinkExpirationRestrictionDays);return K.n()&&t.audience!==o.a.anyone&&(s=null),{expirationErrorCode:y.b.none,peoplePickerError:r,selectedPermissions:(0,a.a)((0,a.a)({},K.H()?t:{}),{allowEditing:this._isEditingToggleEnabled(t.audience),trackLinkUsers:t.trackLinkUsers,audience:t.audience,isEdit:t.isEdit,isReview:i,sharingRole:t.sharingRole,expiration:s,sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople,updatePassword:t.updatePassword,password:t.password,hasPassword:t.hasPassword,preventDownload:t.preventDownload,shareId:t.shareId,fetchLinkOnly:t.fetchLinkOnly,sharingScope:t.sharingScope}),showActivityIndicator:!1,preventDownloadDisabled:this._isAllowEditingEnabled(t.audience),officeReviewModeDisabled:!!this._isAllowEditingEnabled(t.audience),showConfirmationDialog:!1}},t.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==y.b.none||!!this.state.peoplePickerError},t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState((0,a.a)((0,a.a)({},this.state),{expirationErrorCode:e}))},t.prototype._onCancel=function(){this.props.onCancel()},t.prototype._onApplyClicked=function(){var e=this,t=this.state.selectedPermissions,n=t.specificPeople;if(K.nb()&&!y.T(t.audience)&&(n=[]),this._peoplePickerHasUnresolvedText)this.setState((0,a.a)((0,a.a)({},this.state),{peoplePickerError:C.createElement("span",null,L.Yj)}));else if(!y.T(t.audience)||0!==t.specificPeople.length||!this.props.copyLinkShortcut&&this.props.mode!==r.a.linkSettings){var i=this.props.doesCreate;if(t.fetchLinkOnly)this.setState((0,a.a)((0,a.a)({},this.state),{showActivityIndicator:i,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)});else{var s=!1;this._showSimplifiedShareDialogV2&&K.n()&&(s=t.audience!==o.a.existing);var c=s||t.audience===o.a.anyone||t.audience===o.a.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:null,d=this._determineMatchingTemplateAndSettingChange(c),l=this.state.selectedPermissions.isReview;if(this.state.selectedPermissions.audience!==o.a.anyone&&(this._currentPassword=""),d){var u=!!this._matchingTemplate&&this._matchingTemplate.passwordProtected;this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},t),{expiration:c,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:l,shareId:this._existingPasswordLinkShareId,hasPassword:u,specificPeople:n}),showActivityIndicator:i,showConfirmationDialog:!0}))}else this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},t),{expiration:c,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:l,hasPassword:!!this._currentPassword,shareId:"",specificPeople:n}),showActivityIndicator:i,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}}else this.setState((0,a.a)((0,a.a)({},this.state),{peoplePickerError:C.createElement("span",null,L.Hh)}))},t.prototype._determineMatchingTemplateAndSettingChange=function(e){if(this.state.selectedPermissions.audience!==o.a.anyone)return!1;if(this._matchingTemplate=this._getShareLinkTemplate(),!this._matchingTemplate||!this._matchingTemplate.linkDetails)return!1;if(this._currentPassword&&this._matchingTemplate.passwordProtected)return!0;var t=this._matchingTemplate.linkDetails.expiration;return null!==e&&null!==t&&(e.getMonth()!==t.getMonth()||e.getDate()!==t.getDate())},t.prototype._onPeoplePickerChange=function(e){var t=x.h({selectedItems:e,sharingLinkKind:c.a.direct,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked});if(!this.props.createPeopleSharingLinks&&this.state.selectedPermissions.audience===o.a.specificPeople){for(var n=!1,i=!1,r=0,s=e;r<s.length;r++){var d=s[r];n||(n=d.isExternal&&!d.providerName),i||(i=!d.isExternal||d.isExternal&&!!d.providerName)}n&&i&&(t=C.createElement("span",null,L.Ee))}K.A()||this.props.onSelectedPeopleChange&&this.props.onSelectedPeopleChange(e),this.setState((0,a.a)((0,a.a)({},this.state),{peoplePickerError:t,selectedPermissions:(0,a.a)((0,a.a)({},this.state.selectedPermissions),{specificPeople:e})}))},t.prototype._getShareLinkTemplate=function(){var e=this._findMatchingShareLinkTemplate();return e&&(e.passwordProtected&&e.linkDetails?this._existingPasswordLinkShareId=e.linkDetails.shareId:this._existingPasswordLinkShareId=""),e},t.prototype._findMatchingShareLinkTemplate=function(){var e,t,n=!!this._currentPassword,a=this.props.sharingInformation.sharingLinkTemplates;if(!a||0===a.length)return null;for(var i=l.a.anyone,r=this._calculateRole(),o=0,s=a;o<s.length;o++){var c=s[o];if(c.role===r&&c.scope===i){if(n&&c.passwordProtected)return c;c.passwordProtected?e=c:t=c}}return e&&e.linkDetails&&!this._deletedPassword&&n?e:t},t.prototype._calculateRole=function(){return this.state.selectedPermissions.preventDownload?s.a.restrictedview:this.state.selectedPermissions.isReview?s.a.review:this.state.selectedPermissions.isEdit?(0,y.q)(this.props.clientId,this.props.sharingInformation):s.a.view},t.prototype._renderSharingInfoBar=function(){var e=this._getSharingInfoBarProps(this.props.sharingInfoBarMessageTypeId);return this.props.shouldRenderSharingInfoBar&&this.props.renderSharingInfoBar(e)},t.prototype._onPasswordChange=function(e){this._currentPassword=e,this._deletedPassword=0===e.length},t.prototype._onPreventDownloadToggleChange=function(e){this._preventDownloadToggle=e;var t=e?c.a.flexible:(0,y.y)(this.state.selectedPermissions.audience,y.Q(this.state.selectedPermissions.sharingRole));this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},this.state.selectedPermissions),{sharingRole:e?s.a.restrictedview:s.a.view,preventDownload:e,sharingLinkKind:t})}))},t.prototype._onOfficeReviewModeToggleChange=function(e){this._officeReviewModeToggle=e;var t=e?s.a.review:this.state.selectedPermissions.isEdit?(0,y.q)(this.props.clientId,this.props.sharingInformation):s.a.view;this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},this.state.selectedPermissions),{sharingRole:t,isReview:e,sharingLinkKind:e?c.a.flexible:(0,y.y)(this.state.selectedPermissions.audience,this.state.selectedPermissions.isEdit)})}))},t.prototype._isAllowEditingEnabled=function(e){return this._isSharingAbilityEnabled(e,"Editing")},t.prototype._isSharingAbilityEnabled=function(e,t){var n=this.props.sharingInformation.sharingAbilities;return"Editing"===t?w.g(e,n):w.k(e,n)},t.prototype._isEditingToggleEnabled=function(e){return this._isAllowEditingEnabled(e)&&this._isSharingAbilityEnabled(e,"Reading")},t.prototype._getShareDialogConfirmationCode=function(e,t){var n=this.state.selectedPermissions.expiration,a=t.linkDetails.expiration,i=e&&t.passwordProtected,r=null!==n&&null!==a&&(n.getMonth()!==a.getMonth()||n.getDate()!==a.getDate());return i&&r?f.a.shareDialogPasswordAndExpiration:i?f.a.shareDialogPasswordOnly:f.a.shareDialogExpirationOnly},t.prototype._renderConfirmationDialog=function(){var e=!!this._currentPassword,t=this._matchingTemplate,n=this._getShareDialogConfirmationCode(e,t),a=t&&t.linkDetails&&null!==t.linkDetails.passwordLastModifiedBy?t.linkDetails.passwordLastModifiedBy.primaryText:"",i=t&&t.linkDetails&&null!==t.linkDetails.expiration?(0,N.f)(t.linkDetails.expiration):"";return C.createElement(p.ConfirmationDialog,{confirmationCode:n,participant:null,onApply:this._onConfirmationUseNew,onCancel:this._onConfirmationUseExisting,linkPasswordSetBy:a,linkExpiration:i})},t.prototype._onConfirmationUseNew=function(){var e=this;this.setState((0,a.a)((0,a.a)({},this.state),{showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})},t.prototype._onConfirmationUseExisting=function(){var e=this,t=this.state.selectedPermissions,n=this._matchingTemplate&&this._matchingTemplate.linkDetails?this._matchingTemplate.linkDetails.expiration:null,i=!(!this._matchingTemplate||!this._matchingTemplate.linkDetails)&&this._matchingTemplate.passwordProtected;this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},t),{expiration:n,updatePassword:!1,password:"",hasPassword:i}),showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})},t.prototype._getSharingInfoBarProps=function(e){var t;switch(e){case re.a.PageSharingAssetWarning:case re.a.LimitedSharing:case re.a.LimitedSharingExisting:t=12;default:t=0}return{extraHeight:t,parentCssClass:"ModifyPermissions",isSimplifiedDialog:!0}},t.contextTypes={shareClickTime:O.number,sharingStore:O.object.isRequired,resize:O.func.isRequired,sharingClientMessenger:O.object.isRequired,platformDetection:O.object.isRequired,onDismiss:O.func.isRequired},t}(C.Component),ce=se}
,function(e,t,n){n.r(t),n.d(t,{default:function(){return l}});var a=n(0),i=n(1),r=n(247),o=n(27),s=n(5),c=n(66),d=n(11);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareToTeams{width:100%}.od-ShareToTeams.wide{min-width:480px}@media (max-width:480px){.od-ShareToTeams.wide{min-width:320px}}.od-ShareToTeams .ms-Dialog-inner{padding:0}.od-ShareToTeams iframe{border:none;height:500px;width:100%}"}]);var l=function(e){function t(t){var n=e.call(this,t)||this;return n._closeModal=function(){n.setState({showModal:!1}),n.props.onDismiss()},n._onBackButtonClicked=function(){n.setState({showModal:!1}),n.props.onBackButtonClicked()},n.state={showModal:!0},n}return(0,a.d)(t,e),t.prototype.render=function(){return i.createElement(r.a,{isOpen:this.state.showModal,onDismiss:this._closeModal,isBlocking:!1,dialogContentProps:{showCloseButton:!0,className:"od-ShareToTeams"},minWidth:480},c.b(i.createElement(o.a,{className:"od-Share-backButton",id:"od-ShareToTeams-backButton",onClick:this._onBackButtonClicked,iconProps:{iconName:"Back"},ariaLabel:d.ub}),d.ub,{position:s.a.bottomLeftEdge,targetElementId:"od-ShareToTeams-backButton"}),i.createElement("iframe",{src:this.props.url,style:{height:"".concat(this.props.height(),"px")}}))},t}(i.Component)}
,function(e,t,n){n.r(t),n.d(t,{SharePolicyDetails:function(){return m},default:function(){return _}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PolicyTip .od-PolicyTip-title{display:none}.od-SharePolicyDetails{padding:24px}"}]);var i=n(100),r=n(51),o=n(553),s=n(1),c=n(12),d=n(11),l=n(552),u=n(20),f=n(5),p=n(44),m=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onOverrideClicked=function(){var e=i.props.policyTipInformation.info.overrideOption;e===l.c.allow?i._store.updatePolicy(l.b.override):e===l.c.allowWithJustification&&i.setState((0,a.a)((0,a.a)({},i.state),{showJustificationInput:!0}))},i._onOverrideSubmitClicked=function(e){i._store.updatePolicy(l.b.override,e)},i._onReportClicked=function(){i._store.updatePolicy(l.b.reportFalsePositive)},i._store=n.sharingStore,i._resize=n.resize,i.state={showJustificationInput:!1},i}return(0,a.d)(t,e),t.prototype.componentDidUpdate=function(){this._resize()},t.prototype.render=function(){var e=this.props,t=this.state,n=e.policyTipInformation.info;return s.createElement("div",{className:"od-SharePolicyDetails"},this._renderHeader(),s.createElement("div",{className:"od-Share-PolicyTip"},s.createElement(o.a,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:n?n.overrideOption===l.c.allowWithJustification:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:u.p(this.props.clientId))&&s.createElement(p.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:d.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a.context.onDismiss()},tooltipContent:d.Vb,directionalHint:f.a.bottomAutoEdge})},t.prototype._renderHeader=function(){return s.createElement(r.a,{actions:this._getHeaderActions(),mainHeaderText:d.sh,renderBackButton:!0,onBackButtonClicked:this.props.onBackButtonClicked})},t.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=e&&(e.overrideOption===l.c.allow||e.overrideOption===l.c.allowWithJustification);return{headerText:d.vh,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?"".concat(d.yh,": ").concat((0,i.e)(e.lastScanned)):void 0,learnMoreActionLabel:e?d.Sh:void 0,learnMoreLabel:e?d.Dh:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:d.Ih,overrideActionLabel:t?d.xh:void 0,overrideLabel:d.Oh,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:d.wh,reportLabel:d.Lh,reportInProgressLabel:d.Ah,submitButtonLabel:d.kh,titleText:void 0}},t.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":e===l.a.falsePositiveReported?d.Eh:e===l.a.overridden||e===l.a.falsePositiveReportedAndOverridden?d.Ch:""},t.contextTypes={sharingStore:c.object.isRequired,resize:c.func.isRequired,onDismiss:c.func.isRequired},t}(s.Component),_=m}
,function(e,t,n){n.r(t),n.d(t,{PermissionsList:function(){return Y},default:function(){return J}});var a=n(0),i=n(4);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsList{max-height:inherit;overflow-y:auto}.od-PermissionsList-simplifiedHeader{padding:10px}.od-PermissionsList-content{padding:24px;margin:0;padding-top:0}.od-PermissionsList-content-wac{padding:0 20px;margin:0}.od-PermissionsList-emptyLinks{padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem;min-height:2.25rem}.od-PermissionsList-inheritance{margin:16px}[dir=ltr] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-left:8px}[dir=rtl] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-right:8px}[dir=ltr] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-right:8px}[dir=rtl] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-left:8px}.od-PermissionsList-linksListHolder .od-ShareLinkDetails--sectionHeader{margin-top:0}.od-PermissionsList-header{font-weight:400;font-size:.875rem;display:inline;position:relative}.od-PermissionsList-header.new{display:flex;padding:24px;align-items:center}.od-PermissionsList-header.mainHeader{display:flex;padding:14px}.od-PermissionsList-header-no-position{font-weight:400;font-size:14px;display:flex;position:relative;padding:24px}.od-ShareLinkDetails--sectionHeader{display:flex;flex-wrap:wrap;justify-content:space-between}.od-ShareLinkDetails--sectionHeader .ms-Icon{padding:0 5px;font-size:.875rem}.od-ShareLinkDetails--sectionHeader .ms-Icon--NoPadding{padding:0}.od-ShareLinkDetails--sectionHeader .ms-Icon--Add,.od-ShareLinkDetails--sectionHeader .ms-Icon--Info,.od-ShareLinkDetails--sectionHeader .ms-Icon--Share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:.75rem}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{margin:-5px 0;font-size:.875rem}[dir=ltr] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir=ltr] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:right}[dir=rtl] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir=rtl] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:left}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess .od-ShareLinkDetails-Share-buttonText,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share .od-ShareLinkDetails-Share-buttonText{font-size:.875rem;margin-right:9px}.od-ShareLinkDetails--sectionHeader .ms-Button{height:2rem}[dir=ltr] .od-PermissionsList-stopSharingText{margin-left:20px}[dir=rtl] .od-PermissionsList-stopSharingText{margin-right:20px}.ms-Button.od-PermissionsList-stopSharingButton{border:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:0}.ms-Button.od-PermissionsList-stopSharingButton span.ms-Button-label{font-weight:400}.ms-Button.od-PermissionsList-stopSharingButton:active,.ms-Button.od-PermissionsList-stopSharingButton:focus,.ms-Button.od-PermissionsList-stopSharingButton:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:';background-color:none}.ms-Button.od-PermissionsList-stopSharingButton:active .ms-Button-textContainer,.ms-Button.od-PermissionsList-stopSharingButton:focus .ms-Button-textContainer,.ms-Button.od-PermissionsList-stopSharingButton:hover .ms-Button-textContainer{text-decoration:underline}@media screen and (-ms-high-contrast:active){.ms-Button.od-PermissionsList-stopSharingButton:active,.ms-Button.od-PermissionsList-stopSharingButton:focus,.ms-Button.od-PermissionsList-stopSharingButton:hover{border-color:highlight;color:highlight}}.od-PermissionsList-entities{padding-bottom:5px}.od-PermissionsList-advancedUrl{margin-bottom:16px}[dir=ltr] .od-PermissionsList-advancedUrl{text-align:right}[dir=rtl] .od-PermissionsList-advancedUrl{text-align:left}.od-PermissionsList-entities div:last-of-type{border:none}.od-PermissionsList-links>div:last-of-type ul.od-ShareLink-participants:last-of-type::after{height:0}.od-PermissionsList-principalGroup{outline:transparent;position:relative}.od-PermissionsList-principalGroup::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsList-principalGroup:focus:after{content:"";position:absolute;top:-.125rem;right:-.125rem;bottom:-.125rem;left:-.125rem;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-PermissionsList-addressBarDescription{display:inline-block;padding-top:20px;font-size:.75rem}.od-AddressBarLinkHint{padding-top:20px;padding-bottom:24px}.od-AddressBarLinkHint .od-ShareHint{margin:0}.od-AddressBarLinkHint .od-ShareLinkDescription .od-ShareLinkDescription-icon{font-size:.875rem;height:1.5rem;width:1.5rem;max-width:100px;max-height:100px}.od-AddressBarLinkHint .od-ShareLinkDescription .od-ShareLinkDescription-icon i{font-size:.875rem}.od-AddressBarLinkHint .od-ShareHintDetail .od-ShareHintDetail-status .od-ShareHintDetail-statusText{font-size:.75rem;line-height:1rem;overflow-wrap:anywhere}.od-AddressBarLinkHint .od-ShareHintDetail .od-ShareHintDetail-status .od-ShareHintDetail-chevron{font-size:.5rem}.ms-ContextualMenu-container .ms-ContextualMenu.ms-FocusZone.is-open{max-width:unset}"}]);var r=n(51),o=n(31),s=n(29),c=n(375);(0,i.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:flex;outline:0}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir=ltr] .od-SharePrincipal-persona{margin-right:8px}[dir=rtl] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{outline:transparent;position:relative;cursor:pointer;background:0 0;border:none;padding:0}.od-SharePrincipal-permissions::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-SharePrincipal-permissions:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-SharePrincipal-deleteIcon{right:8px}[dir=rtl] .od-SharePrincipal-deleteIcon{left:8px}"}]);var d=n(225),l=n(5),u=n(78),f=n(43),p=n(32),m=n(1),_=n(12),h=n(10),b=n(11),g=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onStopSharingClick=function(){a.setState({isUpdatingRole:!0}),a._store.updatePermissions(a.props.principal,p.a.none)},a.state={showContextualMenu:!1,isUpdatingRole:!1,roleText:a._computeInitialRoleText(t.principal)},a._store=n.sharingStore,a._onChangeRoleClick=a._onChangeRoleClick.bind(a),a._onPermissionsClick=a._onPermissionsClick.bind(a),a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&this._focusElement.focus()},t.prototype.componentDidUpdate=function(){var e=this._computeInitialRoleText(this.props.principal);e!==this.state.previousRoleText&&this.setState({isUpdatingRole:!1,roleText:e,previousRoleText:this.state.roleText})},t.prototype.render=function(){var e=this,t=this.props.principal;return m.createElement("div",{className:"od-SharePrincipal",role:"presentation",ref:function(t){e._focusElement=t}},m.createElement(u.a,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:f.a.blue,primaryText:t.primaryText,size:f.c.regular,imageUrl:t.imageUrl}),m.createElement("div",{className:"od-SharePrincipal-details",role:"presentation"},m.createElement("div",{className:"od-SharePrincipal-details-primaryText"},t.primaryText),this._renderChangePermissionsButton(t)))},t.prototype._computeInitialRoleText=function(e){var t=this.props.principal.role;if("number"!=typeof t)return e.sharingLinkKind?b.l:"";switch(t){case p.a.edit:return b.hb;case p.a.review:return b.wb;case p.a.view:return b.Ab;case p.a.owner:return b.Bf;default:return""}},t.prototype._computeRoleText=function(){return this.state.isUpdatingRole?b.Zj:this.state.roleText},t.prototype._renderChangePermissionsButton=function(e){var t=e.role;return this.state.isUpdatingRole||this.props.userRole!==p.a.owner||t!==p.a.edit&&t!==p.a.view&&t!==p.a.review?m.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()):m.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!0,"aria-describedby":"changePermissionsDescription".concat(e.id)},m.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()),this._renderChevron(e.role),this._renderContextualMenu(e.role),m.createElement("div",{role:"tooltip","aria-hidden":"true",className:"od-Share-screenReaderOnly",id:"changePermissionsDescription".concat(e.id)},"Set permissions for "+e.primaryText))},t.prototype._renderChevron=function(e){if(e===p.a.edit||e===p.a.view||e===p.a.review)return m.createElement("div",{className:"od-SharePrincipal-permissions-icon"},m.createElement(h.a,{iconName:"ChevronDown"}))},t.prototype._renderContextualMenu=function(e){var t,n,a=this;switch(e){case p.a.view:t=p.a.edit,n=b.I,p.a.review,b.e;break;case p.a.review:t=p.a.edit,n=b.I,p.a.view,b.Rb;break;case p.a.edit:t=p.a.view,n=b.Rb,p.a.review,b.e}if(this.state.showContextualMenu)return m.createElement(d.a,{items:[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:"".concat(b.Pj),onClick:this._onStopSharingClick}],onDismiss:function(){a.setState({showContextualMenu:!1})},directionalHint:l.a.bottomLeftEdge,isBeakVisible:!0,target:this.state.target})},t.prototype._onChangeRoleClick=function(e){this.setState({isUpdatingRole:!0,previousRoleText:this.state.roleText}),this._store.updatePermissions(this.props.principal,e)},t.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(t===p.a.edit||t===p.a.view||t===p.a.review)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})},t.contextTypes={sharingStore:_.object.isRequired},t}(m.Component),v=n(379),y=n(539),S=n(325),D=n(72),I=n(20),x=n(179),C=n(42),O=n(80),w=n(65),E=n(74),A=n(55),L=n(23),k=n(16),M=n(174),P=n(555),T=n(27),U=n(115),F=n(81),H=n(7),R=n(77),N=n(85),B=n(46),j=n(17),V=n(66),z=n(70),G=n(94),K=n(61),W=n(374),q=n(44),Q={ODB:1466},Y=function(e){function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=m.createRef(),i._onStopSharingLinkClick=function(){i.setState({showStopSharingDialog:!0})},i._stopSharing=function(){i.props.onStopSharingClicked(),i._addressBarLink=void 0,i.setState({showStopSharingText:!1}),i._onStopSharingDialogDismiss()},i._onStopSharingDialogDismiss=function(){i.setState({showStopSharingDialog:!1})},i._showPermissionsList=function(){i.setState({showLinkDetails:!1,showAddressBarLinkDetails:!1})},i._onRemoveLink=function(){i.setState({linkRemovedText:b.le}),setTimeout(function(){i.setState({linkRemovedText:""})},3e3)},i._onLinkSelected=function(e){i.setState({currentSharingLink:e,showLinkDetails:!0})},i._onShareClick=function(e){i._engagementHelper.manageAccessLinkSectionShareClicked(i.props.engagementExtraData),i._targetElement=e.target,i._mode=o.a.share,i.setState({showShare:!0})},i._onGrantAccessClick=function(e){i._engagementHelper.manageAccessGrantAccessClicked(i.props.engagementExtraData),i._targetElement=e.target,i._mode=o.a.addPeople,i.setState({showGrantAccess:!0})},i._onDismiss=function(){i._mode===o.a.share?i.setState({showShare:!1}):i.setState({showGrantAccess:!1}),i._onDismissFromContext()},i._onAddressBarLinkClicked=function(){i.setState(function(){return(0,a.a)((0,a.a)({},i.state),{showAddressBarLinkDetails:!0})})},i._shareClickTime=n.shareClickTime,i._sharingStore=n.sharingStore,i._resize=n.resize,i._onDismissFromContext=n.onDismiss,i._mode=i.props.mode,i._addressBarLink=null,i._engagementHelper=i._sharingStore.getEngagementHelper();var r=!1;if(i._sharingStore&&i._sharingStore.isShared&&i._sharingStore.isOwner&&i._sharingStore.getSharedObjectType&&(r=i._sharingStore.isShared()&&i._sharingStore.isOwner()&&i._sharingStore.getSharedObjectType()===z.a.file),i.state={showStopSharingText:r,showLinkDetails:!1,showAddressBarLinkDetails:!1,showStopSharingDialog:!1,currentSharingLink:void 0,linkRemovedText:"",showShare:!1,showGrantAccess:!1,selectedKey:s.a.existing},i._isShareCommandsExperimentOn=I.g(i.props.clientId)||I.h(i.props.clientId),i._isLinkSettingsEditPanelEnabled=i._sharingStore.showManageAccess()&&(i.props.mode===o.a.manageAccess||i.props.mode===o.a.share||i.props.mode===o.a.addPeople),B.a.isFeatureEnabled(Q)){var c=i.props.sharingInformation.sharingLinks?i.props.sharingInformation.sharingLinks.filter(function(e){return e.isAddressBarLink}):[];c.length>0&&(i._addressBarLink=c[0])}return i._hasBackButton=i.props.mode!==o.a.manageAccess,i._resizeTracker=new K.a(n.resize),i}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._resizeIfNeeded(),this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():A.r(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,this.props.correlationId)},t.prototype.componentDidUpdate=function(){this.props.hideElementsInManageAccess(this.state.showLinkDetails),this._resize(),this._resizeIfNeeded()},t.prototype.getChildContext=function(){return{onDismiss:this._onDismiss}},t.prototype.render=function(){var e,t=this.props.sharingInformation,n=this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1)>0;if(t.hasPermissionsInformation){var a=t.sharedObjectType===z.a.list,i=!this._sharingStore.isConsumerLists();e=m.createElement("div",{className:"od-PermissionsList-content-wac","aria-label":b.De},m.createElement("div",{className:"od-PermissionsList-links"},this._renderLinks()),!a&&m.createElement("div",{className:"od-PermissionsList-addressbar"},this._renderAddressBarAccess()," "),i&&m.createElement("div",{className:"od-PermissionsList-entities"},this._renderPrincipals(n)),this.props.advancedUrl&&!I.f(this.props.clientId)&&this._renderAdvancedUrl())}else e=m.createElement("div",{className:"od-Share-spinnerHolder"},m.createElement(C.a,{className:"od-Share-spinner",label:b.Gb,type:O.b.large}));var r=t.hasInheritedLinks,o=(this.props.showHeader||!I.g(this.props.clientId))&&!this.state.showLinkDetails&&!this.state.showAddressBarLinkDetails;return m.createElement("div",{tabIndex:-1,ref:this._topLevelDivRef,className:"od-PermissionsList od-Share-noFocusBorder"},V.a(b.De+", "+this.props.sharingInformation.item.name,"assertive","alert",!0),o&&this._renderHeader(),this.state.showStopSharingText&&!this.state.showLinkDetails&&!this.state.showAddressBarLinkDetails&&this._renderStopSharing(),r&&this._renderInheritance(n),this.state.showLinkDetails||this.state.showAddressBarLinkDetails?this._renderLinkDetails():e)},t.prototype._renderStopSharing=function(){return m.createElement("div",{className:"od-PermissionsList-stopSharing"},this.state.showStopSharingDialog&&m.createElement(W.a,{onDismiss:this._onStopSharingDialogDismiss,showStopSharingDialog:this.state.showStopSharingDialog,stopSharing:this._stopSharing.bind(this),primaryButtonText:b.Pj,dialogContentProps:{type:x.a.close,title:b.Mj,subText:b.kj}}),m.createElement("div",{className:"od-PermissionsList-stopSharingText"},this.state.showStopSharingText&&!this.state.showLinkDetails&&m.createElement(M.a,{iconProps:{iconName:"Blocked2"},className:"od-PermissionsList-stopSharingButton",onClick:this._onStopSharingLinkClick},b.Pj)))},t.prototype._renderAdvancedUrl=function(){return this.props.advancedUrl&&m.createElement("div",{className:"od-PermissionsList-advancedUrl"},m.createElement("a",{target:"_blank",href:this.props.advancedUrl,onClick:this._sendAdvancedClickEngagementEvent.bind(this),rel:"noreferrer"},b.G))},t.prototype._sendAdvancedClickEngagementEvent=function(){this._engagementHelper.manageAccessAdvancedLinkClicked(this.props.engagementExtraData)},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:I.p(this.props.clientId))&&m.createElement(q.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:b.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a.context.onDismiss()},tooltipContent:b.Vb,directionalHint:l.a.bottomAutoEdge})},t.prototype._renderHeader=function(){return m.createElement("div",{className:"od-PermissionsList-simplifiedHeader"},m.createElement(r.a,{actions:this._getHeaderActions(),mainHeaderText:b.De,renderBackButton:this._hasBackButton,onBackButtonClicked:this.props.backButtonClicked}))},t.prototype._renderInheritance=function(e){var t,n;return this.props.sharingInformation.item.itemType===F.a.Folder?n=b.jd:this.props.sharingInformation.item&&(n=b.Bd),t=e?H.j(b.m,n):H.j(b.kf,n),m.createElement("div",{className:"od-PermissionsList-inheritance"},m.createElement(U.a,null,t))},t.prototype._renderLinkDetails=function(){if(this.state.showAddressBarLinkDetails){var e=this.props.sharingInformation.addressBarLinkSettings;return m.createElement(c.b,{companyName:this.props.companyName,link:this._addressBarLink,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,showPermissionsList:this._showPermissionsList,enableLinkSettings:!0,isAddressBarLink:!0,addressBarLinkSettings:e,engagementExtraData:this.props.engagementExtraData,inlineInDialog:this.props.showHeader})}return m.createElement(c.b,{key:this.state.currentSharingLink.shareId,mode:this.props.mode,companyName:this.props.companyName,link:this.state.currentSharingLink,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this._isLinkSettingsEditPanelEnabled,showMoreOptions:!1,onShowLinkDetailsClicked:this._onLinkSelected,linkDetailsView:!0,showPermissionsList:this._showPermissionsList,onRemoveLink:this._onRemoveLink,engagementExtraData:this.props.engagementExtraData,inlineInDialog:this.props.showHeader})},t.prototype._renderLinks=function(){var e=this,t=this.props.sharingInformation.sharingLinks,n=!1;return m.createElement("div",{className:"od-PermissionsList-linksListHolder"},this._isLinkSettingsEditPanelEnabled&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},m.createElement("span",null,m.createElement(h.a,{iconName:"Link","aria-label":b.ae,className:"ms-Icon ms-Icon--Link",role:"img","aria-hidden":"true"}),m.createElement("h2",{className:"od-PermissionsList-header"},b.be),V.b(m.createElement("span",null,m.createElement(h.a,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b.be+" "+b.he,role:"img",tabIndex:0})),b.he,{tooltipId:"od-ShareLinkDetails-tooltip-links",position:l.a.topCenter})),!this.props.isInfectedFile&&this._isShareCommandsExperimentOn&&this.props.mode===o.a.manageAccess&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-share"},m.createElement(P.a,{iconProps:{iconName:"Share"},"aria-label":b.Vi,onClick:this.props.centeredManageAccessEnabled?this.props.shareButtonClicked:this._onShareClick.bind(this),"aria-haspopup":!0},m.createElement("span",{className:"od-ShareLinkDetails-Share-buttonText"},b.Vi)),this.state.showShare&&this._renderShare())),m.createElement("ul",{className:"od-PermissionsList-links"},t.map(function(t,a){if(t.audience!==s.a.specificPeople&&t.isActive&&!t.isAddressBarLink)return n=!0,m.createElement("li",{key:t.shareId},m.createElement(c.b,{index:a,key:t.shareId,mode:e.props.mode,companyName:e.props.companyName,link:t,clientId:e.props.clientId,sharingInformation:e.props.sharingInformation,groupsMemberCount:e.props.groupsMemberCount,linkRecipients:e.props.linkRecipients,enableLinkSettings:e._isLinkSettingsEditPanelEnabled,showMoreOptions:e._isLinkSettingsEditPanelEnabled,onShowLinkDetailsClicked:e._onLinkSelected,linkDetailsView:!1,showPermissionsList:e._showPermissionsList,engagementExtraData:e.props.engagementExtraData,inlineInDialog:e.props.showHeader}))}),!n&&this._renderNoSharingLinks()),this._isLinkSettingsEditPanelEnabled&&m.createElement("div",null,V.a(n?"":b.Ze,"polite","alert",!0),V.a(this.state.linkRemovedText,"assertive","alert",!0)))},t.prototype._renderNoSharingLinks=function(){if(this._isLinkSettingsEditPanelEnabled)return m.createElement("div",{className:"od-PermissionsList-emptyLinks"},b.Ze)},t.prototype._renderPrincipals=function(e){var t=this,n=this.props.sharingInformation,a=n.sharingPrincipals.slice(),i=a.filter(function(e){return e.type===D.a.user}),r=a.filter(function(e){return e.type===D.a.securityGroup||e.type===D.a.sharePointGroup});return this._engagementHelper.manageAccessNumberOfSharingPrincipals({numberOfUsers:i.length,numberOfGroups:r.length}),this._isLinkSettingsEditPanelEnabled?m.createElement("div",{className:"od-PermissionsList-entitiesListHolder"},this._isLinkSettingsEditPanelEnabled&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},m.createElement("span",null,m.createElement(h.a,{iconName:"PlayerSettings","aria-label":b._h,className:"ms-Icon ms-Icon--PlayerSettings",role:"img","aria-hidden":"true"}),m.createElement("h2",{className:"od-PermissionsList-header"},b._h),V.b(m.createElement("span",null,m.createElement(h.a,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b._h+" "+b.mh,role:"img",tabIndex:0})),b.mh,{tooltipId:"od-ShareLinkDetails-tooltip-principals"})),!this.props.isInfectedFile&&this._isShareCommandsExperimentOn&&this.props.mode===o.a.manageAccess&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-grantAccess"},V.b(m.createElement(T.a,{className:"ms-Icon--NoPadding",iconProps:{iconName:"Add"},"aria-label":b.w,onClick:this.props.centeredManageAccessEnabled?this.props.grantAccessClicked:this._onGrantAccessClick.bind(this),"aria-haspopup":!0}),b.w),this.state.showGrantAccess&&this._renderShare())),m.createElement("ul",{className:"od-PermissionsList-entities","aria-label":b.jg},m.createElement(w.a,{direction:E.a.vertical,isInnerZoneKeystroke:function(e){return e.which===(0,L.a)(k.a.right)}},a.map(function(e,a){return m.createElement("li",{key:e.id},m.createElement(v.a,{key:e.id,principal:e,userRole:n.userRole,clientId:t.props.clientId,mode:o.a.manageAccess,sharingInformation:n,engagementExtraData:t.props.engagementExtraData}))})))):m.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":b.jg},a.map(function(a,i){return m.createElement("li",{key:a.id,tabIndex:0,"aria-atomic":!0,"aria-live":"assertive",className:"od-PermissionsList-principalGroup"},m.createElement(g,{principal:a,takeFocus:!e&&0===i,userRole:n.userRole,clientId:t.props.clientId,sharingInformation:n}))}))},t.prototype._renderShare=function(){var e;return m.createElement(R.a,{target:this._targetElement,preventDismissOnScroll:!0,role:"alert","aria-live":"assertive",directionalHint:l.a.bottomCenter,onDismiss:this._onDismiss},m.createElement(N.a,{isClickableOutsideFocusTrap:!0},m.createElement(S.a,{mode:this._mode,hideShareDialogOverflowButton:!0,clientId:this.props.clientId,maxWidth:!1===(null===(e=this.props.hostOptions)||void 0===e?void 0:e.enableWiderDialog)||I.l(this.props.clientId)?j.d:j.f})))},t.prototype._renderAddressBarAccess=function(){if(B.a.isFeatureEnabled(Q)){var e=this.props.sharingInformation.addressBarLinkSettings;if((0,G.a)(this.props.sharingInformation.fileExtension),e&&this._addressBarLink)return m.createElement("div",{className:"od-PermissionsList-addressBarAccess","aria-label":b.C},m.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader"},b.A),m.createElement("div",{className:"od-PermissionsList-addressBarDescription"},b.C),m.createElement("div",{className:"od-AddressBarLinkHint"},m.createElement(y.a,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:null,onShareHintClick:this._onAddressBarLinkClicked,sharingInformation:this.props.sharingInformation,linkRecipients:this.state.currentSharingLink?(0,j.A)(this.state.currentSharingLink):[],customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:this._addressBarLink})))}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.contextTypes={shareClickTime:_.number,sharingStore:_.object.isRequired,resize:_.func.isRequired,sharingClientMessenger:_.object.isRequired,onDismiss:_.func},t.childContextTypes={onDismiss:_.func},t}(m.Component),J=Y}
,function(e,t,n){n.r(t),n.d(t,{PermissionsPivot:function(){return Me},PermissionsViewState:function(){return Ae},default:function(){return Pe}});var a=n(0),i=n(1),r=n(12),o=n(180),s=n(4);(0,s.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsPivot-contentParent{overflow-x:hidden;overflow-y:auto}.od-PermissionsPivot-contentParent:focus-visible{outline:0}.od-PermissionsPivot-linkDetailsView{display:flex;flex-direction:column;height:100%}.od-PermissionsPivot-content .principalContent{margin:0 -8px}.od-PermissionPivot-resultsCount{float:right;position:inherit;font-style:normal;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PermissionsPivot-coloredFolderIcon{position:relative!important;padding-right:4px;right:2px}.od-PermissionsPivot-footerDiv{margin:12px 8px 0 8px}.od-PermissionsPivot-footerDiv .ms-Spinner{position:relative;top:unset;left:-180px}[dir=ltr] .od-PermissionsPivot-pivot .ms-Pivot .ms-Button+.ms-Button{margin-left:0}[dir=rtl] .od-PermissionsPivot-pivot .ms-Pivot .ms-Button+.ms-Button{margin-right:0}.od-PermissionsPivot-DefaultView-content,.od-PrincipalDetails-content{padding:24px}.od-PermissionsPivot-linkDetailsView .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding:4px 24px 0 24px}.od-PermissionsPivot-headerButtons{position:absolute;top:0}[dir=ltr] .od-PermissionsPivot-headerButtons{right:0}[dir=rtl] .od-PermissionsPivot-headerButtons{left:0}.od-PermissionsPivot-title{font-weight:600;font-size:1.25rem;display:inline}.od-PermissionsPivot-title.withBackButton{font-size:1rem!important}.od-PermissionsPivot-close,.od-PrincipalDetails-close{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";float:right;font-size:.875rem}[dir=rtl] .od-PermissionsPivot-close,[dir=rtl] .od-PrincipalDetails-close{float:left}.od-PermissionsPivot-fileNameAndIcon,.od-PrincipalDetails-fileNameAndIcon{padding:12px 0 8px 7px;font-size:.75rem;overflow:hidden;text-overflow:ellipsis;display:flex;flex-direction:row;align-items:center}@supports (font:-apple-system-caption1){.od-PermissionsPivot-fileNameAndIcon,.od-PrincipalDetails-fileNameAndIcon{font:-apple-system-caption1}}[dir=ltr] .od-PermissionsPivot-fileNameAndIcon .od-PermissionsPivot-sensitivityLabel,[dir=ltr] .od-PermissionsPivot-fileNameAndIcon .od-PrincipalDetails-sensitivityLabel,[dir=ltr] .od-PrincipalDetails-fileNameAndIcon .od-PermissionsPivot-sensitivityLabel,[dir=ltr] .od-PrincipalDetails-fileNameAndIcon .od-PrincipalDetails-sensitivityLabel{margin-left:8px}[dir=rtl] .od-PermissionsPivot-fileNameAndIcon .od-PermissionsPivot-sensitivityLabel,[dir=rtl] .od-PermissionsPivot-fileNameAndIcon .od-PrincipalDetails-sensitivityLabel,[dir=rtl] .od-PrincipalDetails-fileNameAndIcon .od-PermissionsPivot-sensitivityLabel,[dir=rtl] .od-PrincipalDetails-fileNameAndIcon .od-PrincipalDetails-sensitivityLabel{margin-right:8px}.od-PrincipalDetails-tooltipFileIcon{padding-right:6px}.od-PrincipalDetails-tooltipChevron{padding:0 10px}.od-PermissionsPivot-fileIcon,.od-PrincipalDetails-fileIcon{padding:0;vertical-align:bottom;width:1rem;height:1rem}[dir=ltr] .od-PermissionsPivot-fileIcon,[dir=ltr] .od-PrincipalDetails-fileIcon{padding-right:8px}[dir=rtl] .od-PermissionsPivot-fileIcon,[dir=rtl] .od-PrincipalDetails-fileIcon{padding-left:8px}.od-PermissionsPivot-dropdown,.od-PermissionsPivot-pivot{padding-top:12px}.od-PermissionsPivot-dropdown div[role=tablist].ms-FocusZone,.od-PermissionsPivot-pivot div[role=tablist].ms-FocusZone{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:0 24px 0 24px;margin:0 -24px}.od-PermissionsPivot-dropdown div [role=tabpanel],.od-PermissionsPivot-pivot div [role=tabpanel]{padding-top:8px}.od-PermissionsPivot-dropdown div.od-PermissionsPivot-dropdown-container,.od-PermissionsPivot-pivot div.od-PermissionsPivot-dropdown-container{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:0 24px 16px 24px;margin:0 -24px}.od-PermissionsPivot-dropdown .ms-Dropdown-title,.od-PermissionsPivot-pivot .ms-Dropdown-title{height:100%;line-height:normal;display:flex;min-height:32px;align-items:center}.od-PermissionsPivot-sharingHeaderButtons{padding-left:6px;display:flex}.od-PermissionsPivot-sharingHeaderButtons.flex-start{justify-content:flex-start}.od-PermissionsPivot-sharingHeaderButtons.space-between{justify-content:space-between}.od-PermissionsPivot-sharingHeaderButtons button{height:20px;padding:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:.875rem}.od-PermissionsPivot-sharingHeaderButtons button i{font-size:.875rem;margin-right:4px;margin-left:2px}.od-PermissionsPivot-sharingHeaderButtons button .ms-Button-label{padding-bottom:2px}@supports (font:-apple-system-body){.od-PermissionsPivot-sharingHeaderButtons button .ms-Button-label,.od-PermissionsPivot-sharingHeaderButtons button i{font:-apple-system-body}}.od-PermissionsPivot-stopSharingButtonDisabled{color:#a19f9d!important}.od-PermissionsPivot-pivot button.ms-Button--command.ms-Pivot-link{font-size:.875rem}@supports (font:-apple-system-body){.od-PermissionsPivot-pivot button.ms-Button--command.ms-Pivot-link{font:-apple-system-body}}.od-PermissionsPivot-resolvedLink{border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}div.od-PermissionsPivot-search{padding:12px 0;height:auto;margin:0 8px;font-size:.875rem}@supports (font:-apple-system-body){div.od-PermissionsPivot-search{font:-apple-system-body}}div.od-PermissionsPivot-search .od-SharePrincipal-roleIcon{font-size:.875rem}div.od-PermissionsPivot-search .ms-SearchBox-iconContainer{font-size:1rem}div.od-PermissionsPivot-search :-ms-input-placeholder{font-size:.875rem}div.od-PermissionsPivot-search ::placeholder{font-size:.875rem}@supports (font:-apple-system-body){div.od-PermissionsPivot-search :-ms-input-placeholder{font:-apple-system-body}div.od-PermissionsPivot-search ::placeholder{font:-apple-system-body}}div.od-PermissionsPivot-search .ms-Button--icon,div.od-PermissionsPivot-search .ms-SearchBox-icon{font-size:.875rem;width:2rem}@supports (font:-apple-system-body){div.od-PermissionsPivot-search .ms-Button--icon,div.od-PermissionsPivot-search .ms-SearchBox-icon{font:-apple-system-body;width:-apple-system-headline}}.od-PermissionsPivot-searchResultsCount{font-style:italic;margin:0 8px;font-size:.875rem}@supports (font:-apple-system-body){.od-PermissionsPivot-searchResultsCount{font:-apple-system-body}}.od-PermissionsPivot-searchResultsCountWrapper div{padding-bottom:8px}button.od-PermissionsPivot-sectionShareButton{display:block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:0;border:0 transparent}button.od-PermissionsPivot-sectionShareButton:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";border:0 transparent}button.od-PermissionsPivot-sectionShareButton:hover:active{border:0 transparent}button.od-PermissionsPivot-sectionShareButton i.ms-Icon{margin-left:0}@supports (font:-apple-system-body){button.od-PermissionsPivot-sectionShareButton i,button.od-PermissionsPivot-sectionShareButton span{font:-apple-system-body}}.od-PermissionsPivot-emptySection-announce{height:0}.od-PermissionsPivot-emptySection{padding-top:16px;font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@supports (font:-apple-system-body){.od-PermissionsPivot-emptySection{font:-apple-system-body}}@supports (font:-apple-system-body){.od-PermissionsPivot-dropdown-container .ms-Dropdown-title{font:-apple-system-body;line-height:normal}}@supports (font:-apple-system-body){.ms-Dropdown-optionText{font:-apple-system-body;line-height:normal}}ul.od-PermissionsPivot-linksList,ul.od-PermissionsPivot-usersList{list-style-type:none;padding-left:0}ul.od-PermissionsPivot-usersList{margin:0 -8px}div.od-PermissionsPivot-user{margin:0 20px}.od-PermissionsPivot-infoMessage{font-size:.75rem;margin:12px 0}[dir=ltr] .od-PermissionsPivot-backButton{margin-left:-8px}[dir=rtl] .od-PermissionsPivot-backButton{margin-right:-8px}.od-PermissionsPivot-backButton.ie{top:8px}[dir=rtl] .od-PermissionsPivot-backButton{transform:scale(-1,1)}li.od-PermissionsPivot-resolvedLink .od-ShareLink-header{margin-left:-24px;margin-right:-24px}[dir=ltr] .od-PrincipalDetails-backButton{margin-left:-8px}[dir=rtl] .od-PrincipalDetails-backButton{margin-right:-8px}[dir=rtl] .od-PrincipalDetails-backButton{transform:scale(-1,1)}.od-PrincipalDetails-backButton.ie .ms-Button-flexContainer{display:inline}.od-PrincipalDetails-editStatus{font-weight:600;font-size:.875rem}[dir=ltr] .od-PrincipalDetails-editStatus{right:0}[dir=rtl] .od-PrincipalDetails-editStatus{left:0}@supports (font:-apple-system-body){.od-PrincipalDetails-editStatus{font:-apple-system-body}}.od-PrincipalDetails-name{font-size:.875rem}[dir=ltr] .od-PrincipalDetails-name{left:0}[dir=rtl] .od-PrincipalDetails-name{right:0}@supports (font:-apple-system-body){.od-PrincipalDetails-name{font:-apple-system-body}}.od-PrincipalDetails-title{font-weight:600;font-size:.75rem;display:inline;line-height:16px;vertical-align:text-top}.od-PrincipalDetails-title .Header-filename{font-weight:600;font-size:.75rem}.od-PrincipalDetails-title .Header-filename.mobile{font-size:.875rem}@supports (font:-apple-system-body){.od-PrincipalDetails-title .Header-filename{font:-apple-system-body;line-height:normal}}.od-PrincipalDetails-accessSummary{padding-top:16px}@supports (font:-apple-system-body){.od-PrincipalDetails-accessSummary .ms-Persona-primaryText,.od-PrincipalDetails-accessSummary .od-PrincipalDetails-accessSummaryRole{font:-apple-system-body}}.od-PrincipalDetails-accessSummaryTitle{font-weight:600;font-size:.875rem}.od-PrincipalDetails-accessSummaryTitle.manageGroupLink{padding-bottom:24px}.od-PrincipalDetails-accessSummaryTitle.noManageGroupLink{padding-bottom:12px}@supports (font:-apple-system-body){.od-PrincipalDetails-accessSummaryTitle{font:-apple-system-body}}.od-PrincipalDetails-unknownTooltip{padding-left:6px}.od-PrincipalDetails-accessSummaryTooltip{padding-left:4px;display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PrincipalDetails-accessSummaryTooltip i{vertical-align:middle}.od-PrincipalDetails-textTooltipContent{margin:8px;font-size:.75rem;overflow-wrap:break-word}.od-PrincipalDetails-Persona{line-height:2rem}.od-PrincipalDetails-Persona div.ms-Persona-primaryText{font-size:1.125rem}[dir=ltr] .od-PrincipalDetails-Persona .ms-Persona-details{padding-left:12px}[dir=rtl] .od-PrincipalDetails-Persona .ms-Persona-details{padding-right:12px}[dir=ltr] .od-PrincipalDetails-Persona .ms-Persona-details{padding-right:6px}[dir=rtl] .od-PrincipalDetails-Persona .ms-Persona-details{padding-left:6px}.od-PrincipalDetails-Persona.ie .ms-Persona-details{flex-direction:row;justify-content:flex-end}.od-PrincipalDetails-accessSummaryPrincipalSubtext{font-size:.875rem;line-height:1.25rem;padding-top:4px;margin-left:calc(2rem + 8px)}.od-PrincipalDetails-accessSummaryPrincipalSubtext .od-PrincipalDetails-unknownUserLink{padding:0 .25rem}.od-PrincipalDetails-accessSummaryRole{display:inline;font-weight:600;line-height:2rem;vertical-align:middle;font-size:1.125rem;white-space:nowrap}.od-PrincipalDetails-content2{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:24px;font-size:1rem;min-height:270px}.od-PrincipalDetails-content2.group{min-height:240px}.od-PrincipalDetails-content2 .ms-GroupHeader-title{padding-left:0}.od-PrincipalDetails-accessDetailsSection{font-weight:600;padding-bottom:6px;font-size:.875rem;margin-top:0}@supports (font:-apple-system-body){.od-PrincipalDetails-accessDetailsSection{font:-apple-system-body}}.od-PrincipalDetails-inlineTooltip{padding:0 4px 0 2px;display:inline}.od-PrincipalDetails-inheritedTooltipContent{margin:20px;font-size:.75rem;overflow-wrap:break-word}.od-PrincipalDetails-inheritedTooltipContent-description{padding-bottom:12px}.od-PrincipalDetails-inheritedTooltipContent-secondFilename{display:inline-block}.od-PrincipalDetails-groupHeader{width:100%;cursor:pointer;display:grid;display:-ms-grid;grid-template-columns:min-content auto}i.od-PrincipalDetails-groupHeader-headerChevron{font-size:.5rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding-top:6px;padding-bottom:6px;grid-column:1}[dir=ltr] i.od-PrincipalDetails-groupHeader-headerChevron{padding-left:6px}[dir=rtl] i.od-PrincipalDetails-groupHeader-headerChevron{padding-right:6px}[dir=ltr] i.od-PrincipalDetails-groupHeader-headerChevron{padding-right:8px}[dir=rtl] i.od-PrincipalDetails-groupHeader-headerChevron{padding-left:8px}.od-PrincipalDetails-groupHeader-text{-ms-grid-column:2;grid-column:2}.od-PrincipalDetails-footer{width:100%;position:sticky;bottom:0}.od-PrincipalDetails-infoMessage-region{margin:-32px 16px 12px 16px;z-index:100;min-height:32px;height:auto}.od-PrincipalDetails-inheritanceInfoMessage{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";border-radius:6px;margin-top:12px}@media screen and (-ms-high-contrast:active){.od-PrincipalDetails-inheritanceInfoMessage{background:window}}@supports (font:-apple-system-body){.od-PrincipalDetails-inheritanceInfoMessage .ms-MessageBar-text{font:-apple-system-body}}.od-PrincipalDetails-actionsContainer{padding:16px 24px 26px 24px;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:2.375rem}.od-PrincipalDetails-actionsContainer button.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@supports (font:-apple-system-body){.od-PrincipalDetails-actionsContainer button{height:auto;padding:8px}}@supports (font:-apple-system-body){.od-PrincipalDetails-actionsContainer .ms-Button-label{font:-apple-system-body}}.od-PrincipalDetails-actionsContainer-spacer{padding:16px 24px 24px 24px;background-color:transparent;height:2rem}.od-PrincipalDetails-actionsStack{position:relative;float:right}[dir=rtl] .od-PrincipalDetails-actionsStack{float:left}.od-PrincipalDetails-cell{padding-left:calc(.5rem + 6px + 8px);padding-top:2px;padding-bottom:6px}.od-PrincipalDetails-cellDirectAccess{font-size:.875rem;color:#605e5c}@supports (font:-apple-system-body){.od-PrincipalDetails-cellDirectAccess{font:-apple-system-body}}.od-PrincipalDetails-cellLinkDetails{font-size:.75rem;color:#323130}.od-PrincipalDetails-cellRoleSelector{width:200px;padding-top:12px}.od-PermissionPivot-fileNameAndIconIE{overflow:hidden;text-overflow:ellipsis;max-width:320px;white-space:nowrap}.od-PermissionPivot-fileNameAndIconIEContainer{display:flex;flex-direction:row}"}]);var c=n(375);(0,s.b)([{rawString:"@keyframes fadeOutAnimation{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-50%)}}.od-TransientMessageBar-infoMessage-transient{animation:fadeOutAnimation .3s cubic-bezier(.1,.25,.75,.9) 3s}.od-TransientMessageBar-infoMessage-correlation{padding-top:15px}"}]);var d,l=n(167),u=n(115),f={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}},p=function(e){function t(t,n){var a=e.call(this,t)||this;return a._correlationId=a.props.correlationId,a.state={isVisible:!1},a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){var e=this;this.setState({isVisible:!0}),this.props.infoMessage.isTransient&&setTimeout(function(){e._resetNotification()},3e3)},t.prototype.render=function(){var e,t,n=this.props.infoMessage,r=n.isTransient?" od-TransientMessageBar-infoMessage-transient":" od-TransientMessageBar-infoMessage-visible";switch(n.type){case l.a.success:e=i.createElement(i.Fragment,null,n.message),t={ariaLabel:n.message,onDismiss:void 0};break;case l.a.error:e=i.createElement(i.Fragment,null,n.message,i.createElement("div",{className:"od-TransientMessageBar-infoMessage-correlation"},i.createElement("span",null,o.C," ",this._correlationId))),t={ariaLabel:n.message,onDismiss:this._resetNotification.bind(this),truncated:!0,overflowButtonAriaLabel:o.yb};break;default:e=i.createElement(i.Fragment,null,n.message),t={ariaLabel:n.message,onDismiss:this._resetNotification.bind(this)}}return i.createElement("div",null,this.state.isVisible&&i.createElement(u.a,(0,a.a)({},t,{className:this.props.additionalClassName+r,messageBarType:n.type,dismissButtonAriaLabel:o.l,role:"alert",styles:f}),e))},t.prototype._resetNotification=function(){this.setState({isVisible:!1}),this.props.dismissCallback()},t}(i.Component),m=n(245),_=n(239),h=n(88),b=n(108),g=n(32),v=n(31),y=n(72),S=n(93),D=n(39),I=n(240),x=n(16),C=n(10),O=n(28),w=n(2),E=n(382),A=n(43),L=n(85),k=n(78),M=n(82),P=n(568),T=n(119),U=n(57),F=n(50),H=n(5),R=n(557),N=n(250),B=n(377),j=n(7),V=n(105),z=n(219),G=n(217),K=n(86),W=n(17),q=n(20),Q=n(51),Y=n(44),J=n(70),X=n(143);!function(e){e[e.none=0]="none",e[e.direct=1]="direct",e[e.full=2]="full"}(d||(d={})),(0,R.a)(void 0);var Z={id:"",accessType:0,role:g.a.none,permission:{id:"",isSPO:!0,rawPermission:{shareId:""},role:g.a.none},isGroupCollapsed:!0},$={root:{height:"2rem",borderRadius:"0.25rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"},label:{fontSize:"0.875rem"}},ee={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}},te=function(e){function t(n,r){var s=e.call(this,n)||this;return s._onShouldVirtualize=function(){return!1},s._generateGroups=function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];if(8!==a.accessType){var i={count:1,startIndex:n,key:a.id,level:0,children:[],isCollapsed:a.isGroupCollapsed,name:s._computeGroupHeaderText(a.accessType,a),data:{sharingRole:a.role,accessType:a.accessType,item:a}};t.push(i)}}return t},s._onRenderHeader=function(e,t){var n,r;if(e){var c,d,l=e.group.data.item,u=e.group.data.sharingRole,f=s._getEditText(u,l,(null===(n=s.state.sharingInformation)||void 0===n?void 0:n.sharedObjectType)===J.a.list,(null===(r=s.state.sharingInformation)||void 0===r?void 0:r.sharedObjectType)===J.a.folder),p=s._isInheritedPermission(e.group.data.accessType),m=s._isBundlePermission(e.group.data.accessType),_=4===e.group.data.accessType||6===e.group.data.accessType;p&&(c=s._getInheritedTooltipContent(l,_)),m&&(d={onRenderContent:function(){return i.createElement(I.a,{className:"od-PrincipalDetails-textTooltipContent"},i.createElement("span",null,j.j(_?o.j:o.h,l.permission.rawPermission.inheritedFrom.name.toLowerCase())))}});var h=function(e){var t=s.state.accessItems.map(function(t){return t.id===e.key&&(t.isGroupCollapsed=!e.isCollapsed),t});s.setState({accessItems:t})};return e.onGroupHeaderClick=function(e){h(e)},e.onGroupHeaderKeyUp=function(e,t){e.preventDefault(),e&&e.keyCode&&(e.keyCode===x.a.space||e.keyCode===x.a.enter)&&h(t)},e.expandButtonProps={style:{display:"none"}},e.onRenderName=function(){var n=0===e.groupIndex?t+".":"";return i.createElement("div",{className:"od-PrincipalDetails-groupHeader","aria-label":"".concat(n," ").concat(e.group.name,", ").concat(f,", ").concat(o.G)},i.createElement(C.a,{"data-is-focusable":!1,onClick:function(){return e.onGroupHeaderClick(e.group)},className:"od-PrincipalDetails-groupHeader-headerChevron",iconName:e.group.isCollapsed?"ChevronDown":"ChevronUp"}),i.createElement("div",{className:"od-PrincipalDetails-groupHeader-text"},i.createElement("span",{className:"od-PrincipalDetails-name"},e.group.name),":"," ",i.createElement("span",{className:"od-PrincipalDetails-editStatus"},f),i.createElement("span",{className:"od-PrincipalDetails-groupTooltip"},p&&i.createElement(O.a,{tooltipProps:c,id:"od-PrincipalDetails-inheritedTooltip"},i.createElement("span",{tabIndex:0,role:"button",className:"od-PrincipalDetails-inlineTooltip"},i.createElement(C.a,{"aria-describedby":"od-PrincipalDetails-inheritedTooltip","data-is-focusable":!0,iconName:"Info"}))),m&&i.createElement(O.a,{tooltipProps:d,id:"od-PrincipalDetails-bundleTooltip"},i.createElement("span",{tabIndex:0,role:"button",className:"od-PrincipalDetails-inlineTooltip"},i.createElement(C.a,{"aria-describedby":"od-PrincipalDetails-bundleTooltip","data-is-focusable":!0,iconName:"Info"}))))))},e.styles=(0,w.I)({groupHeaderContainer:{height:"fit-content",padding:"8px 0px"}}),i.createElement(E.a,(0,a.a)({},e))}return null},s._onRenderCell=function(e,t,n){var a,r,d,l,u=s.props,f=u.sharingInformation.sharingLinks?u.sharingInformation.sharingLinks.filter(function(e){var n,a;return(null==e?void 0:e.shareId)===(null===(a=null===(n=null==t?void 0:t.permission)||void 0===n?void 0:n.rawPermission)||void 0===a?void 0:a.shareId)})[0]:null,p=(0,K.a)({clientId:u.clientId,sharingStore:s._store,sharingInformation:u.sharingInformation,scenarioId:s._store.getScenarioId&&s._store.getScenarioId(),isPreventDownloadAllowed:s._store.isPreventDownloadAllowed&&s._store.isPreventDownloadAllowed(),shareMode:v.a.manageAccess}),_=(s._store.isShared&&s._store.isShared()||u.sharingInformation.isShared)&&(s._store.isOwner&&s._store.isOwner()||u.sharingInformation.userRole===g.a.owner)&&t.role!==g.a.none,h=s._store.isOwner&&!s._store.isOwner(),b=0===t.accessType&&t.role===g.a.none&&(0,W.u)(u.principal)===g.a.edit,y=s.props.isEnterprise?""===t.id&&t.role===g.a.none:t.role===g.a.none,S=b||h;l=h?o.q:b?o.r:o.o;var D=null===(a=u.sharingInformation)||void 0===a?void 0:a.addressBarLinkSettings,x=D&&0===D.linkPermission;switch(t.accessType){case 0:case 3:case 5:d=i.createElement(I.a,{key:null===(r=t.permission.rawPermission)||void 0===r?void 0:r.shareId},i.createElement("div",{className:"od-PrincipalDetails-cellDirectAccess"},l),i.createElement("div",{className:"od-PrincipalDetails-cellRoleSelector"},i.createElement(m.a,{componentRef:s._roleSelectorRef,sharingRole:t.role,ariaLabel:o.p,mode:v.a.manageAccess,clientId:u.clientId,permissionId:t.id,onRoleChange:s._itemAccessChanged,menuPermissionOptions:p,roleSelectorAs:m.a,showRemoveDirectAccess:_,showGrantAccess:y,isGrantAccess:!0,disabled:S})));break;case 7:case 1:case 2:case 4:case 6:d=f&&i.createElement(I.a,{key:f.shareId},i.createElement(c.b,{key:f.shareId,companyName:u.companyName,link:f,clientId:u.clientId,mode:v.a.manageAccess,sharingInformation:u.sharingInformation,showPermissionsList:s._showPermissionsList,onShowLinkDetailsClicked:u.openLinkDetailsCallback.bind(f),enableLinkSettings:!0,showMainDeleteOption:!!f.isAddressBarLink&&x&&s._store&&s._store.isOwner(),showMoreOptions:!f.isAddressBarLink||!x&&s._store&&s._store.isOwner(),isAddressBarLink:f.isAddressBarLink,addressBarDetailsView:f.isAddressBarLink,engagementExtraData:u.engagementExtraData,linkRecipients:(0,W.A)(f),hideConsumerExpiredLinkIcons:!0,spacing:c.a.compact,isAccessSummaryLink:s.props.isEnterprise}))}return i.createElement("div",{role:"row","data-selection-index":n},i.createElement("div",{className:"od-PrincipalDetails-cell",role:"cell"},d))},s._showPermissionsList=function(){},s._onStopSharingDialogDismiss=function(){s.setState({activePermissionId:void 0,showStopSharingDialogType:d.none},function(){var e;(null===(e=s._roleSelectorRef)||void 0===e?void 0:e.current)&&s._roleSelectorRef.current.focus()})},s._stopSharingConfirmed=function(){s._engagementEventHelper.manageAccessV3PrincipalRemoveDirectAccess((0,W.D)(s.state.principal.type),s.props.engagementExtraData),s._store.updatePermissionById(s.state.activePermissionId,g.a.none),s._onStopSharingDialogDismiss()},s._itemAccessChanged=function(e,t){var n;if(e!==g.a.none){if(t&&s.state.updatedPermissions.has(t)){var i=s.props.principal.accessMap.get(t);if(i){var r=(0,W.C)(i);e===r?(n=s.state.updatedPermissions).delete(t):(n=s.state.updatedPermissions.set(t,e),n=s.state.updatedPermissions)}}else n=s.state.updatedPermissions.set(t,e),n=s.state.updatedPermissions;if(n){var o=s.state.accessItems.map(function(n){return n.id===t?(0,a.a)((0,a.a)({},n),{role:e}):n});s.setState({accessItems:o,updatedPermissions:n})}}else s.setState({activePermissionId:t,showStopSharingDialogType:d.direct})},s._undoClicked=function(){s._engagementEventHelper.manageAccessV3CancelPermissionUpdate(s.props.engagementExtraData);var e=s.state.sharingInformation.sharingPrincipals.filter(function(e){return e.id===s.props.principal.id})[0],n=t._parsePermissions(s.state.sharingInformation,e,s.props.backButtonCallback,s.props.isEnterprise).map(function(e){return(0,a.a)((0,a.a)({},e),{isGroupCollapsed:!0})});s.setState({updatedPermissions:new Map,accessItems:n,showMessageBar:!1})},s._applyClicked=function(){var e=new V.a({scenario:(0,z.a)("ShareManageAccessV3.updatePermissions"),perfGoalInMs:3e4}),t=[];s.state.updatedPermissions.forEach(function(e,n){if(n&&""!==n){var a=s._store.updatePermissionById(n,e);t.push(a)}else s._store.grantDirectAccess(s.props.principal.id.toString(),e)}),Promise.all(t).then(function(){(0,G.e)({customerPromise:e,engagementExtraData:s.props.engagementExtraData,sharingStore:s._store}),s.setState({updatedPermissions:new Map,showMessageBar:!0,messageBarContent:{type:l.a.success,message:o.kb,isTransient:!0}},function(){var e;(null===(e=s._roleSelectorRef)||void 0===e?void 0:e.current)&&s._roleSelectorRef.current.focus()}),s._store.fetchSharingInformation(!0)},function(t){(0,G.d)({customerPromise:e,rawErrorMessage:t||"generic share manage access failure",engagementExtraData:s.props.engagementExtraData,errorType:G.a.api,sharingStore:s._store}),s.setState({updatedPermissions:new Map,showMessageBar:!0,messageBarContent:{type:l.a.error,message:o.Lb,isTransient:!1}}),s._store.fetchSharingInformation(!0)})},s._store=n.store,s._permissionsViewSettings=s._store.getPermissionsViewSettings(),s._engagementEventHelper=n.store.getEngagementHelper(),s._isConsumer=s.props.store.isConsumer(),s._showSimplifiedDialogV2=(0,W.Z)(s.props.clientId,s._store),s._roleSelectorRef=i.createRef(),s.state={sharingInformation:n.sharingInformation,accessItems:t._parsePermissions(n.sharingInformation,n.principal,n.backButtonCallback,s.props.isEnterprise),principal:n.principal,updatedPermissions:new Map,activePermissionId:void 0,showStopSharingDialogType:d.none,showMessageBar:!1},s}return(0,a.d)(t,e),t.prototype.componentDidUpdate=function(e,n,a){var i=this;if(this.props.sharingInformation!==e.sharingInformation){var r=this.props.sharingInformation.sharingPrincipals.filter(function(e){return e.id===i.props.principal.id})[0];this.props.sharingInformation.sharingPrincipals&&this.props.sharingInformation.sharingPrincipals.length<1||!r?this.props.backButtonCallback():this.setState({sharingInformation:this.props.sharingInformation,accessItems:t._parsePermissions(this.props.sharingInformation,r,this.props.backButtonCallback,this.props.isEnterprise),principal:r,updatedPermissions:new Map,activePermissionId:void 0,showStopSharingDialogType:d.none})}},t.prototype.render=function(){var e=this,t=this.state.principal,n={imageUrl:t.imageUrl,text:t.primaryText,showSecondaryText:!1,size:A.c.size32,presence:A.b.none,showInitialsUntilImageLoads:!0,coinProps:{styles:{coin:{width:"2rem",height:"2rem"},image:{width:"2rem !important",height:"2rem !important"},imageArea:{width:"2rem",height:"2rem"},initials:{width:"2rem",height:"2rem",fontSize:"1.125rem",lineHeight:"2rem"}}},styles:{root:{height:"2rem"},primaryText:{fontSize:"1.125rem"}}};this._safeFileName=(0,W.$)(this.props.fileName),this._safeFileName,this.props.fileName;var r=this._permissionsViewSettings.supportedGroupTypes.indexOf(t.type)>=0,s=t.primaryText===o.Eb&&""===t.secondaryText;s&&(n.text="",n.onRenderPrimaryText=function(){return i.createElement("span",null,t.primaryText,i.createElement("span",{className:"od-PrincipalDetails-unknownTooltip"},e._renderUnknownDisplayNameTooltip()))});var c=r&&!this.props.isEnterprise,l=r?o.sb:o.ob;return i.createElement(L.a,null,i.createElement("div",{className:"od-PrincipalDetails"},i.createElement("div",{className:"od-PrincipalDetails-content",tabIndex:-1},this.state.showStopSharingDialogType!==d.none&&this._renderStopSharing(),this._renderHeader(),i.createElement("div",{className:"od-PrincipalDetails-accessSummary"},i.createElement("h2",{className:"od-PrincipalDetails-accessSummaryTitle ".concat(c?"manageGroupLink":"noManageGroupLink")},i.createElement("span",null,o.b),i.createElement(_.a,{message:o.a,ariaLabel:o.b+" "+o.a,className:"od-PrincipalDetails-accessSummaryTooltip"})),i.createElement(I.a,{horizontal:!0},i.createElement(k.a,(0,a.a)({},n,{className:"od-PrincipalDetails-Persona\n                ".concat(q.o(this.props.clientId)?"ie":"")})),i.createElement("span",{className:"od-PrincipalDetails-accessSummaryRole"},(0,W.E)((0,W.u)(t),this.props.sharingInformation.sharedObjectType===J.a.list,!0).title)),c&&i.createElement(M.a,{className:"od-PrincipalDetails-accessSummaryPrincipalSubtext",href:this._permissionsViewSettings.manageGroupLink,target:"_blank",underline:!0},o.W),s&&i.createElement("span",{className:"od-PrincipalDetails-accessSummaryPrincipalSubtext"},o.wb,i.createElement(M.a,{className:"od-PrincipalDetails-unknownUserLink",href:this._permissionsViewSettings.manageUnknownUserLink,target:"_blank",underline:!0},o.Cb),o.Ob))),i.createElement("div",{className:"od-PrincipalDetails-content2 spo ".concat(r?"group":"")},i.createElement("h2",{className:"od-PrincipalDetails-accessDetailsSection"},l),i.createElement(P.a,{items:this.state.accessItems,onRenderCell:this._onRenderCell,selectionMode:T.c.none,groups:this._generateGroups(this.state.accessItems),groupProps:{onRenderHeader:function(t){return e._onRenderHeader(t,l)}},compact:!0,onShouldVirtualize:this._onShouldVirtualize,focusZoneProps:{defaultTabbableElement:this._getDefaultTabbableElement}}),t.hasGSIAndCheckAccessPerms&&t.type===y.a.user&&this.props.isEnterprise&&i.createElement(u.a,{className:"od-PrincipalDetails-inheritanceInfoMessage",styles:ee,dismissButtonAriaLabel:o.l},o.J)),i.createElement("div",{className:"od-PrincipalDetails-footer ".concat("spo")},i.createElement("div",{className:"od-PrincipalDetails-infoMessage-region"},this.state.showMessageBar&&i.createElement(p,(0,a.a)({},this.props,{infoMessage:this.state.messageBarContent,dismissCallback:this._messageBarDismissed.bind(this),additionalClassName:"od-PrincipalDetails-infoMessage-footerMessageBar"}))),i.createElement("div",{className:"od-PrincipalDetails-actionsContainer"},i.createElement(I.a,{horizontal:!0,tokens:{childrenGap:12},className:"od-PrincipalDetails-actionsStack"},i.createElement(U.a,{text:o.e,onClick:this._applyClicked,disabled:this.state.updatedPermissions.size<1,className:"od-PrincipalDetails-applyChangesBtn",styles:$}),i.createElement(F.a,{text:o.xb,onClick:this._undoClicked,disabled:this.state.updatedPermissions.size<1,className:"od-PrincipalDetails-cancelChangesBtn",styles:$}))))))},t.prototype._renderHeader=function(){return i.createElement("div",{className:"od-PrincipalDetails-title"},i.createElement(Q.a,{mainHeaderText:o.V,renderBackButton:!0,onBackButtonClicked:this.props.backButtonCallback,actions:this._getHeaderActions(),isContextualHeader:!0}))},t.prototype._getHeaderActions=function(){var e=this;return i.createElement(i.Fragment,null,this.props.showCloseButton&&i.createElement(Y.a,{menuIconProps:{iconName:"Clear"},ariaLabel:o.l,tooltipContent:o.l,directionalHint:H.a.bottomAutoEdge,onClick:function(t){t.stopPropagation(),t.preventDefault(),e.props.onDismiss()}}))},t.prototype._getDefaultTabbableElement=function(e){return e.setAttribute("tabIndex","0")},t.prototype._renderUnknownDisplayNameTooltip=function(){var e=o.Ab;return i.createElement(O.a,{content:e,calloutProps:{gapSpace:0},id:"od-PrincipalDetails-unknownDisplayNameTooltip"},i.createElement("span",{tabIndex:0,role:"button",className:"od-PrincipalDetails-inlineTooltip"},i.createElement(C.a,{className:"od-PrincipalDetails-unknownDisplayName-infoIcon","aria-describedby":"od-PrincipalDetails-unknownDisplayNameTooltip","data-is-focusable":!0,iconName:"Info"})))},t.prototype._messageBarDismissed=function(){this.setState({showMessageBar:!1})},t.prototype._computeGroupHeaderText=function(e,t){var n,a;switch(e){case 0:a=o.n;break;case 1:a=o.pb;break;case 2:a=o.d;break;case 3:a=o.M+t.permission.rawPermission.inheritedFrom.name+"";break;case 4:a=o.O+t.permission.rawPermission.inheritedFrom.name;break;case 5:a=o.g+t.permission.rawPermission.inheritedFrom.name.toLowerCase();break;case 6:a=o.i+t.permission.rawPermission.inheritedFrom.name.toLowerCase();break;case 7:var i=(null===(n=this.props.companyName)||void 0===n?void 0:n.length)>o.m.length?o.m:this.props.companyName;a=j.j(o._,i)}return a},t.prototype._getInheritedTooltipContent=function(e,t){var n=this,r=this.props.sharingInformation.item,s=e.permission.rawPermission.inheritedFrom.path,c={size:16,type:N.a.folder},d=e.permission.rawPermission.inheritedFrom.name||s.substring(s.lastIndexOf("/")+1),l=r.parentName?d!==r.parentName:s.replace(r.parentPath,"").split("/").length>1;return{onRenderContent:function(){return i.createElement(I.a,{className:"od-PrincipalDetails-inheritedTooltipContent"},i.createElement("div",{className:"od-PrincipalDetails-inheritedTooltipContent-description"},t?o.P:o.N),i.createElement("span",null,i.createElement("span",null,i.createElement(C.a,(0,a.a)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},(0,B.a)(c))),d),i.createElement(C.a,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"}),l&&i.createElement("span",null,i.createElement("span",null,"..."),i.createElement(C.a,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"})),i.createElement("span",{className:"od-PrincipalDetails-inheritedTooltipContent-secondFilename"},i.createElement(C.a,(0,a.a)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},(0,B.a)(n.props.fileIconProps))),n.props.fileName)))}}},t.prototype._isInheritedPermission=function(e){return 3===e||4===e},t.prototype._isBundlePermission=function(e){return 5===e||6===e},t.prototype._getEditText=function(e,t,n,a){if(0===t.accessType&&t.role===g.a.none)return o.Z;var i="";switch(e){case g.a.submit:i=a?o.Mb:o.cb;break;case g.a.edit:i=n?o.s:o.t;break;case g.a.review:i=o.lb;break;case g.a.view:i=o.Tb;break;case g.a.manageList:i=o.X;break;case g.a.restrictedview:i=o.f}return i},t._parsePermissions=function(e,t,n,i){var r=e.sharingPrincipals.filter(function(e){return e.id===t.id})[0];if(!(e.sharingPrincipals&&e.sharingPrincipals.length<1)&&r){var o=[],s=!1;return t.accessMap.forEach(function(e){var n;if(e.isSPO){n=(0,a.a)((0,a.a)({},e),{accessType:2,role:(0,W.C)(e),permission:e,isGroupCollapsed:!0}),e.rawPermission.scope===S.a.specificPeople?n.accessType=1:e.rawPermission.scope===S.a.organization?n.accessType=7:-1!==e.id.indexOf("membership")?n.accessType=8:e.rawPermission.scope===S.a.anyone?n.accessType=2:(n.accessType=0,s=!0),t.sharingLinkKind&&(t.sharingLinkKind===D.a.anonymousView||t.sharingLinkKind===D.a.anonymousEdit?n.accessType=2:t.sharingLinkKind===D.a.direct?(n.accessType=0,s=!0):t.sharingLinkKind!==D.a.organizationView&&t.sharingLinkKind!==D.a.organizationEdit||(n.accessType=7));var i=e.rawPermission;(0,X.d)()&&i&&i.inheritedFrom&&(n.accessType=s?3:4)}else e&&(n={id:(i=e.rawPermission).id,accessType:2,role:(0,W.C)(e),permission:e,isGroupCollapsed:!0},i.grantedTo&&i.grantedTo.user&&i.grantedTo.user.id===t.id||i.grantedTo&&i.grantedTo.group&&i.grantedTo.group.id===t.id?(i.inheritedFrom?void 0!==i.inheritedFrom.path?n.accessType=3:n.accessType=5:n.accessType=0,s=!0):i.link&&(i.inheritedFrom?void 0!==i.inheritedFrom.path?n.accessType=4:n.accessType=6:"requestAccess"===i.link.type||i.invitation&&i.invitation.signInRequired?n.accessType=1:n.accessType=2));o.push(n)}),!s&&i&&o.push(Z),o}n()},t.prototype._renderStopSharing=function(){var e,t=this.props.principal,n={id:t.id,name:t.primaryText,image:t.imageUrl,isResolved:!0,principalName:t.loginName,userId:t.loginName,email:t.email,job:t.secondaryText,isExternal:t.isExternal,loginName:t.loginName,principalType:t.type};switch(this.state.showStopSharingDialogType){case d.direct:e=h.a.direct;break;case d.full:default:e=h.a.participant}return i.createElement("div",{className:"od-PermissionsPivot-stopSharing"},this.state.showStopSharingDialogType!==d.none&&i.createElement(b.ConfirmationDialog,{confirmationCode:e,participant:n,onApply:this._stopSharingConfirmed.bind(this),onCancel:this._onStopSharingDialogDismiss}))},t}(i.Component),ne=n(379),ae=n(29),ie=n(558),re=n(380),oe=n(174),se=n(179),ce=n(563),de=n(381),le=n(246),ue=n(42),fe=n(81),pe=n(323),me=n(59),_e=n(18),he=n(66),be=n(55),ge=n(114),ve=n(24),ye=n(374),Se=n(61);(0,s.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-sensitivity-label-left-align{display:flex!important;border-radius:4px;padding:1px 8px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";margin:1px;overflow:hidden;align-items:center}.od-sensitivity-label-left-align:focus-visible{outline:1px solid}.od-sensitivity-label{border-radius:4px;padding:2px 6px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";display:flex;margin:1px;overflow:hidden}[dir=ltr] .od-sensitivity-label{margin-left:8px}[dir=rtl] .od-sensitivity-label{margin-right:8px}.od-sensitivity-label:focus-visible{outline:1px solid}.od-sensitivity-text{font-size:.75rem;font-weight:400;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}@supports (font:-apple-system-body){.od-sensitivity-text{font:-apple-system-body}}.od-sensitivity-tooltip-text{font-size:.75rem;font-weight:600;margin:0;margin-bottom:2px}.od-sensitivity-tooltip-information{font-size:.75rem;margin:0}.od-sensitivity-label-container{display:flex}.od-sensitivity-aria-label{visibility:hidden}.od-sensitivity-shieldIcon{display:flex}[dir=ltr] .od-sensitivity-shieldIcon{margin-left:-4px}[dir=rtl] .od-sensitivity-shieldIcon{margin-right:-4px}[dir=ltr] .od-sensitivity-shieldIcon{margin-right:3px}[dir=rtl] .od-sensitivity-shieldIcon{margin-left:3px}.od-sensitivity-shieldIcon svg path{fill:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-sensitivity-shieldIcon svg path{filter:invert(100%)}.od-sensitivity-label-left-align{border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-sensitivity-shieldIcon svg path{filter:invert(0%)}}"}]);var De=n(11);function Ie(e,t){var n=i.useState(null),a=n[0],r=n[1],o=((0,W._)(t.clientId,t.sharingStore)||(0,W.Z)(t.clientId,t.sharingStore))&&De.hi;return e.sensitivityLabelInformation.displayName&&t.sharingStore.getEngagementHelper().showSensitivityLabel(e.engagementExtraData),i.createElement("div",{className:"od-sensitivity-label-container"},i.createElement(O.a,{tooltipProps:{directionalHint:H.a.bottomAutoEdge,onRenderContent:function(){return t.sharingStore.getEngagementHelper().hoverOverSensitivityLabel(e.engagementExtraData),i.createElement("div",{className:"od-sensitivity-tooltip"},i.createElement("p",{className:"od-sensitivity-tooltip-text"},o,e.sensitivityLabelInformation.displayName),i.createElement("p",{className:"od-sensitivity-tooltip-information"},a))},calloutProps:{hidden:null===a||0===a.length}},onTooltipToggle:function(n){return n?void(null===a&&t.sharingStore.getSensitivityLabels(e.getGraphToken).then(function(t){if(t){var n=t.filter(function(t){return t.id===e.sensitivityLabelInformation.id});0!==n.length?r(n[0].tooltip):r("")}else r("")}).catch(function(){r("")})):null},styles:{root:{display:"flex",overflow:"hidden",width:"min-content"}},id:"sensitivity-label"},i.createElement("span",{className:e.filename&&0!==e.filename.length?"od-sensitivity-label":"od-sensitivity-label-left-align",tabIndex:0,role:"note","aria-label":a?o+e.sensitivityLabelInformation.displayName+", "+a:e.sensitivityLabelInformation.displayName},(0,ve.$)()&&function(){var t,n;return void 0===(null===(t=e.sensitivityLabelInformation)||void 0===t?void 0:t.hasIRMProtection)?null:(null===(n=e.sensitivityLabelInformation)||void 0===n?void 0:n.hasIRMProtection)?i.createElement(C.a,{iconName:"ShieldLock16RegularIcon",className:"od-sensitivity-shieldIcon"}):i.createElement(C.a,{iconName:"Shield16RegularIcon",className:"od-sensitivity-shieldIcon"})}(),i.createElement("p",{className:"od-sensitivity-text"},e.sensitivityLabelInformation.displayName))))}Ie.contextTypes={sharingStore:r.object.isRequired,clientId:r.number.isRequired};var xe=n(46),Ce=n(560),Oe=n(651),we={iconName:"CirclePlus"},Ee=30;(0,R.a)(void 0);var Ae={mainPeople:0,mainGroups:1,mainLinks:2,principalDetails:3,linkDetails:4},Le={root:{height:"2rem",borderRadius:"0.25rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"},label:{fontSize:"0.875rem"}},ke={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}},Me=function(e){function t(t,n){var r,s,d,l=e.call(this,t)||this;l._viewStates=[],l._navHeaderItems=new Map,l._topLevelDivRef=i.createRef(),l._searchRef=i.createRef(),l._stopSharingRef=i.createRef(),l._onAdvancedSettingsClick=function(){window.open(l.props.advancedUrl,"_blank"),l._sendAdvancedClickEngagementEvent()},l._setShowViewOnlyMessageDismissed=function(){l.setState({showViewOnlyBanner:!1})},l._setShowInheritedMessageDismissed=function(){l.setState({showInheritedMessage:!1})},l._setShowBundleMessageDismissed=function(){l.setState({showBundleMessage:!1})},l._renderSelectedDropdownContent=function(){switch(l.state.dropdownSelectedKey){default:return i.createElement("div",{className:"od-PermissionsPivot-scroll"}," ",l._renderPeopleContent()," ");case 1:return i.createElement("div",{className:"od-PermissionsPivot-scroll"}," ",l._renderGroupsContent()," ");case 2:return i.createElement("div",{className:"od-PermissionsPivot-scroll"}," ",l._renderLinksContent()," ")}},l._handlePrincipalKeyDown=function(e,t){return function(n){n.keyCode!==x.a.enter&&n.keyCode!==x.a.space||e||(n.preventDefault(),l._openPersonDetailsPage(t))}},l._onRenderPrincipalContentCell=function(e,t){var n,a=l._getItemFocusStyle(e),r=ve.k()&&!ve.l()?l._viewOnly||-1!==(null===(n=e.loginName)||void 0===n?void 0:n.indexOf(l.props.sharingInformation.allOrganizationSecurityGroupId)):l._viewOnly;return i.createElement("div",{key:e.id,onClick:r?function(){}:l._openPersonDetailsPage.bind(l,e),className:a.itemCell,"data-is-focusable":!0,"aria-disabled":e.role===g.a.owner?"true":"false",onKeyDown:l._handlePrincipalKeyDown(r,e)},l._renderInnerCellContent(e))},l._renderPeopleContent=function(){var e,t=!1,n=!(l.state.peopleCount<=1),a=l._isConsumer?l.state.filteredUserPrincipals.length:l.state.usersToShow.length,r=l.state.showSearchResultCount?a+" "+(1===a?o.ib:o.ab):"",s=l.state.showSearchResultCount?0===a?r:j.j(o.eb,r):"";return i.createElement("div",{id:"od-PermissionsPivot-content principalContent"},l.state.sharingInformation.hasInheritedLinks&&l.state.showInheritedMessage&&i.createElement(u.a,{className:"od-PermissionsPivot-infoMessage",onDismiss:l._setShowInheritedMessageDismissed,dismissButtonAriaLabel:o.l,styles:ke},l._isConsumer?o.L:o.K),l.state.sharingInformation.hasBundleLinks&&l.state.showBundleMessage&&i.createElement(u.a,{className:"od-PermissionsPivot-infoMessage",onDismiss:l._setShowBundleMessageDismissed,dismissButtonAriaLabel:o.l,styles:ke},o.k),i.createElement("div",{className:"od-PermissionsPivot-usersList"},n&&i.createElement(ie.a,{componentRef:l._searchRef,className:"od-PermissionsPivot-search",placeholder:l.state.showLoadMore?o.tb:o.nb,underlined:!0,onChange:function(e,n){if(""!==n){t=!0;var a=l.state.userPrincipals.filter(function(e){return e.primaryText.toLowerCase().indexOf(n.toLowerCase())>=0||e.email&&e.email.toLowerCase().indexOf(n.toLowerCase())>=0});l.setState({filteredUserPrincipals:a,usersToShow:a,showSearchResultCount:!0,accessChecked:!1,showLoadMore:!1,isFiltering:!l._isConsumer},function(){if(!l._isConsumer&&l.state.usersToShow.length>0&&!l.state.accessChecked){var e=l.state.usersToShow.map(function(e){return{email:e.loginName}});l.props.store.checkUserAccess&&l.props.store.checkUserAccess(e).then(function(){l.setState({accessChecked:!0})})}})}else l._resetPrincipalSearch();t&&l._engagementEventHelper.manageAccessV3UserDidSearch(l.props.engagementExtraData)}}),i.createElement("span",{className:"od-PermissionsPivot-searchResultsCountWrapper",role:"alert","aria-live":"assertive"},i.createElement("div",null,n&&l.state.showSearchResultCount&&i.createElement("div",{className:"od-PermissionsPivot-searchResultsCount","aria-label":s},r))),i.createElement(re.a,{className:"od-PermissionsPivot-peopleList",items:l._isConsumer?l.state.filteredUserPrincipals:l.state.usersToShow,onRenderCell:l._onRenderPrincipalContentCell}),!l._isConsumer&&l.state.showLoadMore&&i.createElement("div",{className:"od-PermissionsPivot-footerDiv"},i.createElement(M.a,{onClick:l._onLoadMoreClick},o.U),l._renderResultsCount())),i.createElement("div",{className:"od-PermissionsPivot-emptySection-announce","aria-live":"polite"},l.state.peopleCount<=1&&(!l._isEnterprise||0==l.state.linksCount&&(0===l.state.userPrincipals.length||(null===(e=l.state.userPrincipals[0])||void 0===e?void 0:e.role)===g.a.owner))&&i.createElement("div",{className:"od-PermissionsPivot-emptySection"},l._isFolder?o.B:o.A,i.createElement(oe.a,{className:"od-PermissionsPivot-sectionShareButton",iconProps:we,onClick:l._showDefaultShare.bind(l,"people"),styles:Le},o.rb))))},l._grantAccessToAllOrgSG=function(){return l.props.store.grantAccessToAllOrgSG()},l._removeAccessToAllOrgSGAndEEEU=function(){return l.props.store.removeAccessToAllOrgSGAndEEEU()},l._onLoadMoreClick=function(){l.setState(function(e){return{usersToShow:l.state.userPrincipals.slice(0,(e.page+1)*Ee),page:e.page+1,showLoadMore:(e.page+1)*Ee<l.state.userPrincipals.length,accessChecked:!1}})},l._openPersonDetailsPage=function(e){e.role!==g.a.owner&&(l._viewStates.push(l.state.viewState),l._engagementEventHelper.manageAccessV3PrincipalDetailsClicked((0,W.D)(e.type),l._engagementExtraData),l.setState({viewState:Ae.principalDetails,selectedPrincipal:e}))},l._renderGroupsContent=function(){var e=ve.db()?l._isConsumer:l._isConsumer||l.props.store.isCOB&&l.props.store.isCOB(),t=e?"https://go.microsoft.com/fwlink/?linkid=2234328":"https://go.microsoft.com/fwlink/?linkid=2234808",n=e?o.u:o.v,a=l._isFolder?o.x:o.w;return i.createElement("div",{id:"od-PermissionsPivot-content principalContent"},l.state.sharingInformation.hasInheritedLinks&&l.state.showInheritedMessage&&i.createElement(u.a,{className:"od-PermissionsPivot-infoMessage",onDismiss:l._setShowInheritedMessageDismissed,dismissButtonAriaLabel:o.l,styles:ke},e?o.L:o.K),l.state.sharingInformation.hasBundleLinks&&l.state.showBundleMessage&&i.createElement(u.a,{className:"od-PermissionsPivot-infoMessage",onDismiss:l._setShowBundleMessageDismissed,dismissButtonAriaLabel:o.l,styles:ke},o.k),i.createElement("div",{className:"od-PermissionsPivot-emptySection-announce","aria-live":"polite"},l.state.groupsCount<1&&i.createElement("div",{className:"od-PermissionsPivot-emptySection"},j.j(a,n),i.createElement("a",{href:t,target:"_blank",rel:"noreferrer"}," ",o.Q),i.createElement(oe.a,{className:"od-PermissionsPivot-sectionShareButton",iconProps:we,onClick:l._showDefaultShare.bind(l,"groups"),styles:Le},j.j(o.F,n)))),i.createElement("div",{className:"od-PermissionsPivot-usersList"},i.createElement(re.a,{className:"od-PermissionsPivot-groupsList",items:l.state.groupPrincipals,onRenderCell:l._onRenderPrincipalContentCell})))},l._renderAddressBarLink=function(e,t,n,a){return xe.a.isFeatureEnabled(ve.b)&&l._isEnterprise&&n&&i.createElement("li",{key:t.shareId,className:"od-PermissionsPivot-resolvedLink"},i.createElement(c.b,{key:t.shareId,isAddressBarLink:t.isAddressBarLink,companyName:l.props.companyName,link:t,clientId:l.props.clientId,mode:v.a.manageAccess,sharingInformation:l.state.sharingInformation,enableLinkSettings:!0,showMoreOptions:!a,showMainDeleteOption:!1,showPermissionsList:l._returnToPreviousView,onShowLinkDetailsClicked:l._openLinkDetailsPage.bind(l,t),engagementExtraData:l._engagementExtraData,linkDetailsView:!1,onRemoveLink:l._removeLink,linkRecipients:(0,W.A)(t),hideConsumerExpiredLinkIcons:!0,spacing:c.a.standard,showLinkHeader:!0,fileName:l._fileName,fileIcon:l._fileIconProps.type,addressBarLinkSettings:e}))},l._renderLinksContent=function(){var e=l.props.sharingInformation.addressBarLinkSettings,t=!!e&&0===e.linkPermission,n=!!e&&e.linkDisabled,r=l._addressBarLink;(t||n)&&l.props.sharingInformation.sharedObjectType!==J.a.folder&&(r=(0,a.a)((0,a.a)({},l.props.sharingInformation.directLink),{isAddressBarLink:!0}),l._addressBarLink=r);var s=!n&&t&&l.state.linksCount>=1,d=!!r&&!(!n&&t)||s,u=l.state.linksCount<1,f=l.state.linksCount<1;d&&r.isAddressBarLink&&(u=!1,f=n||t?l.state.linksCount<1:l.state.linksCount<2);var p=l.props.store.getUnhealthyLinks&&l.props.store.getUnhealthyLinks(),m=!u&&!f||!p||0===p.length;return i.createElement("div",{id:"od-PermissionsPivot-content"},i.createElement("ul",{role:"list",className:"od-PermissionsPivot-linksList"},l._renderAddressBarLink(e,r,d,t),i.createElement("div",{className:"od-PermissionsPivot-emptySection-announce","aria-live":"polite"},m&&i.createElement("div",{className:"od-PermissionsPivot-emptySection"},u&&i.createElement("div",null,l._isFolder?o.z:o.y),f&&i.createElement(oe.a,{className:"od-PermissionsPivot-sectionShareButton",iconProps:we,onClick:l._showDefaultShare.bind(l,"links"),styles:Le},o.T))),(l.props.store.isConsumer()?l.state.sharingInformation.sharingLinks:l.props.store.getActiveLinks()).map(function(e,t){return e.expiration=(l.props.store.isConsumer()||ve.n()||e.audience===ae.a.anyone)&&e.expiration?new Date(e.expiration):null,!e.isAddressBarLink&&i.createElement("li",{key:e.shareId,className:"od-PermissionsPivot-resolvedLink"},i.createElement(c.b,{key:e.shareId,isAddressBarLink:e.isAddressBarLink,companyName:l.props.companyName,link:e,clientId:l.props.clientId,mode:v.a.manageAccess,sharingInformation:l.state.sharingInformation,enableLinkSettings:!0,showMoreOptions:!0,showMainDeleteOption:!0,showPermissionsList:l._returnToPreviousView,onShowLinkDetailsClicked:l._openLinkDetailsPage.bind(l,e),engagementExtraData:l._engagementExtraData,linkDetailsView:!1,onRemoveLink:l._removeLink,linkRecipients:(0,W.A)(e),hideConsumerExpiredLinkIcons:!0,spacing:c.a.standard,showLinkHeader:!0,fileName:l._fileName,fileIcon:l._fileIconProps.type}))}),p&&p.map(function(e){var t=l.state.sharingInformation.userRole===g.a.owner;return i.createElement("li",{key:e.shareId,className:"od-PermissionsPivot-resolvedLink"},i.createElement(c.b,{key:e.shareId,isAddressBarLink:e.isAddressBarLink,companyName:l.props.companyName,link:e,clientId:l.props.clientId,mode:v.a.manageAccess,sharingInformation:l.state.sharingInformation,enableLinkSettings:!0,showMoreOptions:t,showMainDeleteOption:t,showPermissionsList:l._returnToPreviousView,onShowLinkDetailsClicked:l._openLinkDetailsPage.bind(l,e),engagementExtraData:l._engagementExtraData,linkDetailsView:!1,onRemoveLink:l._removeLink,linkRecipients:(0,W.A)(e),hideConsumerExpiredLinkIcons:!0,spacing:c.a.standard,showLinkHeader:!0,fileName:l._fileName,fileIcon:l._fileIconProps.type}))})))},l._returnToPreviousView=function(){l._viewStates&&l._viewStates.length>0?l.setState({viewState:l._viewStates.pop(),filteredUserPrincipals:l.state.userPrincipals,showSearchResultCount:!1,usersToShow:l.state.userPrincipals.slice(0,l.state.page*Ee),showLoadMore:!l._isConsumer&&l.state.userPrincipals.slice(0,l.state.page*Ee).length<l.state.userPrincipals.length,showAddressBarLinkDetails:!1}):l.setState({viewState:Ae.mainPeople,filteredUserPrincipals:l.state.userPrincipals,showSearchResultCount:!1,usersToShow:l.state.userPrincipals.slice(0,l.state.page*Ee),showLoadMore:!l._isConsumer&&l.state.userPrincipals.slice(0,l.state.page*Ee).length<l.state.userPrincipals.length,showAddressBarLinkDetails:!1})},l._resetPrincipalSearch=function(){l.setState({filteredUserPrincipals:l.state.userPrincipals,usersToShow:l.state.userPrincipals.slice(0,l.state.page*Ee),showSearchResultCount:!1,showLoadMore:!l._isConsumer&&l.state.userPrincipals.slice(0,l.state.page*Ee).length<l.state.userPrincipals.length,isFiltering:!1})},l._removeLink=function(){l.setState({alertContent:o.R})},l._openLinkDetailsPage=function(e){l._viewStates.push(l.state.viewState),l.setState({selectedLink:e,viewState:Ae.linkDetails,showAddressBarLinkDetails:e.isAddressBarLink})},l._stopSharing=function(){l.setState({stopSharingState:0,showStopSharingDialog:!1}),l.props.onStopSharingClicked().then(function(e){var t,n=0===e.statusCode&&!e.errorMessage;n&&(null===(t=l.props.store)||void 0===t||t.stopSharing()),l.setState({showStopSharingText:!n,showStopSharingDialog:!n,alertContent:n?o._b:o.hb,stopSharingState:n?1:2,showLoadMore:!n})}),l._engagementEventHelper.manageAccessV3StopSharingClicked(l._engagementExtraData)},l._showDefaultShare=function(e){l._engagementEventHelper.manageAccessV3ShareClicked(e,l._engagementExtraData);var t=l._sanitizeOverrideViewState(l.state.viewState);l.props.onDefaultShare(t)},l._shareClickTime=n.shareClickTime,l._sharingClientMessenger=n.sharingClientMessenger,l._engagementExtraData=t.engagementExtraData,l._engagementEventHelper=t.store.getEngagementHelper(),l._resize=n.resize,l._resizeTracker=new Se.a(n.resize),l._plaformDetection=n.platformDetection,l._fileName=t.sharingInformation.item.name,l._isFolder=(null===(s=null===(r=t.sharingInformation)||void 0===r?void 0:r.item)||void 0===s?void 0:s.itemType)===fe.a.Folder||t.sharingInformation.sharedObjectType===J.a.folder;var f=(null===(d=t.sharingInformation.item)||void 0===d?void 0:d.extension)||t.sharingInformation.fileExtension;f&&" "!==f?l._fileIconProps={extension:l.props.sharingInformation.item.extension||f,size:16}:l._isFolder?l._fileIconProps={size:16,type:N.a.folder}:l._fileIconProps={size:16,type:N.a.genericFile};var p=l.props.store;l._isConsumer=p.isConsumer(),l._permissionsViewSettings=p.getPermissionsViewSettings();var m=l.props.maxHeight<650?l.props.maxHeight:650;l.heightStyle={height:m},l.heightStyle={minHeight:650},l.props.maxHeight&&(l.heightStyle={height:m}),l._navHeaderItems.set(ge.c.People,o.$),l._navHeaderItems.set(ge.c.Groups,l._permissionsViewSettings.groupPivotHeader),l._navHeaderItems.set(ge.c.Links,o.S);var _=!1;if(p&&p.getCanStopSharing){var h=!l._addressBarLink||l._addressBarLink.sharingScope===S.a.organization;_=p.getCanStopSharing()&&h}var b,y=p.parsePrincipals(),D=y.users,I=y.groups;l._engagementEventHelper.manageAccessV3Opened(l._engagementExtraData),l.props.viewOverride&&(b=l._sanitizeOverrideViewState(l.props.viewOverride),l._viewStates.push(b)),l._addressBarLink=xe.a.isFeatureEnabled(ve.b)&&p.getAddressBarLink&&p.getAddressBarLink(),l._isSPO=(0,W.Z)(l.props.clientId,l.props.store),l._isEnterprise=l._isSPO,ve.fb()||(l._isSPO=!l._isConsumer||p.isCOB&&p.isCOB(),l._isEnterprise=!l._isConsumer&&p.isCOB&&!p.isCOB()),l._hasBackButton=l.props.mode!==v.a.manageAccess;var C=p.getLinksCount();return l._engagementEventHelper.manageAccessV3NumberOfLinks({numberOfLinks:C}),l._viewOnly=l.props.sharingInformation.userRole===g.a.view||l.props.sharingInformation.userRole===g.a.restrictedview||l.props.sharingInformation.userRole===g.a.review,l.state={alertContent:"",sharingInformation:l.props.sharingInformation,selectedNavKey:b||0,showInheritedMessage:l.props.sharingInformation.hasInheritedLinks,showBundleMessage:l.props.sharingInformation.hasBundleLinks,showSearchResultCount:!1,dropdownSelectedKey:0,useDropdown:window.outerWidth<pe.a.DEFAULT_BREAKPOINTS.Small,peopleCount:D.length,groupsCount:I.length,linksCount:C,viewState:b||Ae.mainPeople,selectedPrincipal:void 0,userPrincipals:D,groupPrincipals:I,filteredUserPrincipals:D,selectedLink:void 0,showStopSharingText:_,showStopSharingDialog:!1,stopSharingState:void 0,accessChecked:!1,usersToShow:D.slice(0,Ee),showLoadMore:!l._isConsumer&&D.length>=Ee,page:1,isFiltering:!1,showAddressBarLinkDetails:!1,showViewOnlyBanner:l._viewOnly},l}return(0,a.d)(t,e),t.prototype.componentDidUpdate=function(e,t,n){var a=this;if(this.props.sharingInformation!==e.sharingInformation||this.state.viewState!==t.viewState){var i=this.props.store,r=i.parsePrincipals(),o=r.users,s=r.groups;this._addressBarLink=xe.a.isFeatureEnabled(ve.b)&&i.getAddressBarLink&&i.getAddressBarLink();var c=void 0;this.state.selectedPrincipal&&(c=this.props.sharingInformation.sharingPrincipals.filter(function(e){return e.id===a.state.selectedPrincipal.id})[0]);var d=void 0;this.state.selectedLink&&(d=this.props.sharingInformation.sharingLinks.filter(function(e){return e.shareId===a.state.selectedLink.shareId})[0]);var l,u=!1;i&&i.getCanStopSharing&&(u=i.getCanStopSharing()),l={sharingInformation:this.props.sharingInformation,filteredUserPrincipals:o,userPrincipals:o,peopleCount:o.length,groupPrincipals:s,groupsCount:s.length,linksCount:i.getLinksCount(),selectedPrincipal:c,selectedLink:d,showStopSharingText:u,usersToShow:this.state.isFiltering?this.state.usersToShow:o.slice(0,this.state.page*Ee)},this.setState(l)}if(!this._isConsumer&&this.state.page!==t.page){var f=this.state.usersToShow.slice(t.page*Ee,this.state.page*Ee).map(function(e){return{email:e.loginName}});this.props.store.checkUserAccess&&f.length>0&&!this.state.accessChecked?this.props.store.checkUserAccess(f).then(function(){a.setState({accessChecked:!0})}):this.setState({accessChecked:!0})}this._resize(),this._resizeIfNeeded()},t.prototype.componentDidMount=function(){var e,t=this;if(!this._isConsumer){var n=this.state.usersToShow.map(function(e){return{email:e.loginName}});this.props.store.checkUserAccess&&n.length>0&&!this.state.accessChecked?this.props.store.checkUserAccess(n).then(function(){var e=t.props.store.parsePrincipals().users;t.setState({accessChecked:!0,usersToShow:t.state.isFiltering?t.state.usersToShow:(0,a.g)([],e.slice(0,t.state.page*Ee),!0)})}):this.setState({accessChecked:!0})}null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){return e.end({resultType:_e.b.Success})}),this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():be.r(this._shareClickTime,this.props.clientId,v.a.manageAccess,this.props.scenarioId,this.props.correlationId);var i=new me.a(this);i.on(window,"keydown",function(e){e&&e.keyCode===x.a.escape?t._handleEscKeyPress(e):e&&e.keyCode===x.a.forwardSlash&&t._searchRef&&t._searchRef.current&&!t._searchRef.current.hasFocus()&&(e.preventDefault(),t._searchRef.current.focus(),t._engagementEventHelper.manageAccessV3QuickfindHotkeyUsed(t._engagementExtraData))}),i.on(window,"resize",function(){t.setState({useDropdown:window.outerWidth<pe.a.DEFAULT_BREAKPOINTS.Small})}),this._resize(),this._resizeIfNeeded()},t.prototype.render=function(){var e;switch(this.state.viewState){case Ae.mainPeople:case Ae.mainGroups:case Ae.mainLinks:e=this._renderDefaultPermissionsView();break;case Ae.principalDetails:e=this._renderPrincipalDetailsView();break;case Ae.linkDetails:e=this._renderLinkDetailsView();break;default:e=this._renderDefaultPermissionsView()}return i.createElement(L.a,null,i.createElement("div",{className:"od-PermissionsPivot-contentParent",style:this.heightStyle},he.a(this.state.alertContent,"assertive","alert"),e))},t.prototype._customPivotHeaderString=function(e,t){var n=e;return t>0&&t<100?n+=" • "+t.toString():t>=100&&(n+=" • 99+"),n},t.prototype._sendAdvancedClickEngagementEvent=function(){this._engagementEventHelper.manageAccessV3AdvancedSettingsClicked(this.props.engagementExtraData)},t.prototype._renderFileNameAndIcon=function(){var e,t,n=(0,W.$)(this._fileName),r=n.length>26,o=this._isFolder&&this._isSPO?i.createElement(Ce.a,{className:"od-PermissionsPivot-coloredFolderIcon",color:(null===(e=this.props.store)||void 0===e?void 0:e.getItem)&&(null===(t=this.props.store.getItem().properties)||void 0===t?void 0:t.color)}):i.createElement(C.a,(0,a.a)({className:"od-PermissionsPivot-fileIcon","aria-hidden":"true"},(0,B.a)(this._fileIconProps))),s=r?(0,he.b)(i.createElement("div",{className:this._plaformDetection.isIE&&"od-PermissionPivot-fileNameAndIconIEContainer"},i.createElement("span",{"aria-hidden":"true"},o),i.createElement("span",{className:this._plaformDetection.isIE&&"od-PermissionPivot-fileNameAndIconIE","aria-label":this._fileName},n)),this._fileName,{position:H.a.topLeftEdge}):i.createElement(i.Fragment,null,i.createElement("span",{"aria-hidden":"true"},o),this._fileName);return i.createElement("div",{className:"od-PermissionsPivot-fileNameAndIcon ".concat(this._plaformDetection.isIE?"isIE":"")},s,i.createElement("div",{className:"od-PermissionsPivot-sensitivityLabel"},this._renderSensitivityLabel()))},t.prototype._renderStopSharing=function(){var e=this,t={primaryButtonText:o.mb,onDismiss:function(){var t;e.setState({showStopSharingDialog:!1}),e._stopSharingRef&&(null===(t=e._stopSharingRef.current)||void 0===t||t.focus())},showStopSharingDialog:this.state.showStopSharingDialog,stopSharing:this._stopSharing,dialogContentProps:{type:se.a.close,title:o.gb,subText:o.bb}};return 2===this.state.stopSharingState&&(t=(0,a.a)((0,a.a)({},t),{primaryButtonText:o.Sb,dialogContentProps:{type:se.a.close,title:o.Ib,subText:o.Db}})),i.createElement("div",{className:"od-PermissionsPivot-stopSharing"},this.state.showStopSharingDialog&&i.createElement(ye.a,(0,a.a)({},t)))},t.prototype._renderViewOnlyBanner=function(){return this.state.showViewOnlyBanner&&i.createElement(u.a,{className:"od-PermissionsPivot-infoMessage",onDismiss:this._setShowViewOnlyMessageDismissed,dismissButtonAriaLabel:o.l,styles:ke},o.Pb)},t.prototype._renderStopSharingText=function(){var e=this,t=this.props.store&&this.props.store.isShared&&this.props.store.isShared(),n=!!ve.K()||this.props.store.isOwner&&this.props.store.isOwner();if(t&&n)return this.state.showStopSharingText&&this._permissionsViewSettings.itemStopSharingSupported?i.createElement(oe.a,{componentRef:this._stopSharingRef,iconProps:{iconName:"Blocked2"},"aria-label":o.mb,onClick:function(){e.setState({showStopSharingDialog:!0})}},o.mb):this._permissionsViewSettings.itemStopSharingSupported&&i.createElement(O.a,{content:"".concat(o.vb)},i.createElement(oe.a,{componentRef:this._stopSharingRef,iconProps:{iconName:"Blocked2"},"aria-label":o.mb,onClick:function(){e.setState({showStopSharingDialog:!0})},disabled:!0,className:"od-PermissionsPivot-stopSharingButtonDisabled"},o.mb))},t.prototype._renderSharingHeaderButtons=function(){return i.createElement("div",{className:"od-PermissionsPivot-sharingHeaderButtons space-between"},!this._hasBackButton&&i.createElement(oe.a,{iconProps:{iconName:"Share"},className:"od-PermissionsPivot-share","aria-label":o.ub,onClick:this._showDefaultShare.bind(this,"header"),tabIndex:0},o.ub),this._renderStopSharingText())},t.prototype._renderDefaultPermissionsView=function(){var e=this;return i.createElement("div",{className:"od-PermissionsPivot-DefaultView-content",tabIndex:-1,ref:this._topLevelDivRef},this._renderHeader(),!this.state.useDropdown&&i.createElement("div",{className:"od-PermissionsPivot-pivot"},i.createElement(ce.a,{selectedKey:String(this.state.selectedNavKey),onLinkClick:function(t){var n=Number(t.props.itemKey);e._viewStates.push(n),e.setState({selectedNavKey:n,viewState:n});var a=e._parseNavigationHeadersForTelem(t.props.headerText),i=[ge.c.People,ge.c.Groups,ge.c.Links],r=i&&i.length-1>=n&&i[n]||ge.c.Other;e._engagementEventHelper.manageAccessV3NavClicked(r,parseInt(a[1]),e._engagementExtraData),e._resetPrincipalSearch()}},i.createElement(de.a,{className:"od-PermissionsPivot-pivotItem",itemKey:"0",headerText:this._customPivotHeaderString(this._navHeaderItems.get(ge.c.People),this.state.peopleCount)},this._renderPeopleContent()),i.createElement(de.a,{itemKey:"1",headerText:this._customPivotHeaderString(this._navHeaderItems.get(ge.c.Groups),this.state.groupsCount)},this._renderGroupsContent()),i.createElement(de.a,{itemKey:"2",headerText:this._customPivotHeaderString(this._navHeaderItems.get(ge.c.Links),this.state.linksCount)},this._renderLinksContent()))),this.state.useDropdown&&i.createElement("div",{className:"od-PermissionsPivot-dropdown"},i.createElement(le.a,{className:"od-PermissionsPivot-dropdown-container",options:this._populateDropdownOptions(),onChange:function(t,n){var a=e._parseNavigationHeadersForTelem(n.text),i=Number(n.key),r=[ge.c.People,ge.c.Groups,ge.c.Links],o=r&&r.length-1>=i&&r[i]||ge.c.Other;e._engagementEventHelper.manageAccessV3NavClicked(o,parseInt(a[1]),e._engagementExtraData),e._viewStates.push(i),e.setState({selectedNavKey:i,viewState:i,dropdownSelectedKey:i})},defaultSelectedKey:this.state.selectedNavKey}),i.createElement("div",{className:"od-PermissionsPivot-dropdownContent"},this._renderSelectedDropdownContent())))},t.prototype._renderPrincipalDetailsView=function(){return i.createElement(te,(0,a.a)({},this.props,{backButtonCallback:this._returnToPreviousView,showCloseButton:this.props.showCloseButton,fileName:this._fileName,fileIconProps:this._fileIconProps,onDismiss:this.props.onDismiss,principal:this.state.selectedPrincipal,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,openLinkDetailsCallback:this._openLinkDetailsPage,store:this.props.store,companyName:this.props.companyName,engagementExtraData:this._engagementExtraData,isEnterprise:this._isEnterprise,renderSensitivityLabel:this._renderSensitivityLabel.bind(this)}))},t.prototype._renderLinkDetailsView=function(){var e=this.props.sharingInformation.addressBarLinkSettings,t=e&&e.linkDisabled?(0,a.a)((0,a.a)({},this.props.sharingInformation.directLink),{isAddressBarLink:!0}):this._addressBarLink;return i.createElement("div",{className:"od-PermissionsPivot-linkDetailsView"},i.createElement(c.b,(0,a.a)({},this.props,{companyName:this.props.companyName,link:this.state.showAddressBarLinkDetails?t:this.state.selectedLink,clientId:this.props.clientId,mode:v.a.manageAccess,sharingInformation:this.state.sharingInformation,enableLinkSettings:!0,showMoreOptions:!0,showPermissionsList:this._returnToPreviousView,engagementExtraData:this._engagementExtraData,linkDetailsView:!0,onRemoveLink:this._removeLink,linkRecipients:!this.state.showAddressBarLinkDetails&&(0,W.A)(this.state.selectedLink),inlineInDialog:!this.props.store.isConsumer(),hideConsumerExpiredLinkIcons:!0,spacing:c.a.standard,addressBarLinkSettings:this.state.showAddressBarLinkDetails&&e,isAddressBarLink:this.state.showAddressBarLinkDetails})))},t.prototype._populateDropdownOptions=function(){return[{key:0,text:this._customPivotHeaderString(this._navHeaderItems.get(ge.c.People),this.state.peopleCount)},{key:1,text:this._customPivotHeaderString(this._navHeaderItems.get(ge.c.Groups),this.state.groupsCount)},{key:2,text:this._customPivotHeaderString(this._navHeaderItems.get(ge.c.Links),this.state.linksCount)}]},t.prototype._renderInnerCellContent=function(e){return i.createElement(ne.a,{key:e.role,principal:e,userRole:this.state.sharingInformation.userRole,clientId:this.props.clientId,mode:v.a.manageAccess,sharingInformation:this.state.sharingInformation,showViewOnly:!0,roleVerbose:!0,engagementExtraData:this._engagementExtraData,useCompact:!0,allowFocus:!1,useAccessMap:!0,showUnknownUsers:!0,pageContext:this.props.pageContext,isSPO:this._isSPO,isEnterprise:this._isEnterprise,accessChecked:e.type!==y.a.user||this.state.accessChecked,interactionAriaLabel:o.fb})},t.prototype._getItemFocusStyle=function(e){var t=(0,w.E)(),n=t.palette,a=ve.k()&&!ve.l()?this._viewOnly||-1!==e.loginName.indexOf(this.props.sharingInformation.allOrganizationSecurityGroupId):this._viewOnly;return(0,w.I)({itemCell:[(0,w.w)(t,{inset:-1}),e.role!==g.a.owner?{selectors:{"&:hover":{background:!a&&n.neutralLighter,cursor:a?"default":"pointer"},"&:active":{background:!this._viewOnly&&n.neutralLight}}}:void 0,{selectors:{"&:focus":{border:"1px solid ".concat(n.neutralLight)}}}]})},t.prototype._renderMainHeader=function(){return i.createElement("div",{className:"od-PermissionsPivot-header"},i.createElement(Q.a,{mainHeaderText:o.V,renderBackButton:this._hasBackButton,onBackButtonClicked:this.props.backButtonClicked,actions:this._getHeaderActions(),className:"Header-odc"}))},t.prototype._renderHeader=function(){var e;return e=this.props.store.isConsumer()||0!==this.state.stopSharingState?i.createElement(i.Fragment,null,this._renderSharingHeaderButtons(),this._renderCompanyWideBanner(),this._renderViewOnlyBanner()):i.createElement("div",{className:"od-PermissionsPivot-DefaultView-spinner"},i.createElement(ue.a,null)),i.createElement(i.Fragment,null,this._renderMainHeader(),this._renderStopSharing(),this._renderFileNameAndIcon(),e)},t.prototype._getHeaderActions=function(){var e=this,t={items:[{key:"advancedSettings",text:o.c,ariaLabel:o.c,onClick:this._onAdvancedSettingsClick}],styles:{list:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"0.875rem"},".ms-ContextualMenu-link":{height:"2.25rem",lineHeight:"2.25rem"}}}},directionalHint:H.a.bottomRightEdge};return i.createElement(i.Fragment,null,this._isEnterprise&&i.createElement(Y.a,{menuIconProps:{iconName:"AddFriend"},ariaLabel:o.E,tooltipContent:o.E,directionalHint:H.a.bottomAutoEdge,onClick:this.props.grantAccessClicked}),this._isEnterprise&&this.props.advancedUrl&&!q.f(this.props.clientId)&&!q.o(this.props.clientId)&&i.createElement(Y.a,{menuIconProps:{iconName:"More"},ariaLabel:o.Y,menuProps:t,tooltipContent:o.Y,directionalHint:H.a.bottomAutoEdge}),this.props.showCloseButton&&i.createElement(Y.a,{menuIconProps:{iconName:"Clear"},ariaLabel:o.l,tooltipContent:o.l,directionalHint:H.a.bottomAutoEdge,onClick:function(t){t.stopPropagation(),t.preventDefault(),e.props.onDismiss()}}))},t.prototype._renderCompanyWideBanner=function(){if(ve.k()&&!ve.l()&&!this._isConsumer&&this.props.store.isCOB&&!this.props.store.isCOB()){var e=(0,W.Y)(this.props.sharingInformation),t=!(!this.props.store.getAllOrgSG||!this.props.store.getAllOrgSG()),n=!(!this.props.store.getEEEU||!this.props.store.getEEEU()),a=this.props.store.doesSPGroupContainAllOrgSGOrEEEU&&this.props.store.doesSPGroupContainAllOrgSGOrEEEU();return e&&i.createElement(i.Suspense,{fallback:i.createElement(i.Fragment,null)},i.createElement(Oe.a,{companyName:this.props.companyName,doesAllOrgSGHaveAccess:t,doesEEEUHaveAccess:n,doesSPGroupContainAllOrgSGOrEEEU:a,grantAccessToAllOrgSG:this._grantAccessToAllOrgSG,removeAccessToAllOrgSGAndEEEU:this._removeAccessToAllOrgSGAndEEEU}))}},t.prototype._renderSensitivityLabel=function(){if(this.props.sensitivityLabelInformation){var e="",t=this.props.sharingItemInformation;if(t){var n=t.childCount>1?" (".concat(j.j(o.D,t.childCount),")"):"";e=(0,W.$)("".concat(t.name," ").concat(n))}return i.createElement(Ie,{sensitivityLabelInformation:this.props.sensitivityLabelInformation,engagementExtraData:this.props.engagementExtraData,getGraphToken:this.props.getGraphToken,filename:e.split(" ").join("")})}},t.prototype._renderResultsCount=function(){return i.createElement("div",{className:"od-PermissionPivot-resultsCount"},j.j(o.db,this.state.usersToShow.length,this.state.userPrincipals.length))},t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this.props.onDismiss(),e.stopPropagation()},t.prototype._sanitizeOverrideViewState=function(e){return e>=0&&e<=Ae.mainLinks?e:Ae.mainPeople},t.prototype._parseNavigationHeadersForTelem=function(e){var t=e.split(" • ");return t[1]||(t[1]="0"),t},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.contextTypes={shareClickTime:r.number,platformDetection:r.object.isRequired,sharingStore:r.object.isRequired,sharingClientMessenger:r.object.isRequired,resize:r.func.isRequired,onDismiss:r.func.isRequired},t}(i.Component),Pe=Me}
,function(e,t,n){n.r(t),n.d(t,{AddPeople:function(){return N},AddPeopleView:function(){return s},default:function(){return B}});var a=n(0),i=n(4);(0,i.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@keyframes bounce{0%{transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;animation-timing-function:ease-out}100%{transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;animation-timing-function:ease-in}}.od-AddPeople{overflow:hidden auto}.od-AddPeople.blocker{position:relative}.od-AddPeople.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-AddPeople.wide{min-width:480px}@media (max-width:480px){.od-AddPeople.wide{min-width:320px}}.od-AddPeople .od-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;height:2.5rem;width:100%}@supports (font:-apple-system-body){.od-AddPeople .od-Share-PeoplePicker .ms-BasePicker-input{font:-apple-system-body}}.od-AddPeople-SimplifiedHeader{align-self:self-end}.od-AddPeople-Success{display:flex;flex-flow:column nowrap;align-items:center;padding:24px}.od-AddPeople-Success .od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;transform:translateX(-50%) scale(.5,.5);transform-origin:50% 50%;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.3125rem;border-radius:50%;width:2.75rem;height:2.75rem;animation:bounce .45s;animation-fill-mode:both;display:flex;align-items:center;justify-content:center;margin-left:2.75rem;background-color:"},{theme:"shareSuccessIcon",defaultValue:"#498205"},{rawString:"}.od-AddPeople-Success .od-AddPeople-SuccessMessage{font-weight:500;font-size:1.25rem}.od-AddPeople-Failure{padding:24px 16px 0 16px;font-size:.875rem}.od-AddPeople-NotAllowed{padding:0 16px;font-size:.875rem}.od-AddPeople-NotAllowed button{font-size:.875rem;height:2rem}.od-AddPeople-center{text-align:center;width:100%;align-items:center;display:flex;flex-direction:column;padding-top:6px!important}"}]);var r=n(31),o=n(1);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AddPeople-Edit-Header{padding:24px;display:flex;width:inherit;align-items:center;margin:0}.od-AddPeople-Header{padding:16px 16px 0 16px}.od-AddPeople-Edit-Header-relative{position:relative;padding:24px;display:flex;width:inherit;align-items:center;margin:0}.od-AddPeople-Edit-Section{margin:0;padding:0 24px 24px 24px;display:flex;flex-flow:column nowrap}.od-AddPeople-Edit-Section .od-AddPeople-Edit-Section-PermissionAlert{margin-bottom:8px}.od-AddPeople-Edit-Section .ms-TextField-wrapper{margin:6px 0}.od-AddPeople-Message{margin-top:12px}.od-AddPeople-Message div{border-color:transparent}.od-AddPeople-Message textarea{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding:0}@supports (font:-apple-system-body){.od-AddPeople-Message textarea:-ms-input-placeholder{font:-apple-system-body}.od-AddPeople-Message textarea::placeholder{font:-apple-system-body}}.od-PeoplePicker-RoleSelector-wrapper{display:flex;align-items:flex-start}.od-AddPeople-NotificationSelector{align-self:flex-start;margin-top:12px;margin-bottom:12px}.od-AddPeople-NotificationSelector .fui-Checkbox__indicator{margin:unset}[dir=ltr] .od-AddPeople-NotificationSelector .fui-Checkbox__indicator{margin-right:4px}[dir=rtl] .od-AddPeople-NotificationSelector .fui-Checkbox__indicator{margin-left:4px}.od-AddPeople-NotificationSelector .fui-Checkbox__label{padding:0}[dir=ltr] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-left:4px}[dir=rtl] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-right:4px}@supports (font:-apple-system-body){.od-AddPeople-NotificationSelector .ms-Checkbox-text{font:-apple-system-body}}[dir=ltr] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-right:4px}[dir=rtl] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-left:4px}.od-AddPeople-AddButton{align-self:flex-start;font-size:.875rem;height:2rem;padding:0 1rem}@supports (font:-apple-system-body){.od-AddPeople-AddButton{font:-apple-system-body;height:auto;padding:8px}}"}]);var s,c=n(57),d=n(39),l=n(11),u=n(133),f=n(245),p=n(249),m=n(73),_=n(115),h=n(99),b=n(32),g=n(235),v=n(12),y=n(242),S=n(61),D=n(132),I=n(17),x=n(373),C=n(86),O=n(5),w=n(2),E=n(7),A=n(20),L=n(51),k=n(44),M=n(70),P=n(71),T=function(e){function t(t,n){var i,r=e.call(this,t)||this;r._peoplePickerHasUnresolvedText=!1,r._topLevelDivRef=o.createRef(),r._onPeoplePickerChange=function(e){r.setState(function(t,n){var i=m.h({selectedItems:e,sharingLinkKind:d.a.direct,canAddExternalPrincipal:n.sharingInformation.canAddExternalPrincipal,sharingInformation:n.sharingInformation,viewPolicyTipCallback:function(){return null}}),o=r.state.notifyRecipients||e.filter(function(e){return e.isExternal}).length>0;return(0,a.a)((0,a.a)({},t),{people:e,notifyRecipients:o,peoplePickerError:i})})},r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e},r._onMessageChange=function(e,t){r.setState({messageText:t})},r._validateMessage=function(e){var t,n=(0,I.r)(e);return r.setState({messageText:e}),n<=x.a?(t="",r.setState({shareMessageError:!1})):(t=n+"/"+x.a,r.setState({shareMessageError:!0})),t},r._onRoleSelectorChange=function(e){r.setState({roleSelection:e})},r._onAllowEditChange=function(e,t){r.setState({notifyRecipients:t})},r._onAddButtonClick=function(){if(r._peoplePickerHasUnresolvedText)r.setState((0,a.a)((0,a.a)({},r.state),{peoplePickerError:o.createElement("span",null,l.Yj)}));else{var e=r.state.messageText||null;r._store.addPeople(r.state.people,r.state.roleSelection,r.state.notifyRecipients,e),r.props.onLoading&&r.props.onLoading({notifiedRecipients:r.state.notifyRecipients,requestedAccess:r.userRequiresAccessApproval()})}},r._store=n.sharingStore,r._resize=n.resize,r._dismiss=n.onDismiss,r._store.addListener(function(){var e=r._store.getAddPeopleResult();if(null!==e){var t=e===y.a.AccessRequestsQueued||e===y.a.CompletedSuccessfully,n=r.userRequiresAccessApproval();t&&r.props.onSuccess?r.props.onSuccess({notifiedRecipients:r.state.notifyRecipients,requestedAccess:n}):r.props.onFailure&&r.props.onFailure({notifiedRecipients:r.state.notifyRecipients,requestedAccess:n})}}),(i=r.props.sharingInformation.userRole===b.a.owner?b.a.edit:r.props.sharingInformation.userRole)!==b.a.edit||r.props.sharingInformation.sharedObjectType!==M.a.list||r.props.sharingInformation.userRole!==b.a.manageList&&r.props.sharingInformation.userRole!==b.a.owner||(i=b.a.manageList);var s=m.h({selectedItems:r.props.currentSettings.specificPeople,sharingLinkKind:d.a.direct,canAddExternalPrincipal:r.props.sharingInformation.canAddExternalPrincipal,sharingInformation:r.props.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked});return r.state={people:[],messageText:"",roleSelection:i,notifyRecipients:!0,peoplePickerError:s,shareMessageError:!1},r._resizeTracker=new S.a(n.resize),r}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()},t.prototype.render=function(){return o.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople-Edit"},this._renderHeader(),o.createElement("div",{className:"od-AddPeople-Edit-Section"},this.userRequiresAccessApproval()&&this._renderRequestAccessAlert(),this._renderPeoplePicker(),!1,this._renderMessageArea(),this._renderNotificationSelector(),this._renderAddButton()))},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype.isAddButtonEnabled=function(){return this.state.people.length>0&&null===this.state.peoplePickerError&&!1===this.state.shareMessageError},t.prototype.userRequiresAccessApproval=function(){return this.props.sharingInformation.requiresAccessApproval},t.prototype.numberSelectedUnverifiedExternals=function(){return this.state.people.filter(function(e){return(0,m.g)(e)}).length},t.prototype._getRoleSelectorProps=function(e){var t=!1,n=(0,C.a)({clientId:this.props.clientId,sharingStore:this._store,sharingInformation:this.props.sharingInformation,scenarioId:this._store.getScenarioId&&this._store.getScenarioId(),isPreventDownloadAllowed:this._store.isPreventDownloadAllowed&&this._store.isPreventDownloadAllowed(),shareMode:r.a.addPeople});if((0,P.c)()&&this.props.sharingInformation.requiresAccessApproval){t=!0;var a=this._store.getReShareLink(this.props.currentSettings.audience),i=this.props.currentSettings.sharingRole;a&&(i=(0,I.J)(a,this.props.clientId,this.props.sharingInformation)),n=(0,C.b)({role:i})}return{menuPermissionOptions:n,sharingRole:this.state.roleSelection,mode:r.a.addPeople,clientId:this.props.clientId,ariaLabel:l.x,showStopSharing:!1,onRoleChange:this._onRoleSelectorChange,roleSelectorAs:e?p.a:f.a,isGrantAccess:!0,disabled:t}},t.prototype._renderPeoplePicker=function(){var e=this.state.people,t=m.c(e),n=m.d(e,0);return o.createElement("div",{className:"od-Share-PeoplePicker"},o.createElement(u.a,{defaultSelectedItems:this.state.people,error:this.state.peoplePickerError,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t,oversharingGroupsWarning:n,pickerSettings:this.props.sharingInformation.peoplePickerSettings,sharingLinkKind:d.a.direct,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,allowSPGroups:!0,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:null,onInputChange:this._onPeoplePickerInputChange,roleSelectorProps:this._getRoleSelectorProps(!0),renderRoleSelector:!0}))},t.prototype._renderHeader=function(){var e,t=null===(e=this.props.sharingInformation.item)||void 0===e?void 0:e.name,n=(0,I.$)(t,22);return o.createElement("div",{className:"od-AddPeople-Header"},o.createElement(L.a,(0,a.a)({},(0,D.a)(this.props),{actions:this._getHeaderActions(),mainHeaderText:this._getHeaderText(n),fullHeaderText:this._getHeaderText(t),renderBackButton:this.props.mode!==r.a.addPeople&&this.props.centeredManageAccessEnabled,onBackButtonClicked:this.props.backButtonClicked})))},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:A.p(this.props.clientId))&&o.createElement(k.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:l.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a._dismiss()},tooltipContent:l.Vb,directionalHint:O.a.bottomAutoEdge})},t.prototype._getHeaderText=function(e){return(0,E.j)(l.Ud,e)},t.prototype._renderMessageArea=function(){if(this.state.notifyRecipients)return o.createElement(h.a,{borderless:!0,className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:l.we,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,styles:{field:{fontSize:".875rem",lineHeight:" 1.0625rem",selectors:{"::placeholder":{fontSize:".875rem"}},borderColor:"transparent",border:"none"}}})},t.prototype._renderNotificationSelector=function(){var e=this.numberSelectedUnverifiedExternals()>0;return o.createElement(g.a,{className:"od-AddPeople-NotificationSelector",disabled:e,label:l.Sf,onChange:this._onAllowEditChange,checked:this.state.notifyRecipients,styles:{text:{fontSize:"0.875rem",lineHeight:"1.25rem"},checkbox:{width:"1.25rem",height:"1.25rem"},checkmark:{fontSize:"0.875rem"}}})},t.prototype._renderAddButton=function(){var e=l.u,t=(0,w.E)();return o.createElement(c.a,{disabled:!this.isAddButtonEnabled(),onClick:this._onAddButtonClick,className:"od-AddPeople-AddButton",styles:{labelDisabled:t.semanticColors.primaryButtonTextDisabled}},e)},t.prototype._renderRequestAccessAlert=function(){return o.createElement(_.a,{className:"od-AddPeople-Edit-Section-PermissionAlert"},l.Wh)},t.contextTypes={sharingStore:v.object.isRequired,resize:v.func.isRequired,onDismiss:v.func.isRequired},t}(o.Component),U=n(120),F=n(10),H=n(55),R=n(114);!function(e){e[e.edit=0]="edit",e[e.successGrantingPermissions=1]="successGrantingPermissions",e[e.successRequestingPermissions=2]="successRequestingPermissions",e[e.failure=3]="failure",e[e.notAllowed=4]="notAllowed"}(s||(s={}));var N=function(e){function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=o.createRef(),i._onLoading=function(e){i.setState(function(t,n){var i;return t.view===s.edit?(i=e.requestedAccess?l.t:e.notifiedRecipients?l.n:l.o,(0,a.a)((0,a.a)({},t),{loading:!0,message:i})):t})},i._onSuccess=function(e){var t,n;e.requestedAccess?(t=l.j,n=s.successRequestingPermissions):(t=e.notifiedRecipients?l.y:l.z,n=s.successGrantingPermissions),i.setState({view:n,message:t,loading:!1}),i._store.getEngagementHelper().log(R.d.Completed,{accessRequested:e.requestedAccess}),i._sharingClientMessenger?i._sharingClientMessenger.sendShareAddPeopleCompleted(!0,t):H.a(!0,t)},i._onFailure=function(e){var t=l.v;i.setState({view:s.failure,message:t,loading:!1}),i._sharingClientMessenger?i._sharingClientMessenger.sendShareAddPeopleCompleted(!1,t):H.a(!1,t)},i._store=n.sharingStore,i._shareClickTime=n.shareClickTime,i._resize=n.resize,i._dismiss=n.onDismiss,i._sharingClientMessenger=n.sharingClientMessenger;var r=!1===t.sharingInformation.canAddExternalPrincipal&&!1===t.sharingInformation.canAddInternalPrincipal&&!1===t.sharingInformation.canRequestAccessForGrantAccess;return i.state={message:"",view:r?s.notAllowed:s.edit,loading:!1},i._resizeTracker=new S.a(n.resize),i}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():H.r(this._shareClickTime,this.props.clientId,r.a.addPeople,this.props.scenarioId,this.props.correlationId),this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()},t.prototype.render=function(){return o.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople ".concat(this.state.loading?" blocker":""),style:{maxHeight:this.props.maxHeight}},this.renderView(),this.state.loading?o.createElement(U.a,{message:this.state.message}):null)},t.prototype.renderView=function(){switch(this.state.view){case s.edit:return o.createElement(T,(0,a.a)({},(0,D.a)(this.props),{centeredManageAccessEnabled:this.props.centeredManageAccessEnabled,backButtonClicked:this.props.backButtonClicked,sharingInformation:this.props.sharingInformation,onLoading:this._onLoading,onSuccess:this._onSuccess,onFailure:this._onFailure,currentSettings:this.props.currentSettings,onViewPolicyTipClicked:this.props.onViewPolicyTipClicked,onManageExistingAccessClick:this.props.onManageExistingAccessClick,mode:this.props.mode}));case s.successGrantingPermissions:return this._renderSuccessGranting();case s.successRequestingPermissions:return this._renderSuccessRequesting();case s.failure:return this._renderFailure();case s.notAllowed:return this._renderNotAllowed()}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._renderSuccessGranting=function(){return o.createElement("div",{className:"od-AddPeople-Success"},this._renderHeader(),o.createElement("div",{className:"od-AddPeople-center"},o.createElement("div",{className:"od-ShareNotification-icon"},o.createElement(F.a,{iconName:"CheckMark",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}})),o.createElement("h1",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message)),o.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))},t.prototype._getHeaderActions=function(){var e,t;return(null!==(t=null===(e=this.props.hostOptions)||void 0===e?void 0:e.showCloseButton)&&void 0!==t?t:A.p(this.props.clientId))&&o.createElement(k.a,{menuIconProps:{iconName:"Clear"},ariaLabel:l.Vb,tooltipContent:l.Vb,directionalHint:O.a.bottomAutoEdge,onClick:this._dismiss})},t.prototype._renderHeader=function(){return o.createElement("div",{className:"od-AddPeople-SimplifiedHeader"},o.createElement(L.a,{actions:this._getHeaderActions(),mainHeaderText:""}))},t.prototype._renderSuccessRequesting=function(){return o.createElement("div",{className:"od-AddPeople-Success"},this._renderHeader(),o.createElement(F.a,{className:"od-ShareNotification-icon",iconName:"PeopleAlert"}),o.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),o.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))},t.prototype._renderFailure=function(){return o.createElement("div",{className:"od-AddPeople-Failure"},this._renderHeader(),o.createElement("p",null,this.state.message))},t.prototype._renderNotAllowedHeader=function(){return o.createElement(L.a,{actions:this._getHeaderActions(),mainHeaderText:l.We})},t.prototype._renderNotAllowed=function(){var e=this;return o.createElement(o.Fragment,null,this._renderNotAllowedHeader(),o.createElement("div",{className:"od-AddPeople-NotAllowed"},o.createElement("p",null,l.Ge),o.createElement("p",null,l.Ke),o.createElement(c.a,{autoFocus:!0,onClick:function(){e._dismiss()}},l.Ef)))},t.contextTypes={sharingStore:v.object.isRequired,shareClickTime:v.number,resize:v.func.isRequired,onDismiss:v.func.isRequired,sharingClientMessenger:v.object.isRequired},t}(o.Component),B=N}
,function(e,t,n){n.r(t),n.d(t,{AriaTelemetryHandler:function(){return s.a},getCustomerPromiseContext:function(){return d},getCustomerPromiseHandler:function(){return l}});var a=n(0),i=n(392),r=n(393),o=n(41),s=n(208),c=(0,i.a)()((0,r.a)()(s.a));function d(e){var t=e.clientName,n=e.ariaContext,a=e.ariaEnvironment;return{UserId:n.userId,Product:"Files",Manifest:n.manifest,Version:n.version,ClientName:t,FarmName:"NA",FarmLabel:"NA",AccountType:o.a[n.accountType],CustomerRing:a,TenantID:"NA",ServerGU:"NA",SessionId:n.session}}function l(e){e.clientName,e.ariaContext,e.ariaEnvironment;var t=(0,a.f)(e,["clientName","ariaContext","ariaEnvironment"]),n=d(e);return new c((0,a.a)({contextProvided:n},t))}}
,,,,,,function(e,t,n){function a(e){return!!e&&"function"==typeof e.addEventListener}function i(e){return!!e&&!!e.__events__}function r(e,t){var n=e,a=n.__declaredEvents=n.__declaredEvents||{};if("string"==typeof t)a[t]=!0;else for(var i=0;i<t.length;i++)a[t[i]]=!0}function o(e,t,n,r){var o,s=e;if(a(s)){if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(t,r,!0),c.args=n,o=s.dispatchEvent(c)}}else for(;s&&!1!==o;)if(i(s)){var d=s.__events__[t];for(var l in d)if(Object.prototype.hasOwnProperty.call(d,l))for(var u=d[l],f=0;!1!==o&&f<u.length;f++){var p=u[f];p.objectCallback&&(o=p.objectCallback.call(p.parent,n))}s=r?s.parent:null}else s=null;return o}n.d(t,{a:function(){return r},b:function(){return a},c:function(){return o}})}
,function(e,t,n){var a=n(54),i=function(){function e(){}return e.prototype.debounce=function(e){var t=this;this.clear(),this._originalPromise=e;var n=new a.a(function(){return t._originalPromise.cancel()});return this._originalPromise.done(function(e){t._clear(!1),n.complete(e)},function(e){t._clear(!1),n.error(e)}),n.getPromise()},e.prototype.clear=function(){this._clear(!0)},e.prototype.isExecuting=function(){return Boolean(this._originalPromise)},e.prototype._clear=function(e){this.isExecuting()&&(e&&this._originalPromise.cancel(),this._originalPromise=null)},e}();t.a=i}
,function(e,t,n){function a(e,t){var n,a,i=!!e.Fallback,r=e.ODB;if("boolean"==typeof r)i=r;else if(r>0){if(r>=6e4){var o=r-6e4+2e3+1;n=Math.floor(o/32),a=1<<o%32}else{if(!(r<=2e3))return!1;n=Math.floor(r/32),a=1<<r%32}i=n<t.length&&0!=(t[n]&a)}return i}function i(e,t){var n,a,i=!!e.Fallback,r=e.ODBECS;return"string"==typeof r&&null!==(a=null===(n=null==t?void 0:t.ClientFeatures)||void 0===n?void 0:n.has(r))&&void 0!==a&&a&&(i=!0),i}n.d(t,{a:function(){return i},b:function(){return a}})}
,,function(e,t,n){function a(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return s}});var a=n(286),i=n(162),r=n(14),o=n(321);function s(e){return function(e){return void 0!==e.getModule}(e)?c({path:e.path,getModule:e.getModule,getExport:o.a}):c({path:e.path,require:e.require,getExport:o.a})}function c(e){var t=e.path,n=e.getExport;return r.c.resolve(function(e){return void 0!==e.getModule}(e)?d(e.getModule,t):function(e,t){return d(function(){return new r.c(function(n,a){e([t],n,a)})},t)}(e.require,t)).then(n)}function d(e,t){return i.a.mark("Module_".concat(t),20),e().then(function(e){return e},function(e){return r.c.isCanceled(e)||a.a.log(e),r.c.reject(e)})}}
,function(e,t,n){function a(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i}});var a=n(319);function i(e,t,n){return void 0===n&&(n=a.a),!r(e,t,{comparer:n})}function r(e,t,n){var i;void 0===n&&(n={});var r=n.comparer,o=void 0===r?a.a:r,s=n.debug,c=void 0!==s&&s;if((0,a.a)(e,t))return!1;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!c||{previous:e,next:t};var d=Object.keys(e),l=Object.keys(t);if(d.length!==l.length)return!c||{__keys:{previous:d,next:l}};for(var u=0,f=d;u<f.length;u++){var p=f[u];if(!(p in t)||!o(e[p],t[p],p))return!c||((i={})[p]={previous:e[p],next:t[p]},i)}return!1}}
,function(e,t,n){var a=n(59),i=n(90),r={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},o={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},s=function(){function e(e,t){this._scope=new i.a,this._events=new(this._scope.attached(a.a))(this),this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n},this._windowWidth=0,this._windowHeight=0,this._onContainerResize()}return e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}},e.determineWindowSize=function(e,t){if(void 0===t&&(t=o),0===e)return"Medium";for(var n in o)if(e<t[n])return n},e.determineCssClass=function(e){return r[e]},e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden",n.width="100px",n.msOverflowStyle="scrollbar",n.overflow="scroll",t.style.width="100%",document.body.appendChild(e),e.appendChild(t);var a=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var r=a-i;return this.getScrollbarWidth=function(){return r},r},Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._scope.dispose()},e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]},e.prototype._afterContainerResize=function(){},e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,a=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,r=this._formFactorSize=e.determineWindowSize(a,this._breakpoints());this._cssClass=e.determineCssClass(r);var s=this._isHamburgerVisible;this._isHamburgerVisible=a<o.Large;var c=this._showLabels;this._showLabels=this.compareSize(r,"Medium")>0,i&&r!==i&&this._events.raise("formFactorChange"),"boolean"==typeof s&&s!==this._isHamburgerVisible&&this._events.raise("hamburgerVisibilityChange"),"boolean"==typeof c&&c!==this._showLabels&&this._events.raise("showCommandLabelsChange"),this._afterContainerResize()},e.DEFAULT_BREAKPOINTS=o,e.MAC_SCROLL_BAR_WIDTH=8,e}();t.a=s}
,,function(e,t,n){n.d(t,{a:function(){return _e}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:active){.od-Share.not-IE{border:3px solid}}.od-Share{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';border-radius:2px;min-height:130px}.od-Share.od-SimplifiedShare{border-radius:8px;min-height:inherit}.od-Share.animation{transition:height .2s cubic-bezier(.33, 0, .1, 1)}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Share.od-Share--permissionsPivot{overflow:unset!important}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:focus,.od-Share a:hover{color:"},{theme:"linkHovered",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:'}.od-Share .od-Share-noFocusBorder:focus{outline:0;border:none}.od-Share .ms-Button--default{outline:transparent;position:relative}.od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button--default:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b;color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c;color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939;color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e,.06)}.od-Share .icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e;color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.od-Share .ms-Tooltip{pointer-events:none}.od-Share .ms-Spinner{position:absolute;top:50%;left:50%}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share .ms-Button{overflow:visible}}#od-Share-backButton-tooltip{position:relative}button.od-Share-backButton{z-index:1;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:relative;left:inherit}button.od-Share-backButton#od-ShareToTeams-backButton{top:-40px}[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}button.od-Share-backButton.absolute{position:absolute;top:8px}[dir=ltr] button.od-Share-backButton.absolute{left:8px}[dir=rtl] button.od-Share-backButton.absolute{right:8px}button.od-Share-backButton.priorView{top:14px}[dir=ltr] button.od-Share-backButton.priorView{left:16px}[dir=rtl] button.od-Share-backButton.priorView{right:16px}.od-Share-shareMainDiv{position:relative;overflow:hidden auto}.od-Share-spinnerHolder{align-items:center;display:flex;height:130px;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--default,.teams .ms-Button.ms-Button--primary{border-radius:3px;min-width:96px}.teams .ms-Button--default{border:1px solid rgba(37,36,36,.15)}.teams .ms-Button--primary.is-disabled{border:none}.SendLink-statusIconItem{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .SendLink-statusIconItem{margin-left:4px}[dir=rtl] .SendLink-statusIconItem{margin-right:4px}[dir=ltr] .SendLink-statusIconItem{margin-right:4px}[dir=rtl] .SendLink-statusIconItem{margin-left:4px}.SendLink-statusIconItem .ms-Icon{background-color:transparent;position:relative}.SendLink-statusIconItem .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.SendLink-statusIconTooltip{font-size:.875rem}.SendLink-statusIcon{font-size:.625rem;width:2.75px;height:2.75px}.blockDownloadSVG{width:1.125rem;height:1.125rem}"}]);var i=n(31),r=n(95),o=n(303),s=n(207),c=n(218),d=n(132),l=n(11),u=n(42),f=n(80),p=n(1),m=n(55),_=n(12),h=n(365),b=function(e){function t(t,n){var a=e.call(this,t)||this;return a._initialLinkShown=!1,a._onLinkSettingsCancelClick=function(){a.setState({shouldCopyLinkToClipboard:!1},function(){a.props.onLinkPermissionsCancelClicked()})},a._onLinkSettingsApplyClicked=function(e){a.setState({shouldCopyLinkToClipboard:!0},function(){a.props.onLinkPermissionsApplyClicked(e)})},a._onCopyButtonClicked=function(e){a.setState({shouldCopyLinkToClipboard:!0},function(){a.props.onLinkPermissionsApplyClicked(e,!0)})},a._shareClickTime=n.shareClickTime,a.state={shouldCopyLinkToClipboard:!0},a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.sharingInformation,n={clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClick,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig};switch(this.props.viewState){case c.a.linkSuccess:case c.a.copyLinkShortcut:return this._initialLinkShown||(m.r(this._shareClickTime,this.props.clientId,i.a.copy,this.props.scenarioId,this.props.correlationId),this._initialLinkShown=!0),this.props.viewState==c.a.linkSuccess?p.createElement(s.ShareNotification,(0,a.a)({},(0,d.a)(this.props),{shareType:r.a.copy,itemName:t.item.name,linkUrl:e.displayUrl,sharingHintProps:n,engagementExtraData:this.props.engagementExtraData,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})):p.createElement(h.a,{singleComponent:!0,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyButtonClicked.bind(this,this.props.currentSettings)});case c.a.modifyPermissions:return p.createElement(o.ModifyPermissions,(0,a.a)({},(0,d.a)(this.props),{shareId:e.shareId,mode:e.mode,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onShowPermissionsListClicked:this.props.onShowPermissionsListClicked,onSelectedPeopleChange:function(){},renderBackButton:!0}));default:return p.createElement("div",{className:"od-Share-spinnerHolder"},p.createElement(u.a,{className:"od-Share-spinner",label:l.Gb,type:f.b.large}))}},t.contextTypes={shareClickTime:_.number},t}(p.Component),g=n(32),v=n(39),y=n(29),S=n(69),D=n(164),I=n(93),x=n(550),C=n(306),O=n(307),w=n(373),E=n(305),A=n(73),L=n(110),k=n(20),M=n(347),P=n(120),T=n(27),U=n(302),F=n(299),H=n(17),R=n(47),N=n(86),B=n(59),j=n(308),V=n(203),z=n(2),G=n(5),K=n(108),W=n(88),q=n(66),Q=n(364),Y=n(16),J=n(114),X=n(24),Z=n(219),$=n(71),ee=n(61),te=n(83),ne=n(510),ae=n(242),ie=n(70),re=n(105),oe=n(18),se=n(331),ce=n(221),de=n(304),le=n(112),ue=n(217),fe=n(87),pe=n(94),me=n(329),_e=function(e){function t(t,n){var o,s=e.call(this,t)||this;s._viewStates=[],s._shareMainControl=(0,p.createRef)(),s._onPermissionsDefaultShare=function(e){s._lastPermissionsSubView=e,s._showShare()},s._topLevelDivRef=p.createRef(),s._copyLinkOnCancelClicked=function(){s._returnToPreviousView()},s._copyLinkOnApplyClicked=function(e,t){var n={currentSettings:e,linkRecipients:e.specificPeople,viewState:s.state.viewState};X.g()&&t&&(n.viewState=c.a.spinner),s.setState(n,function(){s._store.getEngagementHelper().linkSettingsApplyClicked(s._engagementExtraData),s._onCopyLinkClicked(!0)})},s._closeButtonOnBlur=function(){s.setState({isCloseButtonOnFocus:!1})},s._closeButtonOnFocus=function(){s.setState({isCloseButtonOnFocus:!0})},s._onRoleChange=function(e){var t=(0,H.Q)(e),n=e===g.a.view,i=e===g.a.review,r=e==g.a.manageList;if(!(t||n||i||r))throw new Error("Role not implemented: "+g.a[e]);var o=s.state.currentSettings,c=i||r?v.a.flexible:(0,H.y)(o.audience,t);o.sharingRole!==e&&s._store.getEngagementHelper().log("SharingRoleChanged",{isEdit:t,isReview:i}),s.setState((0,a.a)((0,a.a)({},s.state),{currentSettings:(0,a.a)((0,a.a)({},o),{sharingRole:e,isEdit:t,isReview:i,sharingLinkKind:c})}))},s._onShareTargetClicked=function(e,t){var n;switch(m.y(e),e){case r.a.outlook:n="outlookClicked";break;case r.a.webShareToTeams:n="webShareToTeamsClicked";break;case r.a.mobileShareToTeams:n="mobileShareToTeamsClicked";break;case r.a.nonOutlook:n="nonOutlookClicked";break;case r.a.copy:n="copyButtonClicked";break;case r.a.moreApps:n="moreAppsClicked"}var i=new re.a({scenario:(0,Z.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}}),o=(0,me.a)(s.props.clientId);if(o){var c=new re.a({scenario:"".concat(o,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}});s._shareLinkCustomerPromise=[i,c]}else s._shareLinkCustomerPromise=[i];if(s._store.getEngagementHelper().log("ShareV3.shareTargetClicked",(0,a.a)((0,a.a)({},s._engagementExtraData),{shareType:e})),e!==r.a.share)return e===r.a.copy?(m.b(),void s._onCopyLinkClicked(t)):void(e!==r.a.webShareToTeams?s.setState({shareType:e,shareTargetClicked:!0},function(){s._store.shareLink({settings:s.state.currentSettings,recipients:s.state.linkRecipients,copyLinkCommand:!1,shareType:e})}):s._onRedirectTeamsClicked())},s._onLinkPermissionsApplyClicked=function(e){if(s._store.getEngagementHelper().linkSettingsApplyClicked(s._engagementExtraData),s._onSelectedPermissionsChange(e),s.props.mode===i.a.linkSettings){var t=new re.a({scenario:(0,Z.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}}),n=(0,me.a)(s.props.clientId);if(n){var a=new re.a({scenario:"".concat(n,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}});s._shareLinkCustomerPromise=[t,a]}else s._shareLinkCustomerPromise=[t];s.setState({shareType:r.a.share,applyLinkSettingsClicked:!0},function(){var e=s.state.linkRecipients;if(k.l(s.props.clientId)){var t=s.state.currentSettings.sharingLinkKind;t!==v.a.organizationEdit&&t!==v.a.organizationView||(e=e.filter(function(e){return!e.isExternal}))}s._store.shareLink({settings:s.state.currentSettings,recipients:e,copyLinkCommand:!1})})}},s._onLinkPermissionsCancelClicked=function(){s.props.mode===i.a.linkSettings&&m.e(),s._returnToPreviousView()},s._returnToPreviousView=function(){s._viewStates&&s._viewStates.length&&(s.setState({viewState:s._viewStates.pop(),showTeamsDialog:!1},function(){var e,t;null===(t=null===(e=s._shareMainControl)||void 0===e?void 0:e.current)||void 0===t||t.shouldShowActivityIndicator(!1)}),s.state.viewState===c.a.modifyPermissions&&s._store.getEngagementHelper().linkSettingsCancelClicked(s._engagementExtraData))},s._hideElementsInManageAccess=function(e){s.props.hideElementsInManageAccess&&s.props.hideElementsInManageAccess(e)},s._onSelectedPeopleChange=function(e){var t=s.state.permissionsMap;s.state.currentSettings.audience===y.a.existing&&s._store.checkPermissions(e),s._store.resetPeoplePickerError(),s.setState({linkRecipients:e,permissionsMap:t},function(){s._store.fetchGroupsMemberCount(e)})},s._onSendLinkClicked=function(e,t){var n=s.state.linkRecipients,a=new re.a({scenario:(0,Z.a)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}}),i=(0,me.a)(s.props.clientId);if(i){var o=new re.a({scenario:"".concat(i,"-ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}});s._shareLinkCustomerPromise=[a,o]}else s._shareLinkCustomerPromise=[a];s.setState({shareType:r.a.share,recipientsCount:n.length,externalRecipientsCount:A.a(n),linkedinRecipientsCount:A.b(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0},function(){m.v(),s._store.shareLink({settings:s.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})},s._onViewPolicyTipClicked=function(){s._viewStates.push(s.state.viewState),s.setState({viewState:c.a.policyDetails})},s._onSendLinkMessageChange=function(e){s.setState({messageText:e})},s._onSendLinkSubjectChange=function(e){s.setState({subjectText:e})},s._onInterruptUseNew=function(){s._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(s._engagementExtraData),s.setState({shareType:r.a.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:(0,a.a)((0,a.a)({},s.state.currentSettings),{updatePassword:!0})},function(){s._store.shareLink({settings:s.state.currentSettings,recipients:s.state.linkRecipients,copyLinkCommand:!1})})},s._onInterruptUseExisting=function(){s._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(s._engagementExtraData),s.setState({shareType:r.a.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:(0,a.a)((0,a.a)({},s.state.currentSettings),{updatePassword:!1,password:null})},function(){s._store.shareLink({settings:s.state.currentSettings,recipients:s.state.linkRecipients,copyLinkCommand:!0})})},s._onInterruptCancel=function(){s._store.getEngagementHelper().copyLinkInterruptCancelled(s._engagementExtraData),s.setState({showCopyLinkInterrupt:!1}),s._shareMainControl.current.shouldShowActivityIndicator(!1)},s._enterShareView=function(){s._store.getEngagementHelper().manageAccessLinkSectionShareClicked(s._engagementExtraData),s._viewStates.push(s.state.viewState),s.setState({viewState:c.a.default})},s._enterGrantAccessView=function(){s._store.getEngagementHelper().manageAccessGrantAccessClicked(s._engagementExtraData),s.setState({viewState:c.a.addPeople})},s._enterManageAccessView=function(){s._usePermissionsPivot?s.setState({viewState:c.a.permissionsPivot}):s.setState({viewState:c.a.permissionsList})},s._showShare=function(){s._viewStates.push(s.state.viewState),s.setState({viewState:c.a.default})},s._showModifyPermissions=function(e,t){s._viewStates.push(s.state.viewState),s.setState({viewState:c.a.modifyPermissions,copyLinkShortcut:t},function(){s._store.getEngagementHelper().linkSettingsOpened(s._engagementExtraData,e)})},s._showPermissionsList=function(){s._viewStates.push(s.state.viewState),s._store.getEngagementHelper().manageAccessOpened(s._engagementExtraData);var e=s.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,a=n&&!t;t?m.h():a?n():s.setState({viewState:s._usePermissionsPivot?c.a.permissionsPivot:c.a.permissionsList,showHeaderInManagedAccess:!0})},s._dismiss=n.onDismiss,s._resize=n.resize,s._store=n.sharingStore,s._shareClickTime=n.shareClickTime,s._isPeopleSharingLinksEnabled=!1,s._rumoneLogger=new se.a,s._lastPermissionsSubView;var l=(0,H._)(s.props.clientId,s._store)||(0,H.Z)(s.props.clientId,s._store);s._usePermissionsPivot=s._store.isConsumer()||l;var u=m.i()||(null===(o=s.props.hostOptions)||void 0===o?void 0:o.isDarkMode),f=t.theme;f||(f=m.f()),(f&&s.props.clientId!==S.a.wac||u)&&s._loadTheme(u?(0,H.o)():f),s._sizeConstraints={maxHeight:k.f(s.props.clientId)?"none":s.props.maxHeight||"none",maxWidth:s.props.maxWidth||"none",overflowY:"auto",overflowX:"hidden"};var _={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:c.a.default,readyToCopy:!1,shareType:r.a.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",summaryText:t.summaryText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:s._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1};_.viewState=t.mode===i.a.share?c.a.shareShimmer:c.a.spinner,s.state=_,s._baseProps=(0,d.a)(t),s._correlationId=s.props.correlationId||te.a.generate(),s._baseProps.correlationId=s._correlationId;var h=(0,fe.a)(location.search.substring(1)),b=h.migratedhosting&&"true"===h.migratedhosting.toLowerCase();return s._engagementExtraData={isSimplifiedShareDialog:!1,isSimplifiedShareDialogV2:!1,clientId:t.clientId,scenarioId:t.scenarioId,correlationId:s._correlationId,hostSessionId:t.hostSessionId||"",mode:t.mode||(t.copyLinkShortcut?i.a.copy:i.a.share),isMigratedhosting:b},s._resizeTracker=new ee.a(n.resize),s}return(0,a.d)(t,e),t.prototype.componentWillUnmount=function(){this._store.removeListeners&&this._store.removeListeners()},t.prototype.componentDidMount=function(){var e=this;try{var t=this._store,n=void 0;try{n=(0,ne.a)((0,ne.c)(t.getAuthToken())),this._engagementExtraData.appId=n}catch(e){}t.getEngagementHelper().log(J.d.Opening,this._engagementExtraData),new B.a(this).on(window,"keydown",function(t){t&&t.keyCode===Y.a.escape&&e._handleEscKeyPress(t)}),t.addListener(this._sharingStoreListener.bind(this));var a=this.props.mode===i.a.manageAccess;if(t.fetchSuiteNavInformation(),t.fetchSharingInformation(!0,a),t.fetchPolicyTipInformation(),this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===i.a.copy&&!this.props.shareId&&k.l(this.props.clientId)&&(this._copyLinkShortcutInvoked=!0,this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0}),this.setState({shareType:r.a.copy,shareTargetClicked:!0})),this._resizeIfNeeded(),this.state.sharingInformation&&(this.state.viewState===c.a.default||this.state.viewState===c.a.linkSuccess||this.state.viewState===c.a.linkSettings&&this.props.mode===i.a.linkSettings)){var o=this.props.mode,s=this.state.viewState;setTimeout(function(){e._writeShareDataToRumoneLogger({mode:o,viewState:s})},0)}this._logSuccessfulShareDialogLoadingCustomerPromise()}catch(e){this._setGenericErrorState(e)}},t.prototype.componentDidUpdate=function(){var e=this;this._resizeIfNeeded();var t=function(){var t=e.props.mode,n=e.state.viewState;setTimeout(function(){e._writeShareDataToRumoneLogger({mode:t,viewState:n})},0)};if(this.state.sharingInformation){if(this.props.mode===i.a.share)if(this.state.viewState!==c.a.default||this.state.shareTargetClicked){if(this.state.viewState===c.a.linkSuccess){var n=this.props.mode,a=this.state.viewState;setTimeout(function(){e._writeCopyLinkTargetDataToRumoneLogger({mode:n,viewState:a,clickTime:e._copyTargetClickTime})})}}else t();else if(this.state.viewState===c.a.shareToTeams){var r="https://teams.microsoft.com/share?href="+this.state.sharingLinkCreated.url+"&referrer=SharePoint.com";this._teamsUrl=r,this.setState({showTeamsDialog:!0})}else(this.props.mode===i.a.copy&&this.state.viewState===c.a.linkSuccess||this.props.mode===i.a.linkSettings&&this.state.viewState===c.a.linkSettings)&&t();this._logSuccessfulShareDialogLoadingCustomerPromise()}},t.prototype.componentDidCatch=function(e,t){this._setGenericErrorState(e)},t.prototype.render=function(){var e,t,n,i,o=this,s=this.props,d=(s.clientId,s.copyLinkShortcut),_=this.state,h=_.sharingInformation,b=_.currentSettings,g=_.showActivityIndicator,S=_.sharingLinkCreated,D="od-Share ".concat(this.props.fullScreenIframeMode?" not-IE":""),I=!1;if(h&&b&&d&&(X.g()||S)&&this.state.viewState!==c.a.error)I=!0,n=this._renderPostCopyShortcutView();else switch(this.state.viewState){case c.a.error:n=this._renderError(h);var x="generic share link failure";m.A(this.state.shareType,this.state.sharingInformation.rawError||x,this.state.sharingInformation.errorCategory,this.state.sharingInformation.errorMessage),null===(e=this._shareLinkCustomerPromise)||void 0===e||e.forEach(function(e){return(0,ue.d)({customerPromise:e,rawErrorMessage:h.rawError||x,engagementExtraData:o._engagementExtraData,errorType:h.rawError?ue.a.api:ue.a.generic,sharingStore:o._store})}),this._shareLinkCustomerPromise=void 0;break;case c.a.default:case c.a.shareToTeams:D+=g?" od-Share--hasActivity":"",I=!0,n=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case c.a.modifyPermissions:I=!0,n=p.createElement(p.Fragment,null,this._renderModifyPermissions(c.a.modifyPermissions),this._renderActivityIndicator());break;case c.a.linkSuccess:null===(t=this._shareLinkCustomerPromise)||void 0===t||t.forEach(function(e){return(0,ue.e)({customerPromise:e,engagementExtraData:o._engagementExtraData,sharingStore:o._store})}),this._shareLinkCustomerPromise=void 0,n=this._renderNotification(),this.state.shareType,r.a.copy;break;case c.a.permissionsList:I=!0,n=this._renderPermissionsList();break;case c.a.permissionsPivot:I=!0,n=this._renderPermissionsPivot();break;case c.a.policyDetails:n=p.createElement(p.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case c.a.atMention:D="",n=this._renderAtMention();break;case c.a.linkSettings:D+=g?" od-Share--hasActivity":"",I=!0,n=p.createElement(p.Fragment,null,this._renderModifyPermissions(c.a.linkSettings));break;case c.a.shareShimmer:D+=" od-Share--hasShimmer",I=!0,n=this._renderShareMainShimmer();break;case c.a.notify:b.sharingLinkKind=v.a.direct,b.audience=y.a.existing,this._engagementExtraData=(0,a.a)((0,a.a)({},this._engagementExtraData),{appMap:h.item.appmap}),D="",n=p.createElement(F.Notify,(0,a.a)({},this._baseProps,{currentSettings:b,sharingInformation:h,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));break;case c.a.addPeople:I=!0,n=this._renderAddPeople();break;case c.a.spinner:n=p.createElement("div",{className:"od-Share-spinnerHolder"},p.createElement(u.a,{className:"od-Share-spinner",label:l.Gb,size:f.a.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))}i=I||D?p.createElement("div",{className:D,style:I?this._sizeConstraints:void 0},n):n;var C=k.l(this.props.clientId)?" teams":"";return p.createElement(M.a,null,p.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:C+" isFluent"},i))},t.prototype._logSuccessfulShareDialogLoadingCustomerPromise=function(){var e;!this.state.sharingInformation||this.props.mode===i.a.manageAccess&&this.props.shareLoadingCustomerPromise&&this._usePermissionsPivot||null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){e&&e.context&&e.context.SharingMode!==i.a.manageAccess&&e.end({resultType:oe.b.Success})})},t.prototype._sharingStoreListener=function(e){var t,n,o,s,d=this,l=this._store;try{if(this.state.viewState===c.a.error)return;if(this.props.mode===i.a.copy&&e&&e.type===ae.b.UnshareLink)return;var u=l.getSharingInformation(),f=l.getSharingLinkCreated(),p=l.getCompanyName(),_=l.getGroupsMemberCount(),h=l.getPolicyTipInformation(),b=l.getPermissionsMap(),v=l.getDefaultRecipients();if(this._outlookAvailability=l.getOutlookAvailability()||(null===(t=this.props.hostOptions)||void 0===t?void 0:t.outlookAvailability),this._isPeopleSharingLinksEnabled=l.isPeopleSharingLinksEnabled(),!u)return;u.webTemplateId&&(this._engagementExtraData.webTemplateId=u.webTemplateId),u.itemUniqueId&&(this._engagementExtraData.itemUniqueId=u.itemUniqueId),u.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),l.fetchSharingInformation(!0,!0));var y=this._store.getItemInformationForLogging(),S=y.itemType,I=y.extension;this._engagementExtraData.itemType=S,this._engagementExtraData.extension=I,this._sanitizeSharingContextInfo(u);var x=this._getSettings(u),C=(0,a.a)({},this.state);if(this.state.viewState!==c.a.shareShimmer&&this.state.viewState!==c.a.spinner||(C.viewState=this._getInitialViewState(u,x,f),C.viewState!==c.a.shareShimmer&&C.viewState!==c.a.spinner&&m.C()),u.error||u.isStubFile)u&&u.error&&(u.errorCategory===D.a.shareLink||u.errorCategory===D.a.shareObject||u.errorCategory===D.a.createLink||u.errorCategory===D.a.invite)?(null===(n=this._shareLinkCustomerPromise)||void 0===n||n.forEach(function(e){return(0,ue.d)({customerPromise:e,rawErrorMessage:u.rawError||u.error,engagementExtraData:d._engagementExtraData,errorType:u.error?ue.a.api:ue.a.generic,sharingStore:d._store})}),this._shareLinkCustomerPromise=void 0):null===(o=this.props.shareLoadingCustomerPromise)||void 0===o||o.forEach(function(e){return(0,ue.d)({customerPromise:e,rawErrorMessage:(null==u?void 0:u.isStubFile)?new Error("Is stub file"):u.rawError||u.error,engagementExtraData:d._engagementExtraData,errorType:ue.a.api,sharingStore:d._store})}),m.q(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,u,this._correlationId),u.errorCategory===D.a.shareLink?C.viewState=c.a.default:C.viewState=c.a.error,X.F()&&A.f(u.error)&&u.errorCategory===D.a.invite&&(C.viewState=this.state.viewState),C.sharingInformation=u;else if((e&&e.type===ae.b.ShareLink||this.props.shareId)&&f&&(this.state.shareTargetClicked||this.props.copyLinkShortcut||this.state.applyLinkSettingsClicked)){this._modifiedSharingLinkUrl=this._getModifiedSharingLinkUrl(f,x,u);var O=this.state.shareType,w=this.state.currentSettings,E=w?w.isEdit:x.isEdit,M=w?w.isReview:x.isReview,P=w?w.preventDownload:x.preventDownload,T=w?w.audience:x.audience,U=N.j(T,u.sharingAbilities,u.fileExtension),F=N.l(T,u.sharingAbilities,u.fileExtension),R=(0,a.a)((0,a.a)({},this._engagementExtraData),{shareType:O,audience:f.audience,isEdit:E,isReview:F&&M,sharingRole:P?g.a[g.a.restrictedview]:g.a[this.state.currentSettings.sharingRole],recipientsCount:this.state.recipientsCount,externalRecipientsCount:this.state.externalRecipientsCount,linkedinRecipientsCount:this.state.linkedinRecipientsCount,sharingLinkKind:f.sharingLinkKind,hasMessage:this.state.hasMessage,hasSubject:this.state.hasSubject,messageLength:this.state.messageLength,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(f),isDefaultLink:u.defaultSharingLink.sharingLinkKind===f.sharingLinkKind,linkBlocksDownload:!!P,linkWithOfficeReviewMode:U&&M,groupRecipientCount:this.state.linkRecipients.filter(function(e){return e.entityType===L.a.group&&null==e.familySharingTargetType}).length});X.u()&&k.r(this.props.clientId)&&(R.sharedToFamilyGroup=this.state.linkRecipients.some(function(e){return e.familySharingTargetType===Q.a.Family}),R.sharedToFamilyMember=this.state.linkRecipients.some(function(e){return e.familySharingTargetType===Q.a.FamilyMember}));var B=this._store.getEngagementHelper();B.shareCompleted(R),B.logShareLinkGeneration(f,R),null===(s=this._shareLinkCustomerPromise)||void 0===s||s.forEach(function(e){return(0,ue.e)({customerPromise:e,engagementExtraData:d._engagementExtraData,sharingStore:d._store})}),this._shareLinkCustomerPromise=void 0;var j=(0,H.M)(f.sharingLinkKind);if(m.z(this.state.shareType,j),O===r.a.outlook||O===r.a.nonOutlook)k.q(this.props.clientId)?(this._store.navigateToOwa(this._getRecipientEmails(this.state.linkRecipients),this._modifiedSharingLinkUrl),m.p(),this._dismiss()):m.x(this._getRecipientEmails(this.state.linkRecipients),this.state.linkRecipients.length,this.state.messageText,this._modifiedSharingLinkUrl);else if(O===r.a.mobileShareToTeams)this._dismiss(),m.B(f,this._getRecipientEmails(this.state.linkRecipients),this.state.messageText);else if(O===r.a.moreApps)try{C=(0,a.a)((0,a.a)({},C),{viewState:c.a.linkSuccess,companyName:p,sharingLinkCreated:f,showActivityIndicator:!1}),m.o(f.url)}catch(e){}else if(O===r.a.webShareToTeams){if(this._modifiedSharingLinkUrl){var V="https://teams.microsoft.com/share?href="+this._modifiedSharingLinkUrl+"&referrer=SharePoint.com";return this._teamsUrl=V,void this.setState({showTeamsDialog:!0})}}else this.props.mode===i.a.linkSettings?m.n(f,p,this.props.customLabeledAudienceConfig,this.state.sharingInformation.sharedObjectType===ie.a.list,this.props.clientId):C=(0,a.a)((0,a.a)({},C),{viewState:c.a.linkSuccess,sharingLinkCreated:f,companyName:p,showActivityIndicator:!1,sharingInformation:u,currentSettings:this._getSettings(u)})}else!this.props.copyLinkShortcut||!u||this.props.shareId||u.error||this._copyLinkShortcutInvoked||(this._copyLinkShortcutInvoked=!0,X.g()||this._onCopyLinkClicked(!0,x)),C=(0,a.a)((0,a.a)({},C),{sharingInformation:u,companyName:p,groupsMemberCount:_,currentSettings:x,policyTipInformation:h,isLoadingDefaultRecipients:l.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:b}),v&&!v.isConsumed&&(C.linkRecipients=v.recipients,this._store.consumeDefaultRecipients());this._isOpenEventLogged||(this._store.getEngagementHelper().log(J.d.Opened,this._engagementExtraData),this._isOpenEventLogged=!0),this.setState(C)}catch(e){this._setGenericErrorState(e)}},t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case i.a.share:if(e&&t)return c.a.default;break;case i.a.atMention:if(e&&t)return c.a.atMention;break;case i.a.linkSettings:if(t)return c.a.linkSettings;break;case i.a.manageAccess:if(t)return this._usePermissionsPivot?c.a.permissionsPivot:c.a.permissionsList;break;case i.a.copy:if(e&&t&&n)return c.a.linkSuccess;if(X.g())return c.a.copyLinkShortcut;break;case i.a.notify:if(e)return c.a.notify;break;case i.a.addPeople:if(e)return c.a.addPeople;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return this.props.mode===i.a.share?c.a.shareShimmer:c.a.spinner},t.prototype._renderAtMention=function(){var e,t=this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return p.createElement(U.AtMention,(0,a.a)({},this._baseProps,{currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,canGrantEditPermissions:null===(e=this.props.hostOptions)||void 0===e?void 0:e.canGrantEditPermissions,onComplete:t}))},t.prototype._renderPostCopyShortcutView=function(){var e=this.state,t=e.sharingInformation,n=e.currentSettings,i=e.companyName,r=e.sharingLinkCreated,o=e.viewState,s=e.groupsMemberCount,c=r&&r.createdViaCopyLinkCommand||this._copyLinkShortcutInvoked;return X.g()&&(c=!0),p.createElement(b,(0,a.a)({},this._baseProps,{mode:this.props.mode,shareId:this.props.shareId,companyName:i,currentSettings:n,item:t.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClick:this._getNotificationHintClickHandler(c),sharingInformation:t,showExistingAccessOption:this.props.showExistingAccessOption,viewState:o,groupsMemberCount:s,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,hostOptions:this.props.hostOptions}))},t.prototype._renderError=function(e){return p.createElement(V.Error,(0,a.a)({},this._baseProps,{viewState:c.a.error,sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()}))},t.prototype._getSettings=function(e){var t=this,n=this.state.currentSettings,a=e&&e.error,i=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,r=N.f(e.sharingAbilities,e.sharingLinkTemplates),o=!1;if(!n&&!a){var s,c=e.defaultSharingLink;i&&(s=e.sharingLinks.filter(function(e){return e.shareId===t.props.shareId&&e.isActive})[0])&&(c=s,o=!0),void 0!==r&&r.length>0&&((s=r.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0])||(s=r.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0])?(c=s,o=!0):(c=r[0],o=!0)),n=this._initializeCurrentSettings(c,e,this.props.copyLinkShortcut,o),r.length>0&&(n.shareId=c.shareId,n.fetchLinkOnly=!0,n.audience=c.audience,n.expiration=c.expiration,n.isEdit=c.isEdit,n.isReview=c.isReview,n.sharingRole=c.isEdit?(0,H.q)(this.props.clientId,e):c.isReview?g.a.review:g.a.view,n.trackLinkUsers=c.trackLinkUsers,n.preventDownload=c.blockDownload,n.sharingLinkKind=c.sharingLinkKind,this._engagementExtraData.isRedeemedUserResharing=!0,this._engagementExtraData.redeemedLinksCount=r.length)}return n},t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n].email;i&&t.push(i)}return t},t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var a=(t.getTime()-n.getTime())/864e5;return Math.floor(a)}},t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this._dismiss(),e.stopImmediatePropagation()},t.prototype._initializeCurrentSettings=function(e,t,n,a){if(this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:y.a.existing,expiration:null,isEdit:!0,sharingRole:(0,H.q)(this.props.clientId,t),sharingLinkKind:v.a.direct,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:I.a.existing};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===y.a.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=y.a.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:y.a.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:(0,H.q)(this.props.clientId,t),sharingLinkKind:v.a.flexible,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1,sharingScope:I.a.specificPeople};e.audience===y.a.specificPeopleFlex&&n&&!a&&(e.audience=y.a.existing,e.sharingLinkKind=v.a.direct);var i=e.sharingLinkKind,r=i===v.a.anonymousEdit||i===v.a.organizationEdit||i===v.a.direct||i===v.a.flexible,o=e.isEdit&&t.defaultShareLinkPermission===x.a.edit,s=[];return this.props.shareId&&e.principals&&(s=(0,H.A)(e)),{allowEditing:r,audience:(this.props.preferCustomLabeledAudience||!X.S()&&(0,H.P)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig))&&e.audience===y.a.specificPeopleFlex?y.a.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:o,sharingRole:o?(0,H.q)(this.props.clientId,t):g.a.view,sharingLinkKind:e.sharingLinkKind,specificPeople:s,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:e.sharingScope}},t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var a,i,r,o,s=t.sharingAbilities,c="00000000-0000-0000-0000-000000000000"===this.props.shareId,d=c?v.a.direct:t.defaultSharingLink.sharingLinkKind,l=t.defaultShareLinkScope,u=(0,H.P)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?y.a.customLabeledSpecificPeople:y.a.specificPeople;if(t.defaultShareLinkToExistingAccess)u=y.a.existing,d=v.a.direct;else switch(l){case I.a.anyone:u=y.a.anyone;break;case I.a.organization:u=y.a.organization;break;case I.a.specificPeople:(X.S()||u!==y.a.customLabeledSpecificPeople)&&(u=y.a.specificPeopleFlex);break;default:c||!t.canManagePermissions||t.blockPeoplePickerAndSharing?u=y.a.existing:this._isPeopleSharingLinksEnabled?(u!==y.a.customLabeledSpecificPeople&&(u=y.a.specificPeopleFlex),d=v.a.flexible):u=y.a.existing}u===y.a.specificPeopleFlex&&n&&(u=y.a.existing,d=v.a.direct);var f=null,p=N.e(u,s).linkExpiration;(p?p.defaultExpirationInDays:null)>0&&(f=new Date((new Date).toDateString())).setDate(f.getDate()+p.defaultExpirationInDays);var m,_=N.g(u,s),h=_&&t.defaultShareLinkPermission===x.a.edit,b=h?(0,H.q)(this.props.clientId,t):g.a.view;(m=t.defaultShareLinkPermission===x.a.restrictedView)&&(b=g.a.restrictedview);var S=(null===(i=null===(a=this.props)||void 0===a?void 0:a.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],D=(null===(o=null===(r=this.props)||void 0===r?void 0:r.hostOptions)||void 0===o?void 0:o.disabledAudienceOptions)||[];return u=-1===S.indexOf(u)&&-1===D.indexOf(u)?u:y.a.existing,N.h(u,s)&&(u=y.a.existing),{allowEditing:_,audience:u,expiration:f,isEdit:h,sharingRole:b,isReview:!1,preventDownload:m,sharingLinkKind:u===y.a.existing?v.a.direct:d,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers,sharingScope:l}},t.prototype._loadTheme=function(e){try{var t=e;(0,z.H)(t)}catch(e){}},t.prototype._onRedirectTeamsClicked=function(){var e=this;this._store.getEngagementHelper().webShareToTeamsTargetClicked(this._engagementExtraData),this._store.getEngagementHelper().shareCompleted(this._engagementExtraData),this.setState({shareType:r.a.webShareToTeams,shareTargetClicked:!0,viewState:c.a.shareToTeams},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:r.a.webShareToTeams}),e._viewStates.push(e.state.viewState)})},t.prototype._onCopyLinkClicked=function(e,t){return(0,a.b)(this,void 0,void 0,function(){var n,i=this;return(0,a.e)(this,function(o){switch(o.label){case 0:return n=(0,a.a)((0,a.a)({sendInvitation:!1},t),this.state.currentSettings),this._copyTargetClickTime=Date.now(),[4,this._store.shouldInterruptCopyLink(n.isEdit)];case 1:return o.sent()?(this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData),this.setState({showCopyLinkInterrupt:!0})):this.setState({shareType:r.a.copy,shareTargetClicked:!0},function(){var t,a=i.state.linkRecipients;i._store.isConsumer()&&(null===(t=i.state.currentSettings)||void 0===t?void 0:t.audience)!==y.a.specificPeople&&(a=[]),i._store.shareLink({settings:n,recipients:a,copyLinkCommand:e,shareType:r.a.copy})}),[2]}})})},t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:r.a.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:r.a.outlook})})},t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:r.a.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:r.a.nonOutlook})})},t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:r.a.mobileShareToTeams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:r.a.mobileShareToTeams})})},t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:r.a.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:r.a.moreApps})})},t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===y.a.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=c.a.default;this.props.mode===i.a.linkSettings?n=this.state.viewState:this._viewStates&&this._viewStates.length>0&&(n=this._viewStates.pop()),this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,trackLinkUsers:e.trackLinkUsers,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===y.a.specificPeople,sharingScope:e.sharingScope},permissionsMap:t})},t.prototype._renderBackButtonForPolicyDetails=function(){if(this.state.viewState===c.a.policyDetails)return q.b(p.createElement(T.a,{className:"od-Share-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:l.ub}),l.ub)},t.prototype._renderBackButtonForPriorView=function(){if(this._usePermissionsPivot&&this._viewStates.length>0)return q.b(p.createElement(T.a,{className:"od-Share-backButton absolute",id:"od-Share-prevView-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:l.ub}),l.ub,{tooltipId:"od-Share-backButton-tooltip",position:G.a.bottomCenter,targetElementId:"od-Share-prevView-backButton"})},t.prototype._renderShareMain=function(e,t){var n=this._usePermissionsPivot&&this._viewStates.length>0;return this.props.clientId!==S.a.odcWac&&this.props.clientId!==S.a.word||!(0,pe.c)(e.fileExtension)||(e.peoplePickerSettings.useNew3Ssearch=!0),p.createElement("div",{className:this.props.fullScreenIframeMode&&"od-Share-shareMainDiv"},p.createElement(w.b,(0,a.a)({},this._baseProps,{key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClick:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,summaryText:this.state.summaryText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this._onRoleChange,hasBackButton:n,fullScreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken,onBackButtonClicked:this._returnToPreviousView})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}),this.state.showTeamsDialog&&this._renderTeamsDialog())},t.prototype._renderTeamsDialog=function(){return p.createElement(de.default,{url:this._teamsUrl,onDismiss:this._dismiss,height:this.props.calculatedIframeHeight,onBackButtonClicked:this._returnToPreviousView.bind(this)})},t.prototype._renderPolicyDetails=function(){return p.createElement(E.SharePolicyDetails,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation,onBackButtonClicked:this._returnToPreviousView})},t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return p.createElement(K.ConfirmationDialog,{confirmationCode:t?W.a.copyInterruptUpdate:W.a.copyInterruptRemove,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew})},t.prototype._renderModifyPermissions=function(e){return p.createElement(p.Fragment,null,p.createElement(o.ModifyPermissions,(0,a.a)({},this._baseProps,{shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this.state.copyLinkShortcut?this._copyLinkOnApplyClicked:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:this.state.copyLinkShortcut,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,fullScreenIframeMode:this.props.fullScreenIframeMode,renderBackButton:this._viewStates.length>0})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!this.state.currentSettings.password}))},t.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,n=e.sharingLinkCreated,i={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(n.createdViaCopyLinkCommand),linkRecipients:e.shareType===r.a.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return p.createElement(s.ShareNotification,(0,a.a)({},(0,d.a)(this.props),{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,generatedFromTargetClick:this.state.shareTargetClicked,engagementExtraData:this._engagementExtraData}))},t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,J.b.CopyLinkSettingsHint,e):null},t.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:y.a.existing,expiration:void 0,isEdit:!1,sharingLinkKind:v.a.uninitialized,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",sharingRole:g.a.none,sharingScope:I.a.existing},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canAddInternalPrincipal:!1,canManagePermissions:!1,canRequestAccessForGrantAccess:!1,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:!1,hasInheritedLinks:!1,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},fileExtension:"",sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:x.a.view,defaultLinkKind:v.a.uninitialized,userRole:g.a.none,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0,permissionsInformation:void 0};return this._renderShareMain(t,e)},t.prototype._renderPermissionsList=function(){this._store.isConsumer()?this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!1):this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);var e=!1;return N.i(this.state.currentSettings.audience,this.state.sharingInformation.sharingAbilities)&&(e=!0),this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===ie.a.list&&X.s(),p.createElement(C.PermissionsList,(0,a.a)({},this._baseProps,{onStopSharingClicked:this.props.onStopSharingClicked,advancedUrl:this.props.advancedUrl,showHeader:this.state.showHeaderInManagedAccess||this.props.showHeaderInManageAccess,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,shareButtonClicked:this._enterShareView,grantAccessClicked:this._enterGrantAccessView,centeredManageAccessEnabled:this.props.showHeaderInManageAccess,hideElementsInManageAccess:this._hideElementsInManageAccess,engagementExtraData:this._engagementExtraData,isInfectedFile:e}))},t.prototype._renderPermissionsPivot=function(){return this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!0),p.createElement(O.PermissionsPivot,(0,a.a)({},this._baseProps,{sharingInformation:this.state.sharingInformation,clientId:this.props.clientId,onDefaultShare:this._onPermissionsDefaultShare,showCloseButton:!k.o(this.props.clientId),onDismiss:this._dismiss,store:this._store,engagementExtraData:this._engagementExtraData,viewOverride:this._lastPermissionsSubView||void 0,companyName:this.state.companyName,onStopSharingClicked:this.props.onStopSharingClicked,shareLoadingCustomerPromise:this.props.shareLoadingCustomerPromise,pageContext:this.props.pageContext,backButtonClicked:this._returnToPreviousView,mode:this.props.mode,grantAccessClicked:this._enterGrantAccessView,maxHeight:this.props.maxHeight}))},t.prototype._renderAddPeople=function(){var e=this,t=!this.props.hideShareDialogOverflowButton;return p.createElement(p.Fragment,null,p.createElement(j.AddPeople,(0,a.a)({},this._baseProps,{backButtonClicked:this._enterManageAccessView,centeredManageAccessEnabled:this.props.showHeaderInManageAccess,onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked})))},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return p.createElement(P.a,{message:l._})},t.prototype._resizeIfNeeded=function(){$.e()&&this.state.viewState===c.a.shareToTeams||this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._getModifiedSharingLinkUrl=function(e,t,n){var a=this.state.shareType,i=e.url;if(a!==r.a.copy&&a!==r.a.outlook)return i;var o=this._getBase62Id(),s=new R.a(i);(0,le.a)()||s.setQueryParameter("e",o);var c=this._store.getNavId();c&&s.setQueryParameter("nav",c);var d=this._store.getInvitationId();return d&&s.setQueryParameter("inviteid",d),s.toString()},t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")},t.prototype._setGenericErrorState=function(e){var t,n=this,i=e.stack?e.stack:e.toString();i.length>1024&&(i=i.substr(0,1024));var r=(0,a.a)((0,a.a)({},this.state.sharingInformation),{error:i,errorCategory:D.a.generic,errorMessage:l.Kj,debugErrorMessage:"CorrelationId: "+this._correlationId});null===(t=this.props.shareLoadingCustomerPromise)||void 0===t||t.forEach(function(e){return e.end({resultType:oe.b.Failure,scenario:"ShareLoading",errorCode:i,extraData:{clientId:n.props.clientId}})}),this.setState({sharingInformation:r,viewState:c.a.error})},t.prototype._sanitizeSharingContextInfo=function(e){if(e&&(this._isSanitizedUrl(e.customizedExternalSharingServiceUrl)||(e.customizedExternalSharingServiceUrl=""),this._isSanitizedUrl(e.fixItUrl)||(e.fixItUrl=""),e.defaultSharingLink&&!this._isSanitizedUrl(e.defaultSharingLink.url)&&(e.defaultSharingLink.url=""),e.directLink&&!this._isSanitizedUrl(e.directLink.url)&&(e.directLink.url=""),e.sharingLinks))for(var t=0;t<e.sharingLinks.length;t++)e.sharingLinks[t]&&!this._isSanitizedUrl(e.sharingLinks[t].url)&&(e.sharingLinks[t].url="")},t.prototype._isSanitizedUrl=function(e){return!e||0===e.length||0===e.toLowerCase().indexOf("http://")||0===e.toLowerCase().indexOf("https://")},t.prototype._writeShareDataToRumoneLogger=function(e){var t=e.mode,n=e.viewState,a=this.props.clickTime||this._store.getSharingClickTime()||performance.timing.navigationStart;this._writePerfData({pageTransitionType:ce.a.fullPageLoad,startTime:a,mode:this.props.mode,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})},t.prototype._writeCopyLinkTargetDataToRumoneLogger=function(e){if(this._rumoneLogger.resetRumOne()){var t=e.mode,n=e.viewState,a=e.clickTime;this._writePerfData({pageTransitionType:ce.a.onePageAppNavigation,startTime:a,mode:i.a.copy,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})}},t.prototype._writePerfData=function(e){var t,n=this,a=e.pageTransitionType,r=e.startTime,o=e.mode,s=e.originalMode,c=e.viewState,d=e.originalViewState,l=e.audience;if(this.props&&r&&this.props.clientId){var u=Object.keys(i.a).filter(function(e){return i.a[e]===o})[0],f=Object.keys(i.a).filter(function(e){return i.a[e]===s})[0],p=Object.keys(S.a).filter(function(e){return S.a[e]===n.props.clientId})[0],m=this._store.getSharingInformationAPIStats?this._store.getSharingInformationAPIStats():null,_=(null===(t=this._store)||void 0===t?void 0:t.getShareLinkAPIStats)?this._store.getShareLinkAPIStats():null,h=this._rumoneLogger.breakdownData,b={modeName:u,startTime:r,endTime:Date.now(),breakDownData:{sharingClientId:h(p),mode:h(u),audience:h(l),originalMode:h(f),viewState:h(c),originalViewState:h(d),getSharingInformationAPIStats:m?h(m):null,shareLinkAPIStats:_?h(_):null,realUserClickTime:h(r!==performance.timing.navigationStart),beforeNavigation:h(r<performance.timing.navigationStart?performance.timing.navigationStart-r:0),isInstantSecondLoad:!1,isLightSpeed:!1}};this._rumoneLogger.logSharingPerformance(b,a)}},t.contextTypes={resize:_.func.isRequired,onDismiss:_.func.isRequired,sharingStore:_.object.isRequired,shareClickTime:_.number,loadFloodgateDataSource:_.func},t}(p.Component)}
,function(e,t,n){function a(e,t,n){var a=[],i=[],r=n||function(e,t){return e===t};return function e(t,n){if(t===n)return!0;if(null===t||null===n)return!1;if("object"!=typeof t||"object"!=typeof n)return!1;var o=Object.keys(t).sort(),s=Object.keys(n).sort();return o.length===s.length&&!!o.every(function(o,c){if(o!==s[c])return!1;if("function"==typeof t[o]||"function"==typeof n[o])return!0;if(r(t[o],n[o]))return!0;if("object"==typeof t[o]){if(-1!==a.indexOf(t[o]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(o));if(a.push(t[o]),-1!==i.indexOf(n[o]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: ".concat(n,", ")+"property: ".concat(o));return i.push(n[o]),!!e(t[o],n[o])&&(a.pop(),i.pop(),!0)}return!1})}(e,t)}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(e,t){return(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},e),t),e.extraMetrics||t.extraMetrics?{extraMetrics:(0,a.a)((0,a.a)({},e.extraMetrics||{}),t.extraMetrics||{})}:{}),e.extraData||t.extraData?{extraData:(0,a.a)((0,a.a)({},e.extraData||{}),t.extraData||{})}:{})},e)}}
,function(e,t){var n;!function(e){e[e.none=1]="none",e[e.available=2]="available",e[e.other=3]="other"}(n||(n={})),t.a=n}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(24);function i(e){if(!(0,a.a)()){var t;switch(e){case 18:case 37:t="odc-files";break;case 4:t="odc-sync";break;default:t=void 0}return t}}}
,function(e,t){t.a={unavailable:-1,none:0,disabled:1,notShareableByLink:2,parentListIsPrivate:3,parentListIsCatalogDocLib:4,notSupportedByWopi:5,irmIsEnabled:6,documentIsProtectedByDlp:7,forceCheckoutEditLink:8,anonymousEditLinkNotAllowedByTenant:9,nonClaimsWebapp:10,accessDeniedToAnonGuest:11,blockedByWhoCanShareSettings:12,blockedByExternalShareSettings:13,accessDeniedNotEnoughPermissions:14,sharingBlockedByVirusCheckStatus:40,loopFilesExternalSharingNotSupported:43,azureB2BIMIntegrationNotConfiguredSharingToNewExternalUserNotSupported:49}}
,function(e,t,n){n.d(t,{a:function(){return l}});var a=n(0),i=n(131),r=n(221),o=n(509),s=n(163),c=n(206),d="ShareControl",l=function(){function e(e){void 0===e&&(e="sharedialog");var t=this;this.resetRumOneApiMeasurement=function(){t._rumone.undoAPIInstrument()},this.computeRenderTime=function(e){return e&&e.startTime&&e.endTime?e.endTime-e.startTime:0},this.checkRenderTimeRequiredDataAvailable=function(e){return!!e&&!!e.startTime&&!!e.endTime},this._rumone=i.b.getRUMOneLogger({name:e})}return e.prototype.logSharingPerformance=function(e,t){var n=this;if(this._rumone&&this._rumone.isRunning()){var i=this.breakdownData;this._rumone.writeScenarioId("ShareDialog.".concat(e.modeName)),this._rumone.addExpectedControl(d),this._rumone.writePageTransitionType(t||r.a.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();var s=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0;s&&(this._rumone.collectSPClientFlights(window._spPageContextInfo),this._evaluateExperiments(window._spPageContextInfo)),this._rumone.setSettings({TTISettings:{getStartTime:function(){return n._regulateTime(e.startTime)},TTIPolyfillSettings:{enabled:!0,calculateTTI:function(t,a,i){var r=n._regulateTime(t)-n._regulateTime(e.startTime);return n._rumone.addEUPLBreakdown("ttiAbsoluteTime_".concat(i),{data:t,needFlatten:!1}),n._rumone.addEUPLBreakdown("transactionStartTime_".concat(i),{data:e.startTime,needFlatten:!1}),n._rumone.addEUPLBreakdown(i,{data:r,needFlatten:!1}),r},options:(0,a.a)({useMutationObserver:!1,trackNetworkRequests:!1},{requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3})},FCIMeasurementSettings:{disabled:!0}}});var c=new o.a({controlId:d,startTime:e.startTime,endTime:e.endTime,renderTimeCalculator:this.computeRenderTime,renderTimeRequiredDataChecker:this.checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(c);var l=e.breakDownData,u=this._getResponseEnd();l=(0,a.a)((0,a.a)({},l),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),herf:i(location.href),isShareDialogASPXHosted:i(s),w3cResponseEnd:i(u-performance.timing.navigationStart),appStart:i(this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"))-this._regulateTime(u)),render:i(this._regulateTime(e.endTime)-this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")))}),this._rumone.writeEUPLBreakdown(JSON.stringify(l))}},e.prototype.resetRumOne=function(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)},e.prototype.breakdownData=function(e){return{data:e,needFlatten:!0}},e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()},e.prototype._regulateTime=function(e){return this._isDateTime(e)&&s.a?e-performance.timing.navigationStart:e},e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN},e.prototype._evaluateExperiments=function(e){e&&(0,c.c)(90089,e)},e}()}
,,,,,,,,,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4}}
,,,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return p},c:function(){return c},d:function(){return a}});var a,i,r=n(113),o=n(7),s=n(354);!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown"}(a||(a={})),function(e){e[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown"}(i||(i={}));var c=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,a=e.multiGeoInfo,i=e.options,r=void 0===i?{}:i,o=r.path,s=void 0===o?void 0:o,c=r.listUrl,d=void 0===c?void 0:c,u=r.webUrl,f=void 0===u?void 0:u,p=r.mayInferListUrl,m=void 0!==p&&p;this._rawPath=s||void 0,this._rawListUrl=d||void 0,this._rawWebUrl=f||void 0,this.defaultFullWebUrl=l(t||void 0),this.defaultListUrl=l(n||void 0),this.multiGeoInfo=a,this.mayInferListUrl=m}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return d(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return d(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return d(this._getNormalizedListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return d(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return d(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return d(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inferredFullListUrl",{get:function(){return d(this._getInferredFullListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0}),e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=l(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}return this._getPath=function(){return e},e},e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=l(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}return this._getListUrl=function(){return e},e},e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;return t&&(e="/"===t[0]||t.indexOf("://")>-1?l(t):"".concat(this.defaultFullWebUrl,"/").concat(t)),this._getWebUrl=function(){return e},e},e.prototype._getCurrentAuthority=function(){var e=new r.a(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e},e},e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!(0,o.f)(t,n)){var a=new r.a(t);e=(0,o.f)(a.authority,this._getCurrentAuthority())?a.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new r.a(t);e=(0,o.f)(n.authority,this._getCurrentAuthority())?n.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();return void 0===t||(0,o.f)(t,n)||(e=(0,o.f)(new r.a(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e},e},e.prototype._getInferredFullListUrl=function(){var e,t=this._getFullListUrl();if(t)e=t;else{var n=this._getFullItemUrl(),a=this._getFullWebUrl();if(n&&a&&(0,s.a)(n,a)){var i=new r.a(n),o=new r.a(a);i.segments.length>o.segments.length&&(e="".concat(i.authority).concat(i.segments.slice(0,o.segments.length+1).join("/")))}}return this._getInferredFullListUrl=function(){return e},e},e.prototype._getServerUrl=function(){var e=this.path&&new r.a(this.path).authority||this.listUrl&&new r.a(this.listUrl).authority||this.webUrl&&new r.a(this.webUrl).authority||this.defaultListUrl&&new r.a(this.defaultListUrl).authority||new r.a(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e},e},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new r.a(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var a=this._getServerRelativePath(),i=new r.a(t).path;if(void 0===a&&(void 0===this.webUrl||i&&(0,s.a)(f(i),f(this._getServerRelativeWebUrl())))||i&&(0,s.a)(f(a),f(i)))e=i;else if(void 0!==a&&(""===this.defaultListUrl||n)){var o=this._getServerRelativeWebUrl();if((0,s.a)(f(a),f(o))){var c=new r.a(a).segments[new r.a(o).segments.length];e="".concat(f(o)).concat(c)}}}}return this._getServerRelativeListUrl=function(){return e},e},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();return void 0!==n&&(e="".concat(t).concat(n)),e},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullItemUrl=function(){return e},e},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new r.a(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new r.a(this.defaultFullWebUrl).path);else{var n=new r.a(t);e="".concat(n.segments.slice(0,-1).join("/"))}return this._getServerRelativeWebUrl=function(){return e},e},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new r.a(this.path).path),this._getServerRelativePath=function(){return e},e},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e},e},e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==a&&(0,s.a)(f(n),t=f(a))&&(e=n&&n.substring(t.length)),this._getListRelativeItemUrl=function(){return e},e},e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==a&&(0,s.a)(f(n),t=f(a))&&(e=n&&n.substring(t.length)),this._getWebRelativeItemUrl=function(){return e},e},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new r.a(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl)),this._getDefaultListUrl=function(){return e},e},e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!(0,o.f)(new r.a(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t},t},e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!(0,o.f)(e,t);return this._getIsCrossList=function(){return n},n},e.prototype._getSiteRelation=function(){var e=a.unknown;if(this._getIsCrossDomain())e=a.crossSite;else if(void 0!==this.webUrl)e=(0,o.f)(u(this.defaultFullWebUrl),u(this._getFullWebUrl()))?a.sameSite:a.crossSite;else{var t=new r.a(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if((0,s.a)(f(n),f(t))){var i=new r.a(u(n)),c=new r.a(u(t));e=i.segments.length-1===c.segments.length||i.segments.length-2===c.segments.length&&"Lists"===i.segments[i.segments.length-2]?a.sameSite:a.unknown}else e=a.crossSite}return this._getSiteRelation=function(){return e},e},e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullWebUrl=function(){return e},e},e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return i.sameGeo;var e=new r.a(this._getServerUrl()).authority;if(!e)return i.unknown;var t=this._getCurrentGeo();if(!t)return i.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?(0,o.f)(n,t)?i.sameGeo:i.crossGeo:i.unknown},e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,a,i){var o=new r.a(n).authority.toUpperCase();!i&&t[o]||(e[o]=a),i&&(t[o]=!0)}if(this.multiGeoInfo)for(var a=0,i=this.multiGeoInfo;a<i.length;a++){var o=i[a],s=o.InstanceId,c=o.IsDefaultDataLocation;if(n(o.MySiteHostUrl,s,c),n(o.PortalUrl,s,c),n(o.RootSiteUrl,s,c),n(o.TenantAdminUrl,s,c),o.AdditionalUrls)for(var d=0,l=o.AdditionalUrls;d<l.length;d++)n(l[d],s,c)}return this._getGeoByAuthority=function(){return e},e},e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];return this._getCurrentGeo=function(){return t},t}},e}();function d(e){return""===e?"/":e}function l(e){return"/"===e?"/":e}function u(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e}function f(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:"".concat(e,"/")}var p=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,a=void 0===n?c:n;this.itemUrlPartsType=a,this.itemUrlContext=t}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,a=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:a,multiGeoInfo:i,options:e})},e}()}
,function(e,t,n){function a(e,t){var n=e.toUpperCase(),a=t&&t.toUpperCase();return n.substring(0,a&&a.length||0)===a}n.d(t,{a:function(){return a}})}
,function(e,t,n){var a=n(202);t.a=a.a}
,function(e,t,n){var a=n(67),i=n(37),r=n(159),o=function(){function e(t){this._async=new a.a(this);var n=t.url,i=t.requestTimeoutInMS,r=void 0===i?e.DEFAULT_TIMEOUT_MS:i,o=t.json,s=t.responseType,c=void 0===s?"":s,d=t.headers,l=void 0===d?{}:d,u=t.withCredentials,f=void 0!==u&&u,p=t.needsCors,m=void 0!==p&&p,_=t.onProgress,h=t.onUploadProgress,b=t.method,g=void 0===b?o?"POST":"GET":b;this._url=n,this._requestTimeoutInMS=r,this._postData=o,this._headers=l,this._method=g,this._withCredentials=f,this._needsCors=m,this._responseType=c,this._progressCallback=_,this._uploadProgressCallback=h}return e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)},e.prototype.start=function(e,t){var n=this;this._successCallback=e,this._failureCallback=t;var a=this._method,o=this._headers;try{this._request=this._getRequest();var s=this,c=s._progressCallback,d=s._uploadProgressCallback,l=s._request,u=s._responseType;for(var f in c&&(l.onprogress=function(e){try{c(e)}catch(e){i.a.logError(e)}}),d&&(l.upload.onprogress=function(e){try{d(e)}catch(e){i.a.logError(e)}}),this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS),l.onreadystatechange=function(){if(!n._completed){var e=4;try{e=l.DONE||4}catch(e){}l.readyState===e&&n._requestEndCallback()}},l.open(a,this._url,!0),"withCredentials"in l&&(l.withCredentials=this._withCredentials),l.responseType=u,o)l.setRequestHeader(f,o[f]);l.send(this._postData)}catch(e){i.a.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:(0,r.a)(o),method:a}),this._abortRequest(),this._callFailureCallback(this._request,-1,!1)}},e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;return t.setRequestHeader=function(){},t.onprogress=function(){},t.ontimeout=function(){},t.onload=function(){e._requestEndCallback()},t},e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0,this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e},e.prototype._timeoutCallback=function(){this._completed||(this._abortRequest(),this._callFailureCallback(this._request,-2,!0))},e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){i.a.log(e)}},e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){i.a.log(e)}},e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=-1,i.a.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}},e.DEFAULT_TIMEOUT_MS=3e4,e}();t.a=o}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return u}});var a=n(47),i=n(18),r={Small:1,Medium:2,Large:3},o="_oat_",s={},c={},d="TryGetAlternativeUrlFailure";function l(e){if(-1===e.indexOf(o))return!0;var t=c[e];if(t)return Date.now()/1e3<t;var n=new a.a(e),r=n.getQueryParameter(o);if(r){var s=r.split("_");if(2===s.length&&(t=Number(s[0])),!t)return new i.a({name:d}).end({resultType:i.b.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:r}}),c[e]=Date.now()/1e3+86400,!0;if(t-=30,c[e]=t,Date.now()/1e3>t)return!1}var l=n.getQueryParameter("P1");if(!l)return!0;var u=Number(l);return u-=30,c[e]=Math.min(u,c[e]),!(Date.now()/1e3>u)}function u(e,t,n){var o;switch(n=n||function(e){var t,n;function a(e){return l(window[e].userPhotoCdnBaseUrl)?window[e].userPhotoCdnBaseUrl:(delete window[e].userPhotoCdnBaseUrl,"")}try{var r=s&&s[e];if(r||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?r=a("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(r=a("_spHomePageContext"))),!r)return;return l(r)?r:void delete s[e]}catch(e){new i.a({name:d}).end({resultType:i.b.Failure,resultCode:"Unexpected",extraData:{error:e}})}}("UserPhotoAspx")||"/_layouts/15/userphoto.aspx",t){case r.Medium:o="M";break;case r.Large:o="L";break;default:o="S"}var c=new a.a(n);return c.setQueryParameter("size",o),c.setQueryParameter("accountname",e||""),c.toString()}}
,function(e,t,n){function a(e){if(!e||0===e.length)return 0;for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t&=t;return t}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n(0),i=n(1),r=n(12);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{align-items:top;display:flex;padding:0;width:100%}.od-ShareLinkDescription .od-ShareLinkDescription-label-section{width:80%;text-align:left}[dir=ltr] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-left:16px}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-right:16px}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{text-align:right}@supports (font:-apple-system-body){.od-ShareLinkDescription .od-ShareLinkDescription-label-section{font:-apple-system-body}}.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font-size:.75rem;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@supports (font:-apple-system-caption1){.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font:-apple-system-caption1}}.od-ShareLinkDescription-label{font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;top:2px;position:relative;margin:0;width:100%}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}@supports (font:-apple-system-body){.od-ShareLinkDescription-label{font:-apple-system-body}}.od-ShareLinkDescription-image{width:1rem;height:1rem}.od-ShareLinkDescription-icon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}@supports (height:-apple-system-body){.od-ShareLinkDescription-icon{height:-apple-system-body;width:-apple-system-body}}.od-ShareLinkDescription-icon .ms-Icon{font-size:.875rem}.od-ShareLinkDescription-icon.icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--AddFriend{top:50%;left:50%;transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:1.5rem;height:1.5rem;border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--AddFriend{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--AddFriend{padding-left:10px}.od-ShareLinkDescription-IELabel{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"}]);var o=n(238),s=n(239),c=n(10),d=function(e){function t(t,n){var a=e.call(this,t)||this;return a._platformDetection=n.platformDetection,a}return(0,a.d)(t,e),t.prototype.render=function(){var e=o.a[this.props.permissionsType],t=this.props.iconUrl?i.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):i.createElement(c.a,{"aria-hidden":"true",iconName:e,styles:{root:{fontSize:"0.875rem",width:"2.75",height:"2.75"}}});return i.createElement("div",{className:"od-ShareLinkDescription"},!1!==this.props.renderIcon&&i.createElement("div",{className:"od-ShareLinkDescription-icon icon-".concat(e),"aria-hidden":"true"},t),this._renderLabel())},t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?i.createElement(s.a,{message:e,disableKeyboard:!0}):"";if(this.props.showLabel){var n=this.props.isSelected||this.props.showDetailText;t=n?null:t;var a=i.createElement("div",{className:"od-ShareLinkDescription-label"},i.createElement("div",{className:"".concat(this._platformDetection.isIE?"od-ShareLinkDescription-IELabel":"")},this.props.label),t);return i.createElement("div",{className:"od-ShareLinkDescription-label-section"},a,n&&i.createElement("span",{className:"od-ShareLinkDescription-detailText"},this.props.detailText))}},t.contextTypes={platformDetection:r.object.isRequired},t}(i.Component)}
,,,,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.Family=0]="Family",e[e.FamilyMember=1]="FamilyMember"}(a||(a={}))}
,function(e,t,n){var a=n(0),i=n(1),r=n(12),o=n(5),s=n(51),c=n(241),d=n(178),l=n(132),u=n(539),f=n(11),p=n(114),m=n(20),_=n(44),h=function(e,t){h.contextTypes={onDismiss:r.func};var n={hideItemName:!e.singleComponent,doNotrenderHeaderButtons:!e.singleComponent,titleIsSubLevel:!0,sendButtonType:e.singleComponent?d.a.button:d.a.copyLink,shouldBeFocused:e.singleComponent,hostOptions:e.hostOptions};return i.createElement("div",{className:"od-ShareMain-section new"},g(e,t.onDismiss),i.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},i.createElement(u.a,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:function(){e.onShareHintClick(p.b.CopyLinkSettingsHint,!0)},sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig}),i.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},i.createElement(c.a,{ctaLabel:f.dc,currentSettings:e.currentSettings,linkRecipients:null,onSendLinkClicked:e.onSendLinkClicked,permissionsMap:null,sharingInformation:e.sharingInformation,sendButtonType:n.sendButtonType,shouldBeFocused:n.shouldBeFocused}))))},b=function(e,t){var n,a;return(null!==(a=null===(n=null==e?void 0:e.hostOptions)||void 0===n?void 0:n.showCloseButton)&&void 0!==a?a:m.p(e.clientId))&&i.createElement(_.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:f.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),t()},tooltipContent:f.Vb,directionalHint:o.a.bottomAutoEdge})},g=function(e,t){var n,r,o=!e.singleComponent,c=!e.singleComponent,u=(e.singleComponent?d.a.button:d.a.copyLink,e.singleComponent,e.hostOptions,null===(r=null===(n=e.sharingInformation)||void 0===n?void 0:n.item)||void 0===r?void 0:r.name);return i.createElement(s.a,(0,a.a)({},(0,l.a)(e),{actions:c?void 0:b(e,t),mainHeaderText:f.lc,subHeaderText:o?"":u}))};t.a=h}
,function(e,t,n){n.d(t,{a:function(){return u}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .teams .od-AudienceChoiceGroup-row{padding-left:0}[dir=rtl] .teams .od-AudienceChoiceGroup-row{padding-right:0}.teams .od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{font-weight:700}.od-AudienceChoiceGroup-row{background:0 0;border:none;cursor:pointer;margin:0;font:-apple-system-caption1;display:flex;flex-wrap:wrap;width:100%;padding:12px 0}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-main{display:flex;width:100%}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-sub{width:90%;margin-left:24px;padding-left:2%}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:';font-weight:600;overflow-wrap:anywhere}.od-AudienceChoiceGroup-row.is-selected .tickIcon::after{content:"\\e73e";font-family:FabricMDL2Icons;flex-basis:10%;color:'},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.75rem;margin-top:10px;padding-right:5px}[dir=ltr] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir=rtl] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:left}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-radio{width:1.25rem;height:1.25rem;margin:0}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-radio.ms-RadioButton-field::before{width:1.25rem;height:1.25rem}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-radio.ms-RadioButton-field.is-checked::after{top:.3125rem;left:.3125rem;width:.625rem;height:.625rem}@media screen and (-ms-high-contrast:active){.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-radio.ms-RadioButton-field.is-checked::after{background-color:highlight}}.od-AudienceChoiceGroup-row.is-disabled{cursor:default}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:#a19f9d;overflow-wrap:anywhere}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast:active){.od-AudienceChoiceGroup-row{outline:1px solid transparent}.od-AudienceChoiceGroup-row.is-selected:focus{outline:1px solid highlight}}@media screen and (-ms-high-contrast:black-on-white){.od-AudienceChoiceGroup-row{outline:1px solid transparent}.od-AudienceChoiceGroup-row.is-selected:focus{outline:1px solid highlight}}.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast:active){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px #37006e inset}}.teams .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.od-AudienceChoiceGroup-description{align-items:center;display:inline-flex;overflow:hidden;width:90%;flex-grow:1;flex-basis:90%}[dir=ltr] .od-AudienceChoiceGroup-description{float:left}[dir=rtl] .od-AudienceChoiceGroup-description{float:right}"}]);var i=n(65),r=n(74),o=n(359),s=n(1),c=n(12),d=n(20),l=n(176),u=function(e){function t(t,n){var a=e.call(this,t)||this;return a._firstInteractiveElement=s.createRef(),a._onActiveElementChanged=function(e){if(!a._platformDetection.isMobile&&!d.f(a.props.clientId)&&e&&e.hasAttribute("data-key")){var t=parseInt(e.getAttribute("data-key"),10);"true"===e.getAttribute("aria-disabled")||a._onRowClick(t)}},a.state={selectedKey:a._getSelectedIndex(t)},a._platformDetection=n.platformDetection,a}return(0,a.d)(t,e),t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var a=n[t];if(a.isChecked)return a.key}},t.prototype.componentDidMount=function(){var e=this;this._firstInteractiveElement&&this._firstInteractiveElement.current&&(this._platformDetection.isIOS?setTimeout(function(){e._firstInteractiveElement.current.focus()},100):this._firstInteractiveElement.current.focus())},t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return s.createElement(i.a,{direction:r.a.vertical,onActiveElementChanged:this._onActiveElementChanged},s.createElement("div",{"aria-labelledby":"od-shareHeader-viewTitle od-PermissionsSettings-prompt-id",role:"radiogroup"},e))},t.prototype._renderItem=function(e,t){var n=e.key,a=!this._platformDetection.isFirefox,i=e.isDisabled&&e.disabledText?e.disabledText:"",r=this.state.selectedKey===n;e.isDisabled||(i=e.detailText);var c=this._platformDetection.isAndroid||this._platformDetection.isIE||this._platformDetection.isFirefox?t+1+" of "+this.props.items.length:"",d="od-AudienceChoiceGroup-radio ms-RadioButton-field";e.isDisabled&&(d+=" is-disabled"),r&&(d+=" is-checked");var u=s.createElement("div",{ref:r?this._firstInteractiveElement:void 0,"aria-checked":r,role:"radio",key:n,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,n),"aria-disabled":e.isDisabled,"data-is-focusable":!e.isDisabled,"aria-posinset":t+1,"aria-setsize":this.props.items.length,"aria-label":"".concat(e.label," ").concat(i," ").concat(c),"data-key":n,className:"od-AudienceChoiceGroup-main"},s.createElement("div",{className:"od-AudienceChoiceGroup-description"},this.props.isAddressBarLinkDetails&&s.createElement("label",{className:d}),s.createElement(o.a,{label:e.label,permissionsType:e.permissionsType,showLabel:!0,iconUrl:e.iconUrl,infoButtonMessage:a?i:"",detailText:e.detailText,isSelected:r,showDetailText:this.props.isAddressBarLinkDetails,renderIcon:!this.props.isAddressBarLinkDetails}),!this.props.isAddressBarLinkDetails&&s.createElement("div",null,s.createElement("label",{className:d}))));return s.createElement(s.Fragment,null,s.createElement("div",{className:this._getRowClasses(e)},u,e.subComponent&&s.createElement("div",{className:"od-AudienceChoiceGroup-sub"},e.subComponent)),t<this.props.items.length-1&&!this.props.isAddressBarLinkDetails?s.createElement(l.a,null):s.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))},t.prototype._getRowClasses=function(e){var t="od-AudienceChoiceGroup-row od-Share-noFocusBorder";return this.state.selectedKey===e.key&&(t+=" is-selected"),e.isDisabled&&(t+=" is-disabled"),t},t.prototype._onRowClick=function(e){var t=this.props;this.setState({selectedKey:e}),t.onAudienceChange(e),this.context.sharingStore.getEngagementHelper().linkSettingsLinkTypeChanged(this.props.engagementExtraData)},t.contextTypes={sharingStore:c.object.isRequired,platformDetection:c.object.isRequired},t}(s.Component)}
,function(e,t,n){n.d(t,{a:function(){return _}});var a=n(0),i=n(1),r=n(12),o=n(32),s=n(245),c=n(11),d=n(10),l=n(28),u=n(5),f=n(86),p=n(71),m=n(17),_=function(e){function t(t,n){var a=e.call(this,t)||this;return a.state={selectedRole:a._getSelectedKey(t)},a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props,t=this._getRoleSelectorProps();return i.createElement(s.a,(0,a.a)({},t),!e.canChangePermission&&this._renderInfoIcon())},t.prototype._getRoleSelectorProps=function(){var e=(0,f.c)({clientId:this.props.clientId,sharingStore:this.context.sharingStore,sharingInformation:this.props.sharingInformation,mode:this.props.mode,audience:this.props.selectedPermissions.audience,isPreventDownloadAllowed:this.context.sharingStore.isPreventDownloadAllowed()});if((0,p.c)()&&this.props.sharingInformation.requiresAccessApproval){var t=this.context.sharingStore.getReShareLink(this.props.selectedPermissions.audience),n=this.props.selectedPermissions.sharingRole;t&&(n=(0,m.J)(t,this.props.clientId,this.props.sharingInformation)),e=(0,f.b)({role:n})}var a=this._getSelectedKey(this.props),i=this.props.onRoleChange;return{disabled:!this.props.canChangePermission,menuPermissionOptions:e,sharingRole:a,mode:this.props.mode,clientId:this.props.clientId,ariaLabel:c.se,onRoleChange:i,roleSelectorAs:s.a,showDropdownWithOfficeReview:this.props.showDropdownWithOfficeReview}},t.prototype._getSelectedKey=function(e){var t,n;return(null===(t=e.selectedPermissions)||void 0===t?void 0:t.sharingRole)?e.selectedPermissions.sharingRole:(null===(n=e.selectedPermissions)||void 0===n?void 0:n.isEdit)?o.a.edit:o.a.view},t.prototype._renderInfoIcon=function(){if(!(0,p.c)()||!this.props.sharingInformation.requiresAccessApproval){var e={maxWidth:"320px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},c.fc)}};return i.createElement("div",{className:"od-changePermissions--info","aria-label":c.fc,"aria-haspopup":!0},i.createElement(l.a,{id:"od-changePermissions--tooltip",directionalHint:u.a.topLeftEdge,calloutProps:{gapSpace:0},tooltipProps:e},i.createElement(d.a,{className:"".concat(this.props.canChangePermission?"disabled":""),iconName:"Info","data-is-focusable":!0,"aria-describedby":"od-changePermissions--tooltip"})))}},t.contextTypes={sharingStore:r.object.isRequired},t}(i.Component)}
,,,function(e,t,n){n.d(t,{a:function(){return v}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px;display:flex;align-items:center;width:100%}.od-ExpirationDatePicker-content{border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ExpirationDatePicker-content,.od-ExpirationDatePicker-content-expired{width:100%;align-items:center;display:flex;flex-wrap:wrap}.od-ExpirationDatePicker-content-expired:hover,.od-ExpirationDatePicker-content:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";cursor:pointer}.od-ExpirationDatePicker-content-expired.od-ExpirationDatePicker-content-IE,.od-ExpirationDatePicker-content.od-ExpirationDatePicker-content-IE{flex-wrap:nowrap}.od-ExpirationDatePicker-content .ms-DatePicker,.od-ExpirationDatePicker-content-expired .ms-DatePicker{display:inline-block;margin-bottom:0;padding:0;flex-grow:1}.od-ExpirationDatePicker-content .ms-DatePicker i,.od-ExpirationDatePicker-content-expired .ms-DatePicker i{display:none}.od-ExpirationDatePicker-content .ms-DatePicker.od-DatePicker-IE,.od-ExpirationDatePicker-content-expired .ms-DatePicker.od-DatePicker-IE{flex-grow:1}.od-ExpirationDatePicker-content .ms-TextField-field,.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .ms-TextField-field,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{height:1.75rem;padding:0;align-items:center;display:flex;font-size:.875rem}@supports (font:-apple-system-body){.od-ExpirationDatePicker-content .ms-TextField-field,.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .ms-TextField-field,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{font:-apple-system-body}}.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{padding-right:.25rem}.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{flex-grow:0}.od-ExpirationDatePicker-content .ms-TextField-fieldGroup,.od-ExpirationDatePicker-content-expired .ms-TextField-fieldGroup{background:0 0}.od-ExpirationDatePicker-content .ms-TextField,.od-ExpirationDatePicker-content-expired .ms-TextField{margin-bottom:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker .ms-TextField div,.od-ExpirationDatePicker-content-expired .ms-DatePicker .ms-TextField div{border-color:transparent;padding:0;align-items:center}.od-ExpirationDatePicker-content .ms-Icon,.od-ExpirationDatePicker-content-expired .ms-Icon{font-size:1.25rem;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-ExpirationDatePicker-label{display:inline-block;margin-top:7px;font-size:1rem}[dir=ltr] .od-ExpirationDatePicker-label{margin-right:12px}[dir=rtl] .od-ExpirationDatePicker-label{margin-left:12px}@supports (font:-apple-system-title1){.od-ExpirationDatePicker-label{font:-apple-system-title1}}.od-ExpirationDatePicker-info{display:flex}[dir=ltr] .od-ExpirationDatePicker-info{margin-left:auto}[dir=rtl] .od-ExpirationDatePicker-info{margin-right:auto}.od-ExpirationDatePicker-info .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem}[dir=ltr] .od-ExpirationDatePicker-info .ms-Icon{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker-info .ms-Icon{margin-right:10px}@supports (font:-apple-system-caption1){.od-ExpirationDatePicker-info .ms-Icon{font:-apple-system-caption1}}.od-ExpirationDatePicker-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';cursor:pointer;font-size:1rem;line-height:0;padding:0;height:1rem;outline:transparent;position:relative}[dir=ltr] .od-ExpirationDatePicker-delete{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker-delete{margin-right:10px}.od-ExpirationDatePicker-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-delete:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@supports (font:-apple-system-title1){.od-ExpirationDatePicker-delete{font:-apple-system-title1}}.od-ExpirationDatePicker-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-ExpirationDatePicker-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired .ms-TextField-field{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-premiumGleam{height:.75rem;width:.75rem;margin-top:2px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:'}[dir=ltr] .od-ExpirationDatePicker-premiumGleam{padding-right:5px}[dir=rtl] .od-ExpirationDatePicker-premiumGleam{padding-left:5px}.od-ExpirationDatePicker-tooltipWrapper{outline:transparent;position:relative}.od-ExpirationDatePicker-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{content:"";position:absolute;top:-.125rem;right:-.125rem;bottom:-.125rem;left:-.125rem;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ExpirationDatePicker-infoTooltipContent{font-size:.875rem}@supports (font:-apple-system-body){.od-ExpirationDatePicker-infoTooltipContent{font:-apple-system-body}}@media (inverted-colors){.ms-DatePicker-day-button[aria-selected=true]{outline:.125rem solid}}input[readonly]:focus{border:.0625rem solid #0078d4}@media (forced-colors:active) and (prefers-color-scheme:dark){.od-ExpirationDatePicker-delete:enabled{color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){.od-ExpirationDatePicker-delete:enabled{color:#000!important;forced-color-adjust:none}}"}]);var i=n(56),r=n(546),o=n(10),s=n(17),c=n(11),d=n(1),l=n(28),u=n(5),f=n(7),p=n(12),m=n(100),_=n(20),h=r.a,b={day:"numeric",month:"numeric",year:"numeric"},g={weekday:"long",day:"numeric",month:"short",year:"numeric"},v=function(e){function t(t,n){var a=e.call(this,t)||this;a._dateRemovedStatus=d.createRef(),a._onSelectDateForExpirationPicker=function(e){a._expirationDateRemoved=!1;var t=e<new Date(Date.now());a._focusDatePicker(),a.setState({hasExpired:t,selectedDate:e}),a.props.onSelectDate(e)},a._onDeleteDate=function(){a._expirationDateRemoved=!0,a._datePicker.focus(),a.setState({selectedDate:null},function(){a.props.onSelectDate(null)})},a._formatDate=function(e){return e?(0,m.g)(e,g):""};var i=a.props.value&&a.props.value<new Date(Date.now());a.state={hasExpired:i,selectedDate:a.props.value},a._platformDetection=n.platformDetection;var r=new Date(Date.now());return a._minDate=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),t.expiryRestriction>0?a._maxDate=new Date(r.getFullYear(),r.getMonth(),r.getDate()+t.expiryRestriction,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()):a._maxDate=new Date(r.getFullYear()+2,r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),a._isMobile=a._platformDetection.isMobile||_.f(a.props.clientId),a._datePickerStrings={months:s.U,shortMonths:s.W,days:s.m,shortDays:s.V,goToToday:c.Pd,setExpirationDate:c.vi,nextMonthAriaLabel:c.qe,prevMonthAriaLabel:c.dh,ariaLabel:a._formattedExpirationDateAriaLabel(),pickerAriaLabel:c.nd,closeButtonAriaLabel:a._isMobile&&c._b||"",invalidInputErrorMessage:f.j(c.sd,(0,m.g)(a._minDate,b))},a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props.value,t=e&&this.state.hasExpired,n=this._platformDetection.isIE;return this._datePickerStrings.ariaLabel=this._formattedExpirationDateAriaLabel(),d.createElement("div",{className:"od-ExpirationDatePicker"+(t?" od-ExpirationDatePicker-expired":"")},d.createElement("div",{className:"od-ExpirationDatePicker-label"+(t?" od-ExpirationDatePicker-expired":"")},d.createElement(o.a,{"aria-hidden":"true",iconName:t?"EventDateMissed12":"Calendar"})),d.createElement("div",{className:"od-ExpirationDatePicker-content"+(t?" od-ExpirationDatePicker-content-expired":"")+(n?" od-ExpirationDatePicker-content-IE":"")},this._renderExpiresLabel(),d.createElement(h,{className:n?"od-DatePicker-IE":"",componentRef:this._resolveRef("_datePicker"),strings:this._datePickerStrings,placeholder:f.j(c.gi,(0,m.d)()),isMonthPickerVisible:!1,onSelectDate:this._onSelectDateForExpirationPicker,value:e,formatDate:this._formatDate,minDate:this._minDate,maxDate:this._maxDate,ariaLabel:this._datePickerStrings.ariaLabel,pickerAriaLabel:this._datePickerStrings.pickerAriaLabel,showGoToToday:!1,showCloseButton:this._isMobile,allFocusable:!1,calloutProps:{preventDismissOnScroll:this._isMobile},disableAutoFocus:this.props.disableAutoFocus,tabIndex:this.props.tabIndex,openOnClick:!0,onAfterMenuDismiss:this._focusDatePicker.bind(this),styles:{callout:{fontSize:"0.875rem",selectors:{".ms-DatePicker-header":{height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-monthAndYear":{fontSize:"0.875rem"},".ms-DatePicker-prevMonth":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-nextMonth":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-weekday":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-day":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-day-button":{width:"1.5rem",height:"1.5rem"}}},textField:{fontSize:"0.875rem",height:"1.75rem",selectors:{".ms-TextField-fieldGroup":{height:"1.75rem"},"input::placeholder":{fontSize:"0.875rem"}}},icon:{fontSize:"0.875rem"}},disabled:this.props.disabled}),this._renderExpirationDateRemovedLabel(),this._renderRemoveDateButton()),this._renderPremiumGleam())},t.prototype._renderExpirationDateRemovedLabel=function(){if(this._expirationDateRemoved)return d.createElement("div",{ref:this._dateRemovedStatus,className:"od-Share-screenReaderOnly",tabIndex:-1,role:"alert","aria-live":"assertive","aria-hidden":!0},c.id)},t.prototype._renderExpiresLabel=function(){if(this.props.value){var e="od-ExpirationDate-expiresLabel"+(this._platformDetection.isIE?" od-ExpirationDate-expiresLabelIE":"");return d.createElement("span",{className:e,role:"status","aria-live":"polite"},this.state.hasExpired?c.ud:c.pd)}},t.prototype._renderRemoveDateButton=function(){var e=this.state.selectedDate;if(!this.props.hideRemoveDateButton){if(this.props.expiryRestriction>0){var t=f.j(c.rd,this.props.expiryRestriction),n={maxWidth:"300px",onRenderContent:function(){return d.createElement("div",{className:"od-ExpirationDatePicker-infoTooltipContent"},t)}};return d.createElement("div",{className:"od-ExpirationDatePicker-info","aria-label":t},d.createElement(l.a,{id:"od-ExpirationDatePicker-tooltip-id",hostClassName:"od-ExpirationDatePicker-tooltip",directionalHint:u.a.topCenter,calloutProps:{gapSpace:0},tooltipProps:n},d.createElement("div",{tabIndex:0,className:"od-ExpirationDatePicker-tooltipWrapper",role:"note"},d.createElement(o.a,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))))}return n={onRenderContent:function(){return d.createElement("div",{className:"od-ExpirationDatePicker-infoTooltipContent"},c.Bh)}},d.createElement(l.a,{tooltipProps:n,id:"expirationDateRemovedButton",calloutProps:{gapSpace:0}},d.createElement("button",{className:"od-ExpirationDatePicker-delete",onClick:this._onDeleteDate,disabled:!e,"aria-label":c.Bh},d.createElement(o.a,{iconName:"Cancel","aria-hidden":!0})))}},t.prototype._formattedExpirationDateAriaLabel=function(){return this.state.selectedDate?f.j(c.od,""):c.vi},t.prototype._renderPremiumGleam=function(){if(this.props.showGleam){var e=window.require?window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20240610.001/onedrive-assets/images/gleam.svg";return d.createElement("img",{role:"presentation",src:e,className:"od-ExpirationDatePicker-premiumGleam"})}},t.prototype._focusDatePicker=function(){this._platformDetection.isIE||this._datePicker.focus()},t.contextTypes={platformDetection:p.object.isRequired},t}(i.a)}
,function(e,t,n){n.d(t,{a:function(){return b}});var a=n(0),i=n(4);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PasswordField{margin-top:4px;height:100%;width:100%;display:block}.od-PasswordField .od-PasswordField-passwordFieldLine{display:flex}.od-PasswordField .od-ShareLink-passwordFieldContent{height:2rem;width:100%;border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-PasswordField .od-ShareLink-passwordFieldContent:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-PasswordField .ms-PasswordField .ms-TextField input:-ms-input-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem}.od-PasswordField .ms-PasswordField .ms-TextField input::placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem}.od-PasswordField .ms-TextField{width:100%;display:inline-block;padding:2px;height:1.75rem;min-width:0;cursor:pointer;border-color:transparent}.od-PasswordField .ms-TextField .ms-TextField-fieldGroup{background:0 0}.od-PasswordField .ms-TextField-field{display:inline-block;padding:0;height:1.75rem;min-width:0;width:100%;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-PasswordField-delete{outline:transparent;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:'}.od-PasswordField-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PasswordField-delete:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-PasswordField-label{display:flex;align-items:center;margin-top:7px;font-size:.875rem}[dir=ltr] .od-PasswordField-label{margin-right:12px}[dir=rtl] .od-PasswordField-label{margin-left:12px}.od-PasswordField-cancel{display:inline-block;vertical-align:top;margin-top:1px}.odPasswordField-lastModifiedBy{font-style:italic}.od-PasswordField-shareReminder{display:block;margin-top:3px;font-size:.75rem}[dir=ltr] .od-PasswordField-shareReminder{padding-left:22px}[dir=rtl] .od-PasswordField-shareReminder{padding-right:22px}.od-PasswordField-shareReminder-detailsPane{display:block;margin-top:8px;font-size:.75rem}[dir=ltr] .od-PasswordField-shareReminder-detailsPane{padding-left:36px}[dir=rtl] .od-PasswordField-shareReminder-detailsPane{padding-right:36px}.od-PasswordField-passwordField{display:flex}.od-PermissionsSettings-delete{outline:transparent;position:relative;background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';cursor:pointer;font-size:.875rem;line-height:0;padding:0}.od-PermissionsSettings-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-delete:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}[dir=ltr] .od-PermissionsSettings-delete{margin-left:auto}[dir=rtl] .od-PermissionsSettings-delete{margin-right:auto}.od-PasswordField-premiumGleam{height:.75rem;width:.75rem;margin-top:12px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir=ltr] .od-PasswordField-premiumGleam{padding-right:5px}[dir=rtl] .od-PasswordField-premiumGleam{padding-left:5px}"}]),n(652);var r=n(1);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .od-PasswordStrengthMeter{padding-left:6px}[dir=rtl] .od-PasswordStrengthMeter{padding-right:6px}.od-PasswordStrengthMeter .display-linebreak{white-space:pre-line}.od-PasswordStrengthMeter-StrengthExplanation{font-weight:700}.od-PasswordStrengthMeter-StrengthNotificationText{display:inline}.od-PasswordStrengthMeter-StrengthNotificationText.Weak{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Fair{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Good{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Strong{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-tooltip{font-size:.875rem}.od-PasswordStrengthMeter-StrengthNotificationText-StrengthText{display:inline;font-weight:700}.od-PasswordStrengthMeter-StrengthNotificationBar{width:auto}.od-PasswordStrengthMeter-StrengthNotificationBar.Weak .ms-ProgressIndicator-progressBar{background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Fair .ms-ProgressIndicator-progressBar{background-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Good .ms-ProgressIndicator-progressBar{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Strong .ms-ProgressIndicator-progressBar{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var o=n(547),s=n(28),c=n(7),d=n(11),l=[d.eg,d.tg,d.ng,d.ag,d.ig],u=function(e){function t(t){var n=e.call(this,t)||this;return n._calculatePasswordStrength=n._calculatePasswordStrength.bind(n),n._renderStrengthText=n._renderStrengthText.bind(n),n._renderStrengthBar=n._renderStrengthBar.bind(n),n}return(0,a.d)(t,e),t.prototype.render=function(){var e=this._calculatePasswordStrength(this.props.currentPassword),t=c.j(d.Sc,l[e]);return this.props.getStrengthMeterValue&&this.props.getStrengthMeterValue(l[e]),r.createElement("div",{className:"od-PasswordStrengthMeter"},r.createElement(s.a,{tooltipProps:{maxWidth:"300px",onRenderContent:function(){return r.createElement("div",{className:"od-PasswordStrengthMeter-tooltip"},r.createElement("ul",{style:{margin:0,padding:0}},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthExplanation"},d.Jf," ",r.createElement("br",null)),d.Xf," ",r.createElement("br",null),d.Zf," ",r.createElement("br",null),d.$f))}}},r.createElement("div",{className:"od-PasswordStrengthMeter-test",tabIndex:0,"aria-label":t},this._renderStrengthText(e),this._renderStrengthBar(e))))},t.prototype._renderStrengthText=function(e){var t=l[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText",role:"status","aria-live":"assertive"},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText-StrengthText"},d.Yf),r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText "+t},t))},t.prototype._renderStrengthBar=function(e){var t=l[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationBar "+t,"aria-hidden":!0,role:"presentation"},r.createElement(o.a,{percentComplete:.25*e,barHeight:4,styles:{itemProgress:{height:"0.25rem"},progressBar:{height:"0.25rem"},progressTrack:{height:"0.25rem"}}}))},t.prototype._calculatePasswordStrength=function(e){var t=0;return e.length>8&&t++,/[A-Z]/.test(e)&&/[a-z]/.test(e)&&t++,/\d/.test(e)&&t++,/[^A-Za-z0-9]/g.test(e)&&t++,t},t}(r.Component),f=n(99),p=n(10),m=n(12),_=n(61),h=n(27),b=function(e){function t(t,n){var i=e.call(this,t)||this;return i._currentStrengthMeterValue="",i._topLevelDiv=r.createRef(),i._onUpdatePassword=function(e,t){void 0===t&&(t=""),i._passwordUpdateLogged||(i._passwordUpdateLogged=!0,i._sharingStore.getEngagementHelper().log("ShareV3.passwordUpdated",(0,a.a)({},i.props.engagementExtraData)));var n=t.length>0;i.setState((0,a.a)((0,a.a)({},i.state),{currentPassword:t,displayRemovePasswordButton:n&&i.props.detailsPane}),function(){i.props.onPasswordChange(t)})},i.props.detailsPane?i.state={currentPassword:"************",disablePasswordField:!0,displayRemovePasswordButton:!0,displayNotificationText:!0,hasExistingPassword:!0}:i.state=(0,a.a)((0,a.a)({},i.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,displayNotificationText:!1,hasExistingPassword:!1}),i._renderShareReminder=i._renderShareReminder.bind(i),i._onFocusPasswordFieldDetails=i._onFocusPasswordFieldDetails.bind(i),i._onFocusPasswordField=i._onFocusPasswordField.bind(i),i._onBlurPasswordField=i._onBlurPasswordField.bind(i),i._onDeletePassword=i._onDeletePassword.bind(i),i._getPasswordFieldAriaLabel=i._getPasswordFieldAriaLabel.bind(i),i._getStrengthMeterValue=i._getStrengthMeterValue.bind(i),i._passwordUpdateLogged=!1,i._sharingStore=n.sharingStore,i._resizeTracker=new _.a(n.resize),i}return(0,a.d)(t,e),t.prototype.componentDidUpdate=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDiv)},t.prototype.render=function(){var e=this.props.detailsPane?this._onFocusPasswordFieldDetails:this._onFocusPasswordField,t=this._getPasswordFieldAriaLabel();return r.createElement("div",{ref:this._topLevelDiv,className:"od-PasswordField"},r.createElement("div",{className:"od-PasswordField-passwordFieldLine"},r.createElement("div",{className:"od-PasswordField-label"},r.createElement(p.a,{iconName:"Lock"})),r.createElement("div",{className:"od-ShareLink-passwordFieldContent"},r.createElement(f.a,{type:"password",name:"password",autoComplete:"off","data-automationid":"share_link_password",disabled:this.state.disablePasswordField,placeholder:d.yi,value:this.state.currentPassword,onChange:this._onUpdatePassword,onFocus:e,onBlur:this._onBlurPasswordField,borderless:!0,ariaLabel:t,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,"aria-describedby":"shareReminderText",styles:{field:{fontSize:".875rem",lineHeight:" 1.0625rem",selectors:{"::placeholder":{fontSize:".875rem"}},borderColor:"transparent",border:"none"}}})),this.state.displayRemovePasswordButton&&r.createElement(h.a,{"data-is-focusable":!0,className:"od-PasswordField-delete",iconProps:{iconName:"Cancel"},ariaLabel:d.Vh,onClick:this._onDeletePassword}),this._renderPremiumGleam()),this._renderShareReminder())},t.prototype._renderShareReminder=function(){var e,t="od-PasswordField-shareReminder";return this.props.detailsPane&&(t+="-detailsPane"),this.state.displayNotificationText?this.state.hasExistingPassword?this.props.detailsPane&&this.props.lastModifiedBy&&(e=r.createElement("div",{className:"odPasswordField-lastModifiedBy"},d.qf+this.props.lastModifiedBy)):e=this.state.currentPassword.length>0?r.createElement(u,{currentPassword:this.state.currentPassword,getStrengthMeterValue:this._getStrengthMeterValue}):r.createElement("div",null,d.Qf):e=r.createElement("div",null,""),r.createElement("div",{className:t,id:"shareReminderText"},e)},t.prototype._renderPremiumGleam=function(){if(this.props.showGleam){var e=window.require?window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20240610.001/onedrive-assets/images/gleam.svg";return r.createElement("img",{role:"presentation",src:e,className:"od-PasswordField-premiumGleam"})}},t.prototype._onFocusPasswordFieldDetails=function(){var e=this;this.setState((0,a.a)((0,a.a)({},this.state),{currentPassword:"",displayNotificationText:!0,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})},t.prototype._onFocusPasswordField=function(){this.setState((0,a.a)((0,a.a)({},this.state),{displayNotificationText:!0}))},t.prototype._onBlurPasswordField=function(){this.state.currentPassword.length>0||this.setState((0,a.a)((0,a.a)({},this.state),{displayNotificationText:!1}))},t.prototype._onDeletePassword=function(){var e=this;this.setState((0,a.a)((0,a.a)({},this.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})},t.prototype._getPasswordFieldAriaLabel=function(){return this.state.displayNotificationText?this.state.currentPassword.length>0?c.j(d.Sc,this._currentStrengthMeterValue):this.state.hasExistingPassword&&this.props.detailsPane&&this.props.lastModifiedBy?d.qf+this.props.lastModifiedBy:d.Wf+d.Qf:d.Wf},t.prototype._getStrengthMeterValue=function(e){this._currentStrengthMeterValue=e},t.contextTypes={resize:m.func.isRequired,sharingStore:m.object.isRequired},t}(r.Component)}
,function(e,t,n){n.d(t,{a:function(){return d}});var a=n(0),i=n(1),r=n(244),o=n(10);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PreventDownloadToggle{vertical-align:top;height:100%;display:flex;line-height:2rem}.od-PreventDownloadToggle .ms-Toggle-stateText{margin:0}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-stateText{padding-right:8px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-stateText{padding-left:8px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-stateText{padding-left:12px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-stateText{padding-right:12px}.od-PreventDownloadToggle .ms-Toggle{width:100%;display:flex;justify-content:space-between}.od-PreventDownloadToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{right:30px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{left:30px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{float:left}.od-PreventDownloadToggle .ms-Toggle-label{padding:0;display:inline-flex;font-size:.875rem;cursor:pointer;align-self:center;margin:0 4px 0 12px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-PreventDownloadToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:400}.od-PreventDownloadToggle .ms-Toggle-innerContainer{line-height:2rem;align-items:center}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:left}.od-preventDownload-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';cursor:pointer;font-size:.75rem}[dir=ltr] .od-preventDownload-tooltip .ms-Icon{margin-left:10px}[dir=rtl] .od-preventDownload-tooltip .ms-Icon{margin-right:10px}.od-preventDownload-tooltipContent{font-size:.875rem}.od-PreventDownloadToggle-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:flex}.od-preventDownload-tooltipWrapper{outline:transparent;position:relative}.od-preventDownload-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-preventDownload-tooltipWrapper:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-preventDownload-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var s=n(11),c=(n(28),n(5),n(7),n(12)),d=function(e){function t(t,n){var a=e.call(this,t)||this;return a.state={preventDownloadToggle:!1},a._onChanged=a._onChanged.bind(a),a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props.disablePreventDownload,t=this.props.isToggled,n=s.ph;this.props.detailsPane&&(t=!0);var a=i.createElement("div",{className:"od-PreventDownloadToggle-label"},s.ph,null);return i.createElement("div",{className:"od-PreventDownloadToggle"},i.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload-Icon"},i.createElement(o.a,{iconName:"BlockDownloadIcon",alt:s.Nd})),i.createElement(r.a,{checked:t,disabled:e,"aria-disabled":e,className:t?"isToggled":"",label:a,ariaLabel:n,onChanged:this._onChanged,role:"switch",styles:{label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}},onText:s.Vj,offText:s.jj}),null)},t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("PreventDownload.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode}),this.setState({preventDownloadToggle:e},function(){t.props.onToggleChange(e)})},t.contextTypes={sharingStore:c.object.isRequired},t}(i.Component)}
,function(e,t,n){n.d(t,{a:function(){return re},b:function(){return oe}});var a=n(0),i=n(4);(0,i.b)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ShareMain.wide{min-width:480px}@media (max-width:480px){.od-ShareMain.wide{min-width:320px}}.od-ShareMain-section{padding:16px 16px 0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:12px}.od-ShareMain-section.new{padding:24px;padding-top:14px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.separator-top{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}.od-ShareMain-section.od-ShareMain-SharedWith{align-self:stretch;padding-bottom:20px;height:2.25rem}.od-ShareMain-section .od-ShareMain-ShareHint.animation{animation:highlight 2s ease-in-out}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-targets-newPadding{clear:both;padding:10px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:flex!important;align-items:center;justify-content:flex-start;padding:0 16px!important;width:100%;height:44px!important;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer!important;border:none!important;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:'!important;font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}@media screen and (-ms-high-contrast:active){.od-ShareMain-footer:focus,.od-ShareMain-footer:hover{outline:2px solid}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-ShareMain-section-body{margin-bottom:0}}.od-ShareMain-copyLink.shareType-section{display:flex;align-items:center;justify-content:space-between}[dir=ltr] .od-ShareMain-Header-backBtnAdjust{margin-left:16px}[dir=rtl] .od-ShareMain-Header-backBtnAdjust{margin-right:16px}@keyframes highlight{from{background:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}35%{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}to{background:0 0}}"}]);var r=n(51),o=n(29),s=n(39),c=n(93),d=n(95),l=n(69),u=n(31),f=n(164);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-method{display:flex;justify-content:space-between;align-items:center}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:.375rem 0;font-size:.875rem;font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir=ltr] .od-SendLink-emailButtons-allCaps{float:right}[dir=rtl] .od-SendLink-emailButtons-allCaps{float:left}[dir=ltr] div.od-SendLink-emailButtons-left{text-align:right}[dir=rtl] div.od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}[dir=ltr] .od-SendLink-emailButtons-roleSelector{float:right}[dir=rtl] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:4.0625rem;padding-bottom:30px;font-size:.75rem}[dir=ltr] .od-SendLink-email .ms-TextField-field{padding-left:0}[dir=rtl] .od-SendLink-email .ms-TextField-field{padding-right:0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:.875rem;height:2rem;width:100%}@supports (font:-apple-system-footnote){.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-sendContainer{justify-content:flex-end}.od-SendLink-characterCounter{font-size:.75rem}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:flex;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;flex-grow:2;width:100%}.SendLink-statusIconContainer{height:100%;margin-bottom:0;font-size:.625rem}[dir=ltr] .SendLink-statusIconContainer{margin-left:4px}[dir=rtl] .SendLink-statusIconContainer{margin-right:4px}[dir=ltr] .SendLink-statusIconContainer{margin-right:4px}[dir=rtl] .SendLink-statusIconContainer{margin-left:4px}.SendLink-statusIconContainer .ms-Icon{background-color:transparent;position:relative}.SendLink-statusIconContainer .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}"}]);var p=n(99),m=n(73),_=n(1),h=n(12),b=n(133),g=n(241),v=n(178),y=n(11),S=n(17),D=n(42),I=n(80),x=n(20),C=n(61),O=n(86),w=n(249);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item.new{margin:0}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:3rem;margin-bottom:8px;width:3rem}.od-ShareTargets-itemImage.new{height:2rem;width:2rem;margin-bottom:0;display:flex;align-items:center;justify-content:center}.od-ShareTargets-icon{font-size:1.625rem;padding-top:.6875rem}.od-ShareTargets-icon.new{padding:0;height:24px;width:24px;font-size:24px}.od-ShareTargets-itemImage--border{border:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font:-apple-system-short-caption2;font-size:.625rem}.od-ShareTargets-target{outline:transparent;position:relative;background:0 0;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareTargets-target.new{padding:0 8px 0 0}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:.0625rem solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:.125rem solid highlight}}"}]);var E=n(328),A=n(10),L=n(28),k=n(5),M=n(71);function P(e,t){var i=this,r=_.useState({showCoachmark:!1,teachingBubbleCampaigns:void 0}),o=r[0],s=r[1],c=_.lazy(function(){return(0,a.b)(i,void 0,void 0,function(){return(0,a.e)(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){return setTimeout(t,e.delayTimeInMilliseconds)})];case 1:return t.sent(),[2,n.e(21).then(n.bind(n,619))]}})})});return _.useEffect(function(){var n=setTimeout(function(){return(0,a.b)(i,void 0,void 0,function(){return(0,a.e)(this,function(e){return Promise.all([t.loadTeachingBubbleCampaigns(),t.shouldTeachingBubbleBeShown(t.campaignKey)]).then(function(e){var t=e[0],n=e[1];s({teachingBubbleCampaigns:t,showCoachmark:n})}),[2]})})},e.delayTimeInMilliseconds);return function(){return clearTimeout(n)}},[s]),o.showCoachmark&&o.teachingBubbleCampaigns&&_.createElement(_.Suspense,{fallback:_.createElement(_.Fragment,null)},_.createElement(c,{componentRef:e.componentRef,delayTimeInMilliseconds:e.delayTimeInMilliseconds,target:e.target,teachingBubbleCampaign:o.teachingBubbleCampaigns[t.campaignKey],dismissCallback:function(){t.markTeachingBubbleAsDismissed(t.campaignKey),s({showCoachmark:!1,teachingBubbleCampaigns:void 0})},onTeachingBubbleSeen:e.onTeachingBubbleSeen,onPrimaryButtonClicked:e.onPrimaryButtonClicked}))}P.contextTypes={shouldTeachingBubbleBeShown:h.func,markTeachingBubbleAsDismissed:h.func,loadTeachingBubbleCampaigns:h.func,campaignKey:h.number};var T=n(55),U=n(112),F=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),H=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg"),R=function(e){function t(t){var n=e.call(this,t)||this;return n._shareToTeamsExperiment=M.e(),n._shareToTeamsCoachmarkTarget=_.createRef(),n._coachmarkRef=_.createRef(),n._showTeams=!1,n.state={areTargetsReady:!1},n}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){var e=this;this._shareToTeamsExperiment&&this.context.canUseTeams().then(function(t){e._showTeams=t,e.setState({areTargetsReady:!0})})},t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.a.existing&&this.props.currentSettings.audience!==o.a.anyone&&this.props.currentSettings.audience!==o.a.organization;return this._shareToTeamsExperiment?(this._shareTargetsData=this.state.areTargetsReady&&this._getShareTargetsData(),e?_.createElement(L.a,{content:y.i,calloutProps:{calloutWidth:300,directionalHint:k.a.topCenter}},_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Mf},this.state.areTargetsReady&&this._renderTargets())):_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Mf},this.state.areTargetsReady&&this._renderTargets())):(this._shareTargetsData=this._getShareTargetsData(),e?_.createElement(L.a,{content:y.i,calloutProps:{calloutWidth:300,directionalHint:k.a.topCenter}},_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Mf},this._renderTargets())):_.createElement("ul",{className:"od-ShareTargets-items","aria-label":y.Mf},this._renderTargets()))},t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.a.existing&&this.props.currentSettings.audience!==o.a.anyone&&this.props.currentSettings.audience!==o.a.organization,n=this.props.sharingInformation.blockPeoplePickerAndSharing&&this.props.currentSettings.audience!==o.a.existing,a=0,i=this._shareTargetsData;a<i.length;a++){var r,s=i[a],c=s.icon,l=c.split(":",2)[1],u=t||n||(0,S.S)(this.props.sharingInformation),f="od-ShareTargets-icon ".concat(u?"od-ShareTargets-disabled":""," new");"od-ShareTargets-itemText ms-font-xs ".concat(u?"od-ShareTargets-disabled":""),r=c.indexOf("font:")>-1?_.createElement(A.a,{iconName:l,className:f}):_.createElement("img",{src:c,className:f}),e.push(_.createElement("li",{key:s.shareType,className:"od-ShareTargets-item new"},_.createElement(L.a,{content:s.label,styles:{root:{display:"inline-block"}}},_.createElement("button",{className:"od-ShareTargets-target new","aria-label":s.label,disabled:u,onClick:s.action,id:s.id,ref:s.shareType===d.a.webShareToTeams?this._shareToTeamsCoachmarkTarget:null},s.shareType===d.a.webShareToTeams?this._renderCoachmark():_.createElement(_.Fragment,null),_.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage new"},r)))))}return e},t.prototype._renderCoachmark=function(){return _.createElement(P,{componentRef:this._coachmarkRef,delayTimeInMilliseconds:200,target:this._shareToTeamsCoachmarkTarget,onTeachingBubbleSeen:this.context.onTeachingBubbleSeen(this.context.campaignKey),onPrimaryButtonClicked:this._onClick.bind(this,d.a.webShareToTeams)})},t.prototype._getShareTargetsData=function(){var e=[],t=this._determineMailShareTarget(this.props.clientId);if((0,U.a)()&&window.sessionStorage.setItem("outlookAvailability",t.toString()),t===E.a.available){var n=x.f(this.props.clientId)?"font:OutlookLogo":F,a="".concat(y.Li," ").concat(y.Pf);e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:d.a.outlook,action:this._onClick.bind(this,d.a.outlook),id:"od-ShareTarget-outlookButton"})}else t===E.a.other&&(a="".concat(y.Li," ").concat(y.nf),e.push({label:a,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:d.a.nonOutlook,action:this._onClick.bind(this,d.a.nonOutlook),id:"od-ShareTarget-nonOutlookButton"}));return(0,T.m)()?(a="".concat(y.Li," ").concat(y.Nj),e.push({label:a,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:d.a.mobileShareToTeams,action:this._onClick.bind(this,d.a.mobileShareToTeams),id:"od-ShareTarget-mobileTeamsButton"})):this.props.fullscreenIframeMode&&this._shareToTeamsExperiment&&!this.context.platformDetection.isIE&&this._showTeams&&(n=H,a="".concat(y.Li," ").concat(y.Nj),e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:d.a.webShareToTeams,action:this._onClick.bind(this,d.a.webShareToTeams),id:"od-ShareTarget-webTeamsButton"})),(0,T.j)()&&(a="".concat(y.Li," ").concat(y.Pe),e.push({label:a,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:d.a.moreApps,action:this._onClick.bind(this,d.a.moreApps),id:"od-ShareTarget-moreAppsButton"})),e},t.prototype._onClick=function(e){var t;e===d.a.webShareToTeams&&(null===(t=this._coachmarkRef.current)||void 0===t||t.dismiss()),this.props.onShareTargetClicked(e)},t.prototype._determineMailShareTarget=function(e){return x.q(this.props.clientId)&&this.props.outlookAvailability===E.a.available?E.a.available:(0,T.d)()},t.contextTypes={platformDetection:h.object.isRequired,shouldTeachingBubbleBeShown:h.func,onTeachingBubbleSeen:h.func,markTeachingBubbleAsDismissed:h.func,campaignKey:h.number,canUseTeams:h.func},t}(_.Component);(0,i.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SummaryBox-header-Area{display:flex;justify-content:space-between;align-items:center;min-height:24px}.od-SummaryBox-header-TextField{display:flex;font-weight:600;font-size:.625rem;align-self:center}.od-SummaryBox-summary-Main{margin:auto;padding-top:0}.od-SummaryBox-header-sparkle{height:15%;width:15%;align-self:center}[dir=ltr] .od-SummaryBox-header-sparkle{margin-right:3px}[dir=rtl] .od-SummaryBox-header-sparkle{margin-left:3px}.od-Summary-tooltipIcon{vertical-align:middle}[dir=ltr] .od-Summary-tooltipIcon{margin-left:calc(50% - 5px + 5px)}[dir=rtl] .od-Summary-tooltipIcon{margin-right:calc(50% - 5px + 5px)}.od-SummaryBox-buttonsContainer{display:flex}.od-SummaryBox-header-closeButton{height:16px;width:16px}.od-SummaryBox-header-closeButtonIcon{font-size:.625rem}.od-SummaryBox-summary-Main::-webkit-scrollbar{width:5px;height:27px}.od-SummaryBox-summary-Main::-webkit-scrollbar-thumb{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:38px}.od-SummaryBox-summary-Main::-webkit-scrollbar-track{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:38px}.od-SummaryBox-footer-CharacterCount{text-align:right;font-size:.625rem;margin-top:5px;align-self:center}"}]);var N=n(27),B=n(551),j=function(e){var t,n=e.summaryText,a=e.onSave,i=e.renderSeparator,r=(0,_.useState)(!1),o=r[0],s=r[1],c=(0,_.useState)(n),d=c[0],l=c[1],u=(0,_.useState)(!1),f=u[0],m=u[1],h="(".concat(d.length,"/").concat(500,")");return _.createElement(_.Fragment,null,!o&&_.createElement(_.Fragment,null,i&&_.createElement(B.a,null),_.createElement("div",{className:"od-SummaryBox-Entire"},_.createElement("div",{className:"od-SummaryBox-header-Area"},_.createElement("div",{className:"od-SummaryBox-header-TextField"},(t=window.require.toUrl("odsp-media/images/photostream/sparklepreviewcolor.svg"),_.createElement("img",{role:"presentation",src:t,className:"od-SummaryBox-header-sparkle"})),y.Pi,_.createElement(L.a,{content:y.Ti},_.createElement(A.a,{iconName:"Error",className:"od-Summary-tooltipIcon"}))),_.createElement(N.a,{className:"od-SummaryBox-header-closeButton",onClick:function(){s(!0),a("")},iconProps:{iconName:"Cancel",className:"od-SummaryBox-header-closeButtonIcon"},title:y.Rh})),_.createElement("div",{className:"od-SummaryBox-summary-TextArea"},_.createElement(p.a,{className:"od-SummaryBox-summary-Main",borderless:!0,ariaLabel:y.ki,placeholder:y.Mi,defaultValue:d,value:d,styles:{fieldGroup:{border:"none",borderRadius:"0px"}},multiline:!0,resizable:!1,onChange:function(e,t){l(t||""),m(!0)},onBlur:function(){f&&(a(d),m(!1))}}),d.length>250&&_.createElement("div",{className:"od-SummaryBox-footer-CharacterCount"},h)))))};j.propTypes={summaryText:h.string.isRequired,onSave:h.func.isRequired};var V,z=j,G=function(e){function t(t,n){var i=e.call(this,t)||this;return i._topLevelDivRef=_.createRef(),i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=(0,S.r)(e);return i.setState((0,a.a)((0,a.a)({},i.state),{messageLength:t})),""},i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=(0,S.r)(e);return i.setState((0,a.a)((0,a.a)({},i.state),{subjectLength:t})),e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength},i._onResolvedSuggestions=function(e){return i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e),e},i._onSendLinkClicked=function(e,t){if(i.props.summaryText){var n=(0,a.a)((0,a.a)({},i.props.engagementExtraData),{summaryTextRemoved:""===i.state.summaryContent,summaryTextEdited:""!==i.state.summaryContent&&i.state.summaryContent!==i.props.summaryText,summaryTextFailed:!!i.props.summaryText&&-1!==i.props.summaryText.indexOf("Something went wrong with retrieving a summary")});i.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked.WithSummary",n)}i.props.onSendLinkClicked(e,t)},i._platformDetection=n.platformDetection,i.state={messageLength:0,summaryContent:i.props.summaryText,subjectLength:0},i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i),i._resizeTracker=new C.a(n.resize),i}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){m.h({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:(0,S.g)(e.sharingInformation)?e.onShareHintClick:void 0,permissionsMap:e.permissionsMap}),this.setState((0,a.a)({},this.state))},t.prototype.componentDidMount=function(){this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e){this._resizeIfNeeded(),e.summaryText!==this.props.summaryText&&this.props.showItemInsights&&this.props.summaryText&&this.updateSummaryContent(this.props.summaryText)},t.prototype.render=function(){var e=this.props,t=e.currentSettings,n=e.linkRecipients,a=m.c(n),i=m.d(n,e.groupsMemberCount),r=this._platformDetection.isIOS||x.e(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||x.b(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";r+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var o=_.createElement(R,{fullscreenIframeMode:this.props.fullscreenIframeMode,clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this.props.onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}),s=this.props.showSendButton?_.createElement("div",{className:r},_.createElement(g.a,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:""===this.props.summaryText?this.props.messageText:this.props.messageText+"\n"+this.state.summaryContent,subjectText:this.props.subjectText,onSendLinkClicked:this._onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:v.a.button,sharingInformation:this.props.sharingInformation})):"",c=e.isLoadingDefaultRecipients?_.createElement("div",null,_.createElement(D.a,{className:"od-SendLink-spinner",label:y.ve,size:I.a.small})):_.createElement(b.a,{defaultSelectedItems:n,error:e.errorMessage,onChange:e.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:a,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:e.clientId,onInputChange:e.onPeoplePickerInputChange||null,renderRoleSelector:this._shouldRenderRoleSelector(),roleSelectorProps:this._getRoleSelectorProps()});return _.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},_.createElement("div",{className:"od-SendLink-email"},_.createElement("div",{className:"od-SendLink-peoplePicker"},c),_.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),_.createElement("div",{className:"od-SendLink-method"},o,s))))},t.prototype._shouldRenderRoleSelector=function(){return this.props.currentSettings.audience!==o.a.existing},t.prototype._getRoleSelectorProps=function(){var e=(0,S.S)(this.props.sharingInformation),t=(0,O.c)({clientId:this.props.clientId,sharingStore:this.context.sharingStore,sharingInformation:this.props.sharingInformation,audience:this.props.currentSettings.audience,mode:u.a.share,isPreventDownloadAllowed:this.context.sharingStore.isPreventDownloadAllowed()}),n=(0,O.j)(this.props.currentSettings.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension);return{shimmer:e,menuPermissionOptions:t,sharingRole:this.props.currentSettings.sharingRole,mode:u.a.share,clientId:this.props.clientId,ariaLabel:y.se,showStopSharing:!1,onRoleChange:this.props.onRoleChange,showLinkSettings:!0,onLinkSettingsClicked:this.props.onLinkSettingsClicked,currentSettings:this.props.currentSettings,roleSelectorAs:w.a,showDropdownWithOfficeReview:n}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData),this.props.onManageExistingAccessClick()},t.prototype.updateSummaryContent=function(e){this.setState({summaryContent:e})},t.prototype._renderTextArea=function(){var e=this;if(this.props.showTextArea){var t=this.props.showItemInsights&&!!this.props.summaryText,n=this.props.summaryText;return _.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&_.createElement(p.a,{borderless:!0,underlined:!0,placeholder:y.Uj,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),_.createElement(p.a,{borderless:!0,placeholder:y.we,ariaLabel:y.Oe,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}),t&&_.createElement(z,{summaryText:n,onSave:function(t){n=t,e.updateSummaryContent(t)},renderSeparator:!0}))}},t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t=e>this.props.maximumMessageLength,n="od-SendLink-characterCounter ".concat(t?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return t?_.createElement("div",{className:"od-SendLink-characterCounterWrapper"},_.createElement("span",{"aria-label":y.Nb,role:"alert",className:n},e,"/",this.props.maximumMessageLength)):_.createElement("div",{className:"od-SendLink-characterCounterWrapper"},_.createElement("span",{className:n},e,"/",this.props.maximumMessageLength))},t.contextTypes={platformDetection:h.object.isRequired,sharingStore:h.object.isRequired,resize:h.func.isRequired},t}(_.Component),K=n(236),W=n(539);!function(e){e.getAttachAsCopyOptions=function(e,t,n,a,i,r){var o=[],s=function(e,t,n,a,i){var r=n.name.split("."),o="";if(r.length>1&&(o=r[1].toLowerCase()),(0,T.k)()||i){var s=function(){!function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t),(0,T.u)()}(e,a)};return x.n(t)||function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1}(o)?{key:"word",name:y.dk,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:s}:x.k(t)||function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1}(o)?{key:"powerpoint",name:y.ch,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:s}:x.d(t)||function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1}(o)?{key:"excel",name:y.ed,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:s}:x.m(t)||function(e){return["vsd","vsdx"].indexOf(e)>-1}(o)?{key:"visio",name:y.sk,iconProps:{iconName:"VisioLogo"},onClick:s}:{key:"document",name:y.Gc,iconProps:{iconName:"Document"},onClick:s}}}(n,e,t,a,i);s&&o.push(s);var c=function(e,t,n){if((0,T.l)()||n)return{key:"pdf",name:y.cg,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){!function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t),(0,T.w)()}(e,t)}}}(n,a,r);return c&&o.push(c),o}}(V||(V={}));var q=V,Q=n(120),Y=n(50),J=n(237),X=n(66),Z=n(24),$=n(114),ee=n(176),te=n(365),ne=n(88),ae=n(651),ie=n(44),re=500,oe=function(e){function t(t,n){var a=e.call(this,t)||this;return a._peoplePickerHasUnresolvedText=!1,a._onSharedWithClicked=function(){a.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(a._engagementExtraData),a.props.onShowPermissionsListClicked()},a._onConfirmationExternalSharingApply=function(){a.setState({showConfirmationDialog:!1,showShareHintAnimation:!0},function(){a.props.onAudienceChange(o.a.specificPeopleFlex,s.a.flexible,c.a.specificPeople)})},a._onConfirmationExternalSharingCancel=function(){a.setState({showConfirmationDialog:!1})},a._onSelectedPeopleChange=function(e){var t=a.props,n=void 0;(0,S.g)(t.sharingInformation)&&(n=t.onShareHintClick,Z.y()&&(n=t.onShareHintClick.bind(a,$.b.PeoplePickerErrorLinkSettingsHint)));var i=m.h({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:n,permissionsMap:t.permissionsMap,audience:t.currentSettings.audience,scope:t.currentSettings.sharingScope}),r=!1,o=!1,s=null;if(i){for(var d=t.currentSettings.sharingScope===c.a.organization,l=0,u=e;l<u.length;l++){var f=u[l];if(f.isExternal&&d){r=!0,M.b()&&(o=!0,s=f);break}}r&&a.context.sharingStore.getEngagementHelper().externalSharingCslError(a._engagementExtraData)}a.setState({peoplePickerErrorMessage:i,showConfirmationDialog:o,externalSharingPerson:s},function(){t.onSelectedPeopleChange(e)})},a._onPeoplePickerInputChange=function(e){a._peoplePickerHasUnresolvedText=""!==e},a._onShareTargetClicked=function(e,t){(a.context.sharingStore.isConsumer()&&a.props.currentSettings.audience!==o.a.specificPeople||a._isPeoplePickerValid(e)||!(a.props.currentSettings.audience===o.a.specificPeopleFlex||a.props.currentSettings.audience===o.a.specificPeople||a.props.linkRecipients.length>0))&&a.setState({showActivityIndicator:!0,shareType:e},function(){a.props.onShareTargetClicked(e,t)})},a._onCopyLinkSectionCopyButtonClicked=function(){a.context.sharingStore.getEngagementHelper().log("ShareV3.copyLinkSectionCopyButtonClicked",a.props.engagementExtraData),a._onShareTargetClicked(d.a.copy,!0)},a._onSendLinkClicked=function(e,t){a.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",a.props.engagementExtraData),a._isPeoplePickerValid(d.a.share)&&a.setState({showActivityIndicator:!0,shareType:d.a.share},function(){a.props.onSendLinkClicked(e,t)})},a._onAttachAsCopyClicked=function(){var e=a.props.clientId;if(a.context.sharingStore.getEngagementHelper().sendACopyClicked(a._engagementExtraData),x.h(e)){var t=!a.state.isAttachAsCopyContextualMenuVisible;a.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===l.a.ngsc||x.f(e))try{window.external.SendCopy()}catch(e){}},a._shareClickTime=n.shareClickTime,a._engagementExtraData=t.engagementExtraData,a._sharingClientMessenger=n.sharingClientMessenger,a._dismiss=n.onDismiss,a.state={isAttachAsCopyContextualMenuVisible:!1,shareType:d.a.share,showActivityIndicator:!1,peoplePickerErrorMessage:null,showConfirmationDialog:!1,externalSharingPerson:null,showShareHintAnimation:!1},a}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():T.r(this._shareClickTime,this.props.clientId,u.a.share,this.props.scenarioId,this.props.correlationId),this._updatePeoplePickerError(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)},t.prototype.render=function(){var e=this.props,t=this.state.showActivityIndicator?this._getActivityMessage():"",n=this._renderFooter();return _.createElement("div",{className:"od-ShareMain ".concat(this.state.showActivityIndicator?" blocker":"")},_.createElement("div",{className:"od-ShareMain-section new"},this._renderHeader(),_.createElement("div",{className:"od-ShareMain-ShareHint ".concat(this.state.showShareHintAnimation?"animation":"")},_.createElement(W.a,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:e.onShareHintClick.bind(this,$.b.MainLinkSettingsHint),sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig})),this._renderSendLink(),this.props.shouldWaitForSharingInfoBarInformation&&this._renderSharingInfoBar()),this._renderCopyLinkSection(!0),this._renderSharedWith(),n,this._renderActivityIndicator(),this._renderConfirmationDialogExternalSharing(),X.a(t,"assertive","alert",!0))},t.prototype._getHeaderActions=function(){var e,t,n,a=this;return(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:x.p(this.props.clientId))&&_.createElement(ie.a,{className:"ShareMain-close",iconProps:{iconName:"Clear"},ariaLabel:y.Vb,onClick:function(e){e.stopPropagation(),e.preventDefault(),a._dismiss()},tooltipContent:y.Vb,directionalHint:k.a.bottomAutoEdge})},t.prototype._renderHeader=function(){var e;return _.createElement(r.a,{actions:this._getHeaderActions(),mainHeaderText:y.Oi,subHeaderText:null===(e=this.props.item)||void 0===e?void 0:e.name,renderBackButton:this.props.hasBackButton,onBackButtonClicked:this.props.onBackButtonClicked})},t.prototype._renderSharingInfoBar=function(){return _.createElement(_.Suspense,{fallback:_.createElement(D.a,null)},_.createElement(ae.c,{sharingInfoBarMessageTypeId:this.props.sharingInfoBarMessageTypeId,parentCssClass:"ShareMain"}))},t.prototype._renderCopyLinkSection=function(e){return _.createElement(_.Fragment,null,_.createElement(ee.a,null),_.createElement(te.a,{singleComponent:!1,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked}))},t.prototype._renderFooter=function(){var e,t,n=this.props,a=n.clientId,i=null===(e=n.hostOptions)||void 0===e?void 0:e.isSendCopyEnabled,r=null===(t=n.hostOptions)||void 0===t?void 0:t.isSendPdfEnabled;if(x.h(a)){var o=q.getAttachAsCopyOptions(a,n.item,this.context.sharingStore,this._engagementExtraData,i,r);if(1===o.length&&"pdf"!==o[0].key)return _.createElement("div",null,_.createElement("button",{className:"od-ShareMain-footer",onClick:o[0].onClick},_.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},_.createElement(A.a,{iconName:"Copy"})),_.createElement("span",null,y.cb)));if(o.length>0)return _.createElement("div",null,_.createElement(Y.a,{className:"od-ShareMain-footer",text:y.cb,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:o},styles:{label:{marginLeft:"0px"}}}))}else if((a===l.a.ngsc||x.f(a))&&this._isSendCopyEnabled())return _.createElement("div",null,_.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},_.createElement("div",{className:"od-ShareMain-attachIcon"},_.createElement(A.a,{iconName:"Copy"})),_.createElement("span",null,y.cb)))},t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||(0,S.S)(this.props.sharingInformation)){var e=this.props;return _.createElement(G,{fullscreenIframeMode:this.props.fullScreenIframeMode,ctaLabel:y.pi,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,summaryText:e.summaryText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:re,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this._engagementExtraData,onShareHintClick:this.props.onShareHintClick,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:e.onShareHintClick.bind(this,$.b.RoleSelector),onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,showItemInsights:this.props.showItemInsights})}},t.prototype._renderSharedWith=function(){var e=(0,S.G)(this.props.sharingInformation,this.context.sharingStore.isConsumer()),t=e.shared,n=e.activeLinks,a=e.sharingPrincipals;return t?_.createElement("div",{className:"od-ShareMain-section od-ShareMain-SharedWith new separator-top"},_.createElement(K.a,{ariaLabel:y.De,label:y.Fi,getPhotoUrl:(0,J.b)(this.props.sharingInformation.webUrl),onClick:this._onSharedWithClicked,sharingLinks:n,sharingPrincipals:a})):null},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return _.createElement(Q.a,{message:this._getActivityMessage(),ariaHidden:!0})},t.prototype._renderConfirmationDialogExternalSharing=function(){if(!M.b()||!this.state.showConfirmationDialog||!this.state.externalSharingPerson)return null;var e=this.state.externalSharingPerson;return _.createElement(_.Suspense,{fallback:_.createElement(D.a,null)},_.createElement(ae.b,{confirmationCode:ne.a.shareDialogExternalSharing,participant:e,onApply:this._onConfirmationExternalSharingApply,onCancel:this._onConfirmationExternalSharingCancel}))},t.prototype._getActivityMessage=function(){switch(this.state.shareType){case d.a.share:return y.s;case d.a.mobileShareToTeams:case d.a.webShareToTeams:return y.q;case d.a.outlook:return y.p;case d.a.copy:case d.a.nonOutlook:case d.a.moreApps:default:return y.r}},t.prototype._isSendCopyEnabled=function(){return T.k()},t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==d.a.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===o.a.specificPeople){for(var t=!1,n=!1,a=0,i=this.props.linkRecipients;a<i.length;a++){var r=i[a];t||(t=r.isExternal&&!r.providerName),n||(n=!r.isExternal||r.isExternal&&!!r.providerName)}if(t&&n)return this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Ee)}),!1}var s=this.props.currentSettings.audience===o.a.specificPeopleFlex||this.props.currentSettings.audience===o.a.specificPeople||e===d.a.share;return this._peoplePickerHasUnresolvedText?(this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Yj)}),!1):0!==this.props.linkRecipients.length||!s||(this.setState({peoplePickerErrorMessage:_.createElement("span",{role:"alert","aria-live":"assertive"},y.Hh)}),!1)}},t.prototype._updatePeoplePickerError=function(e){var t=void 0;if((0,S.g)(e.sharingInformation)&&(t=e.onShareHintClick,Z.y()&&(t=e.onShareHintClick.bind(this,$.b.PeoplePickerErrorLinkSettingsHint))),e.linkRecipients||e.sharingInformation.errorCategory==f.a.shareLink){var n=m.h({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:t,permissionsMap:e.permissionsMap,audience:e.currentSettings.audience,scope:e.currentSettings.sharingScope});n||e.sharingInformation.errorCategory!=f.a.shareLink||(n=_.createElement("span",null,e.sharingInformation.errorMessage)),this.setState({peoplePickerErrorMessage:n,showActivityIndicator:!n&&this.state.showActivityIndicator})}},t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})},t.contextTypes={shareClickTime:h.number,sharingStore:h.object.isRequired,sharingClientMessenger:h.object,onDismiss:h.func.isRequired},t}(_.Component)}
,function(e,t,n){n.d(t,{a:function(){return l}});var a=n(0),i=n(1),r=n(247),o=n(248),s=n(57),c=n(50),d=n(11);(0,n(4).b)([{rawString:".od-StopSharingDialog .ms-Dialog-main{border-radius:4px}.od-StopSharingDialog .ms-Dialog-action button{border-radius:4px}"}]);var l=function(e){function t(t){return e.call(this,t)||this}return(0,a.d)(t,e),t.prototype.render=function(){return i.createElement(r.a,{onDismiss:this.props.onDismiss,hidden:!this.props.showStopSharingDialog,dialogContentProps:this.props.dialogContentProps,modalProps:{className:"od-StopSharingDialog"}},i.createElement(o.a,null,i.createElement(s.a,{onClick:this.props.stopSharing,text:this.props.primaryButtonText,autoFocus:!0}),i.createElement(c.a,{onClick:this.props.onDismiss,text:d.Tb})))},t}(i.PureComponent)}
,function(e,t,n){n.d(t,{b:function(){return me},a:function(){return F}});var a=n(0),i=(n(652),n(292),n(1)),r=n(12),o=n(11),s=n(180),c=n(29),d=n(39),l=n(32),u=n(93),f=n(27),p=n(50),m=n(99),_=n(82),h=n(240),b=n(250),g=n(377),v=n(10),y=n(168),S=n(4);(0,S.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}"}]);var D=n(77),I=n(5),x=n(78),C=n(43),O=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onShowCallout=function(){i.setState((0,a.a)((0,a.a)({},i.state),{isCalloutVisible:!0}))},i._onDismissCallout=function(){i.setState((0,a.a)((0,a.a)({},i.state),{isCalloutVisible:!1}))},i.state={isCalloutVisible:!1},i._uniqueId="j".concat(Math.random().toString().replace(".","")),i}return(0,a.d)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return i.createElement("div",{className:"od-LinkMember"},i.createElement(x.a,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:C.a.blue,size:C.c.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&i.createElement(D.a,{directionalHint:I.a.topCenter,onDismiss:this._onDismissCallout,target:"#".concat(this._uniqueId," "),setInitialFocus:!0},i.createElement("div",{className:"od-LinkMember-tooltip"},i.createElement("span",null,e.primaryText))))},t}(i.Component),w=n(17),E=n(88),A=n(108),L=n(7),k=n(24),M=n(143),P=function(e){function t(t,n){var r=e.call(this,t)||this;return r._onCancel=function(){r.setState(function(){return(0,a.a)((0,a.a)({},r.state),{showDetailsPanel:!1,showConfirmationDialog:!1,participants:r.state.participants,hasPeopleChange:!1})},r._focusToDeleteButton)},r._onConfirmationDeleteParticipant=function(){r.state.confirmationCode===E.a.participant&&(r.props.removeParticipant(r.state.participant),r.setState({showConfirmationDialog:!1,confirmationCode:E.a.none},r._focusToDeleteButton))},r._closeButtonRef=i.createRef(),r.state={participants:r.props.participants,showConfirmationDialog:!1,confirmationCode:E.a.none,hasPeopleChange:!1,removedIndex:0},r}return(0,a.d)(t,e),t.prototype.render=function(){var e=this,t=(0,w._)(this.context.clientId,this.context.sharingStore)||(0,w.Z)(this.context.clientId,this.context.sharingStore),n=this.context.sharingStore.isConsumer()||t,a=this.props.link.sharingScope===u.a.specificPeople&&!this.props.link.isAddressBarLink;return i.createElement("ul",{className:"od-ShareLink-participants ".concat(n&&!this.props.isAccessSummaryLink?"manageAccessV3":""),key:this.props.showDetailsPanel?"Panel-ul-"+this.props.link.shareId:this.props.link.shareId},this.props.participants.map(function(t,n){var r=e.props.participants.length-1<e.state.removedIndex?e.state.removedIndex-1:e.state.removedIndex,s=!k.B()&&(0,M.d)();return i.createElement("li",{className:"od-ShareLink-personaItem",key:e.props.showDetailsPanel?"Panel-li-"+t.email:t.email,"aria-setsize":e.props.participants.length,"aria-posinset":n+1},i.createElement(x.a,{imageUrl:t.image,primaryText:t.name,secondaryText:s?t.email:t.isExternal?o.vd:t.job,size:C.c.size32,showSecondaryText:!!(t.job||t.isExternal||s)}),a&&i.createElement(f.a,{componentRef:n===r&&e._closeButtonRef,"data-is-focusable":!0,ariaLabel:L.j(o.zh,t.name),className:"od-ShareLink-actionButton",iconProps:{iconName:"Cancel"},onClick:function(){e.context.sharingStore.getEngagementHelper().onLinkParticipantOpenDelete(e.props.engagementExtraData),e.setState({showConfirmationDialog:!0,confirmationCode:E.a.participant,participant:t,removedIndex:n})}}))}),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._focusToDeleteButton=function(){var e;this.props.participants.length>0&&(null===(e=this._closeButtonRef)||void 0===e?void 0:e.current)&&this._closeButtonRef.current.focus()},t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,a=t.participants,r=t.participant;return i.createElement(A.ConfirmationDialog,{confirmationCode:n,participants:a,participant:r,onApply:this._onConfirmationDeleteParticipant,onCancel:this.state.confirmationCode===E.a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:E.a.none},e._focusToDeleteButton)}})},t.prototype._onLinkParticipantDelete=function(){var e=this.state.participant,t=[];this.context.sharingStore.getEngagementHelper().onLinkParticipantDelete(this.props.engagementExtraData),this.props.showDetailsPanel?(t=!0!==e.isExternal&&e.principalName?this.props.participants.filter(function(t){return t.principalName!==e.principalName}):this.props.participants.filter(function(t){return t.email!==e.email}),this.setState((0,a.a)((0,a.a)({},this.state),{participants:t,hasPeopleChange:!0})),this.props.onRemoveParticipant(e,t)):this.props.updateLinkSettings(e)},t.contextTypes={sharingStore:r.object.isRequired,clientId:r.number.isRequired},t}(i.Component),T=n(554),U=n(376);(0,S.b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDetails--div{top:0;left:0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";width:100%;height:100%;padding:0 20px;box-sizing:border-box;overflow-y:auto;display:flex;flex-direction:column}.od-ShareLinkDetails--div .od-ShareLinkDetails--header{height:2.5rem;display:flex;align-items:center;flex-shrink:0;font-size:.875rem;margin:10px -20px 0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";position:relative}[dir=ltr] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-left:20px}[dir=rtl] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-right:20px}@supports (font:-apple-system-body){.od-ShareLinkDetails--div .od-ShareLinkDetails--header{font:-apple-system-body}}.od-ShareLinkDetails--div .od-ShareLinkDetails--changeSettings{padding:0 0 12px}.od-ShareLinkDetails--div .od-ShareLinkDetails--footer{position:absolute;width:100%;right:0;bottom:0;left:0}.od-ShareLinkDetails--relative{position:relative}.od-ShareLinkDetails--absolute{position:absolute}.od-ShareLinkDetails--settingIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-left:12px}@supports (font:-apple-system-title1){.od-ShareLinkDetails--settingIcon{font:-apple-system-title1}}.od-ShareLinkDetails--setting{border-bottom:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";margin-bottom:12px;display:block;align-items:center}[dir=ltr] .od-ShareLinkDetails--setting i{padding-left:12px}[dir=rtl] .od-ShareLinkDetails--setting i{padding-right:12px}[dir=ltr] .od-ShareLinkDetails--setting i{padding-right:8px}[dir=rtl] .od-ShareLinkDetails--setting i{padding-left:8px}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-left:0}[dir=rtl] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-right:0}@media screen and (-ms-high-contrast:active){.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:window;color:GrayText;border-color:GrayText}}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-caretDownWrapper{display:none}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-right:8px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .ms-Dropdown{height:40px}.od-ShareLinkDetails--setting .od-RoleSelector-wrapper{display:flex}.od-ShareLinkDetails--setting .od-RoleSelector-rolesDropdown{width:100%}[dir=ltr] .od-ShareLinkDetails--setting .od-RoleSelector-rolesDropdown{margin-left:13px}[dir=rtl] .od-ShareLinkDetails--setting .od-RoleSelector-rolesDropdown{margin-right:13px}.od-ShareLinkDetails--setting .od-canUploadIcon{margin-top:9px}[dir=ltr] .od-ShareLinkDetails--setting .od-canUploadIcon{margin-left:2px}[dir=rtl] .od-ShareLinkDetails--setting .od-canUploadIcon{margin-right:2px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker{width:100%}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker{margin-bottom:10px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{display:flex}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-right:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-right:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-right:37px}@supports (font:-apple-system-caption1){.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font:-apple-system-caption1}}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-RequireVerificationToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem}@supports (font:-apple-system-body){.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{font:-apple-system-body}}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PreventDownloadToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:1.125rem}@supports (font:-apple-system-title1){.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{font:-apple-system-title1}}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordFieldWrapper{width:100%}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField{width:100%;align-items:center}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-shareLinkDetails--passwordFieldMainContent{display:flex}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLink-passwordFieldContent{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField{display:flex;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField{width:100%;margin:0;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField-field{width:100%;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-Toggle-label{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem;line-height:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-left:auto}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-right:auto}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField{margin-bottom:10px}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField .od-PasswordField-label{font-size:1rem}@supports (font:-apple-system-headline){.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField .od-PasswordField-label{font:-apple-system-headline}}@media screen and (-ms-high-contrast:active){.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField input.ms-TextField-field{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}}.od-ShareLinkDetails--passwordCreatedByLabel{font-size:.75rem;font-style:italic;margin-top:-5px;padding:0}[dir=ltr] .od-ShareLinkDetails--passwordCreatedByLabel{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--passwordCreatedByLabel{margin-right:37px}@supports (font:-apple-system-caption1){.od-ShareLinkDetails--passwordCreatedByLabel{font:-apple-system-caption1}}.od-ShareLinkDetails--sectionHeader{position:relative;padding:12px 20px;margin:10px -20px 0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";font-size:.875rem}@supports (font:-apple-system-headline){.od-ShareLinkDetails--sectionHeader{font:-apple-system-headline}}.od-ShareLinkDetails--sectionHeader .ms-Button:not(:hover){background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-ShareLinkDetails--sectionHeader .ms-Button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareLinkDetails--sectionHeaderV2{position:relative;padding:12px 24px;margin:0 -20px 0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem;font-weight:600}@supports (font:-apple-system-headline){.od-ShareLinkDetails--sectionHeaderV2{font:-apple-system-headline}}.od-ShareLinkDetails--sectionHeaderV2.border{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding-top:24px}.od-ShareLink--detailsPanel{top:50px}.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{height:2.5rem;display:flex;align-items:center;flex-shrink:0;font-size:.875rem}[dir=ltr] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-left:10px}[dir=rtl] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-right:10px}@supports (font:-apple-system-headline){.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{font:-apple-system-headline}}.od-ShareLink--detailsPanel .ms-Panel-content{padding:0}.od-ShareLink--detailsPanel .ms-Panel-content .od-ShareLinkDetails--content{max-height:100%;overflow-y:auto;overflow-x:hidden;padding:0 20px 0}.od-ShareLink--detailsPanel .ms-Panel-content .od-Share-PeoplePicker-wrapper{padding-top:20px}.od-PermissionsPivot-linkDetailsView .od-ShareLinkDetails--content{flex:1 0 auto}.od-ShareLinkDetails--content.addressBarLinkDetails .od-ShareLink{padding:24px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";margin:0 -20px}.od-ShareLinkDetails--content.addressBarLinkDetails .od-ShareLinkDetails--sectionHeaderV2{padding-top:24px;padding-bottom:0}.od-ShareLinkDetails--actions{display:flex;align-items:center;justify-content:flex-end;flex-shrink:0;margin-top:auto;height:3.5rem;margin:10px -20px 0}[dir=ltr] .od-ShareLinkDetails--actions{padding-right:35px}[dir=rtl] .od-ShareLinkDetails--actions{padding-left:35px}.od-ShareLinkDetails--actions button.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-ShareLinkDetails--actions.manageAccessV3{bottom:0;left:0;width:100%;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding-bottom:26px;flex-shrink:0;position:sticky}[dir=ltr] .od-ShareLinkDetails--actions.manageAccessV3{right:20px}[dir=rtl] .od-ShareLinkDetails--actions.manageAccessV3{left:20px}.od-ShareLinkDetails--actions.shadeBackground{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:'}.od-ShareLinkDetails--actions button.ms-Button{font-size:.875rem;height:2rem;border-width:.0625rem}@supports (font:-apple-system-body){.od-ShareLinkDetails--actions button.ms-Button{font:-apple-system-body}}.od-ShareLinkDetails--actions .ms-Button--default{outline:transparent;position:relative}.od-ShareLinkDetails--actions .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}[dir=ltr] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-left:10px}[dir=rtl] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-right:10px}.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button--primary::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button:focus::after{left:-2px;right:-2px;top:-2px;bottom:-2px}}.od-ShareLinkDetails--noParticipants{font-size:.75rem;padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";min-height:50px}@supports (font:-apple-system-caption1){.od-ShareLinkDetails--noParticipants{font:-apple-system-caption1}}.od-ShareLinkDetails-addressBarChoiceGroup{padding-top:10px;padding-left:8px}.od-ShareLinkDetails-addressBarChoiceGroupLabel{font-weight:600;font-size:.75rem}@supports (font:-apple-system-caption1){.od-ShareLinkDetails-addressBarChoiceGroupLabel{font:-apple-system-caption1}}.od-ShareLinkDetails--sectionHeader-share button.ms-Button-flexContainer{font-size:.875rem}@supports (font:-apple-system-body){.od-ShareLinkDetails--sectionHeader-share button.ms-Button-flexContainer{font:-apple-system-body}}.od-ShareLinkDetails-Label{padding-left:8px}.manageAccessV3 .od-ShareLinkDetails--changePermissions .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border-bottom:none}[dir=ltr] .manageAccessV3 .od-PreventDownloadToggle-label{padding-left:10px}[dir=rtl] .manageAccessV3 .od-PreventDownloadToggle-label{padding-right:10px}"}]);var F,H=n(177),R=n(238),N=n(133),B=n(73),j=n(246),V=n(244),z=n(370),G=n(367),K=n(44),W=n(51),q=n(57),Q=n(372),Y=n(371),J=n(366),X=n(97),Z=n(20),$=n(86),ee=n(66),te=n(2),ne=n(70),ae=n(243),ie=n(94),re=function(e){function t(t,n){var i,r=e.call(this,t)||this;r._onPeoplePickerChange=function(e){var t=B.h({selectedItems:e,sharingLinkKind:r._link.sharingLinkKind,canAddExternalPrincipal:r.props.sharingInformation.canAddExternalPrincipal,sharingInformation:r.props.sharingInformation,viewPolicyTipCallback:r._store.getPolicyTipInformation,permissionsMap:r._store.getPermissionsMap()});!k.V()&&t||r.props.addParticipant(e[0]),r.setState({peoplePickerError:t})},r._onRemoveParticipant=function(e,t){r.setState({participants:t,participantRemovedText:L.j(o.Gh,e.name),hasPeopleChange:!0}),r.props.updateLinkSettings(e)},r._onRoleChange=function(e){var t=r.state.selectedPermissions,n=(0,w.y)(t.audience,(0,w.Q)(e));r.setState({hasSettingsChange:!0,selectedPermissions:(0,a.a)((0,a.a)({},t),{sharingRole:e,isEdit:(0,w.Q)(e),sharingLinkKind:n,preventDownload:!1}),preventDownloadDisabled:e===l.a.edit||e===l.a.review||r.props.selectedPermissions.sharingScope!==u.a.specificPeople}),r._preventDownloadToggle=!1,r.props.onRoleChange(e)},r._onAudienceChange=function(e){var t=e===c.a.organization;r.setState(function(){return(0,a.a)((0,a.a)({},r.state),{isAddressBarLinkEnabled:t,hasSettingsChange:e!==r._selectedAudience,currentAudience:e,confirmationCode:E.a.addressBarLinkOff})},function(){r.props.onOptionChange(e!==r._selectedAudience)})},r._onPasswordChange=function(e){var t=(0,a.a)((0,a.a)({},r.state),{hasSettingsChange:e.length>0});t=(0,a.a)((0,a.a)({},t),{selectedPermissions:(0,a.a)((0,a.a)({},r.state.selectedPermissions),{password:e,updatePassword:e.length>0,shareId:r._link.shareId})}),r.setState(function(){return t}),r.props.onPasswordChange(e)},r._onConfirmationSave=function(){r.props.addressBarLinkDetails?(r.state.confirmationCode===E.a.addressBarLinkOff?(r._store.setAddressBarLinkCapability(!1),r._link&&r._store.unshareLink(r._link.sharingLinkKind,r._link.shareId)):k._b()?r._store.setAddressBarLinkCapability(!0):r._store.setAddressBarLinkCapability(!0).then(function(){return r._store.shareLinkExpress()}).then(function(){r._store.fetchSharingInformation(!0,!0)}),r.setState(function(){return(0,a.a)((0,a.a)({},r.state),{isAddressBarLinkEnabled:!1,showConfirmationDialog:!1,hasSettingsChange:!1,hasPeopleChange:!1,confirmationCode:E.a.none})},r.props.onCancel)):(r.props.applyParticipants(r.state),r._showSimplifiedShareDialogV2&&r._store.updatePermissionsInfoOnLinkChange&&r._store.updatePermissionsInfoOnLinkChange(r._link.shareId,r.state.selectedPermissions.sharingRole),r.setState((0,a.a)((0,a.a)({},r.state),{showConfirmationDialog:!1,confirmationCode:E.a.none,hasSettingsChange:!1,hasPeopleChange:!1,selectedPermissions:(0,a.a)((0,a.a)({},r.state.selectedPermissions),{preventDownload:r._preventDownloadToggle})})))},r._onCancel=function(){r.setState((0,a.a)((0,a.a)({},r.state),{showConfirmationDialog:!1,confirmationCode:E.a.none}))},r._onSave=function(){if(r.state.hasSettingsChange){var e=r.props.addressBarLinkDetails&&r.state.currentAudience===c.a.existing?E.a.addressBarLinkOff:E.a.linkSettings;r.setState((0,a.a)((0,a.a)({},r.state),{confirmationCode:e,showConfirmationDialog:!0}))}else r.props.applyParticipants(r.state)},r._onBack=function(){r.props.hasPeopleChange||r.props.hasSettingsChange?r.setState((0,a.a)((0,a.a)({},r.state),{showConfirmationDialog:!0,confirmationCode:E.a.back})):r.props.onCancel()},r._onSelectDate=function(e){var t=r.props.sharingInformation.anonymousLinkExpirationRestrictionDays;r.setState((0,a.a)((0,a.a)({},r.state),{expirationErrorCode:(0,w.t)(e,t)}),function(){r._updateExpirationErrorCode((0,w.t)(e,t))}),r._onExpirationChange(e)},r._store=n.sharingStore,r._link=r.props.link,r._companyName=(null===(i=r.props.companyName)||void 0===i?void 0:i.length)>o.zb.length?o.zb:r.props.companyName;var s=r.props.sharingInformation.sharingAbilities;return r._canManageAddressBarLink=(0,w.h)(s),r._odcHideNonPremiumLinkFeatures=(k.R()&&r._store.isConsumer()||(0,M.d)())&&!r._store.isPremiumExperienceAllowed(),r._showSimplifiedShareDialog=(0,w._)(r.props.clientId,r._store),r._showSimplifiedShareDialogV2=(0,w.Z)(r.props.clientId,r._store),r._isNewManageAccess=r._store.isConsumer()||r._showSimplifiedShareDialog||r._showSimplifiedShareDialogV2,r._preventDownloadToggle=!!r.props.selectedPermissions.preventDownload,r.state={expirationErrorCode:w.b.none,hasSettingsChange:r.props.hasSettingsChange||!1,hasPeopleChange:!1,showConfirmationDialog:!1,confirmationCode:E.a.none,participants:r.props.participants,participantRemovedText:"",selectedPermissions:r.props.selectedPermissions,currentAudience:r._getCurrentAudience(),peoplePickerError:B.h({selectedItems:(0,a.a)({},r.props.participants),sharingLinkKind:d.a.direct,canAddExternalPrincipal:r.props.sharingInformation.canAddExternalPrincipal,sharingInformation:r.props.sharingInformation,viewPolicyTipCallback:r._store.getPolicyTipInformation}),preventDownloadDisabled:r.props.selectedPermissions.isEdit||r.props.selectedPermissions.isReview||r.props.selectedPermissions.sharingScope!==u.a.specificPeople,focusPeoplePicker:!1},r._audienceOptions=r._getAudienceOptions(),r}return(0,a.d)(t,e),t.prototype.componentDidMount=function(){var e=this;this._store.addListener(function(){e.setState(function(){var t=e._store.getSharingInformation().sharingLinks.filter(function(t){return t.shareId===e._link.shareId});if(t&&t.length>0)return e._link=t[0],{link:e._link,participants:e._link.sharingLinkKind===d.a.flexible||e._link.isPartialRedeem?(0,w.A)(e._link):[],selectedPermissions:e._getLinkSettings(e._link)}})})},t.prototype._getLinkSettings=function(e){return{allowEditing:!0,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,isManageList:e.isManageList,isCreateOnlyLink:e.isCreateOnlyLink,sharingLinkKind:e.sharingLinkKind,specificPeople:(0,w.A)(e),updatePassword:e.updatePassword,password:e.password,sharingRole:(0,w.J)(e,this.props.clientId,this.props.sharingInformation),preventDownload:e.blockDownload,hasPassword:e.hasPassword,description:e.description,trackLinkUsers:e.trackLinkUsers,sharingScope:e.sharingScope}},t.prototype.render=function(){return i.createElement("div",{className:"od-ShareLinkDetails--div od-ShareLinkDetails--relative"},this._renderDetailsPanelHeader(),this._renderDetailsPanelContent(),this._renderDetailsPanelActions())},t.prototype._renderDetailsPanelContent=function(){var e=$.e(this.props.link.audience,this.props.sharingInformation.sharingAbilities),t=!k.q||!this.props.link.isCreateOnlyLink||e.canManageSubmitOnlyLink.enabled;return this.props.addressBarLinkDetails?this._showSimplifiedShareDialogV2?this._renderNewAddressBarLinkDetails():this._renderAddressBarLinkDetails():i.createElement("div",{className:"od-ShareLinkDetails--content ".concat(this._isNewManageAccess?"manageAccessV3":"")},this._renderShareLink(),this._isNewManageAccess?i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeaderV2 border","data-is-focusable":!0,"aria-label":o.Le},o.Le):i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.ke},o.ke),i.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":o.ke},this.props.link.isCreateOnlyLink?this._renderRequestFileEntry():this._renderChangePermission(),this._renderExpirationDatePicker(t),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),this._renderPasswordField(),this._renderPreventDownloadToggle()),this.props.selectedPermissions.audience!==c.a.specificPeopleFlex&&this.state.participants.length>0&&i.createElement("div",{role:"heading","aria-level":2,className:this._isNewManageAccess?"od-ShareLinkDetails--sectionHeaderV2":"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.af},o.af),this.props.selectedPermissions.audience===c.a.specificPeopleFlex&&i.createElement("div",{role:"heading","aria-level":2,className:this._isNewManageAccess?"od-ShareLinkDetails--sectionHeaderV2":"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.Ed},o.Ed),this._renderPeoplePicker(),this._renderParticipantsList(),ee.a(this.state.participantRemovedText,"assertive","alert"),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._renderRequireVerificationToggle=function(){var e=this.state.selectedPermissions.trackLinkUsers,t=Z.c(this.props.clientId);return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--requireVerification"},i.createElement("div",{className:"od-RequireVerificationToggle"},i.createElement("div",{className:"od-ShareLinkDetails-setting--RequireVerification-Icon"},i.createElement(v.a,{iconName:"ReminderPerson",alt:o.Nd})),i.createElement(V.a,{"aria-disabled":!0,role:"checkbox",checked:e,disabled:!0,label:t?o.ti:o.ai}))))},t.prototype._renderNewAddressBarLinkDetails=function(){return i.createElement("div",{className:"od-ShareLinkDetails--content addressBarLinkDetails"},this._renderShareLink(),i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeaderV2","data-is-focusable":!0,"aria-label":o.Le},o.Le),i.createElement("div",{className:"od-ShareLinkDetails-addressBarChoiceGroup"},i.createElement(J.a,{items:this._audienceOptions,onAudienceChange:this._onAudienceChange,companyName:this._companyName,clientId:this.props.clientId,engagementExtraData:this.props.engagementExtraData,isAddressBarLinkDetails:!0})),this.state.participants.length>0&&i.createElement("div",{role:"heading","aria-level":2,className:this._isNewManageAccess?"od-ShareLinkDetails--sectionHeaderV2":"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.af},o.af),this._link&&this._renderParticipantsList(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._renderAddressBarLinkDetails=function(){return i.createElement("div",{className:"od-ShareLinkDetails--content"},i.createElement("span",{className:"od-ShareLinkDetails-addressBarChoiceGroupLabel"},o.jb),i.createElement("div",{className:"od-ShareLinkDetails-addressBarChoiceGroup"},i.createElement(J.a,{items:this._audienceOptions,onAudienceChange:this._onAudienceChange,companyName:this._companyName,clientId:this.props.clientId,engagementExtraData:this.props.engagementExtraData})),this._isNewManageAccess?i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeaderV2","data-is-focusable":!0,"aria-label":o.Le},o.Le):i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.ke},o.ke),i.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":o.ke},this._renderChangePermission()),this.state.participants.length>0&&i.createElement("div",{role:"heading","aria-level":2,className:this._isNewManageAccess?"od-ShareLinkDetails--sectionHeaderV2":"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.af},o.af),this._link&&this._renderParticipantsList(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._renderShareLink=function(){var e=this.props.isAddressBarLink&&this.props.linkDetailsView;return i.createElement(me,{index:0,link:this._link,companyName:this._companyName,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this.props.enableLinkSettings,showMoreOptions:!1,showPermissionsList:this.props.showPermissionsList,onRemoveLink:this.props.onRemoveLink,engagementExtraData:this.props.engagementExtraData,addressBarDetailsView:e,showLinkHeader:this.props.showLinkHeader})},t.prototype._getHeaderActions=function(){var e,t;return(null!==(t=null===(e=this.props.hostOptions)||void 0===e?void 0:e.showCloseButton)&&void 0!==t?t:Z.p(this.props.clientId))&&i.createElement(K.a,{menuIconProps:{iconName:"Clear"},ariaLabel:o.Vb,tooltipContent:o.Vb,directionalHint:I.a.bottomAutoEdge,onClick:this.context.onDismiss})},t.prototype._renderDetailsPanelHeader=function(){return i.createElement("div",{className:"od-ShareLinkDetails--header new"},i.createElement(W.a,{mainHeaderText:o.De,renderBackButton:!0,onBackButtonClicked:this._onBack,actions:this._getHeaderActions(),isContextualHeader:!0}))},t.prototype._renderDetailsPanelActions=function(){var e=!(this.state.hasPeopleChange||this.state.hasSettingsChange||this.props.hasPeopleChange||this.props.hasSettingsChange)||this.state.expirationErrorCode!==w.b.none,t="od-ShareLinkDetails--actions "+(this._isNewManageAccess?"manageAccessV3":"")+(this._isNewManageAccess?"":"shadeBackground"),n=(0,te.E)();return i.createElement("div",{className:t},i.createElement(q.a,{id:"od-ShareLinkDetails-save",onClick:this._onSave,disabled:e,styles:{labelDisabled:n.semanticColors.primaryButtonTextDisabled}},o.Y),i.createElement(p.a,{onClick:this.props.showPermissionsList,disabled:e},o.Tb))},t.prototype._renderParticipantsList=function(){var e=this,t=this.props.participants;return t.length>0?i.createElement(P,{link:this._link,showDetailsPanel:!0,participants:t,removeParticipant:function(n){1===t.length&&e.setState({focusPeoplePicker:!0}),e.props.removeParticipant(n)},updateLinkSettings:this.props.updateLinkSettings,onRemoveParticipant:this._onRemoveParticipant,engagementExtraData:this.props.engagementExtraData}):this._link.audience===c.a.specificPeopleFlex?i.createElement("div",{className:"od-ShareLinkDetails--noParticipants",role:"alert","aria-label":o.Xe},i.createElement("span",{"aria-hidden":"true"},o.Xe)):void 0},t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state,n=B.c(t.participants),a=B.d(t.participants,this.props.groupsMemberCount);if(this.props.selectedPermissions.audience===c.a.specificPeopleFlex)return i.createElement("div",null,i.createElement(N.a,{defaultSelectedItems:[],onChange:this._onPeoplePickerChange,oversharingExternalsWarning:n,oversharingGroupsWarning:a,pickerSettings:e.sharingInformation.peoplePickerSettings,error:t.peoplePickerError,sharingInformation:e.sharingInformation,sharingLinkKind:e.link.sharingLinkKind,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:o.wg,onResolvedSuggestions:null,renderIcon:this._isNewManageAccess,focusPeoplePicker:this.state.focusPeoplePicker}))},t.prototype._renderChangePermission=function(){var e=this.props,t=e.selectedPermissions.audience,n=(0,w.T)(t);return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},i.createElement(G.a,{clientId:e.clientId,mode:e.mode,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,canChangePermission:n,sharingInformation:this.props.sharingInformation})))},t.prototype._renderRequestFileEntry=function(){var e=[{key:o.Eb,text:o.Eb,data:o.Eb,ariaLabel:o.Eb}];return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},i.createElement("div",{className:"od-RoleSelector-wrapper"},ee.b(i.createElement(v.a,{className:"od-RoleSelector-settingIcon od-canUploadIcon",iconName:"Upload"}),o.Eb),i.createElement(j.a,{className:"od-RoleSelector-rolesDropdown",disabled:!0,label:"",defaultSelectedKey:o.Eb,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:X.a.large,ariaLabel:o.Eb,options:e}),this.props.children)))},t.prototype._getCurrentAudience=function(){var e=this.props.addressBarLinkSettings;return e&&e.linkDisabled||!this._canManageAddressBarLink?c.a.existing:c.a.organization},t.prototype._getAudienceOptions=function(){var e=[],t={icon:R.a[H.a.workGroup],isChecked:!1,isDisabled:!1,key:c.a.existing,label:this._link.isAddressBarLink?o.Hg:o.Ng,linkKinds:[d.a.direct],permissionsType:H.a.existing,detailText:o.Rg},n={disabledText:o.jc,icon:R.a[H.a.workGroup],isChecked:!1,isDisabled:!this._canManageAddressBarLink,key:c.a.organization,label:L.j(this._link.isAddressBarLink?o.Tg:o.Fg,this._companyName),linkKinds:[d.a.organizationView,d.a.organizationEdit],permissionsType:H.a.workGroup,detailText:L.j(o.Ug,this._companyName)};return this._canManageAddressBarLink&&this.state.currentAudience!==c.a.existing?(n.isChecked=!0,t.isChecked=!1,this._selectedAudience=c.a.organization):(n.isChecked=!1,t.isChecked=!0,this._selectedAudience=c.a.existing),e.push(n,t),e},t.prototype._renderExpirationDatePicker=function(e){var t=this.state.selectedPermissions;if(e&&t.audience===c.a.anyone&&!this._odcHideNonPremiumLinkFeatures||!e){var n=(0,w.R)(t.expiration)?void 0:t.expiration;return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--datePicker",style:e?{}:{pointerEvents:"none"}},i.createElement(z.a,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:n,expiryRestriction:this.props.sharingInformation.anonymousLinkExpirationRestrictionDays,disabled:!e,disableAutoFocus:!0})),this._renderExpirationDatePickerErrorMessage())}},t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=(0,w.s)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return i.createElement("span",{className:"od-ShareLinkDetails--expirationError",role:"alert","aria-live":"assertive"},t)},t.prototype._renderPasswordField=function(){if(this.state.selectedPermissions.hasPassword){var e="",t=this._link.passwordLastModifiedBy;return t&&(e=t.primaryText?t.primaryText:t.email?t.email:""),i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLink-detailsPanel-passwordFieldWrapper"},i.createElement("div",{className:"od-ShareLink-detailsPanel-passwordField"},i.createElement(Y.a,{onPasswordChange:this._onPasswordChange,detailsPane:!0,lastModifiedBy:e,engagementExtraData:this.props.engagementExtraData}))))}},t.prototype._onToggleChange=function(e){this._preventDownloadToggle=e,this.setState((0,a.a)((0,a.a)({},this.state),{selectedPermissions:(0,a.a)((0,a.a)({},this.state.selectedPermissions),{preventDownload:e,sharingRole:e?l.a.restrictedview:l.a.view}),hasSettingsChange:!0}))},t.prototype._renderPreventDownloadToggle=function(){var e,t=(0,ie.a)(this.props.sharingInformation.fileExtension),n=this.state.selectedPermissions,a=this.context.sharingStore.isPreventDownloadAllowed();if(e=!this._showSimplifiedShareDialogV2&&"video"!==t,a&&e&&$.m(n.audience,this.props.sharingInformation.sharingAbilities)&&((0,ae.b)(this.props.sharingInformation.fileExtension,ae.a.AllowMediaTA)||this.props.sharingInformation.sharedObjectType===ne.a.folder))return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--preventDownloadToggle"},i.createElement(Q.a,{isToggled:this._preventDownloadToggle,disablePreventDownload:this.state.preventDownloadDisabled,clientId:this.props.clientId,mode:this.props.mode,onToggleChange:this._onToggleChange.bind(this)})))},t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,a=t.participants,r=t.participant;return i.createElement(A.ConfirmationDialog,{confirmationCode:n,participants:a,participant:r,companyName:this._companyName,clientId:this.props.clientId,onApply:this._onConfirmationSave,onCancel:this.state.confirmationCode===E.a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:E.a.none})},onDiscard:this.props.showPermissionsList})},t.prototype._onExpirationChange=function(e){var t=this;this.setState(function(){return(0,a.a)((0,a.a)({},t.state),{selectedPermissions:(0,a.a)((0,a.a)({},t.state.selectedPermissions),{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})}),this.props.onExpirationChange(e)},t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState((0,a.a)((0,a.a)({},this.state),{expirationErrorCode:e}))},t.contextTypes={sharingStore:r.object.isRequired,onDismiss:r.func},t}(i.Component),oe=n(100),se=n(28),ce=n(65),de=n(107),le=n(83),ue=n(16),fe="requestAccessInfo-icon",pe="requestAccessInfo-calloutContent";!function(e){e[e.legacy=0]="legacy",e[e.standard=1]="standard",e[e.compact=2]="compact"}(F||(F={}));var me=function(e){function t(t,n){var i,r=e.call(this,t)||this;return r._addParticipant=function(e){if(0===r.state.participants.filter(function(t){return t.email===e.email}).length){var t=(0,a.g)((0,a.g)([],r.state.participants,!0),[e],!1);r.setState({participants:t,hasPeopleChange:r._checkHasPeopleChange(r._originalParticipants,t)})}},r._removeParticipant=function(e){var t=r.state.participants.filter(function(t){return t.email!==e.email}),n=(0,a.g)([],t,!0);r.setState({participants:n,hasPeopleChange:r._checkHasPeopleChange(r._originalParticipants,n)})},r._checkHasPeopleChange=function(e,t){if(t.length!==e.length)return!0;for(var n=function(e){if(0===t.filter(function(t){return t.email===e.email}).length)return{value:!0}},a=0,i=e;a<i.length;a++){var r=n(i[a]);if("object"==typeof r)return r.value}return!1},r._removeOneParticipant=function(e){var t=r.state.participants.filter(function(t){return t.email!==e.email});r._store.shareLink({settings:r.state.selectedPermissions,recipients:[],copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:r._link.shareId,inviteesToRemove:[(0,w.k)(e)]}),r._originalParticipants=t},r._applyParticipants=function(e){for(var t=r.state.participants.filter(function(e){return 0===r._originalParticipants.filter(function(t){return e.email===t.email}).length}),n=r._originalParticipants.filter(function(e){var t=r.state.participants.filter(function(t){return t.email===e.email});return 0===t.length}),a=[],i=0,o=n;i<o.length;i++){var s=o[i];a.push((0,w.k)(s))}(0!==t.length||0!==a.length||e.hasSettingsChange)&&(r._originalParticipants=r.state.participants,r._store.shareLink({settings:e.selectedPermissions,recipients:t,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:r._link.shareId,inviteesToRemove:a}),r.setState({hasPeopleChange:!1,hasSettingsChange:!1},r._showPermissionsList))},r._onOptionChange=function(e){r.setState(function(){return(0,a.a)((0,a.a)({},r.state),{hasSettingsChange:e})}),r._engagementHelper.manageAccessAddressBarLinkTypeClicked(r.props.engagementExtraData)},r._onChevronClick=function(){r._linkInviteesExpanded=!r._linkInviteesExpanded,r._engagementHelper.manageAccessLinkInviteesToggled(r._linkInviteesExpanded,r.props.engagementExtraData),r.setState({linkMemberExpanded:!r.state.linkMemberExpanded})},r._onCancel=function(){r.setState(function(){return(0,a.a)((0,a.a)({},r.state),{showConfirmationDialog:!1,participants:r._link?(0,w.A)(r._link):[],expirationErrorCode:w.b.none,selectedPermissions:r._getLinkSettings(),hasSettingsChange:!1,hasPeopleChange:!1})}),r._showPermissionsList()},r._showPermissionsList=function(){var e=r.props.showPermissionsList;e&&e()},r._onConfirmationDeleteLink=function(){var e=r.state.confirmationCode;e!==E.a.link&&e!==E.a.linkInheritance&&e!==E.a.linkBundle||(r._onShareLinkDelete(),r.setState({showConfirmationDialog:!1,confirmationCode:E.a.none,hasSettingsChange:!1,linkDetailsView:!1})),r._showPermissionsList()},r._showLinkDetails=function(){r._engagementHelper.manageAccessLinkDetailsClicked(r.props.engagementExtraData);var e=r.props.onShowLinkDetailsClicked;e&&e(r._link)},r._onShareLinkDelete=function(){r._engagementHelper.onShareLinkDelete(r.props.engagementExtraData);var e=r._link;r.props.onRemoveLink&&r.props.onRemoveLink(),r._store.unshareLink(e.sharingLinkKind,e.shareId)},r._onLinkClicked=function(e){try{var t=e.target;t.focus(),t.setSelectionRange(0,t.value.length)}catch(e){}},r._copySharingLinkToClipboard=function(){var e=r.props,t=e.clientId,n=e.sharingInformation,a=r._link.url,i={clientId:t,textField:r._textField,linkUrl:a,itemName:n.item.name,extraQosData:r.props.engagementExtraData};(0,w.l)(i).then(function(e){r.setState({copyLinkToClipboardSuccess:e,copyLinkAlert:o.of}),r._copyButton.focus(),e&&(r._engagementHelper.manageAccessLinkCopyButtonClicked(r.props.engagementExtraData),r._engagementHelper.shareCompleted(r.props.engagementExtraData),setTimeout(function(){r.setState({copyLinkToClipboardSuccess:!1,copyLinkAlert:""})},2e3))})},r._updateLinkSettings=function(e){var t,n,a=[],i=[],s=r.state.participants;if(e){for(var d=0,l=s;d<l.length;d++)if((b=l[d]).principalName&&b.principalName===e.principalName||(null===(t=null==e?void 0:e.email)||void 0===t?void 0:t.length)>0&&(null===(n=null==b?void 0:b.email)||void 0===n?void 0:n.length)>0&&b.email===e.email){a.push((0,w.k)(b)),r.setState({participantRemovedText:L.j(o.Gh,b.name)}),r._chevronButton&&r._chevronButton.focus();break}}else{for(var u=function(e){var t;t=!0===e.isExternal?s.filter(function(t){return t.email===e.email}):s.filter(function(t){return t.userId===e.loginName}),0===t.length&&a.push(e)},f=0,p=r._link.invitees;f<p.length;f++)u(p[f]);for(var m=function(e){if(!0===e.isExternal&&r.state.selectedPermissions.audience===c.a.organization)return"continue";0===(!0===e.isExternal?r._link.invitees.filter(function(t){return t.email===e.email}):r._link.invitees.filter(function(t){return t.loginName===e.userId})).length&&!0===e.isResolved&&i.push(e)},_=0,h=s;_<h.length;_++){var b;m(b=h[_])}}(a.length>0||i.length>0||r.state.hasSettingsChange)&&r._store.shareLink({settings:r.state.selectedPermissions,recipients:i,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:r._link.shareId,inviteesToRemove:a})},r._onPeoplePickerChange=function(e,t){r.setState((0,a.a)((0,a.a)({},r.state),{selectedPermissions:r.state.selectedPermissions,participants:0===e.length?r.state.participants.concat(t):r.state.participants,hasPeopleChange:0===e.length}))},r._onRoleChange=function(e){var t=r.state.selectedPermissions,n=(0,w.y)(t.audience,(0,w.Q)(e));r.setState((0,a.a)((0,a.a)({},r.state),{selectedPermissions:(0,a.a)((0,a.a)({},t),{sharingRole:e,isEdit:(0,w.Q)(e),sharingLinkKind:n}),hasSettingsChange:!0}))},r._onExpirationChange=function(e){e||r._link.expiration||(e=(0,w.p)(r.props.sharingInformation.anonymousLinkExpirationRestrictionDays)),r.setState(function(){return(0,a.a)((0,a.a)({},r.state),{selectedPermissions:(0,a.a)((0,a.a)({},r.state.selectedPermissions),{expiration:e,shareId:r._link.shareId}),hasSettingsChange:e!==r.state.selectedPermissions.expiration||r.state.hasSettingsChange})})},r._onPasswordChange=function(e){r.setState(function(){return(0,a.a)((0,a.a)({},r.state),{selectedPermissions:(0,a.a)((0,a.a)({},r.state.selectedPermissions),{password:e,updatePassword:e.length>0,shareId:r._link.shareId}),hasSettingsChange:!0})})},r._getLinkSettings=function(){if(r._link)return{allowEditing:!0,audience:r._link.audience,expiration:r._link.expiration,isEdit:r._link.isEdit,isReview:r._link.isReview,isManageList:r._link.isManageList,isCreateOnlyLink:r._link.isCreateOnlyLink,sharingLinkKind:r._link.sharingLinkKind,specificPeople:(0,w.A)(r._link),updatePassword:r._link.updatePassword,password:r._link.password,sharingRole:(0,w.J)(r._link,r.props.clientId,r.props.sharingInformation),preventDownload:r._link.blockDownload,hasPassword:r._link.hasPassword,description:r._link.description,trackLinkUsers:r._link.trackLinkUsers,sharingScope:r._link.sharingScope};if(r.props.isAddressBarLink){var e=r.props.addressBarLinkSettings.linkDisabled?u.a.existing:u.a.organization;return{allowEditing:!0,audience:r.props.addressBarLinkSettings.linkDisabled?c.a.existing:c.a.organization,expiration:null,isEdit:r.props.addressBarLinkSettings.linkPermission===l.a.edit,sharingLinkKind:d.a.flexible,specificPeople:r._link?(0,w.A)(r._link):[],updatePassword:!1,password:"",sharingScope:e}}},r._store=n.sharingStore,r._resize=n.resize,r._link=r.props.link,r._engagementHelper=r._store.getEngagementHelper(),r._linkInviteesExpanded=!1,r._isConsumer=r._store.isConsumer(),r._originalParticipants=r._link?(0,w.A)(r._link):[],r._useSimplifiedSharingDialog=(0,w._)(r.props.clientId,r._store)||(0,w.Z)(r.props.clientId,r._store),r._isUnhealthy=r._link.isUnhealthy,r.state={linkRemovedText:"",copyLinkToClipboardSuccess:!1,copyLinkAlert:"",link:r._link,allowPasswordChange:!1,linkMemberExpanded:!1,hasSettingsChange:!1,hasPeopleChange:!1,participants:r._link?(0,w.A)(r._link):[],showConfirmationDialog:!1,confirmationCode:E.a.none,selectedPermissions:r._getLinkSettings(),expirationErrorCode:w.b.none,linkDetailsView:r.props.linkDetailsView,participantRemovedText:"",isRATCalloutVisible:!1,isRATCalloutFocused:!1},(r._store.isConsumer()||r._useSimplifiedSharingDialog)&&(r._useUpdatedIcons=!0,r._hideInvalidExpirationIcons=!0),r._isInherited=!!(null===(i=r._link.inheritedLinkInfo)||void 0===i?void 0:i.path),r._isBundle=!!r._link.inheritedLinkInfo&&!r._isInherited,r}return(0,a.d)(t,e),t.prototype.render=function(){if(this.props.enableLinkSettings&&(this.state.linkDetailsView||!this._useSimplifiedSharingDialog&&this.props.isAddressBarLink))return this._renderLinkDetails();var e=this.props.link,t=e.url,n=(0,w.w)(this.props.link),a={sharingLink:this.props.link,companyName:this.props.companyName,clientId:this.props.clientId,isListSharing:this.props.sharingInformation.sharedObjectType===ne.a.list,customLabeledAudienceConfig:null,fileExtension:this.props.sharingInformation.fileExtension,isAccessSummaryLink:this.props.isAccessSummaryLink},r=(0,w.z)(a),s=e.principals&&e.principals.length>0||e.invitees&&e.invitees.length>0,d="od-ShareLink flightOff ",u="";switch(this.props.spacing){case F.compact:u="compact";break;case F.standard:u="updatedSpacing";break;case F.legacy:default:u=""}d+=u;var f=void 0!==this.props.spacing?"od-ShareLink-container "+u:"",p="od-ShareLink--inviteesHolder "+(this.props.spacing>0?"no-separator":"")+(this.props.isAccessSummaryLink?" accessSummary":""),m=this._link.audience===c.a.specificPeopleFlex||this._link.isPartialRedeem,_=this._isUnhealthy?this.props.sharingInformation.userRole===l.a.owner:this.props.showLinkHeader;return this.props.enableLinkSettings?i.createElement("div",{className:f},_&&this._renderShareLinkHeader(),this._renderShareLink(),ee.a(this.state.copyLinkAlert,"assertive","alert",!0),!e.isUnhealthy&&this.props.showMoreOptions&&s&&i.createElement("div",{"aria-label":o.ie,className:p,"data-is-focusable":!m,"aria-expanded":m?void 0:this.state.linkMemberExpanded},i.createElement("div",{className:"od-ShareLink--inviteesHolder-header",onClick:this._onChevronClick.bind(this)},!this.state.linkMemberExpanded&&(this._link.audience===c.a.specificPeopleFlex||this._link.isPartialRedeem)&&this._renderLinkMembersForEditPanel(),!!this.state.linkMemberExpanded&&i.createElement("div",{className:"od-ShareLink--inviteesHolder-headerExpanded"},this._link.isPartialRedeem?o.Gf:o.Qd),m&&this._renderChevron()),this.state.linkMemberExpanded&&this._renderParticipantsList(),ee.a(this.state.participantRemovedText,"assertive","alert",!0)),this.state.showConfirmationDialog&&this._renderConfirmationDialogDeleteLink()):i.createElement("div",null,i.createElement("div",{className:d},i.createElement("div",{className:"od-ShareLink-main"},i.createElement("div",{className:"od-ShareLink-icon"},i.createElement(v.a,{iconName:n})),this._renderLinkUrlWithTooltip(t,r,!0),this._renderDeleteButton(this._onShareLinkDelete)),i.createElement("div",{className:"od-ShareLink-description flightOff"},r)),s&&this._renderLinkMembers())},t.prototype.componentDidUpdate=function(){this._resize()},t.prototype.componentDidMount=function(){var e=this;this._store.addListener(function(){e.setState(function(){var t=e._store.getSharingInformation().sharingLinks.filter(function(t){return t.shareId===e._link.shareId});if(t&&t.length>0)return e._link=t[0],{link:e._link,participants:e._link.sharingLinkKind===d.a.flexible||e._link.isPartialRedeem?(0,w.A)(e._link):[]}})})},t.prototype._renderLinkDetails=function(){return i.createElement(re,(0,a.a)({link:this._link,participants:this.state.participants,originalParticipants:this._originalParticipants,addParticipant:this._addParticipant,removeParticipant:this._removeParticipant,applyParticipants:this._applyParticipants,updateLinkSettings:this._updateLinkSettings,getLinkSettings:this._getLinkSettings,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,onExpirationChange:this._onExpirationChange,onPasswordChange:this._onPasswordChange,onPeoplePickerChange:this._onPeoplePickerChange,hasPeopleChange:this.state.hasPeopleChange,hasSettingsChange:this.state.hasSettingsChange,onCancel:this._onCancel,showPermissionsList:this._showPermissionsList,addressBarLinkDetails:this.props.isAddressBarLink,onOptionChange:this._onOptionChange,showLinkHeader:this._isUnhealthy},this.props))},t.prototype._renderParticipantsList=function(){return this.state.participants.length>0?i.createElement(P,{link:this._link,showDetailsPanel:!1,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings,removeParticipant:this._removeOneParticipant,engagementExtraData:this.props.engagementExtraData,isAccessSummaryLink:this.props.isAccessSummaryLink}):i.createElement(i.Fragment,null)},t.prototype._renderLinkMembersForEditPanel=function(){var e=this.state.participants.map(function(e){return{personaName:e.name,imageUrl:e.image}});return i.createElement(T.a,{personas:e,personaSize:C.c.size24,maxDisplayablePersonas:4,overflowButtonType:U.a.descriptive,overflowButtonProps:{ariaLabel:o.Ff}})},t.prototype._renderChevron=function(){var e=this;return i.createElement(se.a,{content:o.qd,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.a,{ariaLabel:o.qd,"aria-expanded":this.state.linkMemberExpanded,className:"od-ShareLink--inviteesHolder-headerChevron",iconProps:!0===this.state.linkMemberExpanded?{iconName:"ChevronUp"}:{iconName:"ChevronDown"},componentRef:function(t){return e._chevronButton=t}}))},t.prototype._renderConfirmationDialogDeleteLink=function(){var e=this,t=this.state,n=t.confirmationCode,a=t.participants,r=t.participant;return i.createElement(A.ConfirmationDialog,{confirmationCode:n,participants:a,participant:r,onApply:this._onConfirmationDeleteLink,onCancel:this.state.confirmationCode===E.a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:E.a.none})}})},t.prototype._showRATCallout=function(){this.state.isRATCalloutVisible||this.setState({isRATCalloutVisible:!0})},t.prototype._hideRATCallout=function(){this.state.isRATCalloutVisible&&!this.state.isRATCalloutFocused&&this.setState({isRATCalloutVisible:!1})},t.prototype._ratInfoKeyPressed=function(e){if(e&&e.charCode===ue.a.enter||e.charCode===ue.a.space){e.preventDefault();var t=this.state.isRATCalloutVisible;this.setState({isRATCalloutVisible:!t})}},t.prototype._setCalloutFocused=function(){this.setState({isRATCalloutFocused:!0})},t.prototype._setCalloutUnfocused=function(){this.setState({isRATCalloutFocused:!1,isRATCalloutVisible:!1})},t.prototype._renderShareLinkHeader=function(){var e,t=this._link;if(t.inheritedLinkInfo){var n,a=void 0,r=void 0;if(this._isInherited)a=s.O,n=t.inheritedLinkInfo.name,r=this._getInheritedTooltipContent(t);else if(this._isBundle){if(a=s.i,n=null===(e=t.inheritedLinkInfo.name)||void 0===e?void 0:e.toLowerCase(),!k.ob()&&void 0===n)return;r={onRenderContent:function(){return i.createElement(h.a,{className:"od-PrincipalDetails-textTooltipContent"},i.createElement("span",null,L.j(s.j,n)))}}}return i.createElement("div",{className:"od-ShareLink-header"},i.createElement("span",null,a,i.createElement("span",{className:"od-ShareLink-header-itemname"},n)),i.createElement(se.a,{tooltipProps:r,id:"od-ShareLink-header-tooltip"},i.createElement("span",{tabIndex:0,role:"note",className:"od-ShareLink-header-iconWraper"},i.createElement(v.a,{"aria-describedby":"od-ShareLink-header-tooltip","data-is-focusable":!0,iconName:"Info"}))))}if(t.isUnhealthy)return i.createElement("div",{className:"od-ShareLink-unhealthyHeader"},i.createElement("span",{className:"od-ShareLink-content"},i.createElement(v.a,{iconName:"Blocked2"}),o.Wj))},t.prototype._getInheritedTooltipContent=function(e){var t=this,n=this.props.sharingInformation.item,r=e.inheritedLinkInfo.path,o={size:16,type:b.a.folder},c={size:16,type:this.props.fileIcon},d=e.inheritedLinkInfo.name||r.substring(r.lastIndexOf("/")+1),l=n.parentName?d!==n.parentName:r.replace(n.parentPath,"").split("/").length>1;return{onRenderContent:function(){return i.createElement(h.a,{className:"od-PrincipalDetails-inheritedTooltipContent"},i.createElement("div",{className:"od-PrincipalDetails-inheritedTooltipContent-description"},s.P),i.createElement("span",null,i.createElement("span",null,i.createElement(v.a,(0,a.a)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},(0,g.a)(o))),d),i.createElement(v.a,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"}),l&&i.createElement("span",null,i.createElement("span",null,"..."),i.createElement(v.a,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"})),i.createElement("span",{className:"od-PrincipalDetails-inheritedTooltipContent-secondFilename"},i.createElement(v.a,(0,a.a)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},(0,g.a)(c))),t.props.fileName)))}}},t.prototype._renderShareLink=function(){var e,t=this,n=this._link,a=n.url,r=(0,w.w)(this.props.link),s={sharingLink:n,companyName:this.props.companyName,clientId:this.props.clientId,isListSharing:this.props.sharingInformation.sharedObjectType===ne.a.list,customLabeledAudienceConfig:null,fileExtension:this.props.sharingInformation.fileExtension,isAccessSummaryLink:this.props.isAccessSummaryLink,isFolder:this.props.sharingInformation.sharedObjectType===ne.a.folder},c=(0,w.z)(s),l=n.isAddressBarLink||this.props.isAddressBarLink,u=this._canManageLink(n),f=this.props.showMainDeleteOption,p=this._canDeleteLink(n),m=n.sharingLinkKind===d.a.requestAccess;switch(this.props.spacing){case F.compact:e="od-ShareLink compact";break;case F.standard:e="od-ShareLink updatedSpacing";break;case F.legacy:default:e="od-ShareLink"}var _="od-ShareLink-description "+(m?"compact":""),h=this._isInherited?E.a.linkInheritance:this._isBundle?E.a.linkBundle:E.a.link,b=function(){return t.setState({showConfirmationDialog:!0,confirmationCode:h})},g=this.props.addressBarLinkSettings,y=(0,w.tb)(this.props.companyName);return i.createElement("div",{className:e},i.createElement("div",{className:"od-ShareLink-main"},i.createElement("div",{className:"od-ShareLink-icon2 icon-".concat(r)},i.createElement(v.a,{iconName:r,"aria-hidden":!0})),l&&!this.props.addressBarDetailsView&&i.createElement("div",{className:"od-ShareLink-details"},i.createElement("div",{className:"od-ShareLink-addressBarLinkText"},g&&(g.linkDisabled||0===g.linkPermission)?o.E:L.j(o.B,y))),m?i.createElement("div",{className:"od-ShareLink-details"},o.Qh,this._renderRequestAccess()):(!l||this.props.addressBarDetailsView)&&this._renderLinkUrlWithTooltip(a,this._getAriaLabel(),0===this.props.index),this._renderCopyButton(),this.props.showMoreOptions&&u?i.createElement("span",{className:"od-ShareLink-additionalButtons"},!m&&this._renderMoreOptionsButton(),f?this._renderDeleteButton(b):null):p?this._renderDeleteButton(b):null),u?i.createElement("div",{className:_,onClick:this._showLinkDetails.bind(this)},this._renderShareLinkDescriptionLabel(c)):i.createElement("div",{className:"od-ShareLink-description"},this._renderShareLinkDescriptionLabel(c)))},t.prototype._renderMoreOptionsButton=function(){var e=this._useUpdatedIcons?"Settings":"More";return i.createElement(se.a,{content:o.Ue,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.a,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._showLinkDetails.bind(this),iconProps:{iconName:e},ariaLabel:o.Te}))},t.prototype._renderRequestAccess=function(){var e=le.a.generate(),t=i.createElement("div",{id:pe},i.createElement("div",{className:"od-ShareLink-requestAccessTooltip-text"},o.Yh),i.createElement(_.a,{id:"requestAccessInfo-calloutContentLink",style:{fontSize:"0.875rem"},tabIndex:0,className:"od-SharingLink-learnMoreText",target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2150444"},o.Zd));return k.lb()?i.createElement("span",{tabIndex:0,onMouseOver:this._showRATCallout.bind(this),onMouseLeave:this._hideRATCallout.bind(this),onKeyPress:this._ratInfoKeyPressed.bind(this)},i.createElement(y.a,{iconName:"Info",className:"ms-Icon ms-Icon--Info od-SharingLink-requestAccessInfo",id:fe+""+e,style:{paddingLeft:"2px"}}),this.state.isRATCalloutVisible&&i.createElement(D.a,{id:"requestAccessInfo-callout",ariaLabelledBy:pe,ariaDescribedBy:pe,role:"dialog",gapSpace:0,target:"#".concat(fe+""+e),onDismiss:this._hideRATCallout.bind(this),onMouseOver:this._setCalloutFocused.bind(this),onMouseLeave:this._setCalloutUnfocused.bind(this),directionalHint:I.a.topCenter,setInitialFocus:!0,style:{maxWidth:"300px",padding:"12px 16px",fontSize:"0.75rem"}},t)):i.createElement(se.a,{hostClassName:"od-ShareLink-requestAccessTooltip",calloutProps:{gapSpace:0,directionalHint:I.a.topCenter},content:t},i.createElement(y.a,{iconName:"Info",className:"ms-Icon ms-Icon--Info od-SharingLink-infoIconToolTipBind"}))},t.prototype._renderDeleteButton=function(e){var t=this._useUpdatedIcons?"Delete":"Cancel";return i.createElement(se.a,{content:o.jh,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.a,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:e,iconProps:{iconName:t},ariaLabel:o.jh}))},t.prototype._renderCopyButton=function(){var e=this,t=this._link,n=t.isAddressBarLink||this.props.isAddressBarLink,a=this.state.copyLinkToClipboardSuccess;return!(t.sharingLinkKind===d.a.requestAccess)&&(!n||this.props.addressBarDetailsView)&&i.createElement(p.a,{onClick:this._copySharingLinkToClipboard,"data-is-focusable":!0,ariaLabel:a?o.of:o.cc,componentRef:function(t){return e._copyButton=t},className:"od-ShareLink-copyLinkButton ".concat(this._isUnhealthy?"disabled":""),disabled:this._isUnhealthy},a?o.$b:o.ec)},t.prototype._renderShareLinkDescriptionLabel=function(e){var t=this.props.isAddressBarLink,n=this.props.isAccessSummaryLink,a="od-ShareHintDetail-statusText ";return n?a+="accessSummaryLink ":!1===this.props.linkDetailsView&&(a+="clickable"),t?this.props.linkDetailsView:i.createElement("div",{className:"od-ShareLink-description-label"},i.createElement("span",{className:a},e,n&&this._renderHowCanUserModifyTooltip()),!n&&this._renderStatusIcons())},t.prototype._renderHowCanUserModifyTooltip=function(){var e=this._getTooltipText(),t={onRenderContent:function(){return i.createElement("div",null,e)}};return""!==e&&i.createElement(se.a,{tooltipProps:t,id:"od-ShareLink-howCanUserModifyTooltip"},i.createElement("div",{tabIndex:0,"data-is-focusable":!0,role:"button","aria-label":e,className:"od-ShareLink-howCanUserModifyTooltip"},i.createElement(v.a,{"aria-describedby":"od-ShareLink-howCanUserModifyTooltip",iconName:"Info"})))},t.prototype._getTooltipText=function(){switch(this.props.link.sharingScope){case u.a.organization:return o.$e;case u.a.specificPeople:return o.ef;case u.a.anyone:case u.a.existing:default:return""}},t.prototype._renderLinkUrlWithTooltip=function(e,t,n){return this.props.sharingInformation.userRole!==l.a.owner&&this._link.isUnhealthy?i.createElement(se.a,{content:o.qj},this._renderTextField(e,t,n)):this._renderTextField(e,t,n)},t.prototype._renderTextField=function(e,t,n){var a=this;return i.createElement("div",{className:"od-ShareLink-details ".concat(this._isUnhealthy?"disabled":""),"aria-live":"assertive","aria-relevant":"all",dir:"ltr"},i.createElement(m.a,{"data-is-focusable":!0,autoFocus:n,onClick:this._onLinkClicked,className:"od-ShareLink-url",defaultValue:e,readOnly:!0,ariaLabel:t,componentRef:function(e){return a._textField=e},disabled:this._isUnhealthy}))},t.prototype._renderStatusIcons=function(){if(!this._link.isUnhealthy){var e=this._link.expiration,t=this._link.hasPassword,n=(this._link.blockDownload,this._link.isCreateOnlyLink,this._link.trackLinkUsers),a=[],r=this.props;!e||(0,w.R)(e)&&this._hideInvalidExpirationIcons||(e<new Date(Date.now())?a.push({icon:"EventDateMissed12",tooltip:"".concat(L.j(o.ld,(0,oe.f)(e)))}):e.getTime&&e.getTime()!==new Date(0).getTime()&&a.push({icon:"Calendar",tooltip:"".concat(L.j(o.fd,(0,oe.f)(e)))})),t&&a.push({icon:"Lock",tooltip:o.Ei}),this._link.isReview&&de.a[this.props.sharingInformation.fileExtension]&&a.push({icon:"Feedback",tooltip:o.wf}),n&&a.push({icon:"ReminderPerson",tooltip:Z.c(r.clientId)?o.ei:o.ni});var s=a.map(function(e,t){return i.createElement("span",{key:t,className:"EventDateMissed12"!==e.icon?"od-ShareHintDetail-item":"od-ShareHintDetail-item od-ShareHintDetail-item-expired"},i.createElement(se.a,{content:e.tooltip,id:e.icon},i.createElement(v.a,{iconName:e.icon,"aria-label":e.tooltip,tabIndex:0})))});return i.createElement("div",{className:"od-ShareHintDetail-iconsList"},s)}},t.prototype._getAriaLabel=function(){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,a={sharingLink:this._link,companyName:this.props.companyName,clientId:this.props.clientId,isListSharing:this.props.sharingInformation.sharedObjectType===ne.a.list,customLabeledAudienceConfig:null,fileExtension:this.props.sharingInformation.fileExtension,isAccessSummaryLink:this.props.isAccessSummaryLink,isFolder:this.props.sharingInformation.sharedObjectType===ne.a.folder},i=(0,w.z)(a);return!e||(0,w.R)(e)&&this._hideInvalidExpirationIcons||(e<new Date(Date.now())?i+=" "+L.j(o.ld,(0,oe.f)(e))+".":e.getTime&&e.getTime()!==new Date(0).getTime()&&(i+=" "+L.j(o.fd,(0,oe.f)(e))+".")),t&&(i+=" "+o.Ei+"."),n&&(i+=" "+o.lh+"."),i},t.prototype._renderLinkMembers=function(){var e=this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}})),t="od-ShareLink--inviteesHolder flightOff "+(this.props.spacing>0?"no-separator":"");return i.createElement(ce.a,null,i.createElement("ul",{"aria-label":o.ie,className:t},e.map(function(e){return i.createElement("li",{className:"od-ShareLink-linkMember",key:e.primaryText,"data-is-focusable":!0,tabIndex:0},i.createElement(O,{primaryText:e.primaryText,imageUrl:e.imageUrl}))})))},t.prototype._getSharingRole=function(){return this.state.selectedPermissions.isManageList?l.a.manageList:this.state.selectedPermissions.isEdit?(0,w.q)(this.props.clientId,this.props.sharingInformation):this.state.selectedPermissions.isReview?l.a.review:l.a.view},t.prototype._canDeleteLink=function(e){if(this._isConsumer)return!0;var t=$.e(e.audience,this.props.sharingInformation.sharingAbilities);return e.isEdit?!!t.canDeleteEditLink&&t.canDeleteEditLink.enabled:e.isReview?!!t.canDeleteReviewLink&&t.canDeleteReviewLink.enabled:e.isManageList?!!t.canDeleteManageListLink&&t.canDeleteManageListLink.enabled:!!t.canDeleteReadLink&&t.canDeleteReadLink.enabled},t.prototype._canManageLink=function(e){if(this._isConsumer)return!0;var t=$.e(e.audience,this.props.sharingInformation.sharingAbilities);return e.isAddressBarLink||this.props.isAddressBarLink?(0,w.h)(this.props.sharingInformation.sharingAbilities):e.isEdit?k.m()&&e.isCreateOnlyLink?!(!t.canManageSubmitOnlyLink||!t.canManageSubmitOnlyLink.enabled)||!!t.canDeleteSubmitOnlyLink&&t.canDeleteSubmitOnlyLink.enabled:!!t.canManageEditLink&&t.canManageEditLink.enabled:e.isReview?!!t.canManageReviewLink&&t.canManageReviewLink.enabled:!!t.canManageReadLink&&t.canManageReadLink.enabled},t.contextTypes={sharingStore:r.object.isRequired,resize:r.func.isRequired},t}(i.Component)}
,,,,function(e,t,n){n.d(t,{a:function(){return H}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal2{padding:18px 20px;margin:0 -20px;border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-SharePrincipal2-spinner.ms-Spinner{position:relative;top:unset;left:unset}.od-SharePrincipal2-personaCard{display:inline!important}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone{width:100%;display:flex;justify-content:space-between;align-items:center}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone .ms-Persona.ms-Persona--size32.od-SharePrincipal-persona2{width:max-content}.od-ShareLink-personaItem.od-SharePrincipal2 .od-SharePrincipal-unknownTooltip{padding-left:6px}.od-ShareLink-personaItem.od-SharePrincipal2.narrow{padding:13px 8px;margin:0}.od-ShareLink-personaItem.od-SharePrincipal2 div.ms-Persona-primaryText{font-size:.875rem}@supports (font:-apple-system-body){.od-ShareLink-personaItem.od-SharePrincipal2 div.ms-Persona-primaryText{font:-apple-system-body;height:100%}}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-Persona-secondaryText{color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:"}@supports (font:-apple-system-body){.od-ShareLink-personaItem.od-SharePrincipal2 .ms-Persona-secondaryText{font:-apple-system-body;height:100%}}[dir=ltr] .od-SharePrincipal-roleFullText{padding-left:6px}[dir=rtl] .od-SharePrincipal-roleFullText{padding-right:6px}.od-SharePrincipal-permissions{font-size:.875rem}@supports (font:-apple-system-body){.od-SharePrincipal-permissions{font:-apple-system-body}}.od-SharePrincipal-permissions .lists{width:30%}.od-SharePrincipal-permissions .od-SharePrincipal-role{display:flex}.od-SharePrincipal-permissions .od-SharePrincipal-role i{align-self:center}.od-SharePrincipal-permissions .od-SharePrincipal-role svg{height:1.125rem;width:1.125rem}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissions{display:flex;align-items:center}.od-SharePrincipal-permissions .role-nowrap{white-space:nowrap}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}.ms-SharePrincipal_contextMenu .ms-ContextualMenu-icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}"}]);var i=n(225),r=n(5),o=n(78),s=n(43),c=n(231),d=n(32),l=n(72),u=n(31),f=n(29),p=n(1),m=n(122),_=n(12),h=n(10),b=n(11),g=n(180),v=n(17),y=n(27),S=n(28),D=n(7),I=n(23),x=n(108),C=n(88),O=n(65),w=n(74),E=n(556),A=n(86),L=n(24),k=n(70),M=n(249),P=n(42),T=n(80),U=n(112),F=n(143),H=function(e){function t(t,n){var a=e.call(this,t)||this;return a._menuElement=(0,p.createRef)(),a._principal=a.props.principal,a._personaRef=p.createRef(),a._handlePersonaCoinClick=function(e){a.props.isEnterprise&&(e.stopPropagation(),e.preventDefault())},a._handleCardClose=function(){if(a._personaRef){var e=m.findDOMNode(a._personaRef.current);(null==e?void 0:e.focus)&&e.focus()}},a._showMenu=function(){var e=a.state.showMenu;a.setState({showMenu:!e})},a._hideMenu=function(){a.setState({showMenu:!1})},a._stopSharingConfirmation=function(){a.setState({showConfirmationDialog:!0})},a._onCancel=function(){a.setState({showConfirmationDialog:!1})},a._onStopSharingClick=function(){a._store.getEngagementHelper().manageAccessRemoveDirectAccess(a.props.engagementExtraData),a._store.updatePermissions(a.props.principal,d.a.none)},a.state={showMenu:!1,showConfirmationDialog:!1,selectedRole:t.principal.role},a._principal.primaryText=a._replaceEncoding(a._principal.primaryText),a._store=n.sharingStore,a._onChangeRoleClick=a._onChangeRoleClick.bind(a),a._enableCompactRoleSelector=!0,a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this._principal.role===d.a.owner,t=this._principal.type===l.a.sharePointGroup,n=!e,a=this.props.sharingInformation;a&&a.sharedObjectType===k.a.list&&(n=!t&&!this._principal.isSiteAdmin||t&&!e);var i="od-ShareLink-personaItem od-SharePrincipal2 "+(this.props.useCompact?"narrow":""),r=this._principal.primaryText===g.Eb&&""===this._principal.secondaryText,o="";(0,U.a)()&&(o=this._principal.loginName);var s=this.props.sharingInformation.sharedObjectType===k.a.list;return p.createElement("div",{className:i,"data-is-focusable":!0,"data-principal-detail":o,"aria-label":this._computeAriaLabel(this._principal,e),tabIndex:this._principal.role===d.a.owner?-1:0,role:"button"},p.createElement(O.a,{direction:w.a.horizontal},r&&this.props.showUnknownUsers?this._renderUnknownPersona(this._principal):this._renderPersona(this._principal),p.createElement("div",{className:"od-SharePrincipal-permissions ".concat(s?"lists":"")},n?this._renderChangePermissions(this._principal):p.createElement("span",{className:"od-SharePrincipal-ownerLabel",style:{cursor:"default"}},b.Bf))),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._replaceEncoding=function(e){return null==(e=null==e?void 0:e.replace("\\u0026","&"))?void 0:e.replace("\\u0027","'")},t.prototype._getSecondaryText=function(e){switch(e.type){case l.a.sharePointGroup:return b.yj;case l.a.securityGroup:return b.Ae;default:return e.secondaryText}},t.prototype._renderPersona=function(e){var t;if(this.props.isSPO){var n=!L.B()&&(0,F.d)(),a=L.x()?e.secondaryText:null===(t=this._getSecondaryText(e))||void 0===t?void 0:t.toUpperCase();return p.createElement(o.a,{componentRef:this._personaRef,className:"od-SharePrincipal-persona2",size:s.c.size32,text:e.primaryText,secondaryText:n?e.email:e.isExternal?b.vd:a,showSecondaryText:!!(e.isExternal||a||n&&this._principal.role!==d.a.owner),imageUrl:e.imageUrl,onRenderPersonaCoin:this._onRenderPersonaCoinWithPersonaCard(e)})}return p.createElement(o.a,{className:"od-SharePrincipal-persona2",size:s.c.size32,text:e.primaryText,secondaryText:e.isExternal?b.vd:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl})},t.prototype._renderUnknownPersona=function(e){var t=this,n=function(){return p.createElement("span",null,e.primaryText,p.createElement("span",{className:"od-SharePrincipal-unknownTooltip"},t._renderUnknownDisplayNameTooltip()))};return this.props.isSPO?p.createElement(o.a,{className:"od-SharePrincipal-persona2",onRenderPrimaryText:n,onRenderPersonaCoin:this._onRenderPersonaCoinWithPersonaCard(e)}):p.createElement(o.a,{className:"od-SharePrincipal-persona2",size:s.c.size32,text:e.primaryText,secondaryText:e.isExternal?b.vd:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl,onRenderPrimaryText:n})},t.prototype._onRenderPersonaCoinWithPersonaCard=function(e){var t=this;return function(){var n=t._getPersonaType(e.type);return p.createElement(E.a,{personaType:n,identifier:e.email||e.loginName,pageContext:t.props.pageContext,ariaLabel:e.primaryText,className:"od-SharingPrincipal2-personaCard",tabIndex:0,forceLoad:!0,containerTabIndex:0,moduleLoader:void 0,lpcCardBehavior:{onCardClose:t._handleCardClose,onCardOpen:void 0}},p.createElement(c.a,{size:s.c.size32,text:e.primaryText,secondaryText:e.isExternal?b.vd:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl,onClick:t._handlePersonaCoinClick}))}},t.prototype._getPersonaType=function(e){switch(e){case l.a.securityGroup:case l.a.sharePointGroup:return"Group";default:return"NotResolved"}},t.prototype._getRoleSelectorProps=function(e){return{menuPermissionOptions:(0,A.a)({clientId:this.props.clientId,sharingStore:this._store,sharingInformation:this.props.sharingInformation,scenarioId:this._store.getScenarioId&&this._store.getScenarioId(),isPreventDownloadAllowed:this._store.isPreventDownloadAllowed&&this._store.isPreventDownloadAllowed(),shareMode:u.a.addPeople}),sharingRole:e,mode:u.a.addPeople,clientId:this.props.clientId,ariaLabel:b.x,showStopSharing:!0,onRoleChange:this._onChangeRoleClick.bind(this),onStopSharing:this._stopSharingConfirmation.bind(this),roleSelectorAs:M.a}},t.prototype._renderRoleSelector=function(e){var t=this._getRoleSelectorProps(e);return p.createElement(M.a,(0,a.a)({},t))},t.prototype._renderChangePermissions=function(e){var t=this.state.selectedRole,n=this.props.userRole,a=this.props.showViewOnly,i=a?"od-SharePrincipal-permissionsRole role-nowrap":"od-SharePrincipal-permissionsRole",r=void 0===this.props.allowFocus||this.props.allowFocus;return a||n!==d.a.owner||t!==d.a.edit&&t!==d.a.view&&t!==d.a.review&&t!==d.a.owner&&t!==d.a.manageList?p.createElement("div",{className:i},this._renderRoleIcon(e,r)):this._enableCompactRoleSelector?p.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleSelector(t)):p.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleIcon(e,!1),this._renderChangePermissionDropdown())},t.prototype._renderUnknownDisplayNameTooltip=function(){var e=g.Ab;return p.createElement(S.a,{content:e,calloutProps:{gapSpace:0},id:"od-SharePrincipal-unknownDisplayNameTooltip"},p.createElement("span",{tabIndex:0,role:"note",className:"od-SharePrincipal-inlineTooltip"},p.createElement(h.a,{className:"od-SharePrincipal-unknownDisplayName-infoIcon","aria-describedby":"od-SharePrincipal-unknownDisplayNameTooltip","data-is-focusable":!0,iconName:"Info"})))},t.prototype._renderRoleIcon=function(e,t){var n=e.role;if(this.props.useAccessMap&&(n=(0,v.u)(e)),this.props.userRole===d.a.view||this.props.userRole===d.a.restrictedview||this.props.userRole===d.a.review)return p.createElement(p.Fragment,null);var a=this.props.sharingInformation.sharedObjectType===k.a.list,i=this.props.sharingInformation.sharedObjectType===k.a.folder,r=(0,v.E)(n,a,!1,i),o=this._computeRoleText(n,e,a,i),s=this.props.roleVerbose;return!this.props.isEnterprise||this.props.accessChecked?p.createElement("div",{className:"od-SharePrincipal-role"},p.createElement(h.a,{className:"od-SharePrincipal-roleIcon",iconName:r.name,"data-is-focusable":t,"aria-hidden":!t,"aria-label":o}),s&&p.createElement("span",{className:"od-SharePrincipal-roleFullText"}," ",o," ")):p.createElement(P.a,{size:T.a.small,className:"od-SharePrincipal2-spinner"})},t.prototype._renderChangePermissionDropdown=function(){var e=(0,I.b)();return p.createElement("div",{ref:this._menuElement},p.createElement(y.a,{className:"od-SharePrincipal-changePermissionsChevron",onClick:this._showMenu,iconProps:{iconName:"ChevronDown"},ariaLabel:D.j(b.Bg,this.props.principal.primaryText)}),this.state.showMenu&&p.createElement(i.a,{target:this._menuElement.current,items:this._getContextualMenuItems(),directionalHint:e?r.a.bottomLeftEdge:r.a.bottomRightEdge,onDismiss:this._hideMenu,className:"ms-SharePrincipal_contextMenu"}))},t.prototype._onChangeRoleClick=function(e){e!==this.props.principal.role&&(this._store.updatePermissions(this.props.principal,e),this.setState({selectedRole:e}))},t.prototype._renderConfirmationDialog=function(){var e=this.props.principal,t={id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type};return p.createElement(x.ConfirmationDialog,{confirmationCode:C.a.participant,participant:t,onApply:this._onStopSharingClick,onCancel:this._onCancel})},t.prototype._getContextualMenuItems=function(){var e,t=this,n=this.props.principal.role,a=A.l(f.a.existing,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension),i=this.props.sharingInformation.sharedObjectType===k.a.list&&this.props.principal.type!==l.a.sharePointGroup,r={key:"currentRole",name:(0,v.E)(n,(null===(e=this.props.sharingInformation)||void 0===e?void 0:e.sharedObjectType)===k.a.list).title,onClick:function(){t._onChangeRoleClick(n)},checked:!0,iconProps:{iconName:"CheckMark"}},o={key:"fullControl",name:b.kd,onClick:function(){t._onChangeRoleClick(d.a.owner)}},s={key:"editRole",name:b.hb,onClick:function(){t._onChangeRoleClick(d.a.edit)}},c={key:"reviewRole",name:b.wb,onClick:function(){t._onChangeRoleClick(d.a.review)}},u={key:"viewRole",name:b.Ab,onClick:function(){t._onChangeRoleClick(d.a.view)}},p={key:"stopSharing",name:"".concat(b.Pj),onClick:this._stopSharingConfirmation},m=[r];return i&&n!=d.a.owner&&m.push(o),n!=d.a.edit&&m.push(s),a&&n!=d.a.review&&m.push(c),n!=d.a.view&&m.push(u),m.push(p),m},t.prototype._computeAriaLabel=function(e,t){var n=this._computeRoleText(e.role,e,this.props.sharingInformation.sharedObjectType===k.a.list,this.props.sharingInformation.sharedObjectType===k.a.folder),a="".concat(e.primaryText,", ").concat(e.isExternal?b.vd:"",", ").concat(n,".");return t||(a+=" "+(this.props.interactionAriaLabel||b.Ai)),a},t.prototype._computeRoleText=function(e,t,n,a){if("number"!=typeof e)return t.sharingLinkKind?b.l:"";switch(e){case d.a.edit:return n?b.vb:b.hb;case d.a.review:return b.wb;case d.a.view:return b.Ab;case d.a.owner:return b.Bf;case d.a.manageList:return b.gb;case d.a.restrictedview:return b.fb;case d.a.submit:return a?b.Eb:b.Cb;default:return""}},t.contextTypes={sharingStore:_.object.isRequired},t}(p.Component)}
,,,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(53);function i(e){return void 0===e&&(e=new a.a),{BrowserIsMobile:e.isMobile,BrowserIsPWA:e.isPWA,BrowserMajVer:e.browserMajor,BrowserMinVer:e.browserMinor,BrowserName:e.browserName,BrowserUserAgent:e.userAgent,OSName:e.osName,OSVersion:e.osVersion}}}
,function(e,t,n){n.d(t,{a:function(){return T},b:function(){return R},c:function(){return F}});var a,i,r=n(0),o=n(38),s=n(41),c=n(79),d=n(103),l=n(26),u=(0,d.a)({eventName:"Beacon,",shortEventName:"Beacon"},{name:l.a.String,status:l.a.String,success:l.a.Boolean,retryCount:l.a.Number,totalRetries:l.a.Number,eventCount:l.a.Number}),f=n(37),p=n(53),m=n(356),_=function(){function e(e,t,n,a,i){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var r={};if(i)for(var o=0;o<i.length;++o)r[i[o].EventType]=r[i[o].EventType]+1||1;var s={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:n,EventCount:i?i.length:0,Timestamp:a,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:r,Workload:e.workload||"",FarmLabel:e.farmLabel||"",FarmName:e.farmName||""};this._dataCompletenessJson=JSON.stringify(s)}return Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!1,configurable:!0}),e.prototype.send=function(){new m.a({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,n){})},e}(),h=n(113),b=n(208),g=function(){function e(e){this._handlerLoader=e}return e.prototype.attach=function(e){var t,n=!1;return this._getHandler().then(function(a){n||(t=a.attach(e))}),function(){n=!0,t&&t()}},e.prototype._getHandler=function(){var e=this._handlerLoader();return this._getHandler=function(){return e},e},e}(),v=n(571),y=n(14),S="AriaBeacon",D={logStartEvents:!1,Init:function(e,t,n,i){var o=this;void 0===i&&(i={});try{D.logStartEvents=!0;var s,d=O(t,i.platformDetection),l=new h.a(t.completenessCallbackEndpoint),p={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,farmName:t.farmName,callbackEndpoint:l},m={ariaLoader:function(){return y.c.resolve(n)},context:d,tenantToken:e,disableCookies:t.disableCookies,ariaLogConfiguration:{collectorUrl:t.collectorUrl},logStartEvents:D.logStartEvents,offlineDetection:i.offlineDetection,offlineCache:i.offlineCache,ariaQos:{isQosEvent:function(e){return u.isTypeOf(e)&&!!e.data&&e.data.name===S},reportQos:function(e){var t=e.result,n=e.statusCode,a=e.events;new u({name:S,retryCount:0,totalRetries:0,eventCount:a?a.length:0}).end({success:0===t,status:n+""}),""!==l.authority&&new _(p,t,n,(new Date).getTime(),a).send()}}},b=t.getAuthToken?new g(function(){return(0,r.b)(o,void 0,void 0,function(){var e;return(0,r.e)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t.getAuthToken()];case 1:return e=n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:return[2,a=new C((0,r.a)({userAuthToken:e},m))]}})})}):a=new x(m);return s=i.customManager?b.attach(i.customManager):b.attach(c.a),function(){s(),a=void 0}}catch(e){return e instanceof n.Exception&&(e=new Error("Aria error: ".concat(e.toString()))),f.a.log(e),a=void 0,function(){}}},updateContext:function(e,t){if(void 0===t&&(t={}),a){var n=O(e,t.platformDetection);a.updateContext(n)}},isInitialized:function(e){return!!a},flushTelemetry:function(){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){switch(e.label){case 0:return a?[4,a.flush()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}},I=D,x=(i=l.b.requiredService,function(e){var t="function"==typeof i?i:function(){return i};return function(e){function n(n){var a=n.onLogEvent;return e.call(this,(0,r.a)((0,r.a)({},n),{onLogEvent:function(e){var n=a?a(e):e;if(n.data)return(0,r.a)((0,r.a)({},n),{data:(0,r.a)((0,r.a)({},n.data),{privacyClassification:t(n)})})}}))||this}return(0,r.d)(n,e),n}(e)})(b.a),C=(0,v.a)()(x);function O(e,t){return void 0===t&&(t=new p.a),(0,r.a)({AccountType:s.a[e.accountType],BrowserIsMobile:t.isMobile,BrowserIsPWA:t.isPWA,BrowserMajVer:t.browserMajor,BrowserMinVer:t.browserMinor,BrowserName:t.browserName,BrowserUserAgent:t.userAgent,CloudType:e.cloudType,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:e.isAuthenticated?1:0,Market:e.market,Manifest:e.manifest,OSName:t.osName,OSVersion:t.osVersion,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId||"",UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId,pageCorrelationId:e.pageCorrelationId,originalSession:e.originalSession,ResourceTenantId:e.resourceTenantId,listId:e.listId,product:e.product,SessionId:e.session,TenantId:e.siteSubscriptionId,UserAgent:t.userAgent,ServerGU:e.sideBySideToken},e.context||{})}var w,E,A=n(3),L=n(196);function k(){return n.e(29).then(n.t.bind(n,421,23))}var M={ODB:-990,ODC:"ForceEnableAria"},P={ODB:1607,ODC:"EnableAll1DSTelemetry"},T=function(){function e(){}return e.Init=function(e,t,n,a,i){void 0===n&&(n=k),e&&U(t)&&(w=n().then(function(n){I.Init(e,t,n,{offlineDetection:a,customManager:i})},function(e){}))},e.InitCustomerPromise=function(e,t,n,a){void 0===n&&(n=k),e&&U(t)&&(E=n().then(function(n){I.Init(e,t,n,{offlineDetection:a,customManager:(0,L.a)()})},function(e){}))},e.UpdateContext=function(e){w&&w.then(function(){I.updateContext(e)}).catch(function(){}),E&&E.then(function(){I.updateContext(e)}).catch(function(){})},Object.defineProperty(e,"logStartEvents",{get:function(){return I.logStartEvents},set:function(e){I.logStartEvents=e},enumerable:!1,configurable:!0}),e.flushTelemetry=function(){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){switch(e.label){case 0:if(!w)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,I.flushTelemetry()];case 2:case 3:return e.sent(),[3,4];case 4:return[2]}})})},e.getAriaTimeZone=function(e){var t=Math.abs(e),n=t%60,a=Math.floor(t/60);return"".concat(e>0?"-":"+").concat(a>=10?a:"0".concat(a),":").concat(n>=10?n:"0".concat(n))},e}();function U(e){var t=e.version,n=e.env2,a=!1;return A.a.isActivated("5C0A45DF-2014-4FE8-9D90-180A716AC309")||(a="onebox"===n),!(!A.b.isActivated("010437DC-D681-4308-A21E-8BD4ADE3783C","11/12/2021","Use session storage TAB test running flag to bypass client-side logging.")&&H("_isRunningTABTest"))&&("dev"!==t&&!a||!!o.c.isFeatureEnabled(M)||H("enableAriaUpload")||H("enableTelemetryUpload"))}function F(e){return!A.a.isActivated("79F3363C-046C-445A-A206-0B24F9D906A5")||U(e)}function H(e){var t=!A.b.isActivated("6DC50D29-3FD6-465C-9E8D-80A877497A9D","10/10/2022","Ensure that a boolean value is returned and not undefined.");try{if("sessionStorage"in window&&window.sessionStorage){var n=window.sessionStorage[e],a=n&&"true"===n.toLowerCase();return t?!!a&&"undefined"!=typeof console&&!!console:a&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function R(){return o.c.isFeatureEnabled(P)}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={Email:0,User:1,Group:2,Link:3,Public:4,Friends:5,Facebook:6,Application:7,GroupOwned:99}}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.anonymous=1]="anonymous",e[e.msa=2]="msa",e[e.aad=3]="aad"}(a||(a={}))}
,,function(e,t,n){n.d(t,{a:function(){return r}});var a,i,r={any:0,file:1,"!file":-1,folder:2,"!folder":-2,media:3,"!media":-3,photo:4,"!photo":-4,video:5,"!video":-5,document:6,"!document":-6,audio:7,"!audio":-7,word:8,"!word":-8,powerpoint:9,"!powerpoint":-9,excel:10,"!excel":-10,onenote:11,"!onenote":-11,zip:12,"!zip":-12,pdf:13,"!pdf":-13,text:14,"!text":-14,listItem:15,"!listItem":-15,published:16,"!published":-16};a=r,i={},Object.keys(a).forEach(function(e){i[a[e]]=e})}
,,function(e,t,n){n.d(t,{a:function(){return _},b:function(){return h}});var a=n(0),i=n(83),r=n(3),o=n(41),s=n(47),c=n(208),d=n(393),l=n(392),u=n(206),f=(0,l.a)()((0,d.a)()(c.a)),p=!r.b.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),m=!r.b.isActivated("D3B20610-CED8-4AAF-958B-8EC166C0A3D4","02/20/2024","build as experiment context");function _(e,t){var n,c,d,l,f,_=e.CorrelationId,h=e.systemUserKey,b=e.userLoginName,g=e.farmName,v=e.farmLabel,y=e.siteSubscriptionId,S=e.homeTenantId,D=e.aadTenantId,I=e.SideBySideToken;if(r.b.isActivated("0d905643-decb-4b91-8c6d-87348745d166"))n=_;else{var x=new s.a(window.location.href).getQueryParameter("sessionId");n=i.a.isValidGuid(x)?x:_}if(p){var C=function(e){var t=window.ODSP_EXPERIMENTS||{},n=void 0;for(var a in t)if(t.hasOwnProperty(a)){n=n||{};var i=t[a];i&&i._serverTime&&Date.now()-new Date(i._serverTime).getTime()<1296e6&&(n[a]=t[a])}return window.ODSP_EXPERIMENT_TAGS||(0,u.d)(e),{experiments:n,experimentTags:window.ODSP_EXPERIMENT_TAGS}}(e)||{};c=JSON.stringify(C.experiments),d=JSON.stringify(C.experimentTags),l=function(e){var t,n=e.ExpFeatures,a=void 0;if(n){a="";for(var i=0,r=n;i<r.length;i++)a+=(t=(r[i]>>>0).toString(2),"".concat(Array(32-t.length+1).join("0")).concat(t)).split("").reverse().join("")}return a}(e)}return m&&(f="undefined"!=typeof window?window._spModuleLink:void 0),(0,a.a)((0,a.a)((0,a.a)({UserId:h,FarmName:g,FarmLabel:v,AccountType:b?o.a[o.a.Business]:o.a[o.a.BusinessAnonymous],TenantID:y,ServerGU:I,Session:n,SessionId:n,HomeTenantId:S||D,ResourceTenantId:D},p?{Flights:l,Experiments:c,ExperimentTags:d}:{}),m&&f?{isBuildAsExperimentRunning:f.isBuildAsExperimentRunning,buildAsExperimentTargetVersion:f.targetBuildNumber}:{}),t)}function h(e){var t=e.pageContext,n=e.customerContext,i=(0,a.f)(e,["pageContext","customerContext"]),r=_(t,n||{});return new f((0,a.a)({contextProvided:r,disableCookies:t.isAnonymousGuestUser,ariaLogConfiguration:{collectorUrl:t.ariaCollectorUrl}},i))}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(53);function r(){return function(e){return function(e){function t(t){var n=t.contextProvided,r=(0,a.f)(t,["contextProvided"]),o=new i.a,s=o.osName,c=o.osVersion,d=(0,a.a)({OSName:s,OSVersion:c,UserAgent:navigator.userAgent},n);return e.call(this,(0,a.a)({context:d,logStartEvents:!0},r))||this}return(0,a.d)(t,e),t}(e)}}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(384);function r(){return function(e){return function(e){function t(t){var n=t.context,r=void 0===n?{}:n,o=(0,i.a)();return e.call(this,(0,a.a)((0,a.a)({language:window.navigator.language},t),{context:(0,a.a)((0,a.a)({},o),r)}))||this}return(0,a.d)(t,e),t}(e)}}}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(103),i=n(26),r=n(18),o=(n(58),(0,a.a)({eventName:"Action,Qos,",shortEventName:"Action"},{pageType:i.a.String,queryType:i.a.String,logStartEnd:i.a.Boolean},r.a))}
,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(52),i=n(26),r=n(284),o=(0,a.a)({eventName:"Verbose,Trace,",shortEventName:"Verbose"},{name:{isKey:!0,type:i.a.String},privacyClassification:{isPrefixingDisabled:!0,type:i.a.String}},r.a).withData({privacyClassification:i.b.requiredService})}
,function(e,t,n){n.d(t,{a:function(){return l},b:function(){return d},c:function(){return u},d:function(){return c}});var a=n(106),i=n(191),r=n(294),o=n(124),s=(null===a.a||void 0===a.a?void 0:a.a.mpcDomain)||"https://my.microsoftpersonalcontent.com";function c(e){var t=e.apiVersion,n=e.driveId,a=e.includeViewerId,r=void 0!==a&&a,c=e.migrationState,u=void 0!==c&&c;return n&&"me"!==n||(n=o.c||"me"),(0,i.a)(n)||u?("v1.0"===t&&(t="v2.0"),r?l(t):function(e){return void 0===e&&(e="v2.0"),"".concat(s,"/_api/").concat(e)}(t)):d(t)}function d(e){void 0===e&&(e="v1.0");var t=u(),n=(0,r.b)()===r.a.Dev?"storage.live-int.com":"api.onedrive.com";return"https://".concat(t).concat(n,"/").concat(e)}function l(e){return void 0===e&&(e="v2.0"),"".concat(s,"/personal/").concat(o.c,"/_api/").concat(e)}function u(){switch((0,r.b)()){case r.a.Soak2:return"soak2.test.";case r.a.Soak3:return"soak3.test.";case r.a.Dev:return"newapi.dev.";default:return""}}}
,,,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(0),i=n(105),r=n(18);function o(e,t){return void 0===t&&(t=i.a),function(e){function n(n){var i=e.call(this,n)||this;return n.pillar&&(i._customerPromise=new t({scenario:n.name,pillar:n.pillar,extraData:(0,a.a)((0,a.a)({},null==n?void 0:n.extraData),{isFromQosEvent:!0})}),n.veto&&(i._computeVeto=n.veto)),i}return(0,a.d)(n,e),n.prototype.end=function(t){this._customerPromise&&((null==t?void 0:t.resultType)===r.b.Success?this._customerPromise.end({resultType:null==t?void 0:t.resultType,errorCode:null==t?void 0:t.resultCode,extraData:(0,a.a)((0,a.a)({},null==t?void 0:t.extraData),{isFromQosEvent:!0})}):this._customerPromise.end({resultType:null==t?void 0:t.resultType,errorCode:null==t?void 0:t.resultCode,veto:this._computeVeto?this._computeVeto(t):"None",extraData:(0,a.a)((0,a.a)({},null==t?void 0:t.extraData),{isFromQosEvent:!0})})),e.prototype.end.call(this,t)},n}(e)}}
,,,,function(e,t,n){n.d(t,{a:function(){return a}});var a=n(3).a.isActivated("27B2AAD3-81D5-4366-8DC5-E8CCEAA8F883","12/06/2023")}
,,,,,,,,,,,,,function(e,t,n){n.d(t,{b:function(){return r}});var a=n(25),i="__automationBinding$elements";function r(e,t){var n=e[i];return n&&n[t]}t.a={init:function(e,t,n,r,o){if(a.applyBindingsToNode(e,{attr:{"data-automationId":t()}},o),o){var s=o.$component;if(s){var c=a.utils.unwrapObservable(t());if(c){var d=s[i];d||(d=s[i]={}),d[c]=e,a.utils.domNodeDisposal.addDisposeCallback(e,function(){d[c]&&delete d[c]})}}}}}}
,,function(e,t,n){n.d(t,{a:function(){return s},b:function(){return c}});var a=n(1);n(6),n(160),new Set;var i=n(3),r=a.createContext(void 0),o=r.Provider;function s(e){return a.createElement(o,{value:e.resources},e.children)}function c(){var e=a.useContext(r);if(!e)throw new Error("No ResourceScope available in the current React context. Use ResourcesContextProvider to inject a ResourceScope.");return e}i.a.isActivated("847D02E5-ACDB-4CD7-AE23-1A893384F3C1","7/28/2022","Dispose child resource scopes in the React tree")}
,,function(e,t,n){n.d(t,{a:function(){return H},b:function(){return R}});var a=n(0),i=n(52),r=n(26),o=(0,i.a)({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0},{message:r.a.String,stack:r.a.String,builtStack:r.a.String,line:r.a.Number,col:r.a.Number,url:r.a.String,privacyClassification:{isPrefixingDisabled:!0,type:r.a.String}}).withData({privacyClassification:r.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}),s=0;function c(e){var t,n,a;if(e){var i=e&&e.toString?e.toString():"InvalidMethod()",r=8===i.indexOf(" ")?9:0,o=i.indexOf(")")+1;if(0===(t=i.substring(r,o)).indexOf("function")||t.indexOf("(")<3){var s=o+50;a=s,(n=i=i.replace(/\s\s*/g," "))&&n.length>a&&(n=n.substr(0,a-3)+"..."),t=n+(s<i.length?"}":"")}}return t}function d(){var e,t=[];try{for(e=arguments.callee;e===u||e===d;)e=e?e.caller:e}catch(t){e=null}var n=0;try{for(;e&&n<10;)t.push(c(e)),e=e.caller,n++}catch(e){}return t}var l=[function(e){return"string"==typeof e&&0===e.indexOf("ResizeObserver loop limit exceeded")},function(e){return"string"==typeof e&&0===e.indexOf("ResizeObserver loop completed with undelivered notifications")}];function u(e,t,n,a,i){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&(l.some(function(t){return t(e,i)})||Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,t,n,a,i]))}catch(e){}var r=i&&i.stack,c=d().join("\n");r=r?r.replace(/[ \t]{2,}/g," "):"",c=c.replace(/[ \t]{2,}/g," ");var u={message:e,url:t,line:n,col:a,stack:r,builtStack:c};s<100?o.logData(u):100===s&&o.logData({message:"Hit max error limit of ".concat(100),url:"NA",line:0,col:0,stack:"",builtStack:""}),s++}window.onerror=u,n(286);var f=n(37),p=n(67),m=n(14),_=n(59),h=n(159),b=(0,i.a)({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise"},{message:r.a.String,extraData:r.a.String}).withData({privacyClassification:r.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}),g=new(function(){function e(){this._outstandingPromiseErrors={},this._async=new p.a}return e.prototype.log=function(e){var t=this,n=e.id;e.parent?e.handler&&delete this._outstandingPromiseErrors[n]:(this._outstandingPromiseErrors[n]=e,1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var e=t._outstandingPromiseErrors;t._outstandingPromiseErrors={},Object.keys(e).forEach(function(t){var n=e[t],a=n.exception?n.exception:n.error;if(a instanceof Error||a&&a.stack?m.c.isCanceled(n)||f.a.log(a):b.logData({message:"Promise with no error callback",extraData:(0,h.a)(a)}),window.console&&console.log){var i="Promise with no error callback:"+n.id;console.warn?console.warn(i):console.log(i),console.log(n),a&&a.stack&&console.log(a.stack)}})},0))},e}());new _.a(g).on(m.c,"error",g.log);var v,y,S=n(79),D=n(3),I=(0,i.a)({eventName:"PageInit,",shortEventName:"PageInit"},{screenWidth:r.a.Number,screenHeight:r.a.Number,availableScreenWidth:r.a.Number,availableScreenHeight:r.a.Number,renderWidth:r.a.Number,renderHeight:r.a.Number,browserWidth:r.a.Number,browserHeight:r.a.Number,devicePixelRatio:r.a.Number,referrer:r.a.String}),x=function(){function e(){}return e.init=function(){return v||(v=I.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0})),v},e}(),C=n(385),O=n(277),w=n(279),E=n(47),A=/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/gi,L=n(41),k=n(198),M=["authkey","redeem"],P=/authkey=[!a-zA-Z0-9%]*/gi,T=/authkey/gi,U=!D.a.isActivated("95C49F09-F787-482D-8620-762289668551","12/14/20212","Uses the new cleanstring method for Aria telemetry");function F(e,t){if(!T.test(t))return U?function(e,t){void 0===t&&(t={});var n,a=t.keyDeclaration,i=t.pathsToSanitize,r=void 0===i?[]:i,o=t.keysToSanitize,s=void 0===o?[]:o;if(a&&a.isKey&&(e=e.replace(A,"<guid>")),e.indexOf("http")<0)return e;try{n=new E.a(e)}catch(t){return e}if(""===n.getAuthority())return e;for(var c=e,d=!1,l=0;l<r.length;l++)if(n.getPath().indexOf(r[l])>=0){d=!0;break}if(d)c="".concat(n.getScheme(),"://").concat(n.getAuthority()).concat(n.getPath(),"<scrubbedquerystring>...");else{for(var u=n.getQueryAsObject(),f=0;f<s.length;f++){var p=s[f];u[p]&&(u[p]="<scrubbed>")}n.setQueryFromObject(u),c=n.getDecodedStringForDisplay()}return c}(e,{key:t,keysToSanitize:M}):(e&&(e=(e+="").replace(P,"")),e)}function H(e){void 0===e&&(e={}),x.init();var t=(0,O.getAriaContext)(),n="prod"===(0,O.getAriaEnvironment)()?w.ODCTenantTokens.prod:w.ODCTenantTokens.ppe;t.userId||(e.context&&e.context.userId?t.userId=e.context.userId.toString():t.accountType=L.a.ConsumerAnonymous),null==y||y.dispose(),e.initOneDS||(0,C.b)()?(y=new k.a({tenantToken:n,context:(0,a.a)((0,a.a)({},t),{context:e.context})}),(0,C.c)(t)&&y.attach(S.a)):(y=void 0,C.a.Init(n,(0,a.a)((0,a.a)({},t),{context:e.context})))}function R(e,t){var n=(0,O.getAriaContext)(),i=(0,a.a)((0,a.a)((0,a.a)({},n),t),{context:(0,a.a)((0,a.a)({},n.context),e)});y&&y.updateContext(i),C.a.UpdateContext(i)}S.a.cleanString=F,Object.getPrototypeOf(S.a).cleanString=F}
,,,,function(e,t,n){var a,i,r;n.d(t,{a:function(){return p}});var o=!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode),s=-1!==(null===(a=null===window||void 0===window?void 0:window.document)||void 0===a?void 0:a.cookie.indexOf("srr")),c=window&&"https://www.onedrive-tst.com"===(null===(i=window.location)||void 0===i?void 0:i.origin)&&-1!==(null===(r=window.document)||void 0===r?void 0:r.cookie.indexOf("devhost")),d=s||o||c,l="/files/fabric-cdn-prod_20240610.001",u="".concat("https://res-1.cdn.office.net").concat(l),f=d?u:"",p=function(e){var t,n;if(!f){var a=null===(n=null===(t=window.require)||void 0===t?void 0:t.toUrl)||void 0===n?void 0:n.call(t,"");f=a?"".concat(function(e){var t=e.indexOf("//"),n=e.indexOf("/"),a=t>-1&&t<=n?t+"//".length:-1;if(a>-1){var i=e.indexOf("/",a);return i>-1?e.slice(0,i):e}return""}(a)).concat(l):u}return"".concat(f).concat("")}()}
,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(158),i=function(){function e(e,t){e?(this.root=e.root,this.parent=e.current):this.root=this.parent=a.Empty,this.current=t||a.generate()}return e._getCorrelationVector=function(){var t;return"undefined"!=typeof window?t=window.rootVector:"undefined"!=typeof self&&(t=self.rootVector),t||new e},e.prototype.toString=function(){return"".concat(this.root,"#").concat(this.parent,"#").concat(this.current)},e.RootVector=e._getCorrelationVector(),e}()}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a=new(n(6).b)("navigation")}
,function(e,t,n){n(190);var a=n(129),i=n(25),r=function(){function e(e,t){var n=this;this._source=e,this._getKey=t,this._groupsByKeyId={},this.groups=i.observableArray(),this._initializeGroups(),(0,a.a)(this.groups,function(){n._mapping.dispose()})}return e.group=function(t,n){return new e(t,n).groups},e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),a=JSON.stringify(n),r=e._groupsByKeyId[a];return r?r.values.push(t):(r={key:n,values:i.observableArray([t])},e._groupsByKeyId[a]=r,e.groups.push(r)),{mappedValue:a,dispose:function(){r.values.peek().length>1?r.values.remove(t):(delete e._groupsByKeyId[a],e.groups.remove(r))}}}})},e}();t.a=r}
,,,,,,function(e,t,n){(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:0 16px;position:relative}.od-ShareHint.new{margin:0;padding:0;flex:1}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;display:none}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:1rem}.od-ShareHint .ms-Label{font-size:.75rem;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:.625rem;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:flex;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:.875rem;background:0 0;padding:10px 10px 10px 0;margin:0;opacity:0;transition:opacity .2s;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";border:0}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:.625rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint .od-ShareHint-data.copyLinkNotification{padding:0}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:2.25rem;height:1.5rem}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:1.5rem;border-bottom:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:#fff}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}])}
,,,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return o}});var a=n(91),i=n(92),r=1,o=new a.a("migrationStore",i.a.local)}
,,,,,,,,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i}});var a=n(0),i=function(){function e(e){this._items=[],this._maxSize=e}return Object.defineProperty(e.prototype,"isFull",{get:function(){return this._items.length>=this._maxSize},enumerable:!1,configurable:!0}),e.prototype.getAll=function(){return this._items.slice()},e.prototype.push=function(e){this._items.length>=this._maxSize&&(this._items.length=0),this._items.push(e)},e}(),r=function(){function e(e){if(e<=0)throw new Error("Size must be positive");this._size=e,this._buffer=new Array(e),this._length=0,this._head=-1}return e.prototype.push=function(e){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=e},e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[e]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length>=this._size},enumerable:!1,configurable:!0}),e.prototype.getAll=function(){var e=this._head+1;return this._length<this._size?this._buffer.slice(0,e):(0,a.g)((0,a.g)([],this._buffer.slice(e),!0),this._buffer.slice(0,e),!0)},e}()}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i},c:function(){return o}});var a=n(25);function i(e,t){var n,a=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=e.subscribe(function(){a(e.peek()-n)});return a(e.peek()),{dispose:function(){i.dispose(),r.dispose(),a(-e.peek())}}}function r(e,t){var n,a=function(e,n){var a=t.peek();void 0!==e&&a[e]--,void 0!==n&&(a[n]=(a[n]||0)+1),t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=e.subscribe(function(){a(n,e.peek())});return a(void 0,e.peek()),{dispose:function(){i.dispose(),r.dispose(),a(e.peek(),void 0)}}}function o(e,t){var n=e.peek(),i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=a.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){r.dispose(),o.dispose(),i.dispose()}}}}
,,,function(e,t,n){n.d(t,{a:function(){return a.a},b:function(){return i.a}}),n(126),n(41);var a=n(121),i=(n(18),n(58),n(26),n(79),n(103),n(52),n(104));n(290)}
,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return S}});var a=n(0),i=n(37),r=n(67),o=function(){function e(){this._localHandlers=[]}return e.init=function(){var e=this;this._initialized||(this._initialized=!0,this._originalBeforeUnload=window.onbeforeunload,window.onbeforeunload=window.__onbeforeunload=function(t){return e._handleBeforeUnload(t)})},e.registerHandler=function(e){this._handlers.push(e)},e.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}},e.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null},e._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var n=0;n<this._handlers.length;n++)try{if(t=this._handlers[n](!0))break}catch(e){i.a.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){i.a.log(e)}}return t||void 0},e.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e},e.prototype.registerHashNavDialogHandler=function(e){if(this._hashNavDialogHandler)throw Error("Registering HashNavDialogHandler when one is already set");this._hashNavDialogHandler=e},e.prototype.unregisterHashNavDialogHandler=function(){this._hashNavDialogHandler=void 0},e.prototype.allowHashNav=function(t,n){var a=void 0;if(!e._isDialogOpen&&!e._allowNavs){for(var r=0;r<e._handlers.length;r++)try{if(a=e._handlers[r](!1))break}catch(e){i.a.log(e)}a&&(e._isDialogOpen=!0,this._hashNavDialogCallback(a).then(function(){e._isDialogOpen=!1,e._allowNavs=!0,e._blockNavsAgainId||(e._blockNavsAgainId=e._async.setImmediate(function(){e._allowNavs=!1,e._blockNavsAgainId=null})),t&&t()},function(){e._isDialogOpen=!1,n&&n()}))}return!a&&!e._isDialogOpen},e.prototype.blockHashNav=function(t,n){var a=this,r=null;if(this._dialogWasJustDismissed)return this._dialogWasJustDismissed=!1,!1;for(var o=0;o<e._handlers.length;o++)try{if(r=e._handlers[o](!1))break}catch(e){i.a.log(e)}return!(!r||!this._hashNavDialogHandler||(this._hashNavDialogHandler(r,function(){a._dialogWasJustDismissed=!0,t()},n),0))},e.prototype.registerHandler=function(t){this._localHandlers.push(t),e.registerHandler(t)},e.prototype.unRegisterHandler=function(t){for(var n=0;n<this._localHandlers.length;n++)if(this._localHandlers[n]===t){this._localHandlers.splice(n,1);break}e.unRegisterHandler(t)},e.prototype.dispose=function(){for(var t=0,n=this._localHandlers;t<n.length;t++){var a=n[t];e.unRegisterHandler(a)}},e._handlers=[],e._async=new r.a,e._initialized=!1,e}(),s=o;o.init();var c=n(53),d=n(59),l=n(90),u=n(3),f=n(45),p=n(204);function m(e){return"string"==typeof e?e:(0,p.a)(e)}var _=window.history,h=window.applicationCache,b=new c.a,g=!u.a.isActivated("DE394832-0B5E-447E-B070-CFB40B970AFE"),v=u.a.isActivated("a6d295af-8283-417b-85ed-1090c39b73cf"),y=!u.a.isActivated("E2B6560C-7D5A-4493-ABF2-F2DE0CA09EEE"),S=function(){function e(e){void 0===e&&(e={}),this._viewParamsString="",this._dontBlockNextNav=!1;var t=e.disableHashConversion,n=void 0!==t&&t,a=e.disableNavigationEventListeners,i=void 0!==a&&a,r=e.shouldReloadOnNavigate,o=e.history,c=e.prettyPathMap;this._overrideHistory=o,this._shouldReloadOnNavigate=r,this._performHashConversion=!n,this._disableNavigationEventListeners=e.disableNavigationEventListeners,this._viewParams={},this._prettyPathMap=c,this.scope=new l.a,this._prevHash=window.location.hash,this._supportsHistoryApi=_&&!!_.pushState&&(!h||h.status===h.UNCACHED),this.beforeUnload=new s,this.scope.attach(this.beforeUnload),this._events=this.scope.attach(new d.a(this)),this._events.declare("change"),i||this.setNavEventListeners("on"),this._updateUrlState()}return Object.defineProperty(e.prototype,"_history",{get:function(){return this._overrideHistory?this._overrideHistory:history},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.setNavEventListeners("off"),this.scope.dispose()},Object.defineProperty(e.prototype,"viewParams",{get:function(){return this._viewParams},enumerable:!1,configurable:!0}),e.prototype.navigateTo=function(e){var t=this;if(g||this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)})){var n="string"==typeof e?{url:e}:e,a=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:void 0,r=e.hasOwnProperty("directOpen")?e.directOpen:void 0,o=void 0,s=void 0;if(i&&"#"===i[0]?(o=i.substr(1),s=a):(o="#"===a[0]?a.substr(1):void 0,s=void 0),void 0===n.frameId&&b.isPWA&&"#"!==a&&(n.frameId="_blank"),void 0!==o)n.ignoreHistory?this._replaceState(o,!1,s):this._pushState(o,s);else{var c=void 0,d=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{(c=window.open(r?a:"",n.frameId))&&"_blank"===n.frameId&&(c.opener=null),c&&!r&&(this._disableNavigationEventListeners&&"#"===a?this.updateViewParams("",{ignoreHistory:n.ignoreHistory,clearOtherParams:!0}):c.location.href=a),d=!0}catch(e){}if(!c&&!d)try{n.ignoreHistory?window.location.replace(a):window.location.href=a}catch(e){}}}},e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var n="string"==typeof e?(0,f.a)(e):e,i=(0,a.a)((0,a.a)({},t.clearOtherParams?{}:this._viewParams),n);!v&&t.paramsToDelete&&t.paramsToDelete.forEach(function(e){delete i[e]}),t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)},e.prototype.updateViewParamsWithoutHistoryChange=function(e){var t={type:"popstate",state:{viewParams:e,useViewParamsFromState:!0}};this._updateUrlState(t)},e.prototype.getUrlFromViewParams=function(e){var t=m(e),n=this._getStateUrl(e,t);return"".concat(window.location.origin).concat(n)},e.prototype.reload=function(){window.location.reload()},e.prototype.setNavEventListeners=function(e){var t=("on"===e?this._events.on:this._events.off).bind(this._events);t(window,"hashchange",this._updateUrlState),t(window,"popstate",this._updateUrlState)},e.prototype._updateUrlState=function(e){var t=this,n=!1;if(g?!this.beforeUnload.blockHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()}):this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var a=function(e){var t,n,a,i=e||{},r=i.event,o=i.prettyPathMap,s=!1,c="";(null===(n=null===location||void 0===location?void 0:location.href)||void 0===n?void 0:n.indexOf("#"))>-1?(c=location.hash.substr(1),s=!0):(null===(a=null===location||void 0===location?void 0:location.search)||void 0===a?void 0:a.length)&&(c=location.search.substr(1));var d=(0,f.a)(c);o&&(d=(t=o.getEffectiveViewParamState({currentPathname:(null===location||void 0===location?void 0:location.pathname)||"",actualViewParams:d,actualViewParamsString:c})).viewParams,c=t.viewParamsString);var l=function(e){var t="";if(e&&"popstate"===e.type&&e.state){var n=e.state,a=n.useViewParamsFromState,i=n.viewParams;a&&i&&(t=m(i))}return t}(r),u=(0,f.a)(l),p=u,_=l;for(var h in d)if(u[h]!==d[h]){p=d,_=c;break}return{viewParams:p,viewParamsString:_,usingHashParams:s}}({event:e,prettyPathMap:this._prettyPathMap}),i=a.viewParams,r=a.usingHashParams,o=a.viewParamsString;o!==this._viewParamsString&&(this._viewParamsString=o||"",this._viewParams=i,n=!0),e&&this._shouldReloadOnNavigate&&this._shouldReloadOnNavigate()&&window.location.reload(),r&&this._performHashConversion&&this._supportsHistoryApi&&this._replaceState(o),n&&this._events.raise("change"),this._prevHash=y?window.location.hash:window.document.location.hash}else n=!1,e&&e.preventDefault();return n},e.prototype._resetBeforeNavBlock=function(){if(this._dontBlockNextNav=!0,this._supportsHistoryApi)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)},e.prototype._pushState=function(e,t){var n=m(e);if(this._supportsHistoryApi)try{var a=this._getStateUrl(e,n,void 0);this._history.pushState({},"",a)}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState(),t&&this._setMaskUrl(t)},e.prototype._replaceState=function(e,t,n){var a=m(e);if(this._supportsHistoryApi)try{var i=this._getStateUrl(e,a,t);this._history.replaceState({},"",i)}catch(e){this._supportsHistoryApi=!1,this._hashNav(a)}else this._hashNav(a);this._updateUrlState(),n&&this._setMaskUrl(n)},e.prototype._setMaskUrl=function(e){if(e&&this._supportsHistoryApi){var t={useViewParamsFromState:!0,viewParams:this._viewParams};this._history.replaceState(t,"",e)}},e.prototype._getStateUrl=function(e,t,n){var a=y?window.location.pathname:document.location.pathname;return this._prettyPathMap?this._prettyPathMap.getUpdatedUrl({currentPathname:a,viewParams:e,viewParamsString:t,clearPath:n}):function(e){var t=e.viewParamsString;return"".concat(e.clearPath?"/":e.pathname).concat(t.length>0?"?":"").concat(t)}({pathname:a,viewParamsString:t,clearPath:n})},e.prototype._hashNav=function(e){y?window.location.hash=e:document.location.hash=e},e}()}
,function(e,t,n){n.d(t,{a:function(){return a.a}});var a=n(107)}
,,,function(e,t,n){n(3).a.isActivated("682BEBB8-F1C8-486D-8B3F-0C75B53F6DC3","12/01/2022","Skip convert if driveId/cid is from sharepoint")}
,function(e,t,n){n.r(t),n.d(t,{OneDSTelemetryHandler:function(){return i.a},getCustomerPromiseHandler:function(){return r}});var a=n(309),i=n(198);function r(e){var t=e.tenantToken,n=(0,a.getCustomerPromiseContext)(e);return new i.a({tenantToken:t,context:{context:n}})}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(161);function r(e){return(0,a.b)(this,void 0,void 0,function(){var t,n,r,o,s,c,d;return(0,a.e)(this,function(a){switch(a.label){case 0:return[4,Promise.all(e.map(function(e){return e.then(function(e){return{result:e}},function(e){return{error:e}})}))];case 1:for(t=a.sent(),n=[],r=[],o=!0,s=0,c=t;s<c.length;s++)"error"in(d=c[s])?((0,i.c)(d.error)||(o=!1),r.push(d.error)):(n.push(d.result),o=!1);if(r.length>0)throw o?new i.a:r[0];return[2,n]}})})}}
,,function(e,t,n){var a,i=n(494),r=n(53),o=function(){function e(){}return e.hasClass=function(e,t){return e.classList?e.classList.contains(t):-1!==(e.className?e.className.split(" "):[]).indexOf(t)},e.toggleClass=function(e,t,n){if(e.classList)n?e.classList.add(t):e.classList.remove(t);else{var a=e.className?e.className.split(" "):[],i=a.indexOf(t);n?-1===i&&a.push(t):i>-1&&a.splice(i,1),e.className=a.join(" ")}},e.loadStyles=function(t){e._platform.isUnlimitedStyleSheetsSupported?e.registerStyle(t):e.registerStyleIE(t)},e.registerStyle=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode(e)),t.appendChild(n)},e.registerStyleIE=function(t){var n=document.getElementsByTagName("head")[0],a=e._lastStyleElement?e._lastStyleElement.styleSheet.cssText:"";(!e._lastStyleElement||a.length+e._styleText.length>e.MAX_STYLE_CONTENT_SIZE)&&(e._lastStyleElement=document.createElement("style"),e._lastStyleElement.type="text/css",n.appendChild(e._lastStyleElement)),e._lastStyleElement.styleSheet.cssText+=t},e.loadStylesheet=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.head.appendChild(t)},e.setText=function(t,n){void 0===a&&(a=void 0!==e.ce("div").textContent?"textContent":"innerText"),t[a]=n},e.ce=function(e,t,n){var a=document.createElement(e);if(t)for(var i=Object.keys(t),r=0;r<i.length;r++){var o=i[r];a.setAttribute(o,t[o])}if(n)for(var s=0;s<n.length;s++)a.appendChild(n[s]);return a},e.setShadowParent=function(t,n){t[e.SHADOW_PARENT_KEY]=n},e.getParent=function(t,n){return void 0===n&&(n=!0),n&&t[e.SHADOW_PARENT_KEY]||t.parentElement},e.ct=function(e){return document.createTextNode(e)},e.createComment=function(e){return document.createComment(e)},e.clickElement=function(e){e.onclick?e.onclick(void 0):e.click&&e.click()},e.insertAfter=function(e,t){var n=t.parentNode,a=t.nextSibling;a?n.insertBefore(e,a):n.appendChild(e)},e.waitForElement=function(e,t,n,a){var i=a||document,r=i.querySelector(e);if(!r){var o=new MutationObserver(function(n,a){var r=i.querySelector(e);r&&(t(r),a.disconnect())});return o.observe(n||a||document.documentElement,{childList:!0,subtree:!0}),o}t(r)},e.getElementByTagAndPartialId=function(e,t,n){for(var a=[],i=e.getElementsByTagName(t),r=0;r<i.length;r++)i[r].id.indexOf(n)>=0&&a.push(i[r]);return a.length>0?a[0]:null},e.findAncestor=function(t,n,a){for(void 0===a&&(a=!0);t&&t!==document.body;){if(e.hasClass(t,n))return t;t=e.getParent(t,a)}return null},e.calculateRect=function(e,t){var n=e.getBoundingClientRect(),a=0,r=0,o=0,s=0;if(t){var c=window.getComputedStyle(e);a=parseFloat(c.marginLeft),r=parseFloat(c.marginRight),o=parseFloat(c.marginTop),s=parseFloat(c.marginBottom)}return new i.a(n.left-a,n.top-o,n.width+a+r,n.height+o+s)},e.calculateSubtreeRect=function(t){for(var n=null,a=[t];a.length>0;){t=a.shift();var r=e.calculateRect(t);r.width>0&&r.height>0&&(n=n?n.union(r):r);for(var o=0,s=t.children.length;o<s;o++)a.push(t.children[o])}return n||(n=new i.a),n},e.insertAtIndex=function(e,t,n,a){if(e&&t){n=n<0?0:n;for(var i=e.firstElementChild,r=0;r<n&&i;)a&&a!==i.tagName||r++,i=i.nextElementSibling;i?e.insertBefore(t,i):e.appendChild(t)}},e.MAX_STYLE_CONTENT_SIZE=1e4,e.SHADOW_PARENT_KEY="_OneDrive_shadowParent",e._platform=new r.a,e._lastStyleElement=null,e._styleText="",e}();t.a=o}
,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(495),i=function(e,t){this.width=0,this.height=0,this.width=e,this.height=t},r=function(){function e(t,n,i,r){if(this.x=0,this.y=0,this.width=0,this.height=0,0===arguments.length)this.x=0,this.y=0,this.width=0,this.height=0;else if(t instanceof e){var o=t;this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height}else if(t instanceof a.a){var s=t,c=n;this.x=s.x,this.y=s.y,this.width=c.width,this.height=c.height}else if("object"==typeof t&&"number"==typeof t.left&&"number"==typeof t.top&&"number"==typeof t.width&&"number"==typeof t.height){var d=t;this.x=d.left,this.y=d.top,this.width=d.width,this.height=d.height}else this.x=t,this.y=n,this.width=i,this.height=r}return e.prototype.clip=function(t){var n=new e(this);return n.x<t.x&&(n.width-=t.x-n.x,n.x=t.x),n.getRight()>t.getRight()&&(n.width-=n.getRight()-t.getRight()),n.y<t.y&&(n.height-=t.y-n.y,n.y=t.y),n.getBottom()>t.getBottom()&&(n.height-=n.getBottom()-t.getBottom()),n},e.prototype.contains=function(e){if(e instanceof a.a){var t=e;return t.x>=this.x&&t.y>=this.y&&t.x<=this.getRight()&&t.y<=this.getBottom()}var n=e,i=n.getPoint(),r=new a.a(n.getRight(),n.getBottom());return this.contains(i)&&this.contains(r)},e.prototype.getCenter=function(){return new a.a(this.x+this.width/2,this.y+this.height/2)},e.prototype.getLeft=function(){return this.x},e.prototype.getTop=function(){return this.y},e.prototype.getRight=function(){return this.x+this.width},e.prototype.getBottom=function(){return this.y+this.height},e.prototype.getPoint=function(){return new a.a(this.x,this.y)},e.prototype.getSize=function(){return new i(this.width,this.height)},e.prototype.inflate=function(t,n){var a,i;if("object"==typeof t){var r=t;a=r.width,i=r.height}else a=t,i=n;return new e(this.x-a/2,this.y-i/2,this.width+a,this.height+i)},e.prototype.nudge=function(t){var n=new e(this);return n.x<t.x?n.x=t.x:n.getRight()>t.getRight()&&(n.x=t.getRight()-n.width),n.y<t.y?n.y=t.y:n.getBottom()>t.getBottom()&&(n.y=t.getBottom()-n.height),n},e.prototype.translate=function(t,n){var i;if(t instanceof a.a){var r=t;i=this.translate(r.x,r.y)}else{var o=t,s=n;i=new e(this.x+o,this.y+s,this.width,this.height)}return i},e.prototype.union=function(t){var n=Math.min(this.x,t.x),a=Math.min(this.y,t.y);return new e(n,a,Math.max(this.x+this.width,t.x+t.width)-n,Math.max(this.y+this.height,t.y+t.height)-a)},e.prototype.fit=function(t,n){var a=t;a=this.width&&this.height&&(n?this.width>a.width||this.height>a.height:this.width>a.width&&this.height>a.height)?this._scaleTo(t,n):this;var i=(t.width-a.width)/2,r=(t.height-a.height)/2;return new e(i+this.x,r+this.y,a.width,a.height)},e.prototype._scaleTo=function(t,n){var a=t.width/t.height,i=this.width/this.height,r=0,o=0;return(n?i:a)<(n?a:i)?(o=t.height,r=i*t.height):(r=t.width,o=t.width/i),new e(this.x,this.y,r,o)},e}(),o=r}
,function(e,t,n){var a=function(){function e(t,n){if(void 0===t&&(t=0),void 0===n&&(n=0),t instanceof e){var a=t;this.x=a.x,this.y=a.y}else this.x=t,this.y=n}return e.areEqual=function(e,t,n){return void 0===n&&(n=1e-6),Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n},e.getCenter=function(t){return t.reduce(function(e,t){return e.add(t)},e.ORIGIN).scale(1/t.length)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.distance=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},e.prototype.negate=function(){return new e(-this.x,-this.y)},e.prototype.abs=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.unit=function(){var e=this.abs();return this.scale(e&&1/e||0)},e.prototype.toString=function(){return"[Point ".concat(this.x,", ").concat(this.y,"]")},e.ORIGIN=new e,e}();t.a=a}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.uninitialized=0]="uninitialized",e[e.AddressBarLink=1]="AddressBarLink"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return c},c:function(){return o},d:function(){return s},e:function(){return r}});var a,i=n(498);!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(a||(a={}));var r,o={none:0,icon:1,name:2,title:3,calloutInvoker:4,shareHeroCommand:5,modified:6,url:7},s={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};!function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(r||(r={}));var c=i}
,function(e,t,n){n.r(t),n.d(t,{docAlreadyExists:function(){return s},fileNotFound:function(){return i},invalidView:function(){return r},listNotFound:function(){return o},newExperieceRenderingNotSupported:function(){return d},offline:function(){return f},onePageNavigationError:function(){return u},onePageNavigationViewMismatch:function(){return l},parsingError:function(){return p},queryThrottled:function(){return c},urlTooLongError:function(){return a.a}});var a=n(298),i=-2147024894,r=-2147024809,o=-1,s=-2130575257,c=-2147024860,d=-2,l=-3,u=-4,f=-5,p=-7}
,function(e,t,n){n.d(t,{a:function(){return l}});var a=n(0),i=n(1),r=n(122),o=n(15),s=n(215),c=0,d=(0,o.a)(function(e){return"".concat(++c)});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=(0,s.a)(function(e,t){n(function(n){var i,o=d(t);return(0,a.a)((0,a.a)({},n),((i={})[o]=r.createPortal(e,t),i))})}),c=(0,s.a)(function(e){n(function(t){var n=t,i=d(e);return n[i],(0,a.f)(n,["symbol"==typeof i?i:i+""])})}),l=i.useRef(),u=l.current||(l.current={render:o,unmount:c}),f=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[u,f]},[u,f])}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(1),i=n(322);function r(e,t){var n=a.useRef();return(0,i.a)(n.current,t,{debug:!0})&&(n.current=t),a.useMemo(e,[n.current])}}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.TooManyChildItemsWithUniqueScopes=-13]="TooManyChildItemsWithUniqueScopes",e[e.SharingToBlockedUserOnODB=-62]="SharingToBlockedUserOnODB",e[e.SharingToBlockedBySiteRAC=-84]="SharingToBlockedBySiteRAC"}(a||(a={}))}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a={ShareToTeams:0,SimplifiedV2:1}}
,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(130),i=n(505),r=n(3).a.isActivated("77387d2b-5c80-4bec-8d0c-30b8358fc3b0","2/13/2024","Checks isListSharing to determine if listItemId should be appended"),o=function(){function e(e){this._pageContext=e.pageContext,this._listId=e.listId,this._listItemId=e.listItemId,this._webAbsoluteUrl=e.webAbsoluteUrl,this._isListSharing=e.isListSharing}return e.prototype.getAdvancedUrl=function(){var e=[this._webAbsoluteUrl];if(e.push("/_layouts/15/user.aspx"),e.push("?List="+a.a.encodeURIComponent(this._listId)),!this._isListSharing||r){if(!this._listId||!this._listItemId)return;e.push("&obj=",a.a.encodeURIComponent(this._listId),",",a.a.encodeURIComponent(this._listItemId),",LISTITEM")}return Number(this._pageContext.webTemplate)===i.b.group&&e.push("&noredirect=true"),e.join("")},e}()}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.invalid=-1]="invalid",e[e.teamSite=1]="teamSite",e[e.meetings=2]="meetings",e[e.centralAdmin=3]="centralAdmin",e[e.wiki=4]="wiki",e[e.documentCenter=7]="documentCenter",e[e.blog=9]="blog",e[e.tenantAdmin=16]="tenantAdmin",e[e.app=17]="app",e[e.appCatalog=18]="appCatalog",e[e.mySite=21]="mySite",e[e.subgroup=39]="subgroup",e[e.publishingPortal=52]="publishingPortal",e[e.mySiteHost=54]="mySiteHost",e[e.enterpriseWiki=56]="enterpriseWiki",e[e.group=64]="group",e[e.pointPublishingPersonal=66]="pointPublishingPersonal",e[e.sitePagePublishing=68]="sitePagePublishing",e[e.teamChannel=69]="teamChannel",e[e.projectWebAppSite=6221]="projectWebAppSite",e[e.contentCenter=6001]="contentCenter"}(a||(a={}));for(var i={},r=0,o=Object.keys(a);r<o.length;r++){var s=o[r];"string"==typeof s&&(i[s.toUpperCase()]=a[s])}t.b=a}
,function(e,t){var n=/[<>&'"\\]/g,a=/(&lt;|&gt;|&amp;|&quot;|&#39;|&#92;)/g,i={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"},r={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&#39;":"'","&#92;":"\\"};function o(e){return i[e]}var s=function(){function e(){}return e.encodeText=function(e){return e?e.replace(n,o):""},e.decode=function(e){return e?e.replace(a,function(e){return r[e]}):""},e}();t.a=s}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return a},c:function(){return i}});var a=function(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""},i=function(e,t,n,a,i){var r="",o=a||"/";if(n){var s=new Date;s.setTime(s.getTime()+24*n*60*60*1e3),r=" expires= + ".concat(s.toUTCString()," + ;")}var c="";i&&(c=" samesite=".concat(i,";"),"none"===i.toLowerCase()&&(c+=" secure;")),document.cookie="".concat(e,"=").concat(t,";").concat(r," path=").concat(o,";").concat(c)},r=function(e){document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")}}
,,function(e,t,n){function a(e){return e?e.endTime-e.startTime:0}function i(e){return!(!e||!e.startTime&&0!==e.startTime||!e.endTime&&0!==e.endTime||!(e.endTime>e.startTime))}n.d(t,{a:function(){return r}});var r=function(e){var t=e.controlId,n=e.startTime,r=e.endTime,o=e.ignoreForEUPL,s=e.needFlatten,c=e.renderTimeCalculator,d=void 0===c?a:c,l=e.renderTimeRequiredDataChecker,u=void 0===l?i:l;this.controlId=t,this.startTime=n,this.endTime=r,this.renderTimeCalculator=d,this.renderTimeRequiredDataChecker=u,this.ignoreForEUPL=void 0===o||o,this.needFlatten=void 0!==s&&s}}
,function(e,t,n){function a(e){return e?function(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}(decodeURIComponent(e).split(".")[1]):{}}function i(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}}function r(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var a=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof a||n<a)}n.d(t,{a:function(){return i},b:function(){return r},c:function(){return a}})}
,,,,,,,,,,,,,function(e,t,n){n.d(t,{a:function(){return V}});var a={};n.r(a),n.d(a,{indexedDB:function(){return c},localStorage:function(){return s},none:function(){return d}});var i,r=n(0),o=n(14),s=0,c=1,d=2,l=a,u=n(53),f=n(158),p="undefined"==typeof window?self:window,m=n(18),_=n(3).b.isActivated("18a3d374-cced-4d7f-be15-3b0a8dda8152");!function(e){e.success="success",e.error="error"}(i||(i={}));var h="app",b="app_lastRead",g="ODSP_DB",v="ODSP_DB_TABLE",y="lastModified",S="lastRead",D="ODSP_DB_METADATA_TABLE",I="database_metadata",x="parentKey",C="reads",O=(new u.a).isFirefox,w="indexedDB is not supported",E=function(){function e(t){if(!("indexedDB"in p)||!p.indexedDB)throw new Error(w);var n,a;this._logger=t,e._openDBPromise||(_||(n=this._logger({name:"PersistentCacheIDB.openDB"}),a=Date.now()),e._openDBPromise=this._openIndexedDB().then(function(t){return _||n&&n({resultType:m.b.Success,extraData:{dbOpen:Math.round(Date.now()-a)}}),e._db=t,t}).catch(function(e){throw _||n&&n({resultType:m.b.Failure,error:e.message?e.message:e.toString()}),e}))}return e.prototype.freeSpace=function(t,n){return(0,r.b)(this,void 0,void 0,function(){var a,i,o,s=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=a.transaction([v],"readwrite").objectStore(v).index(b).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(t){return[2,this._readInternal(v,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return(0,r.b)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,h=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return n={},i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=a.transaction([v],"readonly"),c=s.objectStore(v),d=[],l=t.index,u=t.range,f=t.direction,p=t.count,m=c.index(l),(_=m.openKeyCursor(u,f)).onerror=function(e){h._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=p?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return(0,r.b)(this,void 0,void 0,function(){var t;return(0,r.e)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:v,key:t,row:(0,r.a)((0,r.a)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:v,key:t,row:void 0})]})})},e.prototype.statistics=function(){return(0,r.b)(this,void 0,void 0,function(){var e,t;return(0,r.e)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(v,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=O?indexedDB.open(g,{version:4,storage:"temporary"}):indexedDB.open(g,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(v,{keyPath:"key"})).createIndex(y,y,{unique:!1}),a.createIndex(C,C,{unique:!1}),t.createObjectStore(D,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(v)).createIndex(h,h,{unique:!1}),a.createIndex(S,S,{unique:!1}),a.createIndex(b,[h,S],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(v)).createIndex("app_lastModified",[h,y],{unique:!1}),a.createIndex("app_reads",[h,C],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(v)).createIndex(x,x,{unique:!1}),a.createIndex("parentKey_app",[x,h],{unique:!1}),a.createIndex("parentKey_app_lastModified",[x,h,y],{unique:!1}),a.createIndex("parentKey_app_lastRead",[x,h,S],{unique:!1}),a.createIndex("parentKey_app_reads",[x,h,C],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(D,function(e){return e.get(I)}).then(function(t){if(t)return t.data;var n={id:f.generate(),created:Date.now(),cacheType:l.indexedDB};return e._writeInternal({tableName:D,key:I,row:{key:I,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return(0,r.b)(this,void 0,void 0,function(){var a,i,o,s=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){r({resultType:m.b.Success,extraData:{io:Math.round(Date.now()-o)}}),e(d.result)},d.onerror=function(e){r({resultType:m.b.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return(0,r.b)(this,void 0,void 0,function(){var a,i,o,s,c=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return(0,r.b)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return n=t.tableName,a=t.key,i=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=r.sent(),r.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var r=o.transaction([n],"readwrite"),s=r.objectStore(n);r.oncomplete=function(){},r.onerror=function(e){d._errorHandling(e,t)};var c=i?s.put(i):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n=this;return(0,r.e)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:x,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:v,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===i.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),A="PersistentCache",L="PersistentCache_metadata",k=function(){function e(){try{if("localStorage"in p&&p.localStorage&&(this._localStorage=p.localStorage,!this._localStorage.getItem(L))){var e={id:f.generate(),created:Date.now(),cacheType:l.localStorage};this._localStorage.setItem(L,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=(0,r.a)((0,r.a)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(A)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(L)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(A,"_").concat(e)},e}(),M=0,P=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return(0,r.b)(n,void 0,void 0,function(){var e;return(0,r.e)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:M++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=p.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function T(){return p.performance&&performance.now?Math.round(performance.now()):Date.now()}var U=n(58),F="_odspcache_",H="_____",R={cacheType:l.indexedDB},N=function(){function e(e){var t=e.cacheType,n=void 0===t?R.cacheType:t,a=(0,r.f)(e,["cacheType"]);if(this._config=(0,r.a)((0,r.a)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new P,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i,o,s,c;return(0,r.e)(this,function(r){switch(r.label){case 0:t=e.cacheKey,n=e.validBufferTime,a=this._logQos({name:"PersistentCache.read"}),o=T(),Date.now(),r.label=1;case 1:return r.trys.push([1,4,,5]),(s=this._getStorageKey(t))?[4,this._getData({cacheKey:t,storageKey:s,validBufferTime:n})]:[3,3];case 2:i=r.sent(),r.label=3;case 3:return i=i||{key:{original:t,encoded:s},app:this._app,data:void 0,cacheStats:{lastModified:NaN,lastRead:NaN,reads:0},cacheType:this._cacheType,performance:{total:Math.round(T()-o)}},[3,5];case 4:throw c=r.sent(),a({resultType:U.a.Failure,error:c.message?c.message:c.toString(),extraData:{cacheResult:"miss"}}),c;case 5:return a({resultType:U.a.Success,extraData:{cacheResult:"".concat(void 0!==i.data?"hit":"miss")}}),[2,Promise.resolve(i)]}})})},e.prototype.rangeQuery=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i,o,s,c,d=this;return(0,r.e)(this,function(r){if(this._cacheType!==l.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=T(),i=Date.now(),s={lastModified:NaN,lastRead:i,reads:1};try{c=T(),o=this._storage.rangeQuery(e).then(function(e){return n=Math.round(T()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:d._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:s,cacheType:d._cacheType,performance:{io:n,total:Math.round(T()-a)}}})}catch(e){throw t({resultType:U.a.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:U.a.Success}),[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:n,total:Math.round(T()-a)}})]})})},e.prototype.update=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i=this;return(0,r.e)(this,function(r){switch(r.label){case 0:return t=e.cacheKey,n=e.data,a=this._getStorageKey(t),[4,this._cacheUpdateTaskManager.enqueue(a,function(){return i._doCacheUpdate(t,n)}).signal.promise];case 1:return r.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){var t=e.cacheKey;return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(e){return[2,this.update({cacheKey:t,data:void 0})]})})},e.prototype.freeSpace=function(e,t){return(0,r.b)(this,void 0,void 0,function(){return(0,r.e)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e){return(0,r.b)(this,void 0,void 0,function(){var t,n,a,i,o,s,c,d,u=this;return(0,r.e)(this,function(r){switch(r.label){case 0:t=e.cacheKey,n=e.getData,a=T(),i=Date.now(),o=this._logQos({name:"PersistentCache.readAndUpdate"}),s=n().then(function(e){var n={app:u._app,key:{original:t,encoded:u._getStorageKey(t)},data:e,cacheType:l.none,cacheStats:{lastModified:void 0,lastRead:i,reads:1},performance:{total:Math.round(T()-a)}};return u.update({cacheKey:t,data:e}),n}),r.label=1;case 1:r.trys.push([1,8,,9]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Promise.race([this.read(e),s])];case 3:return c=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return!c||c.cacheType!==l.none&&void 0===c.data?[4,s]:[3,7];case 6:c=r.sent(),r.label=7;case 7:return[3,9];case 8:throw d=r.sent(),o({resultType:U.a.Failure,error:d.message?d.message:d.toString()}),d;case 9:return o({resultType:U.a.Success}),[2,c]}})})},e.prototype._initLocalStorage=function(e){if(e===l.localStorage)this._storage=new k;else try{this._storage=new E(this._logQos.bind(this))}catch(e){e.message===w&&(this._storage=new k,this._cacheType=l.localStorage)}},e.prototype._getStorageKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?H+e.user:""));return"".concat(F).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(F,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(H)>=0){var i=a.split(H);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._getData=function(t){var n,a;return(0,r.b)(this,void 0,void 0,function(){var i,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C=this;return(0,r.e)(this,function(O){switch(O.label){case 0:return i=t.cacheKey,o=t.storageKey,s=t.validBufferTime,c=T(),(d=e._buffer[o])&&s&&c-d.readTime<s?[2,d.data]:(l=T(),u=Date.now(),[4,this._storage.read(o)]);case 1:if(f=O.sent(),p=Math.round(T()-l),m={lastModified:(null==f?void 0:f.lastModified)||NaN,lastRead:u,reads:((null==f?void 0:f.reads)||0)+1},_=void 0,h=function(t){var n=(0,r.a)({cacheStats:m,cacheType:C._cacheType,app:(null==f?void 0:f.app)||C._app,key:{original:i,encoded:(null==f?void 0:f.key)||o},performance:{io:p,crypto:_,total:Math.round(T()-c)}},t);return e._buffer[o]={data:n,readTime:l},n},!f)return[2,h({data:void 0})];if(f.lastModified&&(null===(a=null===(n=null==d?void 0:d.data)||void 0===n?void 0:n.cacheStats)||void 0===a?void 0:a.lastModified)===f.lastModified)return[2,h(d.data)];if(void 0===(b=f.data))return[2,h({data:void 0})];if(!this._dataIsEncrypted)return[2,h({data:b})];g=b,v=this._cacheSecret,y=v.CurrentKey.Key,S=v.PreviousKey.Key,D=T(),O.label=2;case 2:return O.trys.push([2,4,,7]),[4,this._crypto.decrypt({encryptedData:g,encryptionSecret:y})];case 3:return I=O.sent(),[3,7];case 4:return(x=O.sent())&&x.message&&x.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:g,encryptionSecret:S})]:[3,6];case 5:void 0!==(I=O.sent())&&this.update({cacheKey:i,data:I}),O.label=6;case 6:if(void 0===I)throw x;return[3,7];case 7:return _=Math.round(T()-D),[2,h({data:I})]}})})},e.prototype._doCacheUpdate=function(t,n){var a;return(0,r.b)(this,void 0,void 0,function(){var i,o,s,c,d,u,f;return(0,r.e)(this,function(p){switch(p.label){case 0:i=this._logQos({name:"PersistentCache.update"}),p.label=1;case 1:return p.trys.push([1,9,,10]),o=this._getStorageKey(t),void 0===n?[3,6]:(s=(0,r.a)((0,r.a)({cacheStats:{lastModified:NaN,lastRead:T(),reads:1}},null===(a=e._buffer[o])||void 0===a?void 0:a.data),{data:n,app:this._app,cacheType:this._cacheType,key:{original:t,encoded:o}}),e._buffer[o]={data:s,readTime:T()},c=n,d=NaN,this._dataIsEncrypted?(u=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:u,data:n,doSerialize:this._cacheType===l.localStorage})]):[3,3]);case 2:return c=p.sent(),d=c.cipherText?c.cipherText.byteLength:0,[3,4];case 3:try{d="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}p.label=4;case 4:return[4,this._storage.write({app:this._app,key:o,data:c,lastRead:s.cacheStats.lastRead,parentKey:t.parentKey,reads:s.cacheStats.reads,size:d})];case 5:return p.sent(),[3,8];case 6:return delete e._buffer[o],[4,this._storage.write({key:o,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:p.sent(),p.label=8;case 8:return[3,10];case 9:throw f=p.sent(),i({resultType:U.a.Failure,error:f.message?f.message:f.toString()}),f;case 10:return i({resultType:U.a.Success}),[2]}})})},e.prototype._logCacheStats=function(){return(0,r.b)(this,void 0,void 0,function(){var e=this;return(0,r.e)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return(0,r.b)(e,void 0,void 0,function(){return(0,r.e)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),B=n(350),j=n(524),V=function(){function e(e,t){this._getDataPromises={};var n=e.id,a=e.dataSourceName,i=e.cacheType,o=void 0===i?l.indexedDB:i,s=(t.pageContext||{}).aadUserId;this._id=n,this._userId=s;var c=a||n,d=m.a.withData(function(e){return e.name&&c&&!e.name.startsWith(c)?(0,r.a)((0,r.a)({},e),{name:"".concat(c,".").concat(e.name)}):e});this._cache=new N({cacheType:o,telemetry:{qos:d}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,r=void 0===i?B.a.useCacheAndUpdateInTheBackground:i,s=n.cacheTimeoutTime,c=void 0===s?j.c:s,d=n.getData,l=n.returnStatistics,u=void 0!==l&&l,f=n.cacheRequestParentKey,p={key:a,user:this._userId,parentKey:f},m=function(){var e=t._getDataPromises[a];if(!e){var n=d();t._getDataPromises[a]=n,e=n.then(function(e){return t._cache.update({cacheKey:p,data:e}).catch(function(){}),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})}return e.then(function(e){return u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return r===B.a.onlyCache?o.c.resolve(this._cache.read({cacheKey:p})).then(function(e){var t=e||{},n=t.data,a=t.cacheStats;return null==n?null:u?{data:n,cacheStats:a}:n}).catch(function(){return null}):o.c.resolve(this._cache.read({cacheKey:p})).then(function(e){var n=e||{},a=n.data,i=n.cacheStats;if(null==a)return m();var o=u?{data:a,cacheStats:i}:a,s=t._isCacheExpired(i.lastModified,c);switch(r){case B.a.useCacheAndNoUpdate:return o;case B.a.useCacheAndUpdateInTheBackground:return s&&m(),o;case B.a.useCacheIfNotExpired:return s?m():o;case B.a.bypassCache:default:return m()}},function(){return m()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove({cacheKey:n})},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update({cacheKey:n,data:t})},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}()}
,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return a},c:function(){return i}});var a=3e5,i=864e5,r="odsp-ds-"}
,,,,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0),i=n(353),r=n(529),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return(0,a.d)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.d.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.b),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return(0,a.d)(t,e),t}(o):d;return i._apiUrlType=l,i}return(0,a.d)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.a)}
,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return r}});var a=n(0),i=n(214),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl||this._webAbsoluteUrl||"",i=n.indexOf("?"),r=i>-1?n.slice(0,i):n,o=(0,a.g)([this._encodeWebAbsoluteUrl?encodeURI(r):r,"_api"],this._segments,!0);return"".concat(o.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&void 0!==e.lastParameterId&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&void 0!==e.parameters&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&void 0!==e.rawParameters&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&void 0!==e.segments&&(o=s._segments).push.apply(o,e.segments),s},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.a(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.a(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return(0,a.d)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()}
,function(e,t,n){n.d(t,{a:function(){return s}});var a=n(0),i=n(353),r=n(45),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.d)(t,e),t}(i.c),s=function(e){function t(t,n){var a=n.itemUrlPartsType,i=void 0===a?o:a;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}return(0,a.d)(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)},t.prototype.getItemUrlParts=function(e){var t=(0,r.a)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})},t}(i.b)}
,function(e,t,n){n.d(t,{a:function(){return u},b:function(){return l}});var a,i,r=n(38),o=n(3);!function(e){e[e.none=0]="none",e[e.standard=1]="standard",e[e.compact=2]="compact",e[e.minimal=3]="minimal",e[e.extended=4]="extended"}(a||(a={})),function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(i||(i={}));var s,c=o.b.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),d="undefined"!=typeof window&&r.c.isFeatureEnabled({ODB:1737});function l(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl,a=e.isSiteListsHost;return"/"===n||""===n||!c&&a||d&&(null==e?void 0:e.isUnifiedAdminUrl)?t:t.substring(0,t.lastIndexOf(n))}function u(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(s||(s={}))}
,function(e,t,n){var a=n(356),i=n(14),r=function(){function e(){}return e.start=function(e){var t=new a.a(e);return new i.c(function(e,n){t.start(e,n)},function(){t.abort(!0)})},e.startAndPostProcess=function(e,t){var n=new a.a(e);return new i.c(function(e,a){n.start(function(n,a){e(t(n,a))},a)},function(){n.abort(!0)})},e}();t.a=r}
,function(e,t,n){function a(e){return decodeURIComponent(escape(atob(e)))}function i(e){var t=function(e){try{var t=(e=e.replace(/-/g,"+").replace(/_/g,"/")).length%4;if(t){if(1===t)return"";e+=new Array(5-t).join("=")}return e}catch(e){return""}}(e);return!(e.length>0&&""===t)&&function(e){try{return!!btoa(atob(e)).match(/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/)}catch(e){return!1}}(t)}n.d(t,{a:function(){return a},b:function(){return i}})}
,function(e,t,n){n.d(t,{a:function(){return a},b:function(){return s},c:function(){return o}});var a,i=n(113),r=n(357);function o(e,t){var n;switch(e.size){case a.Large:n=r.a.Large;break;case a.Medium:n=r.a.Medium;break;default:n=r.a.Small}return(0,r.b)(e.userLoginName,n,t)}function s(e,t,n){var a=(0,r.b)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.a(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return l},b:function(){return f}});var a=n(14),i=n(18),r=n(202),o=n(91),s=n(92),c=n(38),d="DisableSubstrateSearch",l="https://outlook.office.com/search",u={ODB:1286},f=function(){function e(e,t){this._dataRequestor=new r.a({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation=t.sharingContextInformation,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&c.c.isFeatureEnabled(u,this._pageContext.ExpFeatures)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue(d,s.a.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(d,!0,s.a.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return a.c.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.a({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){return t.end({resultType:i.b.Success}),e},function(n){return a.c.isCanceled(n)?(t.end({resultType:i.b.ExpectedFailure,resultCode:"Canceled"}),a.c.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:i.b.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.warmUpInit=function(e){var t=this;this.canUseSubstrate()&&this.getSubstrateToken().then(function(n){t.init(n,e)})},e.prototype.init=function(e,t){var n,a;void 0===t&&(t="documentshare");var i="".concat(l,"/api/v1/init?scenario=").concat(t);this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:i,headers:{Authorization:"Bearer "+e,"X-AnchorMailbox":"OID:".concat(null===(n=this._pageContext)||void 0===n?void 0:n.aadUserId,"@").concat(null===(a=this._pageContext)||void 0===a?void 0:a.aadTenantId)},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new o.a("PeoplePicker",s.a.session))},e}()}
,function(e,t,n){function a(e){return e?"gallatin"===e:location.origin.indexOf(".cn")===location.origin.length-3}function i(e){return"pathfinder"===e||"trailblazer"===e}function r(e){return"ag08"===e||"ag09"===e}n.d(t,{a:function(){return r},b:function(){return a},c:function(){return i}})}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(0),i=n(538),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.noRedirect,s=t.normalizeErrors,c=t.dataRequestorType,d=void 0===c?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r,noRedirect:o})||this}return(0,a.d)(t,e),t}(i.b):c,l=e.dataSourceName,u=void 0===l?"DataSource":l;this.dataRequestor=new d({qosName:u,normalizeErrors:s})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h){void 0===i&&(i="POST");var b=e(),g=a&&a(),v=this.needsRequestDigest(b);return this.dataRequestor.getData({url:b,parseResponse:t,qosName:n,additionalPostData:g,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:v,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_,customerPromise:h})},e}();t.b=r}
,function(e,t,n){n.d(t,{a:function(){return ve},b:function(){return ye}});var a=n(0),i=n(14),r=n(54);function o(e){var t,n=e.adjustRetries,a=e.async,i=e.beforeRetry,o=e.callback,s=e.canRetry,c=void 0===s?function(){return!0}:s,d=e.delay,l=e.resetAttemptsOnRestart,u=e.shouldRestart,f=e.retries,p=0,m=new r.a(function(){t.cancel()});function _(e){u&&u()?(l&&(p=0),b()):m.complete(e)}function h(e){n&&(f=n(e)),p<f&&c(e)?(p++,i&&i(),"number"==typeof d&&a?a.setTimeout(b,d):b()):m.error(e)}function b(){(t=o()).then(_,h)}return b(),m.getPromise()}var s=n(123),c=n(121),d=n(18),l=n(131),u=n(68),f=n(113),p=n(234),m=n(3),_="SPServiceResponse",h=!m.a.isActivated("05F6D32A-E2A4-45FA-B486-30818AF5FC7E","03/17/2023","Stop process response error in GetDataError. Do it in DataRequestor instead"),b=function(e){function t(n){var i=this,r=n.errorData,o=n.innerError instanceof t&&n.innerError.errorData,s=n.errorData||o||{status:0},c=s.message,d=void 0===c?void 0:c,l=s.correlationId,u=void 0===l?void 0:l,f=s.code,p=void 0===f?void 0:f,m=(0,a.f)(s,["message","correlationId","code"]),_="object"==typeof d?d?"string"!=typeof d.value||h?JSON.stringify(d):d.value:"".concat(d):d,b=r&&r.codes||{order:[],map:{}};if(o&&o.codes)for(var g=0,v=o.codes.order;g<v.length;g++){var y=v[g];b.map[y]||(b.order.push(y),b.map[y]=o.codes.map[y])}var S=(0,a.a)((0,a.a)((0,a.a)((0,a.a)((0,a.a)({},"string"==typeof u?{correlationId:u}:{}),"string"==typeof p?{code:p}:{}),"string"==typeof _?{message:_}:{}),n),{extraData:(0,a.a)((0,a.a)({},n.extraData||{}),{hasAuthChallenge:!!s.authenticate,status:s.status,infected:s.infected,groupThrottle:s.groupThrottle,statusText:s.statusText})});(i=e.call(this,S)||this).name="GetDataError",i.codes=b,i.errorData=s;for(var D=0,I=Object.keys(m);D<I.length;D++)i[y=I[D]]=m[y];return i}return(0,a.d)(t,e),t}(u.a),g="Unknown",v="Canceled",y="NoConnection",S="Offline",D="XSPOErrorMessage",I="UrlTooLong",x=n(47),C=n(214),O=n(38),w="MS-CV",E="Retry-After",A="WWW-Authenticate",L="x-ms-diagnostics",k="X-SubStatusCode",M="X-SPO-ErrorCode",P="X-SPO-ErrorMessage",T="X-MSDAVEXT_Error",U="SPSQLQueryCount",F="SPClientServiceRequestDuration",H="SPGroupThrottle",R="X-ServiceWorkerFetchInfo",N="x-virus-infected",B="X-Msedge-Ref",j=function(){function e(e,t,n){this._request=e,this._url=t,this._webAbsoluteUrl=n&&n.webAbsoluteUrl,this._isCanaryRequest=n&&n.isCanaryRequest}return e.prototype.getSourceUrl=function(){return this._url},e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()},e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")},e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")},e.prototype.getStatus=function(){var e=-1;try{e=this._request.status}catch(e){}return"number"==typeof e?e:-1},e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")},e.prototype.getResponseType=function(){return this._request.responseType},e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText},e.prototype.getErrorResponseText=function(){return"blob"===this._request.responseType?{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader(N),authenticate:this.getResponseHeader(A)}:this.getResponseText()},e.prototype.parseError=function(){var e=this,t=new r.a;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,n=new r.a,a=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result),n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},i=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",a),t.addEventListener("error",i),t.readAsText(e)}catch(e){i()}return n.getPromise().then(function(e){return t&&(t.removeEventListener("load",a),t.removeEventListener("error",i)),e})}(this._request.response).then(function(n){var a={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader(N),authenticate:e.getResponseHeader(A)};t.complete(a)}):t.complete(this._request.response):t.complete(this._request.responseText),t.getPromise()},e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n},e.prototype.getRedirectUrl=function(){return this._isCanaryRequest?403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl():403===this.getStatus()||401===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():void 0},e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new x.a(t);n.setQueryParameter("ReturnUrl",C.b(window.location.href)),e=n.toString()}else if(!m.a.isActivated("E01ED707-3C9F-4CD5-8ADF-8A5484D4A861","04/18/2023","Construct redirectUrl targetting Default.aspx")){var a=m.a.isActivated("46AD8143-4179-406B-83E3-582A1DD3F543","07/21/2023","Use location to determine redirectUrl, in case of cross site calls")?new f.a(this._url).authority:new f.a(window.location.href).authority;a&&(e="".concat(a,"/_forms/Default.aspx?ReturnUrl=").concat(encodeURIComponent(location.href)));var i=this.getResponseHeader("Reauthid");if(O.c.isFeatureEnabled({ODB:60017})&&i){var r=new URL(location.href);r.searchParams.append("reauthid",i),e=r.toString()}}return e},e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new x.a(t);n.setQueryParameter("Source",C.b(window.location.href)),n.setQueryParameter("Type","list"),n.setQueryParameter("correlation",C.b(this.getCorrelationId())),e=n.toString()}}return e},e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new x.a(e);return t.setQueryParameter("ReturnUrl",window.location.href),t.toString()},e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader(M),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t},e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),a=n.shift(),i=n.join(": ");e[a]=i})}return this.getResponseHeadersDictionary=function(){return e},e},e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)},e.prototype.getHeaderNumberValue=function(e){var t=this.getResponseHeader(e),n=Number(t);return isNaN(n)?void 0:n},e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"},e}(),V=n(161),z=n(59),G=n(160),K=m.a.isActivated("94486333-390c-4bb2-9cbf-371c7042f19a"),W=O.c.isFeatureEnabled({ODB:60886}),q=m.a.isActivated("A822F129-AEE4-4E61-A630-5B52B95F9DC3"),Q=m.a.isActivated("e8a0bfad-7311-48b1-b31a-c91dc5cd1f48"),Y=function(){function e(e){var t;void 0===e&&(e={}),this._scope=new G.a,this._events=this._scope.attach(new z.a(this));var n=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||n&&new x.a(n).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),m.a.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?n?(this._webAbsoluteUrl=n,this._alwaysGetDigest=!0):this._alwaysGetDigest=!1:this._alwaysGetDigest=null!==(t=e.alwaysGetDigest)&&void 0!==t&&t,this._needsRequestDigest=!1!==e.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(e.formDigest),this._requestCanaryForAuth=!1,this._engagement=e.engagement,this._operationName=e.operationName}return e._isValidFormDigest=function(e){return!!(e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60))},e.prototype.dispose=function(){this._scope.dispose()},e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0,e.abort(),this._currentRequest=void 0}},e.prototype.isRequestActive=function(){return!!this._currentRequest},e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,a=e.successCallback,i=e.failureCallback,r=e.uploadProgressCallback,o=e.additionalPostData,s=e.isRest,c=void 0===s||s,d=e.method,l=void 0===d?"POST":d,u=e.withCredentials,f=e.additionalHeaders,p=e.contentType,_=e.noRedirect,h=e.responseType,b=e.needsRequestDigest,g=void 0===b?this._needsRequestDigest:b,v=(new Date).toISOString(),y=new XMLHttpRequest;y.open(l,n,!0),"boolean"==typeof u&&(y.withCredentials=u),h&&(y.responseType=h);var S=!m.a.isActivated("2368CF71-4213-4E1D-A3BA-BFCC77F2AD83","25/08/2023","Use browser set Content-Type header for FormData requests")&&o instanceof FormData;p?y.setRequestHeader("Content-Type",p):S||(c?y.setRequestHeader("Content-Type","application/json;odata=verbose"):y.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var D=!1;if(f)for(var I in f)I&&(y.setRequestHeader(I,f[I]),"accept"===I.toLowerCase()&&(D=!0));D||y.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=y;var x=function(e){g&&e&&y.setRequestHeader("x-requestdigest",e),t._events.on(y,"readystatechange",function(){t._onReadyStateChange(y,n,a,i,!!_,v)}),r&&y.upload&&t._events.on(y.upload,"progress",function(e){r(e)}),y.send(o)};g?this._ensureRequestDigest(x,i):x()},e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)},e.prototype._ensureRequestDigest=function(t,n){var a=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(a)?t(a.formDigestValue):this._ensureRequestDigestWorker(t,n)},e.prototype._ensureRequestDigestWorker=function(t,n){var a=this,i=new Date,r=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(r._requestCanaryForAuth=!0);var o=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof o?(e._requestDigestPromise||(e._requestDigestPromise=new Promise(function(s,c){r.getServerDataFromUrl({url:x.a.concatenate(o,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),r=JSON.parse(n).d.GetContextWebInformation;e._formDigests[a._webServerRelativeUrl]={serverTime:i.toISOString(),formDigestValue:r.FormDigestValue,formDigestTimeoutSeconds:r.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date},s(e._formDigests[a._webServerRelativeUrl].formDigestValue),e._requestDigestPromise=void 0},failureCallback:function(a,i){q?(t?t(void 0):n&&n(a,i),c(void 0)):c({serverData:a,error:i}),e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})})),q?e._requestDigestPromise.then(function(e){return t&&t(e),e}):e._requestDigestPromise.then(function(e){return t&&t(e),e}).catch(function(e){var a=e.serverData,i=e.error;t?t(void 0):n&&n(a,i)})):n&&n(void 0,new u.a({code:"MissingWebForDigestAuth",isExpected:!1}))},e.prototype._onReadyStateChange=function(t,n,a,i,r,o){var s;if(4===t.readyState)if(this._currentRequest=void 0,this._events.off(t),t.upload&&this._events.off(t.upload),(s=t)&&s.isCancelled)i(void 0,Q?new u.a({code:"RequestAborted",isExpected:!0}):new V.a);else if(function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0}(t)){var c=new j(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),d=c.getStatus(),l=!r&&c.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===d){var f=c.getRedirectLoginPageUrl();try{l?window.location.href=c.getRedirectToErrorCustomPromptLocation():i(c)}catch(e){}f&&!r&&(window.location.href=f)}else{f=c.getAccessDeniedRedirectUrl();try{i(c)}catch(e){}f&&!r&&(this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}}),window.location.href=f)}return}if(200===d||201===d||204===d||W&&!K&&202===d)return void a(c);if(403===d)return e._requestDigestPromise=void 0,void(r?this._ensureRequestDigestWorker(void 0,function(e,t){return i(c,t)}):l?window.location.href=c.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0));401===d&&l&&(window.location.href=c.getRedirectToErrorCustomPromptLocation()),i(c)}else i(void 0,new u.a({code:y,isExpected:!0}))},e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}},e._formDigests={},e._requestDigestPromise=void 0,e}();function J(e){var t=e.options,n=t.url,r=t.authToken,o=t.telemetryHandler,s=t.useExactAuthToken,c=t.method,l=t.additionalHeaders,u=e.dataSyncClient,f=e.aadUserId,p=e.getData,_=function(){return p({url:n,telemetryHandler:o,authToken:r,useExactAuthToken:s})};return m.a.isActivated("26fb0edf-b3af-42db-b8ea-2858c7eacfe0")&&!f?_():i.c.resolve(u).then(function(e){return e?function(e){var t=function(e,t){return function(n,i){var r=n.eventData,o=r.extraData,s=void 0===o?{}:o,c={performanceEntry:s&&s.performanceEntry,httpStatus:s&&s.HttpStatus,correlationId:s&&s.CorrelationId,succeeded:r&&r.resultType===d.b.Success||!1,resultCode:r&&r.resultCode,endpoint:i,extraData:s},l=t&&t(n),u=e.onRequestComplete(c);return s.dataSyncQos=e.getQosInfo(),(0,a.a)((0,a.a)({},l||{}),{eventData:(0,a.a)((0,a.a)({},l?l.eventData:r),{extraData:(0,a.a)((0,a.a)({},l?l.eventData.extraData:r.extraData),e.getQosInfo())}),canRetry:u&&(!l||l.canRetry)})}}(e,o);return e.getData({url:n,method:c,additionalHeaders:l},function(e,n){return p({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0,additionalHeaders:n})},_)}(e):_()})}var X=n(46),Z=n(104),$=n(354);function ee(e){var t=e.options,n=e.webAbsoluteUrl,r=e.apiEvent,o=e.tokenProvider,c=e.getData,d=e.qosName,l=t.url,p=new f.a(l),_="".concat(p.authority,"/{ length: ").concat(p.path.length,", segments: ").concat(p.segments.length," }"),h=function(e,t){if(!o.getAuthToken)return i.c.resolve({authToken:void 0});var n=new r({name:"".concat(d,".getAuthToken").concat(t?".retry":""),url:_});return i.c.resolve(o.getAuthToken(e)).then(function(e){return e&&"string"!=typeof e?(n.end({resultType:s.b.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}),e):(n.end({resultType:s.b.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"}),{authToken:e})}).catch(function(e){return n.end((0,Z.a)(e)),i.c.reject(e)})},b=function(e,t){if(!o.getFormDigest)return i.c.resolve(void 0);var n=new r({name:"".concat(d,".getAuthToken").concat(t?".retry":""),url:_});return i.c.resolve(o.getFormDigest(e)).then(function(e){return n.end({resultType:s.b.Success,resultCode:e?"newDigest":"sameDigest"}),e}).catch(function(e){return n.end((0,Z.a)(e)),i.c.reject(e)})};if(!h&&!b)return c({url:l});if(!m.a.isActivated("1BFD6EB7-B8E4-42E1-93FF-12D3DB9BAE18","10/05/2023","Validate domain for auth token")&&n&&(m.a.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==l[0])&&!(0,$.a)(l,encodeURI(n)))throw new u.a({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});var g={url:l,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge},v={url:l,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge};return h(g,!1).then(function(e){return e.authToken?e:b(v,!1).then(function(t){return e})}).then(function(e){return c({url:l,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){var n;if(ae(t))n={claimsChallenge:{authToken:e.authToken,claims:ne(t),error:t}};else{if(!re(t)&&!ie(t))return i.c.reject(t);n={expiration:{authToken:e.authToken,error:t}}}return h((0,a.a)((0,a.a)({},g),n),!0).then(function(n){if(!n.authToken){var r=void 0;if(ae(t))r={claimsChallenge:{claims:ne(t),error:t}};else{if(!re(t)&&!ie(t))return i.c.reject(t);r={expiration:{error:t}}}return b((0,a.a)((0,a.a)({},v),r),!0).then(function(e){return n})}return n.authToken===e.authToken?i.c.reject(t):n}).then(function(e){return c({url:l,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}})}).catch(function(e){return i.c.reject(e)})})})}var te="Bearer";function ne(e){var t=e.authenticate,n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return m.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}function ae(e){var t=e.authenticate;return!!(t&&t.slice(0,te.length)===te&&t.indexOf('error="insufficient_claims"')>-1)}function ie(e){return!!e.authenticate}function re(e){var t=e.code;return"3000002,invalid_client"===t||"10013"===t||"917656"===t}var oe=n(425),se=n(298),ce=m.a.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","08/11/2023","Prioritize page context auth token when present"),de="undefined"!=typeof window?window:void 0,le=de&&de.performance,ue=m.b.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023"),fe=function(){function e(e,t){var n,a,i,r,o,d,l,u,f,p;this._dataRequestorContext=t.dataRequestorContext,this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(a=this._dataRequestorContext)||void 0===a?void 0:a.tokenProvider,this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(r=this._dataRequestorContext)||void 0===r?void 0:r.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(o=null==t?void 0:t.apiEvent)&&void 0!==o?o:s.a,this._engagement=null!==(d=null==t?void 0:t.engagement)&&void 0!==d?d:c.a,this._normalizeErrors=null===(l=e.normalizeErrors)||void 0===l||l,this._getDataWithTokenProvider=null!==(u=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==u?u:ee,this._getDataWithSyncClient=null!==(f=null==t?void 0:t.getDataWithSyncClient)&&void 0!==f?f:J,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null===(p=null==t?void 0:t.noRedirect)||void 0===p||p}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){var t=e.cancelToken,n=this._getData(e);if(t){var a=t.subscribe(function(){n.cancel()});return Promise.resolve(n).then(function(e){return a(),e}).catch(function(e){throw a(),e})}return Promise.resolve(n)},e.prototype._getData=function(t){var n=this,r=t.parseResponse,s=void 0===r?e.parseJSON:r,c=t.qosExtraData,l=t.additionalPostData,h=void 0===l?"":l,x=t.contentType,C=t.method,N=void 0===C?"POST":C,j=t.maxRetries,V=void 0===j?0:j,z=t.responseType,G=t.onUploadProgress,K=t.timeout,W=t.noTimeoutInLastRetry,q=void 0!==W&&W,Q=t.webAbsoluteUrl,J=t.allowOAuth,Z=void 0===J||J,$=t.customerPromise,ee=t.url,te=t.maxUrlLength,ne=void 0===te?2e3:te,ae=t.onBeforeRequest;if(!m.a.isActivated("AFDE96CC-D737-4483-9FA5-3F98CB47619B")&&ee.length>ne)throw new b({errorData:{code:"".concat(se.a,",").concat(I),status:-1}});var ie=this._dataRequestorContext,re=this._tokenProvider,fe=this._getDataWithTokenProvider,pe=this._getDataWithSyncClient,me=[];this._qosName&&me.push(this._qosName),t.qosName&&me.push(t.qosName);var _e=me.join("."),he=function(e){var r=e.url,l=e.telemetryHandler,I=e.authToken,C=e.useExactAuthToken,j=void 0!==C&&C,W=e.additionalHeaders,J=!0,ee=new f.a(r),te="".concat(ee.authority,"/{ length: ").concat(ee.path.length,", segments: ").concat(ee.segments.length," }"),ne=function(e){var I=e.authToken,C=e.qosExtraData,ee=t.crossSiteCollectionCall,ne=void 0!==ee&&ee,se=t.noRedirect,ce=void 0===se?n._noRedirect:se,fe=t.needsRequestDigest,pe=void 0===fe||fe,me=(0,a.a)((0,a.a)((0,a.a)({},t.additionalHeaders),ue?{}:W),{CollectSPPerfMetrics:U}),he=!!m.a.isActivated("B11E1406-A736-464F-96CB-E2E64BF66881","05/02/2023","add allowOAuth flag to allow or skip OAuth completely (used with Acquire endpoint calls)")||Z;if(he&&I){var be=!1;X.a.isFeatureEnabled({ECS:86137})||I.split(" ").length>1&&(be=!0);var ge=j||be?I:"Bearer ".concat(I),ve=!1;for(var ye in me)ye&&"authorization"===ye.toLowerCase()&&(ve=!0);ve||(me.Authorization=ge),ne=!0,pe=!1,ce=!0}else he&&O.c.isFeatureEnabled({ODB:60959})&&re&&(me.Authorization="Bearer");var Se,De,Ie=new Y((0,a.a)((0,a.a)({},ie?{webServerRelativeUrl:ie.webServerRelativeUrl,webAbsoluteUrl:Q||ie.webAbsoluteUrl,alwaysGetDigest:ne,formDigest:{serverTime:ie.serverTime,updateFormDigestPageLoaded:ie.updateFormDigestPageLoaded,formDigestValue:ie.formDigestValue,formDigestTimeoutSeconds:ie.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:pe,engagement:n._engagement,operationName:n._qosName})),xe=de&&de.location&&new f.a(de.location.href).authority,Ce=new f.a(r).authority;return null==ae||ae(),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,r=e.canRetry,s=e.noTimeoutInLastRetry,c=0,d=Math.max(e.maxRetries,0),l=function(){var e=new i.a(t,function(){n(c>=d||!r())});return a&&(!s||c<d)?i.a.timeout(a,e):e};return c<d?o({canRetry:r,retries:d,callback:l,beforeRetry:function(){c++}}):l()}({timeout:K,onExecute:function(e,i){var o=function(t,o){return function(u){var f=u.getResponseText();De=u.getServiceWorkerDataSourceHeader();var m,_,h,g,v=(0,p.a)(r,o),y=(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:pe,hasAuthToken:!!I,isCrossOrigin:!!xe&&xe!==Ce,CorrelationId:u.getCorrelationId()}),C||{}),{HttpStatus:u.getStatus(),serviceWorkerDataSource:De||void 0,rawRequestDuration:v.duration,performanceEntry:JSON.stringify(v),serviceWorkerFetchInfo:u.getResponseHeader(R)||void 0,SQLRT:u.getHeaderNumberValue(U),ServerDuration:u.getHeaderNumberValue(F)}),S=!1;try{!function(e,t){return"blob"===e&&!!t&&"object"==typeof t}(z,f)?_=s(f,u):h=f,S=!0}catch(e){m=e,g={resultType:d.b.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:y}}g||(g={resultType:d.b.Success,extraData:y});var D=g;if(l&&(g=l({response:_,eventData:g,serverData:u}).eventData),null==t||t.end(D),S)try{e(h||_)}catch(e){}else i(n._normalizeErrors?new b({code:"-1,parse_response",innerError:m,errorData:{correlationId:u.getCorrelationId(),status:u.getStatus()}}):void 0);Ie=void 0}},f=function(e,o){return function(s,f){var v=(0,p.a)(r,o),x=(0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:pe,hasAuthToken:!!I,isCrossOrigin:!!xe&&xe!==Ce,rawRequestDuration:v.duration,performanceEntry:JSON.stringify(v)}),C="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(C=n._offlineDetection.offline),!s){var O=g,U=!0,F=0;f&&f instanceof u.a&&(O=f.code,U=f.isExpected,F=-1),!C||O!==y&&O!==g||(O=S);var R={status:F,code:O},N={resultType:U?d.b.ExpectedFailure:d.b.Failure,resultCode:O,extraData:x};return l&&(N=l({eventData:N,errorData:R}).eventData),null==e||e.end(N),void i(n._normalizeErrors?new b({errorData:R,innerError:f}):R)}var j=function(r){var o=void 0,c=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(L);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:L,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(T);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),_=p[1],h=void 0===_?"-1":_,b=p[2];u={source:T,code:h,message:c=void 0===b?"":b,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}if(!m.a.isActivated("653DFB77-4F5B-4F7E-BAAE-0AA791061E25","03/30/2023","Add extra error codes")){var g=e.getResponseHeader(M);if(g){var v=e.getResponseHeader(P);u={source:M,code:g,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}}if(!m.a.isActivated("32B53DE1-9D7F-48EE-BE6A-6D02852E7030","03/30/2023","Add extra error codes")){var y=e.getResponseHeader(k);y&&(u={source:k,code:y},n.order.push(u.source),n.map[u.source]=u)}return{codes:n,isExpected:t}}(s),u=null==c?void 0:c.isExpected,f=null==c?void 0:c.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var p=void 0;try{p=JSON.parse(r)}catch(e){}if(p)if(p.error_description)o={code:"-1,".concat(p.error||"Unknown"),message:p.error_description},"policy_enforced"===p.error&&(u=!0);else if("string"==typeof p.error)o={message:p.error};else if(p.error&&p.error.message&&p.error.message.value){var v={source:_,code:p.error.code,message:"".concat(p.error.message.value),isDisplayable:!0};f&&(f.order.push(v.source),f.map[v.source]=v),o=p.error}else o=p.error||p["odata.error"]||{responseData:p};else if(r&&!m.a.isActivated("9F364C4C-7016-42DE-8C8C-36891B606E25","11/11/2023","Read HTML error for 400 Unknown")&&400===s.getStatus()){var y;y=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:y},x=(0,a.a)((0,a.a)({},x),{rawUrl:t.url,rawPayload:h})}}var S=s.getStatus(),I=s.getCorrelationId(),O=s.getResponseHeader(H),U=s.getResponseHeader(T);if(x=(0,a.a)((0,a.a)({},x),{CorrelationId:I,HttpStatus:S,GroupThrottle:O,MSCorrelationVector:s.getResponseHeader(w)}),(401===S&&U||403===S||404===S||429===S||503===S||-1===S||0===S&&C)&&(J=!1,u=!0),400===S){var F=function(e){var t={order:[],map:{}};if(!m.a.isActivated("389A4BF0-3228-454F-8BCC-BD561B9B1DBE","10/26/2023","Add code for MSEdgeRef with static code")){var n,a="No X-Msedge-Ref details",i=e.getResponseHeader(B);n=i?{source:k,code:"Non-Empty X-Msedge-Ref details",message:i}:{source:k,code:a,message:a},t.order.push(n.source),t.map[n.source]=n}return{codes:t,isExpected:!1}}(s);f&&F&&(Array.prototype.push.apply(f.order,F.codes.order),F.codes.order.forEach(function(e){f.map[e]=F.codes.map[e]})),m.a.isActivated("9F364C4C-7016-42DE-8C8C-36891B606E25","11/11/2023","Read HTML error for 400 Unknown")||x.rawUrl||x.rawPayload||(x=(0,a.a)((0,a.a)({},x),{rawUrl:t.url,rawPayload:h}))}(o=o||{}).codes=f,o.status=S,o.retryAfter=s.getHeaderNumberValue(E),o.authenticate=s.getResponseHeader(A),!m.a.isActivated("892484e8-2020-4fce-b619-d246a23a8f41","12/08/2023","If context is failed, Mark expected failure")&&o.authenticate&&(u=!0),I&&(o.correlationId=I),O&&(o.groupThrottle=O);var R=o["@error.redirectUrl"],N=s.getRedirectUrl()||R;N&&(u=!0,o.redirectUrl=N);var j=JSON.stringify(o),V=null==f?void 0:f.map.SPServiceResponse;V&&n._normalizeErrors&&!m.a.isActivated("B4426688-76EA-4718-8166-1A4F69314E42","04/18/2023","Simplify SPO message structure")&&(o.message=V.message);var z=null==f?void 0:f.order[0];z&&(v=f.map[z])&&(z===M&&v.message?(o.code=D,o.message=v.message):v.code&&(o.code=v.code)),o.code||(o.code=g);var G="[".concat(S,"] ").concat(o.code),K={resultType:u?d.b.ExpectedFailure:d.b.Failure,error:j,resultCode:G,extraData:x};if(l){var W=l({eventData:K,errorData:o,serverData:s}),q=W.eventData,Q=W.canRetry;q&&(K=q),!0!==Q&&!1!==Q||(J=Q),K.resultType===d.b.ExpectedFailure&&(u=!0)}var Y=n._normalizeErrors?new b({errorData:o,isExpected:u}):o;Y.codes&&Y.codes&&(K.extraData||(K.extraData={}),K.extraData.errorCodes=JSON.stringify(Y.codes.map)),null==e||e.end(K),i(Y)},V=s.getResponseType();V&&"text"!==V?s.parseError().then(j):j(s.getResponseText())}};!function(){var e;e=Se=!m.a.isActivated("B27DA5D9-B6F0-4648-9E59-4700ABA3836F")&&$?new((0,oe.a)(n._apiEvent))({url:te,name:_e,pillar:(null==$?void 0:$.pillar)?$.pillar:void 0,veto:(null==$?void 0:$.veto)?$.veto:void 0}):new n._apiEvent({url:te,name:_e});var t=le&&le.now();Ie.getServerDataFromUrl({url:r,successCallback:o(e,t),failureCallback:f(e,t),uploadProgressCallback:G,additionalPostData:h,method:N,additionalHeaders:me,contentType:x,withCredentials:!I&&void 0,noRedirect:ce,responseType:z,needsRequestDigest:pe})}()},maxRetries:V,noTimeoutInLastRetry:q,canRetry:function(){return J},onCancel:function(e){Ie&&(Ie.abort(),e&&Ie.dispose())}}).then(function(e){return Ie&&Ie.dispose(),e},function(e){return Ie&&Ie.dispose(),!Se.endTime&&i.a.isCanceled(e)&&Se.end({resultCode:v,resultType:d.b.ExpectedFailure}),i.a.reject(e)})};if(I)return i.a.resolve(I).then(function(e){return ne({url:r,authToken:e})});if(!ce&&(null==ie?void 0:ie.authToken))return i.a.resolve(ie.authToken).then(function(e){return ne({url:r,authToken:e})});if(re)return null==fe?void 0:fe({apiEvent:n._apiEvent,getData:ne,options:{url:r,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:Q||ie&&ie.webAbsoluteUrl,qosName:_e,tokenProvider:re});if(ie){if(ie.getAuthToken)return i.a.resolve(ie.getAuthToken()).then(function(e){return ne({url:r,authToken:e})});if(ce&&ie.authToken)return i.a.resolve(ie.authToken).then(function(e){return ne({url:r,authToken:e})})}return ne({url:r})},be={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?null==pe?void 0:pe({options:be,aadUserId:null==ie?void 0:ie.aadUserId,dataSyncClient:this._dataSyncClient,getData:he}):he(be)},e}(),pe=m.a.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","08/11/2023","Prioritize page context auth token when present"),me=m.a.isActivated("cb77018d-603a-46a1-8ddf-5a8f4e2fee2f"),_e=m.a.isActivated("edd26e5c-aa56-40d3-9f21-fdab92ea41e0"),he="undefined"!=typeof window?window:void 0,be=he&&he.performance,ge=m.b.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023"),ve=function(){function e(e,t){var n,i,r,o,d,l,u,f,p,m;if(me)this._pageContext=t?t.pageContext:e.pageContext,this._tokenProvider=null!==(i=null==t?void 0:t.tokenProvider)&&void 0!==i?i:null===(r=this._pageContext)||void 0===r?void 0:r.tokenProvider,this._dataSyncClient=null!==(o=null==t?void 0:t.dataSyncClient)&&void 0!==o?o:null===(d=this._pageContext)||void 0===d?void 0:d.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(l=null==t?void 0:t.apiEvent)&&void 0!==l?l:s.a,this._engagement=null!==(u=null==t?void 0:t.engagement)&&void 0!==u?u:c.a,this._normalizeErrors=!!e.normalizeErrors,this._getDataWithTokenProvider=null!==(f=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==f?f:ee,this._getDataWithSyncClient=null!==(p=null==t?void 0:t.getDataWithSyncClient)&&void 0!==p?p:J,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null!==(m=null==t?void 0:t.noRedirect)&&void 0!==m?m:!!(null==t?void 0:t.tokenProvider)||void 0;else{var _=t?t.pageContext:e.pageContext;this._dataRequestorNew=new fe((0,a.a)((0,a.a)({},e),{normalizeErrors:!!e.normalizeErrors}),(0,a.a)((0,a.a)({},t||{}),{dataRequestorContext:_,noRedirect:null!==(n=null==t?void 0:t.noRedirect)&&void 0!==n?n:!!(null==t?void 0:t.tokenProvider)}))}}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){if(void 0!==this._dataRequestorNew){var t,n,r=function(){e.onBeforeRequest&&e.onBeforeRequest();var t=l.b.getRUMOneLogger(),n=Date.now();t&&(t.readTempData("appDataFetchStart")||t.saveTempData("appDataFetchStart",n))};if(e.cancelToken&&!_e)return i.c.resolve(this._dataRequestorNew.getData((0,a.a)((0,a.a)({},e),{onBeforeRequest:r})));var o=new V.b;return this._dataRequestorNew.getData((0,a.a)((0,a.a)({},e),{onBeforeRequest:r,cancelToken:o.token})).then(function(e){null==t||t(e),null==o||o.dispose()}).catch(function(e){null==n||n(e),null==o||o.dispose()}),new i.c(function(e,a){t=e,n=a},function(){o.cancel()})}var s=this._oldGetData(e);return e.cancelToken&&!_e?i.c.resolve(function(e,t){return(0,a.b)(this,void 0,void 0,function(){var n,i,r;return(0,a.e)(this,function(a){switch(a.label){case 0:n=t.subscribe(function(){e.cancel()}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e];case 2:return i=a.sent(),n(),[2,i];case 3:throw r=a.sent(),n(),r;case 4:return[2]}})})}(s,e.cancelToken)):s},e.prototype._oldGetData=function(t){var n=this,r=t.parseResponse,s=void 0===r?e.parseJSON:r,c=t.qosExtraData,h=t.additionalPostData,x=void 0===h?"":h,C=t.contentType,N=t.method,j=void 0===N?"POST":N,V=t.maxRetries,z=void 0===V?0:V,G=t.responseType,K=t.onUploadProgress,W=t.timeout,q=t.noTimeoutInLastRetry,Q=void 0!==q&&q,J=t.webAbsoluteUrl,Z=t.allowOAuth,$=void 0===Z||Z,ee=t.customerPromise,te=t.url,ne=t.maxUrlLength,ae=void 0===ne?2e3:ne;if(!m.a.isActivated("AFDE96CC-D737-4483-9FA5-3F98CB47619B")&&te.length>ae)throw new b({errorData:{code:"".concat(se.a,",").concat(I),status:-1}});var ie=this._pageContext,re=this._tokenProvider,ce=this._getDataWithTokenProvider,de=this._getDataWithSyncClient,le=[];this._qosName&&le.push(this._qosName),t.qosName&&le.push(t.qosName);var ue=le.join("."),fe=function(e){var r=e.url,h=e.telemetryHandler,I=e.authToken,N=e.useExactAuthToken,V=void 0!==N&&N,q=e.additionalHeaders,Z=!0,te=new f.a(r),ne="".concat(te.authority,"/{ length: ").concat(te.path.length,", segments: ").concat(te.segments.length," }"),ae=function(e){var I=e.authToken,N=e.qosExtraData,te=t.crossSiteCollectionCall,ae=void 0!==te&&te,se=t.noRedirect,ce=void 0===se?n._noRedirect:se,de=t.needsRequestDigest,le=void 0===de||de,fe=(0,a.a)((0,a.a)((0,a.a)({},t.additionalHeaders),ge?{}:q),{CollectSPPerfMetrics:U}),pe=!!m.a.isActivated("B11E1406-A736-464F-96CB-E2E64BF66881","05/02/2023","add allowOAuth flag to allow or skip OAuth completely (used with Acquire endpoint calls)")||$;if(pe&&I){var me=!1;X.a.isFeatureEnabled({ECS:86137})||I.split(" ").length>1&&(me=!0);var _e=V||me?I:"Bearer ".concat(I),ve=!1;for(var ye in fe)ye&&"authorization"===ye.toLowerCase()&&(ve=!0);ve||(fe.Authorization=_e),ae=!0,le=!1,ce=!0}else pe&&O.c.isFeatureEnabled({ODB:60959})&&re&&(fe.Authorization="Bearer");var Se,De,Ie=new Y((0,a.a)((0,a.a)({},ie?{webServerRelativeUrl:ie.webServerRelativeUrl,webAbsoluteUrl:J||ie.webAbsoluteUrl,alwaysGetDigest:ae,formDigest:{serverTime:ie.serverTime,updateFormDigestPageLoaded:ie.updateFormDigestPageLoaded,formDigestValue:ie.formDigestValue,formDigestTimeoutSeconds:ie.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:le,engagement:n._engagement,operationName:n._qosName})),xe=he&&he.location&&new f.a(he.location.href).authority,Ce=new f.a(r).authority,Oe=l.b.getRUMOneLogger(),we=Date.now();return Oe&&(Oe.readTempData("appDataFetchStart")||Oe.saveTempData("appDataFetchStart",we)),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,r=e.canRetry,s=e.noTimeoutInLastRetry,c=0,d=Math.max(e.maxRetries,0),l=function(){var e=new i.c(t,function(){n(c>=d||!r())});return a&&(!s||c<d)?i.c.timeout(a,e):e};return c<d?o({canRetry:r,retries:d,callback:l,beforeRetry:function(){c++}}):l()}({timeout:W,onExecute:function(e,i){var o=function(t,o){return function(l){var u=l.getResponseText();De=l.getServiceWorkerDataSourceHeader();var f,m,_,g,v=(0,p.a)(r,o),y=(0,a.a)((0,a.a)((0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:le,hasAuthToken:!!I,isCrossOrigin:!!xe&&xe!==Ce,CorrelationId:l.getCorrelationId()}),N||{}),{HttpStatus:l.getStatus(),serviceWorkerDataSource:De||void 0,rawRequestDuration:v.duration,performanceEntry:JSON.stringify(v),serviceWorkerFetchInfo:l.getResponseHeader(R)||void 0,SQLRT:l.getHeaderNumberValue(U),ServerDuration:l.getHeaderNumberValue(F)}),S=!1;try{!function(e,t){return"blob"===e&&t&&"object"==typeof t}(G,u)?m=s(u,l):_=u,S=!0}catch(e){f=e,g={resultType:d.b.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:y}}if(g||(g={resultType:d.b.Success,extraData:y}),h&&(g=h({response:m,eventData:g,serverData:l}).eventData),t.end(g),S)try{e(_||m)}catch(e){}else i(n._normalizeErrors?new b({code:"-1,parse_response",innerError:f,errorData:{correlationId:l.getCorrelationId(),status:l.getStatus()}}):void 0);Ie=void 0}},l=function(e,o){return function(s,l){var f=(0,p.a)(r,o),v=(0,a.a)((0,a.a)({},c||{}),{needsRequestDigest:le,hasAuthToken:!!I,isCrossOrigin:!!xe&&xe!==Ce,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}),C="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(C=n._offlineDetection.offline),!s){var O=g,U=!0,F=0;l&&l instanceof u.a&&(O=l.code,U=l.isExpected,F=-1),!C||O!==y&&O!==g||(O=S);var R={status:F,code:O},N={resultType:U?d.b.ExpectedFailure:d.b.Failure,resultCode:O,extraData:v};return h&&(N=h({eventData:N,errorData:R}).eventData),e.end(N),void i(n._normalizeErrors?new b({errorData:R,innerError:l}):R)}var j=function(r){var o=void 0,c=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(L);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:L,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(T);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),_=p[1],h=void 0===_?"-1":_,b=p[2];u={source:T,code:h,message:c=void 0===b?"":b,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}if(!m.a.isActivated("653DFB77-4F5B-4F7E-BAAE-0AA791061E25","03/30/2023","Add extra error codes")){var g=e.getResponseHeader(M);if(g){var v=e.getResponseHeader(P);u={source:M,code:g,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}}if(!m.a.isActivated("32B53DE1-9D7F-48EE-BE6A-6D02852E7030","03/30/2023","Add extra error codes")){var y=e.getResponseHeader(k);y&&(u={source:k,code:y},n.order.push(u.source),n.map[u.source]=u)}return{codes:n,isExpected:t}}(s),l=c.isExpected,u=c.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var f=void 0;try{f=JSON.parse(r)}catch(e){}if(f)if(f.error_description)o={code:"-1,".concat(f.error||"Unknown"),message:f.error_description},"policy_enforced"===f.error&&(l=!0);else if("string"==typeof f.error)o={message:f.error};else if(f.error&&f.error.message&&f.error.message.value){var p={source:_,code:f.error.code,message:"".concat(f.error.message.value),isDisplayable:!0};u.order.push(p.source),u.map[p.source]=p,o=f.error}else o=f.error||f["odata.error"]||{responseData:f};else if(r&&!m.a.isActivated("9F364C4C-7016-42DE-8C8C-36891B606E25","11/11/2023","Read HTML error for 400 Unknown")&&400===s.getStatus()){var y;y=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:y},v=(0,a.a)((0,a.a)({},v),{rawUrl:t.url,rawPayload:x})}}var S=s.getStatus(),I=s.getCorrelationId(),O=s.getResponseHeader(H),U=s.getResponseHeader(T);if(v=(0,a.a)((0,a.a)({},v),{CorrelationId:I,HttpStatus:S,GroupThrottle:O,MSCorrelationVector:s.getResponseHeader(w)}),(401===S&&U||403===S||404===S||429===S||503===S||-1===S||0===S&&C)&&(Z=!1,l=!0),400===S){var F=function(e){var t={order:[],map:{}};if(!m.a.isActivated("389A4BF0-3228-454F-8BCC-BD561B9B1DBE","10/26/2023","Add code for MSEdgeRef with static code")){var n,a="No X-Msedge-Ref details",i=e.getResponseHeader(B);n=i?{source:k,code:"Non-Empty X-Msedge-Ref details",message:i}:{source:k,code:a,message:a},t.order.push(n.source),t.map[n.source]=n}return{codes:t,isExpected:!1}}(s);Array.prototype.push.apply(u.order,F.codes.order),F.codes.order.forEach(function(e){u.map[e]=F.codes.map[e]}),m.a.isActivated("9F364C4C-7016-42DE-8C8C-36891B606E25","11/11/2023","Read HTML error for 400 Unknown")||v.rawUrl||v.rawPayload||(v=(0,a.a)((0,a.a)({},v),{rawUrl:t.url,rawPayload:x}))}(o=o||{}).codes=u,o.status=S,o.retryAfter=s.getHeaderNumberValue(E),o.authenticate=s.getResponseHeader(A),!m.a.isActivated("892484e8-2020-4fce-b619-d246a23a8f41","12/08/2023","If context is failed, Mark expected failure")&&o.authenticate&&(l=!0),I&&(o.correlationId=I),O&&(o.groupThrottle=O);var R=o["@error.redirectUrl"],N=s.getRedirectUrl()||R;N&&(l=!0,o.redirectUrl=N);var j=JSON.stringify(o),V=u.map.SPServiceResponse;V&&n._normalizeErrors&&!m.a.isActivated("B4426688-76EA-4718-8166-1A4F69314E42","04/18/2023","Simplify SPO message structure")&&(o.message=V.message);var z=u.order[0];z&&(p=u.map[z])&&(z===M&&p.message?(o.code=D,o.message=p.message):p.code&&(o.code=p.code)),o.code||(o.code=g);var G="[".concat(S,"] ").concat(o.code),K={resultType:l?d.b.ExpectedFailure:d.b.Failure,error:j,resultCode:G,extraData:v};if(h){var W=h({eventData:K,errorData:o,serverData:s}),q=W.eventData,Q=W.canRetry;q&&(K=q),!0!==Q&&!1!==Q||(Z=Q),K.resultType===d.b.ExpectedFailure&&(l=!0)}var Y=n._normalizeErrors?new b({errorData:o,isExpected:l}):o;Y.codes&&Y.codes&&(K.extraData.errorCodes=JSON.stringify(Y.codes.map)),e.end(K),i(Y)},V=s.getResponseType();V&&"text"!==V?s.parseError().then(j):j(s.getResponseText())}};!function(){var e;e=Se=!m.a.isActivated("B27DA5D9-B6F0-4648-9E59-4700ABA3836F")&&ee?new((0,oe.a)(n._apiEvent))({url:ne,name:ue,pillar:(null==ee?void 0:ee.pillar)?ee.pillar:void 0,veto:(null==ee?void 0:ee.veto)?ee.veto:void 0}):new n._apiEvent({url:ne,name:ue});var t=be&&be.now();Ie.getServerDataFromUrl({url:r,successCallback:o(e,t),failureCallback:l(e,t),uploadProgressCallback:K,additionalPostData:x,method:j,additionalHeaders:fe,contentType:C,withCredentials:!I&&void 0,noRedirect:ce,responseType:G,needsRequestDigest:le})}()},maxRetries:z,noTimeoutInLastRetry:Q,canRetry:function(){return Z},onCancel:function(e){Ie&&(Ie.abort(),e&&Ie.dispose())}}).then(function(e){return Ie&&Ie.dispose(),e},function(e){return Ie&&Ie.dispose(),!Se.endTime&&i.c.isCanceled(e)&&Se.end({resultCode:v,resultType:d.b.ExpectedFailure}),i.c.reject(e)})};if(I)return i.c.resolve(I).then(function(e){return ae({url:r,authToken:e})});if(!pe&&(null==ie?void 0:ie.authToken))return i.c.resolve(ie.authToken).then(function(e){return ae({url:r,authToken:e})});if(re)return ce({apiEvent:n._apiEvent,getData:ae,options:{url:r,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:J||ie&&ie.webAbsoluteUrl,qosName:ue,tokenProvider:re});if(ie){if(ie.getAuthToken)return i.c.resolve(ie.getAuthToken()).then(function(e){return ae({url:r,authToken:e})});if(pe&&ie.authToken)return i.c.resolve(ie.authToken).then(function(e){return ae({url:r,authToken:e})})}return ae({url:r})},me={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?de({options:me,aadUserId:null==ie?void 0:ie.aadUserId,dataSyncClient:this._dataSyncClient,getData:fe}):fe(me)},e}(),ye=ve}
,function(e,t,n){n.d(t,{a:function(){return S}});var a=n(0),i=(n(461),n(541)),r=n(359),o=n(177),s=n(29),c=n(1),d=n(7),l=n(142),u=n(11),f=n(17),p=n(10),m=n(544),_=n(301),h=n(5),b=n(38),g=n(540),v=n(12),y={ODB:1176},S=function(e){function t(t,n){var a=e.call(this,t)||this;if(a._targetDiv=(0,c.createRef)(),a._odShareHintchevron=(0,c.createRef)(),a._onDismiss=function(){a.setState({isCoachmarkVisible:!1})},a._isOnExperiment=!1,b.c.isFeatureEnabled(y)){var i=new g.b({name:"CoachMark",startDate:"08/2/2018",version:g.a.v2});a._isOnExperiment=i.IsExperimentOn()}return a.state={isCoachmarkVisible:a._isOnExperiment},a}return(0,a.d)(t,e),t.prototype.render=function(){var e,t,n=this.props,a=!!this.props.onShareHintClick,p="od-ShareHint ".concat((0,f.S)(n.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"," new"),b="od-ShareHint-data ".concat(a?"od-ShareHint--clickable":"");if(e=c.createElement("div",{className:"od-ShareHint-shimmer"},c.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},c.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},c.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),c.createElement("div",{className:"od-ShareHint-text-shimmer"})),n.isAddressBarLinkHint){var g=this.props.sharingInformation.addressBarLinkSettings,v=this.props.sharingInformation.sharingAbilities,y=(S=g.linkDisabled||!(0,f.h)(v)?o.a.existing:o.a.workGroup)===o.a.existing?u.Ng:d.j(u.Fg,this.props.companyName);t=c.createElement("div",{className:b,ref:this._targetDiv},c.createElement("div",{className:"od-ShareHint-iconHolder"},c.createElement(r.a,{label:y,permissionsType:S,showLabel:!1})),c.createElement(i.a,{clientId:n.clientId,companyName:n.companyName,currentSettings:null,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:n.addressBarLink,isClickable:a,onClickCallback:this._openLinkPermissions.bind(this)}))}else{var S=this._getFileShareTypeFromAudience(),D=(y=this._getLabelFromPermissionsType(S),this.props.currentSettings.audience===s.a.customLabeledSpecificPeople&&this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl);t=n.onShareHintClick?c.createElement("div",{className:b,ref:this._targetDiv},c.createElement("div",{className:"od-ShareHint-iconHolder"},c.createElement(r.a,{label:y,permissionsType:S,iconUrl:D,showLabel:!1})),c.createElement(i.a,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig,isClickable:a,onClickCallback:this._openLinkPermissions.bind(this)})):c.createElement("div",{className:b,autoFocus:!0},c.createElement("div",{className:"od-ShareHint-iconHolder"},c.createElement(r.a,{label:y,permissionsType:S,iconUrl:D,showLabel:!1})),c.createElement(i.a,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig,isClickable:a}))}return c.createElement("div",{"aria-label":u.ke,className:p},t,e,this.state.isCoachmarkVisible&&c.createElement(m.a,{target:this._odShareHintchevron.current,positioningContainerProps:{directionalHint:l.b.isRightToLeft?h.a.bottomLeftEdge:h.a.bottomRightEdge}},c.createElement(_.a,{calloutProps:{directionalHint:l.b.isRightToLeft?h.a.bottomLeftEdge:h.a.bottomRightEdge,gapSpace:0},headline:u.ke,hasCondensedHeadline:!0,hasCloseIcon:!0,closeButtonAriaLabel:u.Vb,onDismiss:this._onDismiss},u.ue,c.createElement("br",null),u.fe)))},t.prototype._renderChevron=function(e){if(e)return c.createElement("div",{ref:this._odShareHintchevron},c.createElement(p.a,{iconName:l.b.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}}))},t.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()},t.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return e===s.a.anyone?o.a.anyone:e===s.a.organization?o.a.workGroup:e===s.a.existing?o.a.existing:e===s.a.customLabeledSpecificPeople?o.a.chat:o.a.specificPeople},t.prototype._getLabelFromPermissionsType=function(e){return e===o.a.anyone?u.Pg:e===o.a.workGroup?d.j(u.Fg,this.props.companyName):e===o.a.existing?u.Ng:e===o.a.specificPeople?u.oh:void 0},t.contextTypes={platformDetection:v.object.isRequired},t}(c.Component)}
,function(e,t,n){n.d(t,{a:function(){return d},b:function(){return x}});var a,i=n(0),r=n(121),o=n(52),s=n(26);!function(e){e[e.Unknown=0]="Unknown",e[e.User=1]="User",e[e.Site=2]="Site"}(a||(a={}));var c,d,l=(0,o.a)({eventName:"Experiment,",shortEventName:"Experiment"},{name:{isPrefixingDisabled:!0,type:s.a.String},isInRamp:{isPrefixingDisabled:!0,type:s.a.Boolean},experiment:{isPrefixingDisabled:!0,type:s.a.String},variant:{isPrefixingDisabled:!0,type:s.a.String},assignmentType:{isPrefixingDisabled:!0,type:s.a.Enum,typeRef:a},assignmentId:{isPrefixingDisabled:!0,type:s.a.String}}),u=n(37),f=n(45),p=n(38),m=n(291),_=n(3),h=n(507),b="ExperimentOverrides",g={},v="".concat(b,"_").concat("enableExp"),y="".concat(b,"_").concat("disableExp");!function(e){e[e.user=1]="user",e[e.tenant=2]="tenant",e[e.farm=3]="farm",e[e.site=4]="site"}(c||(c={})),function(e){e[e.v1=1]="v1",e[e.v2=2]="v2"}(d||(d={}));var S=["ChangeFlowToAutomate2","DocLibServiceWorkerExperimentV2","FileHoverCardAssign","flowOdbCommandBarCoachmarkExperiment","flowOdbCommandBarCoachmarkExperiment2","flowRemindMeCoachmarkExperiment","flowRemindMeCoachmarkExperiment2","flowRequestSignOffCoachmarkExperiment2","FluentLightBoxExperiment","NewCreateSiteEntryPointExperiment"];function D(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);(0,h.c)(v,t.join(",")),(0,h.c)(y,n.join(","))}function I(e,t,n){if(t)for(var a=0,i=t.split(",");a<i.length;a++)e[i[a]]=!0;if(n)for(var r=0,o=n.split(",");r<o.length;r++)e[o[r]]=!1;return e}var x=function(){function e(t,n){var a,o=t.name,s=n&&!p.c.isFeatureEnabled(n);this._isValidName(t.name)||u.a.log("Experiment name '".concat(t.name,"' is invalid."));var l=S.indexOf(t.name)>-1?d.v1:d.v2;this._experimentData=t=(0,i.a)({segmentPopulation:.5,targetType:c.user,version:l},t),s&&(t.name+="AA"),this._isOn=!1;var f=!_.a.isActivated("9D4F1042-BF40-4B7F-9A89-B1014F82C792","10/27/2021","Explictly disable ABExperiment bucketing for Unauthenticated users in ODC");if(e._pageContext){if(f&&"unauth"===(null===(a=e._pageContext)||void 0===a?void 0:a.userLoginName.toLowerCase()))return;switch(this._experimentData.targetType){case c.user:this._isOn=this._isUserExperimentOn();break;case c.tenant:this._isOn=this._isTenantExperimentOn();break;case c.farm:this._isOn=this._isFarmExperimentOn();break;case c.site:this._isOn=this._isSiteExperimentOn()}}else r.a.logData({name:this._experimentData.name+".Experiment.HostSettingsMissing"});s&&(this._isOn=!1),o in g&&(this._isOn=g[o])}return e.init=function(t){e._pageContext=(0,i.a)((0,i.a)({},t),{userLoginName:t.userLoginName||"missing_user",siteSubscriptionId:t.siteSubscriptionId||"missing_tenant",farmLabel:t.farmLabel||"missing_farm",siteId:t.siteId||"missing_site"})},e.Init=function(t){e.init(t)},e.prototype.getExperimentData=function(){return this._experimentData},e.prototype.isOn=function(){return this._isOn},e.prototype.IsExperimentOn=function(){return this._isOn},e.prototype._isUserExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",a=this._experimentData,i=a.name,r=a.version;return r===d.v1?n=i+"_"+t.userLoginName+"_"+t.siteSubscriptionId+"_"+t.farmLabel:r===d.v2&&(n=i+t.userLoginName),this._isExperimentOn(n)},e.prototype._isTenantExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",a=this._experimentData,i=a.name,r=a.version;return r===d.v1?n=i+"_"+t.siteSubscriptionId+"_"+t.farmLabel:r===d.v2&&(n=i+t.siteSubscriptionId),this._isExperimentOn(n)},e.prototype._isFarmExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",a=this._experimentData,i=a.name,r=a.version;return r===d.v1?n=i+"_"+this._getSiteId()+"_"+t.siteSubscriptionId+"_"+t.farmLabel:r===d.v2&&(n=i+this._getSiteId()),this._isExperimentOn(n)},e.prototype._isSiteExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n=this._experimentData.name+"_"+this._getSiteId()+"_"+t.siteSubscriptionId+"_"+t.farmLabel;return this._isExperimentOn(n)},e.prototype._isValidName=function(e){return!/[^A-Za-z0-9]/.test(e)},e.prototype._getSiteId=function(){var t=e._pageContext;return this._experimentData.siteId?this._experimentData.siteId:t.siteId},e.prototype._isExperimentOn=function(e){if(!e)return!1;var t=0;this._experimentData.version===d.v1?t=this._getHashNumber(e):this._experimentData.version===d.v2&&(t=this._getHashNumberMurmur(e));var n=t<=this._experimentData.segmentPopulation;return this._logData(n),n},e.prototype._getHashNumber=function(e){if(0===e.length)return 1;for(var t=5381,n=0;n<e.length;++n)t=(t<<5)+t+e.charCodeAt(n),t&=t;return(t&=65535)/65535},e.prototype._getHashNumberMurmur=function(e){return m.v3(e,1)/4294967295},e.prototype._getExperimentType=function(){return this._experimentData.targetType===c.user?a.User:this._experimentData.targetType===c.site?a.Site:a.Unknown},e.prototype._logData=function(e){l.logData({name:"",isInRamp:e,experiment:this._experimentData.name,variant:e.toString(),assignmentType:this._getExperimentType(),assignmentId:this._experimentData.targetType===c.site?this._getSiteId():""})},e}();p.c.evaluateCanOverride(),p.c.CanOverride&&function(){g=I({},(0,h.b)(v),(0,h.b)(y));var e=location.search?location.search.substring(1):"",t=(0,f.a)(e),n=t.enableExp,a=t.disableExp;I(g,n,a),D(g);try{window.__debugSetExperiment=function(e,t){void 0===t&&(t=!0),g[e]=!!t,D(g)}}catch(e){}}()}
,function(e,t,n){n.d(t,{a:function(){return y}});var a=n(0);(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail-status{padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{display:inline-block;font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";word-break:break-word}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusText.accessSummaryLink{font-size:.75rem}.od-ShareHintDetail-statusText.unHealthy{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-statusText:hover{cursor:default}.od-ShareHintDetail-statusText:hover.clickable{cursor:pointer}.od-ShareHintDetail-statusText i{vertical-align:middle;padding-bottom:6px;padding-left:4px}@supports (font:-apple-system-body){.od-ShareHintDetail-statusText{font:-apple-system-body}}.od-ShareHintDetail{height:100%;background-color:transparent;border:none}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover{cursor:pointer}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{text-decoration:underline}.od-ShareHintDetail.copyLinkNotification{padding:0}.od-ShareHintDetail.copyLinkNotification .od-ShareHintDetail-status{padding:0}.od-ShareHintDetail--hover:hover{border:none}.od-ShareHintDetail--hover:hover:active{border:none}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:.75rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir=ltr] .od-ShareHintDetail-item{margin-left:4px}[dir=rtl] .od-ShareHintDetail-item{margin-right:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}.od-ShareHintDetail-chevron{margin-left:4px;font-size:.5rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareHintDetail-iconTooltipContent{font-size:.875rem}@media screen and (-ms-high-contrast:active){.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{color:highlight}}"}]);var i=n(10),r=n(29),o=n(39),s=n(32),c=n(28),d=n(1),l=n(7),u=n(24),f=n(11),p=n(100),m=n(17),_=n(107),h=n(20),b=n(142),g=n(174),v=n(12),y=function(e){function t(t,n){var a=e.call(this,t)||this;return a._renderStatusIcons=a._renderStatusIcons.bind(a),a}return(0,a.d)(t,e),t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);(0,u.n)()&&this.props.isCopyLinkNotification&&(e=(0,m.v)({clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,currentSettings:this.props.currentSettings,companyName:this.props.companyName,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,sharingStore:this.context.sharingStore}));var t="od-ShareHintDetail ".concat((0,u.L)()?"od-ShareHintDetail--hover":""," ").concat(this.props.isClickable?"od-ShareHintDetail--clickable":""," ").concat(this.props.isCopyLinkNotification?"copyLinkNotification":""),n=e+", "+f.xi;return d.createElement(g.a,{className:t,onClick:this.props.isClickable?this.props.onClickCallback:void 0,"aria-label":n},d.createElement("div",{className:"od-ShareHintDetail-description"},d.createElement("div",{className:"od-ShareHintDetail-status"},d.createElement("span",{className:"od-ShareHintDetail-statusText ".concat(this.props.isClickable?"clickable":"")},e,this._renderStatusIcons(),this._renderChevron(this.props.isClickable)))))},t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=(this.props.currentSettings.preventDownload,[]);e&&e.getTime()!==new Date(0).getTime()&&n.push({icon:"Calendar",tooltip:"".concat(l.j(f.fd,(0,p.f)(e)))}),t&&n.push({icon:"Lock",tooltip:f.Ei}),this.props.currentSettings.audience!==r.a.existing&&this.props.currentSettings.isReview&&_.a[this.props.sharingInformation.fileExtension]&&n.push({icon:"Feedback",tooltip:f.wf}),this.props.currentSettings.audience===r.a.anyone&&this.props.currentSettings.trackLinkUsers&&n.push({icon:"ReminderPerson",tooltip:h.c(this.props.clientId)?f.ei:f.ni});var a=n.map(function(e,t){var n={onRenderContent:function(){return d.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},e.tooltip)}};return d.createElement("span",{className:"od-ShareHintDetail-item"},d.createElement(c.a,{id:e.icon,tooltipProps:n},d.createElement(i.a,{iconName:e.icon,"tab-index":0,"aria-label":e.tooltip,styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})))});return d.createElement("div",{className:"od-ShareHintDetail-iconsList"},a)}},t.prototype._renderChevron=function(e){if(e)return d.createElement(i.a,{iconName:b.b.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHintDetail-chevron",styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})},t.prototype._getLabel=function(e){var t=this.props.companyName,n=this.props.sharingInformation.addressBarLinkSettings,a=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&n)return n.linkDisabled||!(0,m.h)(a)?f.Ng:l.j(f.vc,t);if(!e)return"";if(e.preventDownload){if(e.audience===r.a.anyone)return f.W;if(e.audience===r.a.organization)return l.j(f.yc,t);if(e.audience===r.a.specificPeopleFlex)return f.Ej}switch(e.sharingLinkKind){case o.a.direct:return e.audience===r.a.specificPeople?this.props.sharingInformation.requiresAccessApproval?f.Kh:e.sharingRole?(0,m.Q)(e.sharingRole)?f.Sj:e.sharingRole===s.a.review?_.a[this.props.sharingInformation.fileExtension]?f.Cj:f.Oj:f.wj:e.isEdit?f.Sj:f.wj:f.td;case o.a.organizationView:return l.j(f.vc,t);case o.a.organizationEdit:return l.j(f.pc,t);case o.a.anonymousView:return f.V;case o.a.anonymousEdit:return f.L;case o.a.flexible:return this._getFlexibleLabel(e,t);default:return""}},t.prototype._getFlexibleLabel=function(e,t){return e.audience===r.a.existing?f.td:e.audience===r.a.specificPeopleFlex?e.sharingRole?e.sharingRole==s.a.manageList?f.xj:(0,m.Q)(e.sharingRole)?f.Sj:e.sharingRole===s.a.review?_.a[this.props.sharingInformation.fileExtension]?f.Cj:f.Oj:f.wj:e.isEdit?f.Sj:f.wj:e.audience===r.a.customLabeledSpecificPeople?e.sharingRole===s.a.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.j(f.xc,this.props.customLabeledAudienceConfig.entityName):(0,m.n)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.j(f.Dc,this.props.customLabeledAudienceConfig.entityName):(0,m.n)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.j(f.Cc,this.props.customLabeledAudienceConfig.entityName):(0,m.n)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===r.a.organization?e.sharingRole===s.a.review?_.a[this.props.sharingInformation.fileExtension]?l.j(f.bc,t):l.j(f.gc,t):e.sharingRole==s.a.manageList?l.j(f.hc,t):e.isEdit?l.j(f.pc,t):l.j(f.vc,t):e.audience===r.a.anyone?e.sharingRole===s.a.review?_.a[this.props.sharingInformation.fileExtension]?f.P:f.U:e.sharingRole==s.a.manageList?f.O:e.isEdit?f.L:f.V:""},t.contextTypes={sharingStore:v.object.isRequired},t}(d.Component)}
,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return s},c:function(){return o}});var a=n(7),i=n(232),r=n(360);function o(e,t,n){void 0===n&&(n=!1);var a=Date.now()-e.getTime();if(a<-5*i.c)return l(e,t);if(a<i.c)return s("LessThanAMinute",n);if(a<i.g)return s("AboutAMinute",n);if(a<i.b)return c(Math.floor(a/i.c),"XMinutes");if(a<i.f)return s("AboutAnHour",n);if(a<i.a)return c(Math.floor(a/i.b),"XHours");if(a<i.e){var r=e.toLocaleTimeString(t);return s("YesterdayAndTime",n).replace("{0}",r)}return a<i.d?c(Math.floor(a/i.a),"XDays"):l(e,t)}function s(e,t,n,a){return r[["RelativeDateTime_",e,n?"Future":"",a?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}function c(e,t,n,i){var r=s(t,!!i&&n,i),o=s(t,!1,i,!0);return((0,a.k)(r,o,e)||"").replace("{0}",e+"")}var d={};function l(e,t){return"undefined"!=typeof Intl&&Intl.DateTimeFormat?(d[t]||(d[t]=new Intl.DateTimeFormat(t)),d[t].format(e)):e.toLocaleDateString(t)}}
,,,function(e,t,n){var a,i;n.d(t,{a:function(){return c}}),(i=a||(a={}))[i.default=0]="default",i[i.powerpoint=1]="powerpoint",i[i.stream=2]="stream",i[i.excelRange=3]="excelRange",i[i.excelTable=4]="excelTable",i[i.excelSheet=5]="excelSheet",i[i.excelChart=6]="excelChart",i[i.excelSheetView=7]="excelSheetView",i[i.excelComment=8]="excelComment";var r=n(7),o=n(24),s=n(11);function c(e){var t=e.sharingStore,n=e.fallback,i=e.copyToClipboardFailed;if(o.f()&&t){var c=t.getContextualSharingInformation(),d=t.getNavId();if(c&&d){var l="".concat(function(e){switch(e){case a.excelRange:return s.Qb;case a.excelTable:return s.Zb;case a.excelSheet:return s.Jb;case a.excelChart:return s.Kb;case a.excelSheetView:return s.Yb;case a.excelComment:return s.Wb;case a.powerpoint:return s.Xb;case a.stream:default:return""}}(c.context)).concat(c.location?" "+c.location:""),u=i?s.rf:s.qb;return r.j(u,l)}}return n}}
,,,function(e,t,n){n.d(t,{a:function(){return a}});var a={anyone:0,organization:1,specificPeople:2}}
,,function(e,t){t.a={view:1,edit:2,review:6,restrictedView:7}}
,,function(e,t,n){n.d(t,{a:function(){return i},b:function(){return r},c:function(){return a}});var a={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},r={override:0,reportFalsePositive:1}}
,function(e,t,n){n.d(t,{a:function(){return u}});var a=n(0);(0,n(4).b)([{rawString:".od-PolicyTip-container{display:flex;flex-direction:column}.od-PolicyTip-title{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:100;margin:0 0 8px 0}.od-PolicyTip-description{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-top:20px}.od-PolicyTip-header{display:flex;margin:20px 0}.od-PolicyTip-blockedIcon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300;font-weight:600}[dir=ltr] .od-PolicyTip-headerText{margin-left:12px}[dir=rtl] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-bottom:12px}[dir=ltr] .od-PolicyTip-issue{margin-left:33px}[dir=rtl] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:flex}[dir=ltr] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir=rtl] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir=ltr] .od-PolicyTip-label{margin-left:4px}[dir=rtl] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400}[dir=ltr] .od-PolicyTip-statusText{margin-left:4px}[dir=rtl] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-justificationInputContainer{overflow-y:auto;max-height:110px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300}"}]);var i=n(56),r=n(57),o=n(42),s=n(99),c=n(1),d=n(7),l=n(10),u=function(e){function t(t){var n=e.call(this,t)||this;return n._onReportClicked=function(){n.setState((0,a.a)((0,a.a)({},n.state),{isLoading:!0,reportButtonClicked:!0}),function(){n.props.onReportClicked()})},n._onOverrideClicked=function(){n.setState((0,a.a)((0,a.a)({},n.state),{overrideButtonClicked:!0}),function(){n.props.onOverrideClicked()})},n._onOverrideSubmitClicked=function(){n.setState((0,a.a)((0,a.a)({},n.state),{isLoading:!0,overrideSubmitClicked:!0}),function(){n.props.onOverrideSubmitClicked(n.state.justificationText)})},n._onJustificationChanged=function(e,t){n.props.overrideRequiresJustification&&n.setState((0,a.a)((0,a.a)({},n.state),{justificationText:t||"",overrideSubmitDisabled:!t}))},n.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:t.overrideRequiresJustification},n}return(0,a.d)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState((0,a.a)((0,a.a)({},this.state),{isLoading:!1}))},t.prototype.componentWillUnmount=function(){this.props.onDismissed()},t.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?c.createElement("div",{className:"od-PolicyTip-container"},c.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):c.createElement("div",{className:"od-PolicyTip-container"},c.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),c.createElement("div",{className:"od-PolicyTip-header"},c.createElement(l.a,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),c.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),c.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),c.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return c.createElement("div",null,c.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)},t.prototype._renderIssues=function(){for(var e=[],t=0,n=0,a=this.props.strings.issues;n<a.length;n++){var i=a[n];e.push(c.createElement("span",{className:"od-PolicyTip-issue",key:t++},i))}return e},t.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=c.createElement("a",{href:e.learnMoreUrl,target:"_blank",rel:"noreferrer"},e.learnMoreActionLabel),n=d.h(e.learnMoreLabel,t);return c.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},n)}},t.prototype._getAction=function(e,t,n,a){if(n)return c.createElement("div",{className:"od-PolicyTip-action"},c.createElement("span",null,"".concat(d.j(e,t))));var i=c.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:a,role:"button",href:"javascript:;"},t),r=d.h(e,i);return c.createElement("div",{className:"od-PolicyTip-action"},r)},t.prototype._renderActions=function(){var e=this.props,t=this.state,n=e.strings,a=[],i=this._getAction(n.reportLabel,n.reportActionLabel,t.reportButtonClicked,this._onReportClicked);if(a.push(i),n.overrideActionLabel){var r=this._getAction(n.overrideLabel,n.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);a.push(r)}return a},t.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?c.createElement("div",{className:"od-PolicyTip-status"},c.createElement(o.a,null),c.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?c.createElement("div",{className:"od-PolicyTip-status"},c.createElement(l.a,{iconName:"CheckMark"}),c.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0},t.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return c.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},c.createElement(s.a,{autoAdjustHeight:!0,multiline:!0,value:t.justificationText,onChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&c.createElement(r.a,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))},t}(i.a)}
,,,function(e,t,n){n.d(t,{a:function(){return l}});var a=n(0),i=n(1);(0,n(4).b)([{rawString:".deferredLivePersonaCardRoot_6d7894f7{display:inline-block}.deferredLivePersonaCardRoot_6d7894f7 .lpc-hoverTarget:focus-visible[data-is-focusable=true]{position:initial;outline:-webkit-focus-ring-color auto 1px}"}]);var r=n(21),o=n(56),s=n(338),c=function(e){function t(t){var n=e.call(this,t)||this;return n._deferLoadComponent=function(){!n.state.ComponentModule&&n.props.moduleLoader&&n.props.modulePath&&n.props.moduleLoader.load(n.props.modulePath,n.props.getModule).then(function(e){if(n.props.moduleLoader.parse&&(e=n.props.moduleLoader.parse(e)),!e){var t="ReactDeferredComponent: component not found when loading ".concat(n.props.modulePath," ")+"- check your load and parse functions";console.error(t)}n._mounted?n.setState({ComponentModule:e}):n.state={ComponentModule:e}})},n._mounted=!1,n.state={ComponentModule:void 0},n._setupDeferLoadCallback(t),n}return(0,a.d)(t,e),t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?i.createElement(t,(0,a.a)({ref:function(t){t&&(0,s.a)(e,t)}},this.props.props),this.props.children):this.props.placeHolder||null},t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._setupDeferLoadCallback(e)},t.prototype._setupDeferLoadCallback=function(e){var t=e.customWaiter;t?t.then(this._deferLoadComponent):this._deferLoadComponent()},t}(i.Component),d=n(3),l=function(e){function t(t,a){var r=e.call(this,t,a)||this;return r._onActivate=function(e){r.state.hovered||r.setState({hovered:!0,activatedByFocus:"focus"===e.type})},r.modulePath="./SpLivePersonaCard",r.moduleLoader={load:function(){return n.e(41).then(n.bind(n,620)).then(function(e){return e.SpLivePersonaCard})}},r.state={hovered:t.forceLoad,activatedByFocus:!1},r.containerRef=i.createRef(),r}return(0,a.d)(t,e),t.prototype.render=function(){var e=this,t=this.state.hovered;this.onFocusRender=function(){if(e.state.activatedByFocus){var t=e.containerRef.current.firstChild;e.props.shouldOnFocusMoveFocusToTarget&&t&&t.className.indexOf("lpc-hoverTarget")>-1&&t.focus()}},this._deferredComponentProps={modulePath:this.modulePath,moduleLoader:this.moduleLoader,props:(0,a.a)((0,a.a)({},this.props),{onPersonaCardReady:this.onFocusRender}),customWaiter:this.props.customWaiter,placeHolder:this.props.placeHolder};var n=d.b.isActivated("306d9715-fab4-4c1d-aca6-5fb0e292f65e"),o=(0,r.a)("deferredLivePersonaCardRoot","deferredLivePersonaCardRoot_6d7894f7",this.props.className);return i.createElement("div",{onMouseOver:!n&&t?void 0:this._onActivate,onClick:!n&&t?void 0:this._onActivate,onFocus:!n&&t?void 0:this._onActivate,onMouseDown:!n&&t?void 0:this._onActivate,onKeyDown:!n&&t?void 0:this._onActivate,className:o,tabIndex:!n&&t?void 0:this.props.containerTabIndex,ref:this.containerRef,"data-is-focusable":!(!(this.props.containerTabIndex>-1)||t)},t?i.createElement(c,(0,a.a)({},this._deferredComponentProps),this.props.children):this.props.children)},t.defaultProps={containerTabIndex:-1},t}(o.a)}
,,,,,function(e,t,n){n.d(t,{a:function(){return u}});var a=n(0),i=n(1),r=n(500),o=n(562),s=n(215),c=new WeakMap,d=new Map,l=new WeakMap;function u(e,t){void 0===t&&(t={});var n=t.useChildrenAsPlaceholder,u=void 0!==n&&n,f=function(){return function(e){var t=l.get(e);return t||l.set(e,t=e().then(function(t){var n,a=(n=t).default||n;return c.set(e,a),a}).catch(function(t){return l.delete(e),Promise.reject(t)})),t}(e)},p=function(){if(c.has(e))return c.get(e)};function m(e){var t=this,n=i.useState(function(){return{}}),c=e.placeholder,l=e.children,m=e.barrier,_=e.onRenderError,h=(0,a.f)(e,["placeholder","children","barrier","onRenderError"]),b=(0,r.a)(function(){return h},h),g=i.useState(function(){return p()}),v=g[0],y=g[1],S=i.useRef(y),D=i.useState(),I=D[0],x=D[1],C=i.useRef(x);i.useLayoutEffect(function(){return function(){S.current=void 0,C.current=void 0,d.delete(n)}},[]),i.useLayoutEffect(function(){if(d.size>0){var e=[];d.forEach(function(t){e.push(t)}),d.clear();for(var t=0,n=e;t<n.length;t++)(0,n[t])()}}),i.useLayoutEffect(function(){v||I||(0,a.b)(t,void 0,void 0,function(){var e,t,i,r;return(0,a.e)(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),m?[4,m]:[3,2];case 1:a.sent(),a.label=2;case 2:return[4,f()];case 3:return e=a.sent(),[3,5];case 4:return i=a.sent(),t=i,[3,5];case 5:return d.set(n,function(){e?S.current&&S.current(function(){return e}):t&&C.current&&C.current(t)}),[4,(0,o.b)(0)];case 6:return a.sent(),(r=d.get(n))&&(d.delete(n),r()),[2]}})})},[]);var O=(0,s.a)(function(){x(void 0)});return i.useMemo(function(){if(I){if(_)return i.createElement(i.Fragment,null,_({error:I,retry:O}));throw I}return v?i.createElement(v,(0,a.a)({},b,{children:l})):u?i.createElement(i.Fragment,null,l):c?i.createElement(i.Fragment,null,c):null},[b,c,l,v,I,_])}return m.asAsync={load:f,getComponent:p,options:t},m}}
,function(e,t,n){n.d(t,{a:function(){return c},b:function(){return s}});var a=n(0),i=n(212),r=n(161),o=function(e){function t(t){var n=this,i=t.timeout,r=(0,a.f)(t,["timeout"]);return(n=e.call(this,(0,a.a)((0,a.a)({message:"Timeout"},r),{extraData:{timeout:i}}))||this).timeout=i,n.name="TimeoutError",n}return(0,a.d)(t,e),t}(n(68).a);function s(e,t){return(0,a.b)(this,void 0,void 0,function(){var n,o,s,c,d,l;return(0,a.e)(this,function(a){switch(a.label){case 0:n=new i.a,o=n.resolve,s=n.reject,c=n.promise,t&&t.throwIfCanceled(),d=e!==1/0?window.setTimeout(function(){return o()},e):void 0,l=t&&t.subscribe(function(){d&&window.clearTimeout(d),s(new r.a)}),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,c];case 2:return a.sent(),[3,4];case 3:return l&&l(),[7];case 4:return[2]}})})}function c(e,t){var n="number"==typeof e?{timeout:e}:e,i=n.timeout,s=n.errorProps,c=void 0===s?{}:s,d=new r.b,l=t&&t.subscribe(d.cancel),u=i!==1/0?window.setTimeout(function(){d.cancel(new o((0,a.a)({timeout:i},c)))},i):void 0;return u&&d.token.subscribe(function(){window.clearTimeout(u)}),(0,a.a)((0,a.a)({},d),{dispose:function(){u&&clearTimeout(u),l&&l(),d.dispose()}})}}
,,,,,,,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(358);function i(e){return e&&e.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,function(e,t,n,i,r,o){return"".concat(t).concat((0,a.a)(r)).concat(o)})}}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(41),i=n(7);function r(e){for(var t={CorrelationVector:e.vector.toString(),WebLog_FullName:e.eventName,WebLog_EventType:a.b[e.eventType]},n=e.eventName.split(","),r=0,o=n;r<o.length;r++){var s=o[r];s&&(t["WebLog_Type_".concat(s)]=1)}var c=e.data,d=e.context;if(d)for(var l in d)if(Object.prototype.hasOwnProperty.call(d,l)){if(null==(f=d[l]))continue;t[m=(0,i.a)(l)]=f}if(c)for(var u in c)if(Object.prototype.hasOwnProperty.call(c,u)){var f;if(null==(f=c[u]))continue;var p=e.metadata[u];if(p){var m=p.isPrefixingDisabled?(0,i.a)(u):"".concat((0,i.a)(p.definedInName),"_").concat(u),_=p.type;if(4===_){for(var h in f)if(Object.prototype.hasOwnProperty.call(f,h)){var b=f[h];if(null!=b&&""!==b){var g=void 0;if("object"==typeof b)try{g=JSON.stringify(b)}catch(e){g=b}else g=b;t["".concat(m,"_").concat(h.replace(/\./g,"_"))]=g}}}else t[m]=6===_?p.typeRef[f]:f}}return{name:e.isEventTypePrefixingDisabled?n[n.length-2]:"ev_".concat(n[n.length-2]),values:t}}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(0);function i(){return function(e){return function(e){function t(t){var n=t.context,i=void 0===n?{}:n,r=t.userAuthToken,o=t.userId,s=(t.context,(0,a.f)(t,["userAuthToken","userId","context"])),c=r&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}(r),d=c&&c.puid?"Business":"Unknown",l=c&&c.app_displayname||"Unknown",u=c&&c.appid||"Unknown",f=function(e,t,n){return e?"Unknown"===n?"":e:"Business"===n&&t&&t.puid||""}(o,c,d),p=f?1:0,m=c&&c.tid||"Unknown";return e.call(this,(0,a.a)({context:(0,a.a)({AccountType:d,AppName:l,AppId:u,IsAuthenticated:p,SiteSubscriptionId:m,UserId:f},i)},s))||this}return(0,a.d)(t,e),t}(e)}}}
,function(e,t,n){var a=n(0),i=n(14),r=n(156),o=n(46),s={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},c=function(){function e(e,t){this._dataRequestor=t.dataRequestor,this._betaDataRequestor=t.betaDataRequestor,this._graphApiVersion=e.graphApiVersion||""}return e.getSharesPathFromItemUrl=function(e){var t=btoa(unescape(encodeURIComponent(e)));return"/shares/u!".concat(t.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),"/driveItem")},e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});return n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getFamily=function(){var e={};return o.a.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:(0,a.a)((0,a.a)({},s),{404:!0}),qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e}).catch(function(e){})},e.prototype.getFamilyMembers=function(){var e={};return o.a.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:(0,a.a)((0,a.a)({},s),{404:!0}),qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e}).catch(function(e){})},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})},e.prototype.getDriveInfo=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.createLink=function(e){var t=this,n=e.itemIds,a=e.type,i=e.scope,r=e.preventDownload,o=e.password,s=e.expiration,c=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:a,scope:i,preventDownload:r,password:o,expiration:s}):this.createBundle(n,c||"").then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:a,scope:i,preventDownload:r,password:o,expiration:s})})},e.prototype.createLinkFromItemUrl=function(t){var n=t.itemUrl,a=t.type,i=t.scope,r=t.preventDownload,o=t.password,s=t.expiration;return this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(n),type:a,scope:i,preventDownload:r,password:o,expiration:s})},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.id})},e.prototype.getDriveOwner=function(e){var t="/drives/"+e;return this._dataRequestor.send({path:t,apiName:"/drives/",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getCurrentUser=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}})},e.prototype.getItemInfo=function(e){var t="".concat(this.getDrivesPathFromItemId(e));return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getItemInfoFromItemUrl=function(t){var n="".concat(e.getSharesPathFromItemUrl(t));return this._dataRequestor.send({path:n,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getPermissions=function(e){var t="".concat(this.getDrivesPathFromItemId(e),"/permissions");return("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e.value})},e.prototype.getPermissionsFromItemUrl=function(t){var n;n="1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor;var a="".concat(e.getSharesPathFromItemUrl(t),"/permissions");return n.send({path:a,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:"beta"}}).then(function(e){return e.value})},e.prototype.invite=function(e){var t=this,n=e.itemIds,a=e.recipients,i=e.message,r=e.requireSignIn,o=e.sendInvitation,s=e.roles,c=e.password,d=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),a,i,r,o,s,c,d):this.createBundle(n,l||"").then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),a,i,r,o,s,c,d)})},e.prototype.inviteFromItemUrl=function(t){var n=t.itemUrl,a=t.recipients,i=t.message,r=t.requireSignIn,o=t.sendInvitation,s=t.roles,c=t.password,d=t.expiration;return this.inviteSingleItem(e.getSharesPathFromItemUrl(n),a,i,r,o,s,c,d)},e.prototype.getDefaultLink=function(t,n,a){return n.length>0?this.inviteSingleItem(e.getSharesPathFromItemUrl(t),n,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},a):this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(t),useMultiPart:a}).then(function(e){return i.c.wrap([e])})},e.prototype.getDefaultLinkByUniqueId=function(e,t,n){return t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},n):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:n}).then(function(e){return i.c.wrap([e])})},e.prototype.updatePermissions=function(e,t,n){var a="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t),o={roles:[n]};return this._dataRequestor.send({path:a,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(o),getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value}).catch(function(e){var t=e.message||"Error updating permission",n=e.code||(0,r.d)(e)||"genericPermissionUpdateFailure",a={error:e.error,name:e.name,errorCode:n,debugErrorMessage:JSON.stringify(e),errorMessage:t,rawError:JSON.stringify(e)};return i.c.reject(a)})},e.prototype.updatePermissionsFromItemUrl=function(t,n,a){var i="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n),r={roles:[a]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(r),getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value})},e.prototype.unshareLink=function(e,t){var n="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t);return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(){return!0})},e.prototype.unshareLinkFromItemUrl=function(t,n){var a="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n);return this._dataRequestor.send({path:a,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(){return!0})},e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,a=e.scope,i=e.preventDownload,r=e.password,o=e.useMultiPart,c=e.expiration,d="".concat(n,"/createLink"),l=t&&a?{type:t,scope:a,preventDownload:i}:{};return(r||""===r)&&(l.password=r),c&&(l.expirationDateTime=c),this._dataRequestor.send({path:d,apiName:"createLink",requestType:"POST",useMultiPart:o,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e})},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/".concat(e,"/driveItem")},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/".concat(t[0],"/items/").concat(e):"/drive/items/".concat(e)},e.prototype.inviteSingleItem=function(e,t,n,a,i,r,o,c,d,l){var u="".concat(e,"/invite"),f={recipients:t,message:n,requireSignIn:a,sendInvitation:i,roles:r};return o&&(f.password=o),c&&(f.expirationDateTime=c),this._dataRequestor.send({path:u,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(f),useMultiPart:l,headers:d,getErrorAsMessage:!0,expectedErrorCodes:s,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value})},e}();t.a=c}
,function(e,t,n){var a=n(130),i=n(83),r="https://outlook.office.com/search",o=function(){function e(e,t){this._dataRequestor=t.dataRequestor,this._substrateToken=e.substrateToken,this._mailbox=e.mailbox,this._graphApiVersion=e.graphApiVersion}return e.prototype.getContacts=function(e){var t="/me/contacts?$select=displayName,emailAddresses&$top=50";return e&&e.length>0&&(t+='&$search="'.concat(a.a.encodeURIComponent(e),'"')),this._dataRequestor.send({path:t,apiName:"GetContacts",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){return e.value})},e.prototype.getPeople=function(e){var t=this,n="/me/people?$select=displayName,";return n=this._appendEmailAddressSelector(n),n+="&$top=20",e&&e.length>0&&(n+='&$search="'.concat(a.a.encodeURIComponent(e),'"')),this._dataRequestor.send({path:n,apiName:"GetTopCollaborators",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){var n=e;return"1.0"===t._graphApiVersion&&(n=t._convertPersonEmails(e)),n&&n.value},function(e){})},e.prototype.searchPeople=function(e){var t=this,n="/me/people?$select=displayName,";return n=this._appendEmailAddressSelector(n),n+="&$top=20",e&&e.length>0&&(n+='&$search="'.concat(a.a.encodeURIComponent(e),'"')),this._dataRequestor.send({path:n,apiName:"SearchPeople",requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(function(e){var n=e;return"1.0"===t._graphApiVersion&&(n=t._convertPersonEmails(e)),n&&n.value},function(e){})},e.prototype.searchPeople3S=function(e){var t,n={Authorization:"Bearer "+this._substrateToken,"x-anchormailbox":"SMTP:".concat(this._mailbox)};return t=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:["Mailbox"],Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"]}],TimeZone:"UTC",Cvid:i.a.generate(),Scenario:{Name:"documentshare"}}),this._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:"/api/v1/suggestions",endpoint:r,needsAuthorization:!1,headers:n,requestType:"POST",postData:t}).then(function(e){return e&&e.Groups&&e.Groups.length&&e.Groups[0].Suggestions},function(e){})},e.prototype.isSubstrateTokenAvailabe=function(){return this._substrateToken&&this._substrateToken.length>0},e.prototype.init3S=function(){if(this._substrateToken){var e={Authorization:"Bearer "+this._substrateToken,"x-anchormailbox":"SMTP:".concat(this._mailbox)};this._dataRequestor.send({apiName:"Substrate.PeopleSearchInit",path:"/api/v1/init?scenario=documentshare",endpoint:r,needsAuthorization:!1,headers:e,requestType:"GET"})}},e.prototype._appendEmailAddressSelector=function(e){return"1.0"===this._graphApiVersion?e+="scoredEmailAddresses":e+="emailAddresses",e},e.prototype._convertPersonEmails=function(e){var t=e&&(null==e?void 0:e.value);if(t&&t.length>0){for(var n=0;n<t.length;n++){var a=t[n];if(a.scoredEmailAddresses&&!a.emailAddresses){for(var i=[],r=0;r<a.scoredEmailAddresses.length;r++){var o=a.scoredEmailAddresses[r],s={address:o.address,rank:o.relevanceScore};i.push(s)}a.emailAddresses=i}}return e}},e}();t.a=o}
,function(e,t,n){n.d(t,{a:function(){return r}});var a=n(14),i=function(){return null},r=function(){function e(e){this.getPersonaDetails=i,this.subscribePresence=i,this.getPickerEntityInformation=i,this.addToMruCache=i,this._dataSource=e,this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,i=this,r={cached:null,promise:null};return r.promise=new a.c(function(a,r){n=i._dataSource.search(e,t).then(function(e){e&&a(e)},function(e){r(e)})},function(){n&&n.cancel()}),r},e.prototype.resolve=function(e,t){return this._dataSource.resolve(e,t).then(function(e){return e})},e}()}
,function(e,t,n){n.d(t,{a:function(){return l}});var a=n(0),i=n(14),r=n(173),o=n(386),s=n(3),c=n(38),d=s.b.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","Killswitch for new Share Dialog for COB")||c.c.isFeatureEnabled({ECS:1131341}),l=function(){function e(e,t){this._service=e,this._supportsPeople=t||!1}return e.prototype.getCapabilities=function(){return{supportsMruCaching:!1}},e.prototype.search=function(e,t){var n=this;if(t.useNew3Ssearch&&this._service.isSubstrateTokenAvailabe())try{return this._service.searchPeople3S(e).then(function(i){if(i&&i.length){var o=[],s=r.a.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===o.length&&s){var c={Key:e,IsResolved:!1};o.push((0,a.a)({email:e,name:e,userId:e,isResolved:!0},d?{}:{rawData:c,rawPersonData:c}))}for(var l=0,u=i;l<u.length;l++){var f=u[l],p=f.EmailAddresses&&f.EmailAddresses.length?f.EmailAddresses[0]:"",m="";if(p)try{(m=btoa(f.Id)).indexOf(p)>-1&&(m=m.substring(0,m.indexOf(p)))}catch(e){m=""}c={Key:p,IsResolved:!1},o.push((0,a.a)({email:p,name:f.DisplayName,userId:m,isResolved:!0},d?{}:{rawData:c,rawPersonData:c}))}return o}return n._getContact(e,t)})}catch(e){}else if(this._supportsPeople)try{return this._service.searchPeople(e).then(function(n){var i,o,s=[],c=r.a.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===s.length&&c){var l={Key:e,IsResolved:!1};s.push((0,a.a)({email:e,name:e,userId:e,isResolved:!0},d?{}:{rawData:l,rawPersonData:l}))}if(n&&n.length>0)for(var u=0,f=n;u<f.length;u++){var p=f[u],m=null===(o=null===(i=null==p?void 0:p.emailAddresses)||void 0===i?void 0:i[0])||void 0===o?void 0:o.address,_="";if(m)try{(_=btoa(p.id)).indexOf(m)>-1&&(_=_.substring(0,_.indexOf(m)))}catch(e){_=""}l={Key:m,IsResolved:!1},s.push((0,a.a)({email:m,name:p.displayName,userId:_,isResolved:!0},d?{}:{rawData:l,rawPersonData:l}))}return s})}catch(e){}return this._getContact(e,t)},e.prototype._getContact=function(e,t){return this._service.getContacts(e).then(function(n){var i=r.a.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===n.length&&i){var o={Key:e,IsResolved:!1};return[(0,a.a)({email:e,name:e,userId:e,isResolved:!0},d?{}:{rawData:o,rawPersonData:o})]}var s=e.toLowerCase(),c=n.map(function(e){var t,n="",r="",o=e.emailAddresses;if(o&&o.length>0)for(var c=0,l=o;c<l.length;c++){var u=l[c];if(u&&u.address&&u.address.length>0&&(r||(r=u.address),i&&0===u.address.toLowerCase().indexOf(s))){n=u.address;break}}t=i&&n||e.displayName;var f=i?n:r,p={Key:f,IsResolved:!1};return(0,a.a)({userId:t,name:e.displayName,email:f,isResolved:!0},d?{}:{rawData:p,rawPersonData:p})});return c.filter(function(e){return e.email})})},e.prototype.resolve=function(e,t){var n,a=this,r=function(){n&&(n.cancel(),n=void 0)};return new i.c(function(o,s){var c=function(e){r(),o(e)};n=i.c.timeout(2e3).then(function(){c(a._getPersonFromQuery(e))}),a.search(e,t).then(function(t){0===t.length?c(a._getPersonFromQuery(e)):c(t[0])},function(t){c(a._getPersonFromQuery(e))})},r)},e.prototype.getPersonaDetails=function(e){return null},e.prototype.subscribePresence=function(e,t){return{dispose:function(){}}},e.prototype.getPickerEntityInformation=function(e){return null},e.prototype._getPersonFromQuery=function(e){var t=new r.a(e),n={};return t.getEmail()?(n.name=t.getName()||"",n.image="",n.sharingInfo={type:o.a.Email},n.isResolved=!0):n.name=n.name||e,n.email=t.getEmail()||e,n},e}()}
,function(e,t,n){var a=n(0),i=n(550),r=n(29),o=n(69),s=n(39),c=n(32),d=n(164),l=n(72),u=n(156),f=n(18),p=n(11),m=n(180),_=n(7),h=n(114),b=n(46),g=n(110),v=n(173),y=n(20),S=n(364),D=n(100),I=n(24),x=n(242),C=n(577),O=n(94),w=n(112),E=n(81),A=n(73),L=n(143),k=function(){return null},M=function(){function e(e,t){var n=this;if(this._listeners=null,this._isConvergedItem=!1,this._isShareCustomerPromiseTelemetryInitialized=!1,this.addPeople=k,this.getCompanyName=k,this.getOutlookAvailability=k,this.fetchSuiteNavInformation=k,this.navigateToOwa=k,this.fetchGroupsMemberCount=k,this.getGroupsMemberCount=k,this.fetchPolicyTipInformation=k,this.getPolicyTipInformation=k,this.updatePolicy=k,this.checkPermissions=k,this.getPermissionsMap=k,this.isValidatingDefaultRecipients=function(){return n._isValidatingDefaultRecipients},this.getAddPeopleResult=k,this.hasAccessRequestBeenCreated=k,this.fetchMemberCount=k,this.getMembersCounts=k,this.getInvitationId=k,!e.itemId&&!e.itemUrl&&!e.multiShareIds)throw new Error("An itemId, itemUrl, or multiShareIds must be passed to the Sharing store");this._listeners=new Array,this._shareLink=null,this._grantAccessResult=null,this._itemUrl=e.itemUrl,this._multiShareIds=e.multiShareIds,this._itemId=this._multiShareIds?this._multiShareIds[0]:e.itemId,this._itemName=this._multiShareIds&&this._multiShareIds.length>1?_.j(p.Gi,this._multiShareIds.length):e.itemName,this._sharingService=e.sharingService,this._sharingInformation=null,this._isPremium=null,this._isPremiumPromise=e.isPremiumPromise,this._isBundleShare=this._multiShareIds&&this._multiShareIds.length>1,this._sharingContextInformation=e.sharingContextInformation,this._isUserMinor=e.isUserMinor,this._updateUserIdTelemetryContext=e.updateUserIdTelemetryContext,this._initShareCustomerPromiseTelemetry=e.initShareCustomerPromiseTelemetry,this._engagementHelper=new h.a(e.telemetryManager,{clientId:this._clientId}),this._navId=e.navId,this._family=null,this._familyMembers=[],this._clientId=e.clientId,this._isEdit=null===e.isEdit||void 0===e.isEdit||e.isEdit,this._audience=null!==e.audience&&void 0!==e.audience?e.audience:r.a.anyone,this._isBundleShare&&(this._bundleName=_.j(p.zi,D.a(new Date))),b.a.isFeatureEnabled({ODC:"AtMentionODCKillSwitch"})||(t?this._tryResolveDefaultRecipients(e.defaultRecipients,t.peoplePickerProvider):this._tryResolveDefaultRecipients(e.defaultRecipients,void 0)),this._sharingContextInformation&&this._sharingContextInformation.consumerFlightContexts&&I.d(this._sharingContextInformation.consumerFlightContexts,this._clientId===o.a.odc||this._clientId===o.a.odcWac)}return e.prototype.isConsumer=function(){return!0},e.prototype.isConsumerLists=function(){return!1},e.prototype.isListItem=function(){return!1},e.prototype.getEngagementHelper=function(){return this._engagementHelper},e.prototype._emitChange=function(e){this._listeners.forEach(function(t){return t(e)})},e.prototype.addListener=function(e){this._listeners.push(e),this._emitChange()},e.prototype.shouldInterruptCopyLink=function(e){var t=this;return this._isPremium&&!this.isBundleShare()?this._sharingInformation.hasPermissionsInformation?new Promise(function(n,a){n(t._doesMatchingLinkExist(e))}):new Promise(function(n,a){t._sharingService.getPermissions(t._itemId).then(function(a){t._permissions=a;var i=t._parsePermissions(a),r=i.principals,o=i.sharingLinks;t._sharingInformation.sharingPrincipals=r,t._sharingInformation.sharingLinks=o,n(t._doesMatchingLinkExist(e))})}):new Promise(function(e,t){e(!1)})},e.prototype._doesMatchingLinkExist=function(e){var t=this._sharingInformation.sharingLinks,n=!1;return t.forEach(function(t){t.isEdit!==e||t.application||(n=t.hasPassword)}),n},e.prototype.getInitialLinkSettings=function(e){var t,n=r.a.anyone,a=!0,i=null;if(null==e)t=s.a.anonymousEdit;else if(null!==e.isEdit&&void 0!==e.isEdit&&(a=e.isEdit),null!==e.expiration&&void 0!==e.expiration&&(i=e.expiration),e.audience===r.a.specificPeople)t=s.a.direct,n=r.a.specificPeople;else{if(null!==e.audience&&void 0!==e.audience&&e.audience!==r.a.anyone)throw new Error("ODC does not support other SharingAudience settings.");t=a?s.a.anonymousEdit:s.a.anonymousView,n=r.a.anyone}return{allowEditing:!0,audience:n,expiration:i,isEdit:a,sharingRole:a?c.a.edit:c.a.view,sharingLinkKind:t,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",requireSignIn:e.audience===r.a.specificPeople}},e.prototype.getSharingInformation=function(){return this._sharingInformation},e.prototype.shouldDisableGraphForPeopleSearch=function(){return!1},e.prototype.fetchSharingInformation=function(e){var t=this;return new Promise(function(n){var l,m,_=t._itemId?t._sharingService.getItemInfo(t._itemId):t._sharingService.getItemInfoFromItemUrl(t._itemUrl),h=t._sharingService.getCurrentUser();l=t._sharingService.getDriveInfo(),m=Promise.resolve(void 0),I.j()||(m=t._isPremiumPromise||Promise.resolve(!1));var b=I.u()&&y.r(t._clientId),g=b?t._sharingService.getFamily():Promise.resolve(),v=b?t._sharingService.getFamilyMembers():Promise.resolve(),S=new f.a({name:"SharingInformationPreReqs",extraData:{clientId:o.a[t._clientId]}}),D=Promise.all([t._toTuple(_),t._toTuple(g),t._toTuple(v),t._toTuple(l),t._toTuple(h),t._toTuple(m)]).then(function(o){var l,m,_,h,g=o[0],v=o[1],y=o[2],D=o[3],x=o[4],O=o[5];if(t._isError(g)||t._isError(D)||t._isError(x)||t._isError(O)){if(t._isError(g)){var w=g.error;t._sharingInformation=(0,a.a)((0,a.a)({},t._sharingInformation),{error:(0,u.d)(w),errorCategory:d.a.item,debugErrorMessage:JSON.stringify(g),errorMessage:w.message||p.Md,rawError:w});var E="Canceled"===w.message&&w._handled,A=E?w.message:t._sharingInformation.error;return S.end({resultType:E?f.b.ExpectedFailure:f.b.Failure,resultCode:"Item Error: ".concat(A),extraData:{error:w}}),t._emitChange(),void n()}if(t._isError(x))return w=x.error,t._sharingInformation=(0,a.a)((0,a.a)({},t._sharingInformation),{error:(0,u.d)(w),errorCategory:d.a.me,debugErrorMessage:JSON.stringify(x),errorMessage:w.message||p.Md,rawError:x.error}),S.end({resultType:f.b.Failure,resultCode:"Me Error: ".concat(t._sharingInformation.error),extraData:{error:w}}),t._emitChange(),void n();if(t._isError(O))return w=O.error,t._sharingInformation=(0,a.a)((0,a.a)({},t._sharingInformation),{error:(0,u.d)(w),errorCategory:d.a.drive,debugErrorMessage:JSON.stringify(O),errorMessage:w.message||p.Md,rawError:w}),S.end({resultType:f.b.Failure,resultCode:"Drive Error: ".concat(t._sharingInformation.error),extraData:{error:w}}),t._emitChange(),void n();if(t._isError(D))return w=D.error,t._sharingInformation=(0,a.a)((0,a.a)({},t._sharingInformation),{error:(0,u.d)(w),errorCategory:d.a.drive,debugErrorMessage:JSON.stringify(D),errorMessage:w.message||p.Md,rawError:w}),S.end({resultType:f.b.Failure,resultCode:"Drive Error: ".concat(t._sharingInformation.error),extraData:{error:w}}),t._emitChange(),void n()}else{S.end({resultType:f.b.Success});var k=g.value,M=null==D?void 0:D.value;x.value,"string"!=typeof x.value&&x.value.id,t._currentUserId=M.id,!I.cb()&&t._updateUserIdTelemetryContext&&t._updateUserIdTelemetryContext(t._currentUserId),I.cb()&&(t._isConvergedItem=!(!(null==k?void 0:k.parentReference)||!k.parentReference.siteId)||(null===(l=k["@microsoft.graph.downloadUrl"])||void 0===l?void 0:l.indexOf(L.a))>-1),t._itemId=k.id,t._isPremium=I.G()?!(null===(_=null===(m=M.quota)||void 0===m?void 0:m.storagePlanInformation)||void 0===_?void 0:_.upgradeAvailable):M.quota&&M.quota.storagePlanInformation&&!M.quota.storagePlanInformation.upgradeAvailable,t._isPremium||!I.o()||t._isUserMinor||(t._isPremium=(null===(h=null==M?void 0:M.quota)||void 0===h?void 0:h.total)>=107374182400);var P,T=t._getOwnerPrincipal(k);if(I.j()||(t._isPremium=O.value),t._engagementHelper.setEngagementExtraData({isPremiumUser:t._isPremium}),P=e?t._sharingService.getPermissions(t._itemId):Promise.resolve([]),b&&!t._isError(v)&&!t._isError(y)&&v.value){var U=t._parseFamilyInfo(v.value.id,y.value.value),F=U.family,H=U.familyMembers;t._family=F,t._familyMembers=H}var R=s.a.anonymousEdit,N=r.a.anyone;t._audience===r.a.specificPeople?(R=s.a.direct,N=r.a.specificPeople):t._isEdit||(R=s.a.anonymousView),Promise.all([t._toTuple(P),t._toTuple(T)]).then(function(n){var r,o,s,l,f,m,_,h,b=n[0],g=n[1];if(t._isError(b)||t._isError(g)){if(t._isError(b)){var v=b.error;t._sharingInformation=(0,a.a)((0,a.a)({},t._sharingInformation),{error:(0,u.d)(v),errorCategory:d.a.permissions,debugErrorMessage:JSON.stringify(v),errorMessage:v.message||p.Md,rawError:b.error}),t._emitChange()}else if(t._isError(g)){var y=g.error;t._sharingInformation=(0,a.a)((0,a.a)({},t._sharingInformation),{error:(0,u.d)(y),errorCategory:d.a.permissions,debugErrorMessage:JSON.stringify(y),errorMessage:y.message||p.Md,rawError:g.error}),t._emitChange()}}else{var S=b.value,D=g.value,I=(null===(r=t._sharingContextInformation)||void 0===r?void 0:r.itemExtension)||(0,C.b)(k.name,!0);t._permissions=S;var x=t._parsePermissions(S),O=x.principals,w=x.sharingLinks,E=x.hasInheritedPermissions,A=x.hasBundlePermissions;O=[D].concat(O),t._sharingInformation={anonymousLinkExpirationRestrictionDays:-1,blockPeoplePickerAndSharing:!1,canAddExternalPrincipal:!0,canAddInternalPrincipal:!0,canManagePermissions:!0,canRequestAccessForGrantAccess:!0,defaultShareLinkToExistingAccess:!1,defaultShareLinkScope:void 0,defaultSharingLink:{allowsAnonymousAccess:!0,audience:N,expiration:null,isActive:!0,isEdit:t._isEdit,principals:[],shareId:null,sharingLinkKind:R,sharingScope:void 0,url:null,createdViaCopyLinkCommand:null,invitees:[],isReview:!1,updatePassword:!1,password:null,hasPassword:!1,blockDownload:!1,passwordLastModifiedBy:null},hasInheritedLinks:E,hasBundleLinks:A,isShared:!0,item:{name:t._itemName,hasDlpPolicy:!1,childCount:0,appmap:null===(o=t._sharingContextInformation)||void 0===o?void 0:o.itemAppmap,extension:I,itemType:(null===(s=t._sharingContextInformation)||void 0===s?void 0:s.itemType)?null===(l=t._sharingContextInformation)||void 0===l?void 0:l.itemType:t._getItemType(k),parentName:null===(f=k.parentReference)||void 0===f?void 0:f.name,parentPath:null===(m=k.parentReference)||void 0===m?void 0:m.path},fileExtension:I,sharingLinks:w,sharingPrincipals:O,peoplePickerSettings:{},userDisplayName:"",error:null,errorCategory:null,errorMessage:null,debugErrorMessage:null,requiresAccessApproval:!1,userRole:D&&(null==D?void 0:D.id)===t._currentUserId?c.a.owner:null,defaultShareLinkPermission:t._isEdit?i.a.edit:i.a.view,defaultLinkKind:null,sharingAbilities:(_={enabled:!0,disabledReason:null},h={canDeleteEditLink:_,canDeleteManageListLink:_,canDeleteReadLink:_,canDeleteReviewLink:_,canGetEditLink:_,canGetReadLink:_,canHaveExternalUsers:_,canManageEditLink:_,canManageReadLink:_,canManageManageListLink:_,canGetManageListLink:_,linkExpiration:{defaultExpirationInDays:-1,enabled:!0,disabledReason:null},canRequestGrantAccess:_,canAddInternalPrincipal:_,canAddExternalPrincipal:_,canAddNewExternalPrincipals:_,canAddNewExternalPrincipal:_,canGetReviewLink:void 0,canManageReviewLink:void 0,supportsRestrictedView:void 0,supportsReviewPermission:void 0,supportsEditPermission:_,supportsManageListPermission:void 0,supportsReadPermission:_,supportsRestrictedViewPermission:void 0},{anonymousLinkAbilities:h,anyoneLinkAbilities:h,organizationLinkAbilities:h,peopleSharingLinkAbilities:h,directSharingAbilities:h}),directLink:null,hasPermissionsInformation:t._sharingInformation&&t._sharingInformation.hasPermissionsInformation||e,isGraphAvailable:!0,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:t._itemId,peoplePickerError:void 0,webUrl:void 0},t._emitChange()}})}});if(I.cb()&&!t._isShareCustomerPromiseTelemetryInitialized){var x=new Promise(function(e,t){setTimeout(function(){e()},3e3)});Promise.race([D,x]).then(function(){if(t._initShareCustomerPromiseTelemetry){var e=t._isConvergedItem?"ConsumerOnSPO":"Consumer";t._initShareCustomerPromiseTelemetry(t._sharingContextInformation,{userId:t._currentUserId,accountType:e}),t._isShareCustomerPromiseTelemetryInitialized=!0}})}})},e.prototype.shareLink=function(e){var t=e.settings,n=e.recipients,a=e.emailMessage;n&&0!==n.length?this._shareViaInvite(t,n,a):(null==t?void 0:t.updatePassword)?this._createSharingLink(t):this._createSharingLink(t,{useOldPassword:!0})},e.prototype._getItemType=function(e){return this._multiShareIds&&this._multiShareIds.length>1?E.a.MultiShare:e.bundle&&e.bundle.album?E.a.Album:e.folder?E.a.Folder:void 0},e.prototype._parseFamilyInfo=function(e,t){var n=t.map(function(e){return{userId:e.id,name:e.firstName+" "+e.lastName,email:e.userPrincipalName,isResolved:!0,familySharingTargetType:S.a.FamilyMember}}),a=t[0].firstName;return t.forEach(function(e,t){0!==t&&(a+=", ".concat(e.firstName))}),{family:{userId:e,name:p.Dd,email:a,isExternal:!1,isResolved:!0,entityType:g.a.group,familySharingTargetType:S.a.Family,detailedGroupInfo:g.c.family},familyMembers:n}},e.prototype._getOwnerPrincipal=function(e){var t,n=this,i={id:"",isExternal:!1,loginName:"",primaryText:"",secondaryText:"",role:c.a.owner,type:l.a.user,imageUrl:"",email:""};if(e.shared&&e.shared.owner&&e.shared.owner.user)return i.id=e.shared.owner.user.id,i.primaryText=e.shared.owner.user.displayName,new Promise(function(e,t){return e(i)});if(e.parentReference&&e.createdBy&&e.createdBy.user&&e.parentReference.driveId===e.createdBy.user.id)return i.id=e.createdBy.user.id,i.primaryText=e.createdBy.user.displayName,new Promise(function(e,t){return e(i)});if(e.parentReference){var r=new f.a({name:"SharingStore_GetDriveOwner",extraData:{clientId:o.a[this._clientId],driveIdLength:null===(t=e.parentReference.driveId)||void 0===t?void 0:t.length}});return this._sharingService.getDriveOwner(e.parentReference.driveId).then(function(e){var t;if(null===(t=null==e?void 0:e.owner)||void 0===t?void 0:t.user){var n=e.owner.user;i.id=n.id,i.primaryText=n.displayName}return r.end({resultType:f.b.Success}),new Promise(function(e,t){return e(i)})},function(e){return n._sharingInformation=(0,a.a)((0,a.a)({},n._sharingInformation),{error:(0,u.d)(e),errorCategory:d.a.drive,debugErrorMessage:JSON.stringify(e),errorMessage:e.message||p.Md,rawError:e}),r.end({resultType:f.b.Failure,resultCode:"Drives Error: ".concat(n._sharingInformation.error),extraData:{error:e}}),n._emitChange(),new Promise(function(e,t){return e(i)})})}return new Promise(function(e,t){return e(i)})},e.prototype._parsePermissions=function(e){for(var t,n=[],a=[],i=!1,o=!1,d=[],u=!1,f=function(e){if(e.inheritedFrom&&(void 0!==e.inheritedFrom.path?i=!0:o=!0),!I.W()&&e.roles&&e.roles.indexOf("owner")>=0)return"continue";if(e.grantedTo&&(e.grantedTo.user&&e.grantedTo.user.id&&"requestAccess"!==(null===(t=e.link)||void 0===t?void 0:t.type)||e.grantedTo.group&&e.grantedTo.group.id)){var f=void 0;if(e.grantedTo.user)if(-1===d.indexOf(e.grantedTo.user.id)){var p=e.invitation&&e.invitation.email||e.grantedTo.user.email,_=new Map,h={id:e.id,rawPermission:e,role:"write"===e.roles[0]?c.a.edit:c.a.view,isSPO:u};_.set(e.id,h),f={id:e.grantedTo.user.id,isExternal:!1,loginName:p,primaryText:e.grantedTo.user.displayName||p,secondaryText:e.grantedTo.user.displayName?p:"",role:"write"===e.roles[0]?c.a.edit:c.a.view,type:l.a.user,imageUrl:"",email:p,accessMap:_}}else{var b=a.filter(function(t){return t.id===e.grantedTo.user.id})[0];p=e.invitation&&e.invitation.email||e.grantedTo.user.email,b.secondaryText=b.secondaryText||(e.grantedTo.user.displayName?p:""),b.email=b.email||p,h={id:e.id,rawPermission:e,role:"write"===e.roles[0]?c.a.edit:c.a.view,isSPO:u},b.accessMap.set(e.id,h)}else e.grantedTo.group&&-1===d.indexOf(e.grantedTo.group.id)&&(p=e.invitation&&e.invitation.email||e.grantedTo.group.displayName,_=new Map,h={id:e.id,rawPermission:e,role:"write"===e.roles[0]?c.a.edit:c.a.view,isSPO:u},_.set(e.id,h),f={id:e.grantedTo.group.id,isExternal:!1,loginName:p,primaryText:e.grantedTo.group.displayName||p,secondaryText:"",role:"write"===e.roles[0]?c.a.edit:c.a.view,type:l.a.all,imageUrl:"",email:p,accessMap:_});f&&(a.push(f),d.push(f.id))}else if(e.grantedToIdentities){for(var g=[],v=function(t){var n=void 0;if(-1===d.indexOf(t.user.id)){var i=new Map,r={id:e.id,rawPermission:e,role:"write"===e.roles[0]?c.a.edit:c.a.view,isSPO:u};i.set(e.id,r),n={id:t.user.id,isExternal:!1,loginName:void 0,primaryText:t.user.displayName||m.Eb,secondaryText:"",role:"write"===e.roles[0]?c.a.edit:c.a.view,type:l.a.user,imageUrl:"",email:void 0,accessMap:i},a.push(n),d.push(n.id)}else n=a.filter(function(e){return e.id===t.user.id})[0],r={id:e.id,rawPermission:e,role:"write"===e.roles[0]?c.a.edit:c.a.view,isSPO:u},n.accessMap.set(e.id,r);g.push(n)},y=0,S=e.grantedToIdentities;y<S.length;y++)v(S[y]);var D={allowsAnonymousAccess:!0,audience:r.a.anyone,expiration:e.expirationDateTime||null,isActive:!0,isEdit:"edit"===e.link.type,principals:g,shareId:e.shareId,sharingLinkKind:"edit"===e.link.type?s.a.anonymousEdit:s.a.anonymousView,sharingScope:void 0,url:e.link.webUrl,createdViaCopyLinkCommand:!e.grantedTo,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:!1,application:e.link.application,inheritedLinkInfo:e.inheritedFrom,origPermission:e,isPartialRedeem:!0};n.push(D)}else if(e.link){var x=s.a.uninitialized,C="edit"===e.link.type,O=[];switch(g=[],e.link.type){case"edit":x=s.a.anonymousEdit;break;case"requestAccess":x=s.a.requestAccess,C="write"===e.roles[0],O=[{id:e.grantedTo.user.id,isExternal:!0,loginName:void 0,primaryText:e.grantedTo.user.id,secondaryText:void 0,type:l.a.user,imageUrl:""}];break;default:x=s.a.anonymousView}D={allowsAnonymousAccess:!0,audience:r.a.anyone,expiration:e.expirationDateTime||null,isActive:!0,isEdit:C,principals:g,shareId:e.shareId,sharingLinkKind:x,sharingScope:void 0,url:e.link.webUrl,createdViaCopyLinkCommand:!e.grantedTo,invitees:O,updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:!1,application:e.link.application,inheritedLinkInfo:e.inheritedFrom,origPermission:e,isPartialRedeem:!1},n.push(D)}},p=0,_=e;p<_.length;p++)f(_[p]);return{principals:a,sharingLinks:n,hasInheritedPermissions:i,hasBundlePermissions:o}},e.prototype._shareViaInvite=function(e,t,n){var i,o=this,c=t.map(function(e){var t={};return v.a.isValidEmailSyntax(e.email,!1)?t.email=e.email:t.objectId=e.userId,e.entityType&&e.entityType===g.a.group&&(t.permissionIdentityTypeInput="Group"),t}),l=e.isEdit?"write":"read",f=e.password,m=e.expiration;if(this._itemId||this.isBundleShare()){var _={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],recipients:c,message:n,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:f,expiration:m,bundleName:this._bundleName};(0,w.a)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(_)),i=this._sharingService.invite(_)}else _={itemUrl:this._itemUrl,recipients:c,message:n,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:f,expiration:m},(0,w.a)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(_)),i=this._sharingService.inviteFromItemUrl(_);i.then(function(t){var n,a,i=t[0];if(i.link.type&&(n="edit"===i.link.type?s.a.anonymousEdit:s.a.anonymousView,a="edit"===i.link.type),i.roles&&1===i.roles.length){var c=i.roles[0];n="write"===c?s.a.anonymousEdit:s.a.anonymousView,a="write"===c}o._shareLink={allowsAnonymousAccess:!0,audience:e.requireSignIn?r.a.specificPeople:r.a.anyone,expiration:i.expirationDateTime,isActive:!0,isEdit:a,principals:[],shareId:"",sharingLinkKind:n,sharingScope:void 0,url:i.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:i.hasPassword,blockDownload:i.preventDownload,passwordLastModifiedBy:null},(0,w.a)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(o._shareLink)),o._grantAccessResult=!0,o._emitChange({type:x.b.ShareLink})},function(e){var t,n,i=(0,u.d)(e);if(I.F())return(0,A.f)(i)&&(o._sharingInformation.peoplePickerError=e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message)),o._sharingInformation=(0,a.a)((0,a.a)({},o._sharingInformation),{error:i,rawError:e,errorCategory:d.a.invite,errorMessage:e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message)||p.Md}),(null===(n=null===(t=null==e?void 0:e.response)||void 0===t?void 0:t.error)||void 0===n?void 0:n.fixItUrl)&&(o._sharingInformation.fixItUrl=e.response.error.fixItUrl),o._grantAccessResult=!1,void o._emitChange();["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"].indexOf(i)>-1?o._sharingInformation.peoplePickerError=e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message):(o._sharingInformation=(0,a.a)((0,a.a)({},o._sharingInformation),{error:i,rawError:e,errorCategory:d.a.invite,errorMessage:e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message)||p.Md}),e.response&&e.response.error&&e.response.error.fixItUrl&&(o._sharingInformation.fixItUrl=e.response.error.fixItUrl)),o._grantAccessResult=!1,o._emitChange()})},e.prototype._createSharingLink=function(e,t){var n,i=this,o=e.isEdit?"edit":"view",c="anonymous",l=e.preventDownload,f=t&&t.useOldPassword?null:e.password,m=e.expiration;if(this._itemId||this.isBundleShare()){var _={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],type:o,scope:c,preventDownload:l,password:f,expiration:m,bundleName:this._bundleName};(0,w.a)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(_)),n=this._sharingService.createLink(_)}else _={itemUrl:this._itemUrl,type:o,scope:c,preventDownload:l,password:f,expiration:m},(0,w.a)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(_)),n=this._sharingService.createLinkFromItemUrl(_);n.then(function(e){var t="edit"===e.link.type?s.a.anonymousEdit:s.a.anonymousView;i._shareLink={allowsAnonymousAccess:!0,audience:r.a.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:"edit"===e.link.type,principals:[],shareId:"",sharingLinkKind:t,sharingScope:void 0,url:e.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:e.preventDownload,passwordLastModifiedBy:null},(0,w.a)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(i._shareLink)),i._grantAccessResult=!0,i._emitChange({type:x.b.ShareLink})},function(e){i._sharingInformation=(0,a.a)((0,a.a)({},i._sharingInformation),{error:(0,u.d)(e),errorCategory:d.a.createLink,errorMessage:e.message||p.Md,rawError:e}),i._grantAccessResult=!1,i._emitChange()})},e.prototype.getCurrentUserId=function(){return this._currentUserId},e.prototype.unshareLink=function(e,t,n){var a,i=this;if(n)a=n;else for(var r=0,o=this._permissions;r<o.length;r++){var s=o[r];s.shareId===t&&(a=s)}var c=a.inheritedFrom?a.inheritedFrom.id:this._itemId;(c?this._sharingService.unshareLink(c,a.id):this._sharingService.unshareLinkFromItemUrl(this._itemUrl,a.id)).then(function(){i.fetchSharingInformation(!0)})},e.prototype.getSharingLinkCreated=function(){return this._shareLink},e.prototype.updatePermissions=function(e,t){for(var n=this,a=[],i=0,r=this._permissions;i<r.length;i++){var o=r[i];o.grantedTo&&o.grantedTo.user&&o.grantedTo.user.id===e.id&&a.push(o)}for(var d=0,l=a;d<l.length;d++){var u=l[d],f=u.inheritedFrom?u.inheritedFrom.id:this._itemId;switch(t){case c.a.none:this.unshareLink(s.a.anonymousEdit,u.shareId,u);break;case c.a.edit:(f?this._sharingService.updatePermissions(f,u.id,"write"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,u.id,"write")).then(function(e){n.fetchSharingInformation(!0)});break;default:(f?this._sharingService.updatePermissions(f,u.id,"read"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,u.id,"read")).then(function(e){n.fetchSharingInformation(!0)})}}},e.prototype.checkUserAccess=function(){return Promise.resolve()},e.prototype.updatePermissionById=function(e,t){var n=this._permissions.filter(function(t){return t.id===e})[0];if(!n)return o={error:i="No permission found for given id",name:"invalidItem",errorCode:d.b.invalidItem,errorCategory:d.a.permissions,debugErrorMessage:i,errorMessage:i},console.log(JSON.stringify(o)),Promise.reject(o);var a=n.inheritedFrom?n.inheritedFrom.id:this._itemId;try{switch(t){case c.a.none:this.unshareLink(s.a.anonymousEdit,n.shareId,n);break;case c.a.edit:return this._sharingService.updatePermissions(a,n.id,"write");default:return this._sharingService.updatePermissions(a,n.id,"read")}}catch(e){var i="Error updating permission",r=(0,u.d)(e)||"genericPermissionUpdateFailure",o={error:e.message||i,name:r,errorCode:r,errorCategory:d.a.permissions,debugErrorMessage:JSON.stringify(e),errorMessage:e.message||i,rawError:JSON.stringify(e)};return console.log(JSON.stringify(o)),Promise.reject(o)}},e.prototype.getDefaultRecipients=function(){return this._defaultRecipients},e.prototype.consumeDefaultRecipients=function(){this._defaultRecipients={isConsumed:!0,recipients:this._defaultRecipients.recipients}},e.prototype.grantAccess=function(e,t){void 0===t&&(t=!0);var n=!(0,I.v)();this.shareLink({recipients:e,settings:{allowEditing:!0,isEdit:t,audience:r.a.anyone,specificPeople:null,expiration:null,password:null,sharingLinkKind:s.a.direct,updatePassword:!1,sendInvitation:n,requireSignIn:n}})},e.prototype.getGrantAccessResult=function(){return this._grantAccessResult},e.prototype.isPeopleSharingLinksEnabled=function(){return!1},e.prototype.showManageAccess=function(){return!1},e.prototype.isPasswordModificationAllowed=function(){return!0},e.prototype.isExpirationDateModificationAllowed=function(){return!0},e.prototype.isPremiumExperienceAllowed=function(){return this._isPremium},e.prototype.disablePremiumUpsell=function(){return this._isUserMinor},e.prototype.isPreventDownloadAllowed=function(){return!1},e.prototype.setAddressBarLinkCapability=function(e){},e.prototype.isReportProblemSupported=function(){return!1},e.prototype.isBundleShare=function(){return this._isBundleShare},e.prototype.getNavId=function(){return this._navId},e.prototype.getContextualSharingInformation=function(){return this._sharingContextInformation&&this._sharingContextInformation.contextualSharingInformation},e.prototype.getSupportedAudienceOptions=function(){return[r.a.anyone,r.a.specificPeople]},e.prototype.isSpecificPeopleExpirationAllowed=function(){return!0},e.prototype.showAudienceLearnMore=function(){return!1},e.prototype.resetPeoplePickerError=function(){this._sharingInformation.peoplePickerError&&(this._sharingInformation.peoplePickerError=void 0,this._emitChange())},e.prototype._tryResolveDefaultRecipients=function(e,t){var n=this;if(e&&0!==e.length)if(this._defaultRecipients=void 0,this._isValidatingDefaultRecipients=!0,t)try{for(var a=[],i=[],r=0,o=e;r<o.length;r++){var s=o[r];i.push(t.resolve(s,{}).then(function(e){a.push(e)}))}Promise.all(i).then(function(){n._setDefaultRecipients(a)},function(){n._setUnresolvedDefaultRecipients(e)})}catch(t){this._setUnresolvedDefaultRecipients(e)}else this._setUnresolvedDefaultRecipients(e);else this._isValidatingDefaultRecipients=!1},e.prototype._setDefaultRecipients=function(e){e.map(function(e){e.name=e.name||e.email}),this._defaultRecipients={isConsumed:!1,recipients:e},this._isValidatingDefaultRecipients=!1,this._emitChange()},e.prototype._setUnresolvedDefaultRecipients=function(e){this._setDefaultRecipients(e.map(function(e){return{userId:e,name:e,email:e,isResolved:v.a.isValidEmailSyntax(e,!1)}}))},e.prototype.showEmailsInSuggestions=function(){return!0},e.prototype.getFamily=function(){return this._family},e.prototype.getFamilyMembers=function(){return this._familyMembers},e.prototype.getItemInformationForLogging=function(){var e,t=this.getSharingInformation();return{itemType:(0,O.b)(t.item),extension:(null===(e=t.item)||void 0===e?void 0:e.extension)||"none"}},e.prototype.getSharingClickTime=function(){return NaN},e.prototype.getWebView2Times=function(){return{}},e.prototype.getLinksCount=function(){return this.getSharingInformation().sharingLinks.length},e.prototype.parsePrincipals=function(){for(var e=[],t=[],n=0,a=this.getSharingInformation().sharingPrincipals;n<a.length;n++){var i=a[n];i.type===l.a.user?e.push(i):i.type===l.a.all&&t.push(i)}return this._engagementHelper.manageAccessNumberOfSharingPrincipals({numberOfUsers:e.length}),{users:e,groups:t}},e.prototype.getPermissionsViewSettings=function(){return{groupPivotHeader:m.I,manageGroupLink:"https://go.microsoft.com/fwlink/?linkid=2198883",manageUnknownUserLink:"https://go.microsoft.com/fwlink/?linkid=2207620",itemStopSharingSupported:!1,supportedGroupTypes:[l.a.all]}},e.prototype.getUserIdFromItemId=function(e,t){if(t&&t.length>0&&t[0],e){var n=e.split("!");if(n.length>0)return n[0]}},e.prototype._toTuple=function(e){return(0,a.b)(this,void 0,void 0,function(){var t;return(0,a.e)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e}();t.a=M}
,function(e,t,n){function a(e,t){void 0===t&&(t=!1);var n="";if(e){var a=e.lastIndexOf(".");a>=0&&(n=t?e.substr(a+1):e.substr(a))}return n}function i(e,t){return void 0===t&&(t=!0),e=encodeURI(e),t&&e&&(e=e.replace(/#/g,"%23")),e}n.d(t,{a:function(){return i},b:function(){return a}})}
,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e[e.Click=1]="Click",e[e.Tap=2]="Tap",e[e.Keyboard=3]="Keyboard",e[e.Drop=4]="Drop"}(a||(a={}))}
,,,function(e,t,n){var a;n.d(t,{a:function(){return o}}),function(e){e[e.none=0]="none",e[e.encodeUrl=1]="encodeUrl",e[e.encodeCommand=2]="encodeCommand"}(a||(a={}));var i=function(){function e(){}return e.createProtocolHandlerUrl=function(e,t,n,i,r,o,s){var c=[],d=e.split("|");if(2===d.length)return c.push(d[0]),c.push(":"),c.push(t),c.join("");3===d.length&&(e=d[0]),c.push(e),c.push(":"),c.push(n),o&&"ms-excel"===e&&n!==this.protocolCommand.New&&c.push(r===a.encodeCommand?"%7Cofc":"|ofc"),s&&function(e,t,n){var i=t.clickOriginAppGuid,r=t.clickCorrelationID,o=t.clickTime;i&&(e.push(n===a.encodeCommand?"%7Cor%7C":"|or|"),e.push(i)),r&&(e.push(n===a.encodeCommand?"%7Ccid%7C":"|cid|"),e.push(r)),o&&(e.push(n===a.encodeCommand?"%7Cct%7C":"|ct|"),e.push(o.toString()))}(c,s,r),c.push(r===a.encodeCommand?"%7Cu%7C":"|u|"),c.push(t),n===this.protocolCommand.New&&(c.push(r===a.encodeCommand?"%7Cs%7C":"|s|"),i&&c.push(i));var l=c.join("");return r===a.encodeUrl?encodeURI(l):l},e.protocolCommand={View:"ofv",Edit:"ofe",New:"nft"},e}(),r=[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"];function o(e,t,n,o,s,c,d){o=!function(e){return e&&"."!==e[0]&&(e="."+e),-1!==r.indexOf(e&&e.toLowerCase())}(n)&&o;var l=s?i.protocolCommand.New:o?i.protocolCommand.Edit:i.protocolCommand.View,u=a.none;return i.createProtocolHandlerUrl(e,t,l,c,u,!0,d)}}
,function(e,t,n){var a;!function(e){e[e.download=0]="download",e[e.open=1]="open",e[e.textContent=2]="textContent",e[e.viewInBrowser=3]="viewInBrowser",e[e.bingClickInstrumentation=4]="bingClickInstrumentation",e[e.original=5]="original",e[e.shortcutTarget=6]="shortcutTarget",e[e.video=7]="video",e[e.downloadAsZip=8]="downloadAsZip",e[e.itemUrl=9]="itemUrl",e[e.mediaBaseUrl=10]="mediaBaseUrl",e[e.immersiveReaderUrl=11]="immersiveReaderUrl",e[e.thumbnailSpriteBaseUrl=12]="thumbnailSpriteBaseUrl"}(a||(a={})),t.a=a}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}}
,,function(e,t,n){function a(e){return new Date(e/1e4-621355968e5)}n.d(t,{a:function(){return a}})}
,function(e,t,n){n.d(t,{a:function(){return d},b:function(){return f},c:function(){return l},d:function(){return u}});var a,i=n(659),r=n(81);!function(e){e[e.Invalid=0]="Invalid",e[e.File=1]="File",e[e.FileVersion=2]="FileVersion",e[e.ListItem=3]="ListItem",e[e.List=4]="List",e[e.Folder=5]="Folder",e[e.FolderWithLists=6]="FolderWithLists",e[e.Attachment=7]="Attachment",e[e.ListItemVersion=8]="ListItemVersion",e[e.CascadeParent=9]="CascadeParent",e[e.Web=10]="Web",e[e.App=11]="App"}(a||(a={}));var o,s=n(658),c="genericfile",d=c;function l(e){var t="";return e.type===r.a.Folder?(t=s.b(e.sharingType)?"folder":"sharedfolder",e.isDocSet?t="docset":e.isMountPoint&&(t="linkedfolder")):t=e.type===r.a.OneNote?"one":e.recycleBinProperties&&e.recycleBinProperties.itemType===a.List?"splist":e.listItem?"listitem":"text/typescript"===e.textEditorMimeType?"code":e.panorama?"photo360":f(e.extension),t}function u(e){var t;try{if(e){var n=f(e);if(i.a[n]){var a=i.a[n].type;void 0===a&&(a=r.a.File),t=a}}}catch(e){}return void 0===t&&(t=r.a.Unknown),t}function f(e){if(!o)for(var t in o={},i.a){var n=i.a[t].extensions;if(n)for(var a=0;a<n.length;a++)o[n[a]]=t}return e=e.replace(".","").toLowerCase(),o[e]||c}}
,function(e,t){var n;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(n||(n={})),t.a=n}
,,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return s}});var a=["glb","gltf"],i=["cool","fbx","obj","ply","stl","3mf"];function r(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return r(i,e)}function s(e){return r(a,e)}}
,,,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i}});var a=n(0);function i(e,t){var n=t instanceof Array?r(t,function(){return!0}):t,i=void 0;for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(o in n||(i||(i=(0,a.a)({},e)),delete i[o]));return i||e}function r(e,t,n){for(var a={},i=0,r=e;i<r.length;i++){var o=r[i];a[n?n(o):o]=t(o)}return a}}
,,function(e,t,n){n.d(t,{a:function(){return a}});var a={Network:1,Embed:3,App:4,View:5,Edit:6,Form:7,Direct:8,Organization:9,AppAccess:10,RequestAccess:11,None:100}}
,function(e,t,n){n.d(t,{a:function(){return a}});var a={None:0,Network:1,Mail:2,Embed:3,App:4,GenericView:5,GenericEdit:6,FormSubmission:7,Public:8,PrivateLink:9,AppAccess:10,RequestAccessLink:11}}
,,,,function(e,t,n){var a;n.d(t,{a:function(){return a}}),function(e){e.ScriptLoaded="share_scriptsLoaded",e.UIReady="share_uiReady",e.Ready="share_ready",e.Error="share_error",e.Resize="share_resize",e.GrantAccessCompleted="share_grantAccessCompleted",e.Dismiss="share_dismiss",e.ReadyForRecipients="share_readyForRecipients",e.OutlookClicked="share_outlookClicked",e.SendRecipients="atMention_defaultRecipients",e.ManageAccessClicked="share_manageAccessClicked",e.ShareCompleted="share_completed",e.MakeVisible="share_makeVisible",e.Destruct="share_destruct",e.ResetMakeVisible="share_resetMakeVisible",e.InstantLoadReady="share_instantLoadReady",e.ShareContextInformation="share_postContextInformation",e.Started="share_started",e.LinkSettingCompleted="share_linkSettingsCompleted",e.GetToken="share_getToken",e.DocumentInformation="share_documentInformation",e.SharingInfoBarInformation="share_sharingInfoBarInformation",e.SharingStoreReady="share_sharingStoreReady"}(a||(a={}))}
,function(e,t,n){n.d(t,{a:function(){return o}});var a=n(0),i=n(198),r=n(391);function o(e){var t=e.pageContext,n=e.customerContext,o=(0,a.f)(e,["pageContext","customerContext"]),s=(0,r.a)(t,n||{});return new i.a((0,a.a)((0,a.a)({},o),{context:{context:s}}))}}
,function(e,t,n){n.d(t,{a:function(){return i}});var a=n(69);function i(e){switch(e){case a.a.odb:case a.a.wac:case a.a.odc:case a.a.odcWac:return"Files";case a.a.sharePoint:return"SPO DocLib";case a.a.sharePointPages:return"SPO Sites";case a.a.ngsc:return"Sync";case a.a.listPart:case a.a.listsHome:case a.a.listsIos:return"Lists";case a.a.npe:return"Photos"}return"None"}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var n="__ResourceComponentLoader$componentName",a="__ResourceComponentLoader$componentId",i="__ResourceComponentLoader$childComponents",r="__ResourceComponentLoader$parentComponentViewModel",o="__ResourceComponentLoader$componentBindingElement",s=0,c=function(){function e(e){var t=this._viewModel=e.viewModel,c=t[a]="".concat(++s);t[o]=e.element,t[i]={},t[n]=e.name;for(var d=e.bindingContext;d&&(!d.$data||d.$data===t||!d.$data[i]);)d=d.$parentContext;if(d){var l=this._parentViewModel=d.$data;l[i][c]=t,t[r]=l}}return e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,s=e[a],c=t&&t[i];s&&c&&delete c[s],e&&(delete e[r],delete e[i],delete e[o],delete e[n])},e}();t.a=c}
,,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return l}});var a=n(507),i=n(45),r="expOverrides",o="FeatureOverrides_experiments";function s(e){return"number"==typeof e}function c(e){return Array.isArray(e)&&2===e.length&&s(e[0])&&s(e[1])}function d(e){try{var t=e&&JSON.parse(e);if(Array.isArray(t))return t.filter(c)}catch(e){}return[]}var l=function(){function e(){}return Object.defineProperty(e,"experimentOverrides",{get:function(){return e._experimentOverridesData||(e._experimentOverridesData=function(){try{for(var e=new Map,t=d((0,a.b)(o)),n=0,s=t;n<s.length;n++){var c=s[n];e.set(c[0],c[1])}for(var l=window&&window.location&&window.location.search?d((0,i.a)(window.location.search.substr(1))[r]):[],u=0,f=l;u<f.length;u++)c=f[u],e.set(c[0],c[1]);var p=Array.from(e);return(0,a.c)(o,JSON.stringify(p)),p}catch(e){return[]}}()),e._experimentOverridesData},enumerable:!1,configurable:!0}),e.clear=function(){e._experimentOverridesData=void 0,(0,a.a)(o)},e._experimentOverridesData=void 0,e}()}
,function(e,t,n){n.d(t,{a:function(){return o},b:function(){return i},c:function(){return r}});var a=n(1),i=(a.lazy(function(){return Promise.resolve().then(n.bind(n,306))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,308))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,303))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,207))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,305))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,108))})),r=(a.lazy(function(){return Promise.resolve().then(n.bind(n,203))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,302))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,299))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,304))}),a.lazy(function(){return Promise.resolve().then(n.bind(n,307))}),a.lazy(function(){return n.e(26).then(n.bind(n,613))}),a.lazy(function(){return n.e(27).then(n.bind(n,614))})),o=(a.lazy(function(){return n.e(24).then(n.bind(n,615))}),a.lazy(function(){return n.e(25).then(n.bind(n,616))}),a.lazy(function(){return Promise.all([n.e("ondemand.resx"),n.e(22)]).then(n.bind(n,617))}));a.lazy(function(){return Promise.all([n.e("ondemand.resx"),n.e(23)]).then(n.bind(n,618))})}
,function(e,t,n){(0,n(4).b)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLink-container{padding-bottom:16px}.od-ShareLink-container.compact{padding-bottom:2px}.od-ShareLink{padding:26px 0 12px}.od-ShareLink.flightOff{padding:0}.od-ShareLink.compact{padding:2px 0 0;padding-left:10px}.od-ShareLink.updatedSpacing{padding:16px 0 0}.od-ShareLink .od-ShareLink-main{display:flex;flex-wrap:wrap;align-items:center;position:relative}.od-ShareLink .od-ShareLink-main .ms-Button--default{outline:transparent;position:relative;border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';min-width:3.375rem;height:2rem;margin:0;padding:0}.od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareLink-howCanUserModifyTooltip{padding-left:4px;display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ShareLink-header{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";font-size:.875rem;padding:12px 24px}.od-ShareLink-header .od-ShareLink-header-itemname{font-weight:600}.od-ShareLink-header .od-ShareLink-header-iconWraper{padding:0 4px 0 2px;display:inline}.od-ShareLink-unhealthyHeader{padding:8px;background-color:"},{theme:"errorBackground",defaultValue:"rgba(232,17,35,.2)"},{rawString:";font-size:.75rem;margin-top:12px}.od-ShareLink-unhealthyHeader i{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:1rem;align-self:center;padding-right:8px}.od-ShareLink-unhealthyHeader .od-ShareLink-content{display:flex}.od-ShareLink-icon{position:relative;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.5625rem;border-radius:50%;width:3.125rem;min-width:3.125rem;height:3.125rem}[dir=ltr] .od-ShareLink-icon{margin-right:10px}[dir=rtl] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon i{left:50%}[dir=rtl] .od-ShareLink-icon i{right:50%}[dir=ltr] .od-ShareLink-icon i{transform:translate(-50%,-50%)}[dir=rtl] .od-ShareLink-icon i{transform:translate(50%,-50%)}.od-ShareLink-icon2{position:relative;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.125rem;border-style:solid;border-width:.0625rem;border-radius:50%;box-sizing:border-box;width:2rem;min-width:2rem;height:2rem}[dir=ltr] .od-ShareLink-icon2{margin-right:10px}[dir=rtl] .od-ShareLink-icon2{margin-left:10px}@supports (font:-apple-system-headline){.od-ShareLink-icon2{font:-apple-system-headline}}.od-ShareLink-icon2 i{font-size:1.125rem;position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon2 i{left:50%}[dir=rtl] .od-ShareLink-icon2 i{right:50%}[dir=ltr] .od-ShareLink-icon2 i{transform:translate(-50%,-50%)}[dir=rtl] .od-ShareLink-icon2 i{transform:translate(50%,-50%)}@supports (font:-apple-system-headline){.od-ShareLink-icon2 i{font:-apple-system-headline}}.od-ShareLink-icon2.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLink-icon2.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLink-icon2.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLink-icon2.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLink-icon2.icon-FileRequest{color:#333;background:#fff;border:#fff;font-size:20px}.od-ShareLink-icon2.icon-AddFriend{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLink-icon2.icon-ReminderPerson{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLink-icon2.icon-Favicon{color:#0078d4;background:#fff;border:1px solid #0078d4}.od-ShareLink-copyLinkButton{border-left:0;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:4px;border-bottom-right-radius:4px}@supports (font:-apple-system-body){.od-ShareLink-copyLinkButton{height:auto;padding:8px}}@supports (font:-apple-system-body){.od-ShareLink-copyLinkButton .ms-Button-label{font:-apple-system-body}}.od-ShareLink-copyLinkButton.disabled{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-ShareLink-copyLinkButton.disabled .ms-Button-label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-ShareLink-details{flex:1}.od-ShareLink-details .ms-TextField-field{font-size:.875rem;min-width:100px;border-radius:4px}@supports (font:-apple-system-body){.od-ShareLink-details .ms-TextField-field{font:-apple-system-body}}.od-ShareLink-details .ms-TextField-fieldGroup{height:2rem;border-bottom-left-radius:4px;border-top-left-radius:4px;border-top-right-radius:0;border-bottom-right-radius:0}@supports (font:-apple-system-body){.od-ShareLink-details .ms-TextField-fieldGroup{height:-moz-fit-content;height:fit-content;padding:8px}}.od-ShareLink-details.disabled .ms-TextField-fieldGroup{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-ShareLink-url{font-size:.875rem}@supports (font:-apple-system-body){.od-ShareLink-url{font:-apple-system-body}}.od-ShareLink-additionalButtons{max-width:64px;flex-grow:1}.od-ShareLink-actionButton{outline:transparent;position:relative;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';font-size:1rem;width:2rem;height:2rem}.od-ShareLink-actionButton::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-actionButton:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@supports (font:-apple-system-headline){.od-ShareLink-actionButton{font:-apple-system-headline}}.od-ShareLink-actionButton .ms-Button-icon{font-size:1rem}@supports (font:-apple-system-headline){.od-ShareLink-actionButton .ms-Button-icon{font:-apple-system-headline}}.od-ShareLink-actionButton.cancel{position:absolute;top:0}[dir=ltr] .od-ShareLink-actionButton.cancel{right:10px}[dir=rtl] .od-ShareLink-actionButton.cancel{left:10px}[dir=ltr] .od-ShareLink-actionButton.back{left:0}[dir=rtl] .od-ShareLink-actionButton.back{right:0}[dir=rtl] .od-ShareLink-actionButton.back{transform:scale(-1,1)}.od-SharingLink-requestAccessInfo{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:'}.od-ShareLink-description{padding-top:.5rem;font-size:.75rem}[dir=ltr] .od-ShareLink-description{padding-left:42px}[dir=rtl] .od-ShareLink-description{padding-right:42px}@supports (font:-apple-system-body){.od-ShareLink-description{font:-apple-system-body}}.od-ShareLink-description.flightOff{padding-top:0}[dir=ltr] .od-ShareLink-description.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink-description.flightOff{padding-right:60px}.od-ShareLink-description.compact{padding-top:0}.od-PermissionsList .od-ShareLink-description{cursor:pointer}.od-ShareLink-description .od-ShareLink-description-label{display:inline-block;font-size:.6875rem}[dir=ltr] .od-ShareLink-description .od-ShareLink-description-label{margin-right:4px}[dir=rtl] .od-ShareLink-description .od-ShareLink-description-label{margin-left:4px}@supports (font:-apple-system-caption1){.od-ShareLink-description .od-ShareLink-description-label{font:-apple-system-caption1}}.od-ShareLink--inviteesHolder{display:flex;flex-wrap:wrap;align-items:center;outline:transparent;position:relative}[dir=ltr] .od-ShareLink--inviteesHolder{padding-left:42px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-right:42px}[dir=ltr] .od-ShareLink--inviteesHolder{padding-right:38px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-left:38px}.od-ShareLink--inviteesHolder::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink--inviteesHolder:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}[dir=ltr] .od-ShareLink--inviteesHolder.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink--inviteesHolder.flightOff{padding-right:60px}[dir=ltr] .od-ShareLink--inviteesHolder.accessSummary{padding-left:52px}[dir=rtl] .od-ShareLink--inviteesHolder.accessSummary{padding-right:52px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header{display:flex;align-items:center;width:100%}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-right:8px}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-left:8px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Persona-details{display:none}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font-size:.75rem;font-weight:600}@supports (font:-apple-system-caption1){.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font:-apple-system-caption1}}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:'}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-left:auto}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-right:auto}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font-size:.75rem}@supports (font:-apple-system-caption1){.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font:-apple-system-caption1}}.od-ShareLink--inviteesHolder .od-ShareLink-participants{width:100%}ul.od-ShareLink-participants{cursor:default;list-style:none;padding:0}.od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{content:"";background-color:'},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";display:block;height:.4375rem}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-62px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-62px}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-58px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-58px}.od-ShareLink--inviteesHolder.no-separator ul.od-ShareLink-participants::after{height:0}ul.od-ShareLink-participants.manageAccessV3{padding-top:12px}.od-ShareLink-personaItem{padding:10px 8px;display:flex;align-items:center}.od-ShareLink-personaItem .ms-Persona{width:100%}.od-ShareLink-personaItem .ms-Persona .ms-Persona-optionalText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-tertiaryText{overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText{font-size:.875rem;font:-apple-system-body}.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{font-size:.625rem;color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:';font:-apple-system-caption1;height:1rem;line-height:1rem}.od-ShareLink-personaItem .ms-Button-icon{outline:transparent;position:relative;font-size:.75rem}.od-ShareLink-personaItem .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}@supports (font:-apple-system-caption1){.od-ShareLink-personaItem .ms-Button-icon{font:-apple-system-caption1}}.od-ShareLink-personaItem .ms-Persona-image{height:2rem;width:2rem}.od-ShareLink-details-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-ShareLink-linkMember{outline:transparent;position:relative}.od-ShareLink-linkMember::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-linkMember:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareLink-requestAccessTooltip-text{padding-bottom:10px}"}])}
,function(e,t){var n;!function(e){e[e.None=0]="None",e[e.PageSharingAssetWarning=1]="PageSharingAssetWarning",e[e.LimitedSharing=2]="LimitedSharing",e[e.LimitedSharingExisting=3]="LimitedSharingExisting",e[e.LinkReShare=4]="LinkReShare"}(n||(n={})),t.a=n}
,function(e,t,n){n.d(t,{a:function(){return a}});var a=!n(3).b.isActivated("6d2a844a-9c33-46b3-80c2-9e47560a97b7","4/26/2022")}
,,,,function(e,t,n){n.d(t,{a:function(){return r},b:function(){return i},c:function(){return o}});var a=n(588);function i(e){return void 0===e||e===a.a.Private||e===a.a.Unknown}function r(e){return void 0!==e&&e!==a.a.Private&&e!==a.a.Unknown}function o(e){return e===a.a.Shared}}
,function(e,t,n){var a=n(81),i={accdb:{extensions:["accdb","mdb"]},archive:{type:a.a.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{type:a.a.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},clipchamp:{extensions:["clipchamp"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{type:a.a.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:a.a.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:a.a.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},loop:{extensions:["fluid","loop"]},folder:{type:a.a.Folder,iconType:"svg"},form:{extensions:["form"]},font:{type:a.a.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:a.a.Unknown},html:{extensions:["htm","html","mht"]},link:{type:a.a.Unknown,extensions:["lnk","link","url","website","webloc"]},splist:{type:a.a.Unknown,extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},one:{type:a.a.OneNote,extensions:["note","one"]},onetoc:{type:a.a.OneNote,extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},powerbi:{extensions:["pbix"]},photo:{type:a.a.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{type:a.a.Folder,iconType:"svg"},linkedfolder:{type:a.a.Shortcut,iconType:"svg"},spreadsheet:{extensions:["ods","gsheet","numbers"]},sysfile:{type:a.a.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vector:{type:a.a.Unknown,extensions:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{type:a.a.Media,extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},whiteboard:{extensions:["whiteboard"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{type:a.a.Unknown,extensions:["zip"]}};t.a=i}
]]),define("plt.odsp-common",[],{});