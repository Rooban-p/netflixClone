function _array_like_to_array(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _array_with_holes(e){if(Array.isArray(e))return e}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _class_call_check(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _create_class(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _define_property(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterable_to_array_limit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){_define_property(e,t,n[t])}))}return e}function _sliced_to_array(e,t){return _array_with_holes(e)||_iterable_to_array_limit(e,t)||_unsupported_iterable_to_array(e,t)||_non_iterable_rest()}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(e){if("string"==typeof e)return _array_like_to_array(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_array_like_to_array(e,t):void 0}}var wacBoot;!function(){var e,t,n={830:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(e,i,r){return n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,n,i){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(e,r));return i&&t(o,i.prototype),o},n.apply(null,arguments)}function i(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var o=Object.hasOwnProperty,a=Object.setPrototypeOf,s=Object.isFrozen,u=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,l=Object.freeze,f=Object.seal,d=Object.create,h="undefined"!=typeof Reflect&&Reflect,v=h.apply,p=h.construct;v||(v=function(e,t,n){return e.apply(t,n)}),l||(l=function(e){return e}),f||(f=function(e){return e}),p||(p=function(e,t){return n(e,i(t))});var m,y=P(Array.prototype.forEach),b=P(Array.prototype.pop),g=P(Array.prototype.push),w=P(String.prototype.toLowerCase),_=P(String.prototype.toString),k=P(String.prototype.match),S=P(String.prototype.replace),C=P(String.prototype.indexOf),x=P(String.prototype.trim),R=P(RegExp.prototype.test),A=(m=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return p(m,t)});function P(e){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return v(e,t,i)}}function O(e,t,n){var i;n=null!==(i=n)&&void 0!==i?i:w,a&&a(e,null);for(var r=t.length;r--;){var o=t[r];if("string"==typeof o){var u=n(o);u!==o&&(s(t)||(t[r]=u),o=u)}e[o]=!0}return e}function E(e){var t,n=d(null);for(t in e)!0===v(o,e,[t])&&(n[t]=e[t]);return n}function I(e,t){for(;null!==e;){var n=c(e,t);if(n){if(n.get)return P(n.get);if("function"==typeof n.value)return P(n.value)}e=u(e)}return function(e){return console.warn("fallback value for",e),null}}var W=l(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=l(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),D=l(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),T=l(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),F=l(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),M=l(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N=l(["#text"]),B=l(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),j=l(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=l(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=l(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=f(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=f(/<%[\w\W]*|[\w\W]*%>/gm),G=f(/\${[\w\W]*}/gm),q=f(/^data-[\-\w.\u00B7-\uFFFF]/),J=f(/^aria-[\-\w]+$/),K=f(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=f(/^(?:\w+script|data):/i),Q=f(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y=f(/^html$/i);return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,r=function(e){return t(e)};if(r.version="2.4.7",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var o=n.document,a=n.document,s=n.DocumentFragment,u=n.HTMLTemplateElement,c=n.Node,f=n.Element,d=n.NodeFilter,h=n.NamedNodeMap,v=void 0===h?n.NamedNodeMap||n.MozNamedAttrMap:h,p=n.HTMLFormElement,m=n.DOMParser,P=n.trustedTypes,Z=f.prototype,$=I(Z,"cloneNode"),ee=I(Z,"nextSibling"),te=I(Z,"childNodes"),ne=I(Z,"parentNode");if("function"==typeof u){var ie=a.createElement("template");ie.content&&ie.content.ownerDocument&&(a=ie.content.ownerDocument)}var re=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var i=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(i=n.currentScript.getAttribute(r));var o="dompurify"+(i?"#"+i:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(P,o),oe=re?re.createHTML(""):"",ae=a,se=ae.implementation,ue=ae.createNodeIterator,ce=ae.createDocumentFragment,le=ae.getElementsByTagName,fe=o.importNode,de={};try{de=E(a).documentMode?a.documentMode:{}}catch(e){}var he={};r.isSupported="function"==typeof ne&&se&&void 0!==se.createHTMLDocument&&9!==de;var ve,pe,me=H,ye=z,be=G,ge=q,we=J,_e=X,ke=Q,Se=K,Ce=null,xe=O({},[].concat(i(W),i(L),i(D),i(F),i(N))),Re=null,Ae=O({},[].concat(i(B),i(j),i(V),i(U))),Pe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Ee=null,Ie=!0,We=!0,Le=!1,De=!0,Te=!1,Fe=!1,Me=!1,Ne=!1,Be=!1,je=!1,Ve=!1,Ue=!0,He=!1,ze=!0,Ge=!1,qe={},Je=null,Ke=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Xe=null,Qe=O({},["audio","video","img","source","image","track"]),Ye=null,Ze=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$e="http://www.w3.org/1998/Math/MathML",et="http://www.w3.org/2000/svg",tt="http://www.w3.org/1999/xhtml",nt=tt,it=!1,rt=null,ot=O({},[$e,et,tt],_),at=["application/xhtml+xml","text/html"],st=null,ut=a.createElement("form"),ct=function(e){return _instanceof(e,RegExp)||_instanceof(e,Function)},lt=function(t){st&&st===t||(t&&"object"===e(t)||(t={}),t=E(t),ve=ve=-1===at.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,pe="application/xhtml+xml"===ve?_:w,Ce="ALLOWED_TAGS"in t?O({},t.ALLOWED_TAGS,pe):xe,Re="ALLOWED_ATTR"in t?O({},t.ALLOWED_ATTR,pe):Ae,rt="ALLOWED_NAMESPACES"in t?O({},t.ALLOWED_NAMESPACES,_):ot,Ye="ADD_URI_SAFE_ATTR"in t?O(E(Ze),t.ADD_URI_SAFE_ATTR,pe):Ze,Xe="ADD_DATA_URI_TAGS"in t?O(E(Qe),t.ADD_DATA_URI_TAGS,pe):Qe,Je="FORBID_CONTENTS"in t?O({},t.FORBID_CONTENTS,pe):Ke,Oe="FORBID_TAGS"in t?O({},t.FORBID_TAGS,pe):{},Ee="FORBID_ATTR"in t?O({},t.FORBID_ATTR,pe):{},qe="USE_PROFILES"in t&&t.USE_PROFILES,Ie=!1!==t.ALLOW_ARIA_ATTR,We=!1!==t.ALLOW_DATA_ATTR,Le=t.ALLOW_UNKNOWN_PROTOCOLS||!1,De=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Te=t.SAFE_FOR_TEMPLATES||!1,Fe=t.WHOLE_DOCUMENT||!1,Be=t.RETURN_DOM||!1,je=t.RETURN_DOM_FRAGMENT||!1,Ve=t.RETURN_TRUSTED_TYPE||!1,Ne=t.FORCE_BODY||!1,Ue=!1!==t.SANITIZE_DOM,He=t.SANITIZE_NAMED_PROPS||!1,ze=!1!==t.KEEP_CONTENT,Ge=t.IN_PLACE||!1,Se=t.ALLOWED_URI_REGEXP||Se,nt=t.NAMESPACE||tt,Pe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ct(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Pe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ct(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Pe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Pe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(We=!1),je&&(Be=!0),qe&&(Ce=O({},i(N)),Re=[],!0===qe.html&&(O(Ce,W),O(Re,B)),!0===qe.svg&&(O(Ce,L),O(Re,j),O(Re,U)),!0===qe.svgFilters&&(O(Ce,D),O(Re,j),O(Re,U)),!0===qe.mathMl&&(O(Ce,F),O(Re,V),O(Re,U))),t.ADD_TAGS&&(Ce===xe&&(Ce=E(Ce)),O(Ce,t.ADD_TAGS,pe)),t.ADD_ATTR&&(Re===Ae&&(Re=E(Re)),O(Re,t.ADD_ATTR,pe)),t.ADD_URI_SAFE_ATTR&&O(Ye,t.ADD_URI_SAFE_ATTR,pe),t.FORBID_CONTENTS&&(Je===Ke&&(Je=E(Je)),O(Je,t.FORBID_CONTENTS,pe)),ze&&(Ce["#text"]=!0),Fe&&O(Ce,["html","head","body"]),Ce.table&&(O(Ce,["tbody"]),delete Oe.tbody),l&&l(t),st=t)},ft=O({},["mi","mo","mn","ms","mtext"]),dt=O({},["foreignobject","desc","title","annotation-xml"]),ht=O({},["title","style","font","a","script"]),vt=O({},L);O(vt,D),O(vt,T);var pt=O({},F);O(pt,M);var mt=function(e){g(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=oe}catch(t){e.remove()}}},yt=function(e,t){try{g(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){g(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Re[e])if(Be||je)try{mt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},bt=function(e){var t,n;if(Ne)e="<remove></remove>"+e;else{var i=k(e,/^[\r\n\t ]+/);n=i&&i[0]}"application/xhtml+xml"===ve&&nt===tt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var r=re?re.createHTML(e):e;if(nt===tt)try{t=(new m).parseFromString(r,ve)}catch(e){}if(!t||!t.documentElement){t=se.createDocument(nt,"template",null);try{t.documentElement.innerHTML=it?oe:r}catch(e){}}var o=t.body||t.documentElement;return e&&n&&o.insertBefore(a.createTextNode(n),o.childNodes[0]||null),nt===tt?le.call(t,Fe?"html":"body")[0]:Fe?t.documentElement:o},gt=function(e){return ue.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},wt=function(t){return"object"===e(c)?_instanceof(t,c):t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},_t=function(e,t,n){he[e]&&y(he[e],(function(e){e.call(r,t,n,st)}))},kt=function(e){var t,n;if(_t("beforeSanitizeElements",e,null),_instanceof(n=e,p)&&("string"!=typeof n.nodeName||"string"!=typeof n.textContent||"function"!=typeof n.removeChild||!_instanceof(n.attributes,v)||"function"!=typeof n.removeAttribute||"function"!=typeof n.setAttribute||"string"!=typeof n.namespaceURI||"function"!=typeof n.insertBefore||"function"!=typeof n.hasChildNodes))return mt(e),!0;if(R(/[\u0080-\uFFFF]/,e.nodeName))return mt(e),!0;var i=pe(e.nodeName);if(_t("uponSanitizeElement",e,{tagName:i,allowedTags:Ce}),e.hasChildNodes()&&!wt(e.firstElementChild)&&(!wt(e.content)||!wt(e.content.firstElementChild))&&R(/<[/\w]/g,e.innerHTML)&&R(/<[/\w]/g,e.textContent))return mt(e),!0;if("select"===i&&R(/<template/i,e.innerHTML))return mt(e),!0;if(!Ce[i]||Oe[i]){if(!Oe[i]&&Ct(i)){if(_instanceof(Pe.tagNameCheck,RegExp)&&R(Pe.tagNameCheck,i))return!1;if(_instanceof(Pe.tagNameCheck,Function)&&Pe.tagNameCheck(i))return!1}if(ze&&!Je[i]){var o=ne(e)||e.parentNode,a=te(e)||e.childNodes;if(a&&o)for(var s=a.length-1;s>=0;--s)o.insertBefore($(a[s],!0),ee(e))}return mt(e),!0}return _instanceof(e,f)&&!function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:nt,tagName:"template"});var n=w(e.tagName),i=w(t.tagName);return!!rt[e.namespaceURI]&&(e.namespaceURI===et?t.namespaceURI===tt?"svg"===n:t.namespaceURI===$e?"svg"===n&&("annotation-xml"===i||ft[i]):Boolean(vt[n]):e.namespaceURI===$e?t.namespaceURI===tt?"math"===n:t.namespaceURI===et?"math"===n&&dt[i]:Boolean(pt[n]):e.namespaceURI===tt?!(t.namespaceURI===et&&!dt[i])&&!(t.namespaceURI===$e&&!ft[i])&&!pt[n]&&(ht[n]||!vt[n]):!("application/xhtml+xml"!==ve||!rt[e.namespaceURI]))}(e)?(mt(e),!0):"noscript"!==i&&"noembed"!==i&&"noframes"!==i||!R(/<\/no(script|embed|frames)/i,e.innerHTML)?(Te&&3===e.nodeType&&(t=e.textContent,t=S(t,me," "),t=S(t,ye," "),t=S(t,be," "),e.textContent!==t&&(g(r.removed,{element:e.cloneNode()}),e.textContent=t)),_t("afterSanitizeElements",e,null),!1):(mt(e),!0)},St=function(e,t,n){if(Ue&&("id"===t||"name"===t)&&(n in a||n in ut))return!1;if(We&&!Ee[t]&&R(ge,t));else if(Ie&&R(we,t));else if(!Re[t]||Ee[t]){if(!(Ct(e)&&(_instanceof(Pe.tagNameCheck,RegExp)&&R(Pe.tagNameCheck,e)||_instanceof(Pe.tagNameCheck,Function)&&Pe.tagNameCheck(e))&&(_instanceof(Pe.attributeNameCheck,RegExp)&&R(Pe.attributeNameCheck,t)||_instanceof(Pe.attributeNameCheck,Function)&&Pe.attributeNameCheck(t))||"is"===t&&Pe.allowCustomizedBuiltInElements&&(_instanceof(Pe.tagNameCheck,RegExp)&&R(Pe.tagNameCheck,n)||_instanceof(Pe.tagNameCheck,Function)&&Pe.tagNameCheck(n))))return!1}else if(Ye[t]);else if(R(Se,S(n,ke,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==C(n,"data:")||!Xe[e])if(Le&&!R(_e,S(n,ke,"")));else if(n)return!1;return!0},Ct=function(e){return e.indexOf("-")>0},xt=function(t){var n,i,o,a;_t("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var u={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Re};for(a=s.length;a--;){var c=n=s[a],l=c.name,f=c.namespaceURI;if(i="value"===l?n.value:x(n.value),o=pe(l),u.attrName=o,u.attrValue=i,u.keepAttr=!0,u.forceKeepAttr=void 0,_t("uponSanitizeAttribute",t,u),i=u.attrValue,!u.forceKeepAttr&&(yt(l,t),u.keepAttr))if(De||!R(/\/>/i,i)){Te&&(i=S(i,me," "),i=S(i,ye," "),i=S(i,be," "));var d=pe(t.nodeName);if(St(d,o,i)){if(!He||"id"!==o&&"name"!==o||(yt(l,t),i="user-content-"+i),re&&"object"===e(P)&&"function"==typeof P.getAttributeType)if(f);else switch(P.getAttributeType(d,o)){case"TrustedHTML":i=re.createHTML(i);break;case"TrustedScriptURL":i=re.createScriptURL(i)}try{f?t.setAttributeNS(f,l,i):t.setAttribute(l,i),b(r.removed)}catch(e){}}}else yt(l,t)}_t("afterSanitizeAttributes",t,null)}},Rt=function e(t){var n,i=gt(t);for(_t("beforeSanitizeShadowDOM",t,null);n=i.nextNode();)_t("uponSanitizeShadowNode",n,null),kt(n)||(_instanceof(n.content,s)&&e(n.content),xt(n));_t("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(t){var i,a,u,l,f,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((it=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!wt(t)){if("function"!=typeof t.toString)throw A("toString is not a function");if("string"!=typeof(t=t.toString()))throw A("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(wt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Me||lt(d),r.removed=[],"string"==typeof t&&(Ge=!1),Ge){if(t.nodeName){var h=pe(t.nodeName);if(!Ce[h]||Oe[h])throw A("root node is forbidden and cannot be sanitized in-place")}}else if(_instanceof(t,c))1===(a=(i=bt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?i=a:i.appendChild(a);else{if(!Be&&!Te&&!Fe&&-1===t.indexOf("<"))return re&&Ve?re.createHTML(t):t;if(!(i=bt(t)))return Be?null:Ve?oe:""}i&&Ne&&mt(i.firstChild);for(var v=gt(Ge?t:i);u=v.nextNode();)3===u.nodeType&&u===l||kt(u)||(_instanceof(u.content,s)&&Rt(u.content),xt(u),l=u);if(l=null,Ge)return t;if(Be){if(je)for(f=ce.call(i.ownerDocument);i.firstChild;)f.appendChild(i.firstChild);else f=i;return(Re.shadowroot||Re.shadowrootmod)&&(f=fe.call(o,f,!0)),f}var p=Fe?i.outerHTML:i.innerHTML;return Fe&&Ce["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&R(Y,i.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+p),Te&&(p=S(p,me," "),p=S(p,ye," "),p=S(p,be," ")),re&&Ve?re.createHTML(p):p},r.setConfig=function(e){lt(e),Me=!0},r.clearConfig=function(){st=null,Me=!1},r.isValidAttribute=function(e,t,n){st||lt({});var i=pe(e),r=pe(t);return St(i,r,n)},r.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],g(he[e],t))},r.removeHook=function(e){if(he[e])return b(he[e])},r.removeHooks=function(e){he[e]&&(he[e]=[])},r.removeAllHooks=function(){he={}},r}()}()},181:function(e,t,n){"use strict";n.r(t),n.d(t,{__assign:function(){return o},__asyncDelegator:function(){return x},__asyncGenerator:function(){return C},__asyncValues:function(){return R},__await:function(){return S},__awaiter:function(){return v},__classPrivateFieldGet:function(){return I},__classPrivateFieldIn:function(){return L},__classPrivateFieldSet:function(){return W},__createBinding:function(){return m},__decorate:function(){return s},__esDecorate:function(){return c},__exportStar:function(){return y},__extends:function(){return r},__generator:function(){return p},__importDefault:function(){return E},__importStar:function(){return O},__makeTemplateObject:function(){return A},__metadata:function(){return h},__param:function(){return u},__propKey:function(){return f},__read:function(){return g},__rest:function(){return a},__runInitializers:function(){return l},__setFunctionName:function(){return d},__spread:function(){return w},__spreadArray:function(){return k},__spreadArrays:function(){return _},__values:function(){return b}});var i=function(e,t){return i=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};function a(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function s(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,i){t(n,i,e)}}function c(e,t,n,i,r,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,u=i.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?i.static?e:e.prototype:null,f=t||(l?Object.getOwnPropertyDescriptor(l,i.name):{}),d=!1,h=n.length-1;h>=0;h--){var v={};for(var p in i)v[p]="access"===p?{}:i[p];for(var p in i.access)v.access[p]=i.access[p];v.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var m=(0,n[h])("accessor"===u?{get:f.get,set:f.set}:f[c],v);if("accessor"===u){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=a(m.get))&&(f.get=s),(s=a(m.set))&&(f.set=s),(s=a(m.init))&&r.push(s)}else(s=a(m))&&("field"===u?r.push(s):f[c]=s)}l&&Object.defineProperty(l,i.name,f),d=!0}function l(e,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(e,n):t[r].call(e);return i?n:void 0}function f(e){return"symbol"===(void 0===e?"undefined":_type_of(e))?e:"".concat(e)}function d(e,t,n){return"symbol"===(void 0===t?"undefined":_type_of(t))&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function v(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,_instanceof(t,n)?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))}function p(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var m=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i}function k(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function S(e){return _instanceof(this,S)?(this.v=e,this):new S(e)}function C(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||s(e,t)}))})}function s(e,t){try{_instanceof((n=r[e](t)).value,S)?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function x(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:S(e[i](t)),done:!1}:r?r(t):t}:r}}function R(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=b(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,r,(t=e[n](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return P(t,e),t}function E(e){return e&&e.__esModule?e:{default:e}}function I(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function W(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n}function L(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},821:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},456:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGatesManagerSet=t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=function(e){n=e},t.isChangeGateEnabled=function(e){return!n||n.isChangeGateEnabled(e)},t.isChangeGatesManagerSet=function(){return!!n}},936:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(181);i.__exportStar(n(456),t),i.__exportStar(n(821),t)},591:function(e,t,n){"use strict";var i;n.d(t,{n:function(){return i}}),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotComposeLaunchpad=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor"}(i||(i={}))},284:function(e,t,n){"use strict";var i;n.d(t,{k:function(){return i}}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={}))},108:function(e,t,n){"use strict";n.d(t,{Hv:function(){return r}});var i=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"sendTraceTag",value:function(){}},{key:"shipAssertTag",value:function(){}},{key:"debugAssertTag",value:function(){}},{key:"setCorrelationId",value:function(){}}]),e}(),r=new(function(){function e(){_class_call_check(this,e),this.externalLogger=new i}return _create_class(e,[{key:"setCorrelationId",value:function(e){this.externalLogger.setCorrelationId(e)}},{key:"setLogger",value:function(e){this.externalLogger=e}},{key:"sendTraceTag",value:function(e,t,n,i){this.externalLogger.sendTraceTag(e,t,n,i)}},{key:"debugAssertTag",value:function(e,t,n,i){this.externalLogger.debugAssertTag(e,t,n,i)}},{key:"shipAssertTag",value:function(e,t,n,i){this.externalLogger.shipAssertTag(e,t,n,i)}}]),e}())},48:function(e,t,n){"use strict";n.r(t),n.d(t,{RegionComposer:function(){return o},initializeWindowUtil:function(){return u},registerAfterRegionsRendered:function(){return l},shouldUseRegionComposer:function(){return s},unregisterAfterRegionsRendered:function(){return f}});var i=function(){function e(t){_class_call_check(this,e),this.regionComposerRootClassName="regionComposerRoot",this.regionElements={},this.positioningElements={Top:void 0,Left:void 0,Right:void 0,Bottom:void 0},this.positionCounts={Top:0,Left:0,Right:0,Bottom:0};var n=t.container,i=t.styleSheet;this.containerElement=n,this.styleSheet=i,void 0===this.styleSheet.ownerRule&&0===this.styleSheet.cssRules.length&&this.styleSheet.parentStyleSheet&&!this.styleSheet.parentStyleSheet.parentStyleSheet&&1===this.styleSheet.parentStyleSheet.cssRules.length?((this.styleSheet.parentStyleSheet||this.styleSheet).insertRule(".".concat(this.regionComposerRootClassName,"{display: grid; position: absolute; width: 100%; height: 100%; z-index: 1;}"),0),this.containerElement&&(this.dockPanel=document.createElement("div"),this.dockPanel.classList.add(this.regionComposerRootClassName),this.addPositioningElements(this.dockPanel),this.containerElement.appendChild(this.dockPanel))):this.containerElement&&(this.dockPanel=this.containerElement,this.getPositioningElements(this.dockPanel)),this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{}"),0),this.regionComposerRootStyle=this.styleSheet.cssRules[0]}return _create_class(e,[{key:"dispose",value:function(){this.positionCounts={Top:0,Left:0,Right:0,Bottom:0},this.regionElements={},this.containerElement&&this.dockPanel&&this.containerElement.removeChild(this.dockPanel),this.dockPanel=void 0,this.containerElement=void 0}},{key:"addRegion",value:function(e){if(this.dockPanel){var t,n=this.styleSheet.insertRule(".".concat(e.id,"{display:block;}"),this.styleSheet.cssRules.length),i=this.regionElements[e.id];this.containerElement&&((i=i||this.containerElement.querySelector(".".concat(e.id)))?t=i:(t=document.createElement("div")).classList.add(e.id));var r=this.getGridArea(e.position,!1);return this.updateTemplate(e.position),void 0!==this.lastChildIndex&&this.lastChildOriginalGridArea&&(this.styleSheet.cssRules[this.lastChildIndex].style.gridArea=this.lastChildOriginalGridArea),this.lastChildOriginalGridArea=r,r=this.getGridArea(e.position,!0),this.styleSheet.cssRules[n].style.gridArea=r,t&&!i&&(this.appendRegion(e.position,t),this.regionElements[e.id]=t),this.lastChildIndex=n,this.positionCounts[e.position]=this.positionCounts[e.position]+1,t}}},{key:"updateTemplate",value:function(e){if(this.dockPanel)switch(e){case"Top":var t="repeat(".concat(this.positionCounts.Top+1,", min-content) 1fr repeat(").concat(Math.max(1,this.positionCounts.Bottom),", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=t:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-rows: ").concat(t),this.styleSheet.cssRules.length));case"Left":var n="repeat(".concat(this.positionCounts.Left+1,", min-content) 1fr repeat(").concat(Math.max(1,this.positionCounts.Right),", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=n:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-columns: ").concat(n),this.styleSheet.cssRules.length));case"Right":var i="repeat(".concat(Math.max(1,this.positionCounts.Left),", min-content) 1fr repeat(").concat(this.positionCounts.Right+1,", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=i:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-columns: ").concat(i),this.styleSheet.cssRules.length));case"Bottom":var r="repeat(".concat(Math.max(1,this.positionCounts.Top),", min-content) 1fr repeat(").concat(this.positionCounts.Bottom+1,", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=r:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-rows: ").concat(r),this.styleSheet.cssRules.length))}}},{key:"addPositioningElements",value:function(e){var t=this;Object.keys(this.positioningElements).forEach((function(n){var i=document.createElement("div");i.style.setProperty("display","none"),i.id=n,t.positioningElements[n]=i,e.appendChild(i)}))}},{key:"getPositioningElements",value:function(e){var t=this;Object.keys(this.positioningElements).forEach((function(n){var i=e.querySelector("#".concat(n));i&&(t.positioningElements[n]=i)}))}},{key:"appendRegion",value:function(e,t){var n=this.positioningElements[e];if(n){var i=n.parentNode;i&&!i.contains(t)&&(i.insertBefore(t,n.nextSibling),"Top"!==e&&"Left"!==e||(this.positioningElements[e]=t))}}},{key:"getGridArea",value:function(e,t){if(!this.dockPanel)return"";switch(e){case"Top":return" ".concat(this.positionCounts.Top+1," / ").concat(this.positionCounts.Left+1," / ").concat(t?-1*(this.positionCounts.Bottom+1):this.positionCounts.Top+2," / ").concat(-1*(this.positionCounts.Right+1));case"Left":return" ".concat(this.positionCounts.Top+1," / ").concat(this.positionCounts.Left+1," / ").concat(-1*(this.positionCounts.Bottom+1)," / ").concat(t?-1*(this.positionCounts.Right+1):this.positionCounts.Left+2);case"Right":return"".concat(this.positionCounts.Top+1," / ").concat(-1*(this.positionCounts.Right+1)," / ").concat(-1*(this.positionCounts.Bottom+1)," / ").concat(t?this.positionCounts.Left+1:-1*(this.positionCounts.Right+2));case"Bottom":return" ".concat(-1*(this.positionCounts.Bottom+1)," / ").concat(this.positionCounts.Left+1," / ").concat(t?this.positionCounts.Top+1:-1*(this.positionCounts.Bottom+2)," / ").concat(-1*(this.positionCounts.Right+1))}}},{key:"dockPanelRootElement",get:function(){return this.dockPanel}}]),e}(),r=n(287),o=function(){function e(t){var n=this;_class_call_check(this,e),this.layoutRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.accountForKeyboardRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.regionContainers={},this.unsupportedRules=[],this.setOffsetForActiveAccountForKeyboardRegions=function(e){var t=e?void 0:n.getWindowRectForKeyboardSegment(),i="Undefined"===n.windowMode?"Landscape":n.windowMode,r=n.getAffectedAccountForKeyboardRegions(t,i,n.layoutBreakpoint);if(r){var o=t?t.top+t.height:0;r.forEach((function(t){if(e)t.style.marginBottom="0px";else{var i=t.getBoundingClientRect(),r=Math.max(0,n.keyboardSegment.height-(o-i.bottom));t.style.marginBottom="".concat(r,"px")}}))}},this.boundingWindowRectsChanged=function(e,t){var i=e.find((function(e){return!!e.isOccluded})),r=n.windowMode!==t||n.keyboardSegment!==i;n.setOffsetForActiveAccountForKeyboardRegions(!0),n.windowMode=t,n.keyboardSegment=i,n.render(r)},this.layoutBreakpointChanged=function(e){n.layoutBreakpoint=e,n.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(n.keyboardSegment)return(0,r.getBoundingRect)(n.keyboardSegment)},this.props=t,this.windowMode=(0,r.getWindowMode)(),this.layoutBreakpoint=(0,r.getLayoutBreakpoint)(),this.keyboardSegment=(0,r.getKeyboardSegment)(),this.styleSheet=this.createStyleSheet(),this.createRegions(),(0,r.arrayFindPolyfill)(),(0,r.objectAssignPolyfill)(),(0,r.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),(0,r.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render()}return _create_class(e,[{key:"render",value:function(e){var t=this;e&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){t.setOffsetForActiveAccountForKeyboardRegions(),d()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),d()))}},{key:"dispose",value:function(){var e=this;Object.keys(this.layoutRegions).forEach((function(t){Object.keys(e.layoutRegions[t]).forEach((function(n){var i=e.layoutRegions[t][n];i&&i.dispose()}))})),Object.keys(this.regionContainers).forEach((function(t){var n=e.regionContainers[t];n&&document.removeChild(n),e.regionContainers[t]=void 0})),(0,r.unregisterBoundingWindowRectsChanged)("regionComposer"),(0,r.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}}},{key:"getRegion",value:function(e){return this.regionContainers[e]}},{key:"createRegions",value:function(){var e=this,t=this.props.layoutCollection;Object.keys(t).forEach((function(n){var i=t[n];i&&e.createRegion(i,n)}));var n="";if(Object.keys(this.regionContainers).forEach((function(e){n+=".".concat(e,", ")})),n.length&&(n=n.substr(0,n.length-2),n+="{display: none; position: relative;}",this.styleSheet.insertRule(n,0)),this.styleElement){var i=this.styleSheet.cssRules;this.unsupportedRules=this.unsupportedRules.reverse();for(var r=0;r<i.length;r+=1){i[r].cssRules&&i[r].insertRule(n,0);var o="".concat(this.styleElement.innerHTML).concat(i[r].cssText);o.indexOf("@media not all")>=0&&this.unsupportedRules.length>0&&(o=o.replace("@media not all",this.unsupportedRules.pop())).replace(new RegExp("and (spanning: single-fold-.*)","g"),"{.multipleWindowRects"),this.styleElement.innerHTML=o,this.styleElement.innerHTML="".concat(this.styleElement.innerHTML).concat("")}this.styleSheet=this.styleElement.sheet}}},{key:"createRegionContainer",value:function(e){if(this.regionContainers[e.id])return this.regionContainers[e.id];var t=document.createElement("div");return t.setAttribute("style","width: ".concat("Header"===e.id?"100vw":"100%","; height: 100%; display: flex; flex: auto;")),this.regionContainers[e.id]=t,t}},{key:"createRegion",value:function(e,t){var n=this;Object.keys(e).forEach((function(r){var o=e[r];n.addSelectorForLayoutDefinition(n.styleSheet,t,r);var a=n.rootDockPanel||(n.props.dockPanelProps?n.props.dockPanelProps.container:void 0),s=new i(Object.assign(n.props.dockPanelProps,{container:a,styleSheet:n.getLastChild(n.styleSheet)}));o.forEach((function(e){var i=n.createRegionContainer(e),o=s.addRegion(e);o&&i&&!o.contains(i)&&o.appendChild(i),e.accountForKeyboard&&o&&(n.accountForKeyboardRegions[t][r]||(n.accountForKeyboardRegions[t][r]=[]),n.accountForKeyboardRegions[t][r].push(o))})),!n.rootDockPanel&&s.dockPanelRootElement&&(n.rootDockPanel=s.dockPanelRootElement),n.layoutRegions[t][r]=s}))}},{key:"getLastChild",value:function(e){for(var t=e.cssRules[e.cssRules.length-1];t.cssRules&&t.cssRules.length>0;)t=t.cssRules[t.cssRules.length-1];return t.cssRules?t:t.parentStyleSheet}},{key:"getAffectedAccountForKeyboardRegions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Landscape",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Default";if(this.accountForKeyboardRegions){var i=this.accountForKeyboardRegions[t][n]||this.accountForKeyboardRegions[t].Default||void 0;return e&&i?i.filter((function(t){return(0,r.isRectWithin)(t.getBoundingClientRect(),e)})):i}}},{key:"createStyleSheet",value:function(){return this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement),this.styleElement.sheet}},{key:"addSelectorForLayoutDefinition",value:function(e,t,n){var i,o,a="Small"===n?"max-width":"Large"===n?"min-width":void 0;if("Portrait"===t||"Landscape"===t)i="@media only screen and (orientation: ".concat(t.toLowerCase(),") ").concat(a&&"Default"!==n?"and (".concat(a,": ").concat(r.LayoutBreakpointSizes[n][t],"px ){"):"{","}");else{var s=void 0,u=void 0;"DP"===t?(s="landscape",u="single-fold-vertical"):(s="portrait",u="single-fold-horizontal"),o="@media only screen and (orientation: ".concat(s,") and (spanning: ").concat(u,")"),this.unsupportedRules.push(o),i="".concat(o," ").concat(a&&"Default"!==n?"and (".concat(a,": ").concat(r.LayoutBreakpointSizes[n][t],"px ){"):"{","}")}e.insertRule(i,e.cssRules.length)}}]),e}(),a=!1;function s(){return a}function u(e){var t;a=e&&!("undefined"!=typeof navigator&&(t=navigator.userAgent,/rv:11.0/i.test(t)||/Edge\//i.test(t)||/Safari/i.test(t)&&!/Chrome/i.test(t)&&!/Version\/[1-9][1-9]\.[0-9].*Safari/i.test(navigator.userAgent))),(0,r.initializeBaseWindowUtil)()}var c={};function l(e,t){c[e]=t}function f(e){void 0!==c[e]&&delete c[e]}function d(){for(var e in c)c[e]()}},287:function(e,t,n){"use strict";n.r(t),n.d(t,{LayoutBreakpointSizes:function(){return z},WindowSegment:function(){return r},arrayFindPolyfill:function(){return s},ensureWindowsAPIs:function(){return o},getBoundingRect:function(){return x},getBoundingWindow:function(){return _},getBoundingWindowWithPadding:function(){return k},getBoundingWindowWithPaddingFabric:function(){return S},getKeyboardSegment:function(){return B},getLayoutBreakpoint:function(){return N},getRectSpanningOffset:function(){return O},getWindowMode:function(){return M},getWindowRectForKeyboardSegment:function(){return H},getWindowRectsWithoutKeyboard:function(){return j},initializeBaseWindowUtil:function(){return V},isDLMode:function(){return w},isDPMode:function(){return g},isElementSpanning:function(){return A},isRectSpanning:function(){return P},isRectWithin:function(){return R},isReducedAnimations:function(){return b},objectAssignPolyfill:function(){return u},onWindowRectsChange:function(){return F},registerBoundingWindowRectsChanged:function(){return W},registerLayoutBreakpointChanged:function(){return D},registerSpanningChanged:function(){return E},unregisterBoundingWindowRectsChanged:function(){return L},unregisterLayoutBreakpointChanged:function(){return T},unregisterSpanningChanged:function(){return I}});var i=window.__foldables_env_vars__,r=function(){function e(t,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_class_call_check(this,e),this.left=t,this.right=t+i,this.top=n,this.bottom=n+r,this.x=t,this.y=n,this.width=i,this.height=r,this.pixelDepth=0,this.devicePixelRatio=0,this.isOccluded=o}return _create_class(e,[{key:"toJSON",value:function(){return JSON.stringify(this)}}]),e}();function o(){"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){var n=t||{bubbles:!1,cancelable:!1,detail:null},i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),i}),"function"!=typeof window.DOMRect&&(window.DOMRect=function(e){return{x:0,y:0,width:window.innerWidth,height:window.innerHeight}}),"object"!=typeof window.onBoundingWindowRectsChange&&(window.onBoundingWindowRectsChange=new CustomEvent("onBoundingWindowRectsChange",{bubbles:!1,cancelable:!1}),window.addEventListener("resize",a)),function(){if("function"!=typeof window.getWindowSegments){window.getWindowSegments=function(){var e=window.innerWidth,t=window.innerHeight;try{if(window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")){if(window.matchMedia&&window.matchMedia("(orientation: portrait)").matches&&t>=1300&&964===e)return i&&i.update({spanning:"single-fold-horizontal"}),[new r(0,0,e,t/2),new r(0,t/2,e,t/2)];if(window.matchMedia&&window.matchMedia("(orientation: landscape)").matches&&t>=820&&1440===e)return i&&i.update({spanning:"single-fold-vertical"}),[new r(0,0,e/2,t),new r(e/2,0,e/2,t)];i&&i.update({spanning:"none"})}}catch(e){}return[new r(0,0,e,t)]}}}()}function a(){window.dispatchEvent(window.onBoundingWindowRectsChange)}function s(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r+=1}},configurable:!0,writable:!0})}function u(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i+=1){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0})}var c={},l={},f={},d=[],h=void 0,v=-1,p="Undefined",m="Default",y=!1;function b(){var e,t;return null===(t=window)||void 0===t||null===(e=t.matchMedia)||void 0===e?void 0:e.call(t,"(prefers-reduced-motion: reduce)").matches}function g(){return"DP"===M()}function w(){return"DL"===M()}function _(e){return k(e,0)}function k(e,t){if(e&&d&&!(d.length<=0)){if(1===d.length)return C(d[0],t);var n;if("string"==typeof e){var i=document.querySelector(e);if(!i)return;n=i.getBoundingClientRect()}else if(void 0!==e.preventDefault){var o=e;n=new r(o.clientX,o.clientY,1,1)}else if(e.getBoundingClientRect)n=e.getBoundingClientRect();else if(e.current)n=e.current.getBoundingClientRect();else{if(!e)return;var a=e;n=new r(a.x,a.y,1,1)}var s=x(n);return s&&C(s,t)}}function S(e,t){return k(e,8)}function C(e,t){return u(),e&&Object.assign({},e,{top:e.top+t,left:e.left+t,right:e.right-t,bottom:e.bottom-t,width:e.width-2*t,height:e.height-2*t})}function x(e){return P(e)?d[0]:(s(),d.find((function(t){return R(e,t)})))}function R(e,t){return e.left>=t.left&&e.top>=t.top&&e.right<=t.left+t.width&&e.bottom<=t.top+t.height}function A(e){return void 0!==e&&("DL"===M()||"DP"===M())&&P(e.getBoundingClientRect())}function P(e){return!(d.length<=1)&&(e.right>d[0].left+d[0].width?e.left<d[1].left:e.bottom>d[0].top+d[0].height&&e.top<d[1].top)}function O(e,t){if(d.length<=1)return-1;if(t){if(e.left<d[1].left)return e.right-d[0].right;if(e.top<d[1].top)return e.bottom-d[0].bottom}else{if(e.right>d[0].left+d[0].width)return d[1].left-e.left;if(e.bottom>d[0].top+d[0].height)return d[1].top-e.top}return-1}function E(e,t){c[e]=t}function I(e){void 0!==c[e]&&delete c[e]}function W(e,t){l[e]=t}function L(e){void 0!==l[e]&&delete l[e]}function D(e,t){f[e]=t}function T(e){void 0!==f[e]&&delete f[e]}function F(){window.getWindowSegments||o();var e=window.getWindowSegments(),t=!1;if(e.length!==d.length&&(t=!0),1===(d=e).length){var n=d[0];p=n.width>n.height?"Landscape":"Portrait"}else d.length<=1||d[0].top!==d[1].top?d.length<=1||d[0].left!==d[1].left||(t=t||"DP"===p,p="DL"):(t=t||"DL"===p,p="DP");var i=m;"Landscape"===p||"DL"===p?m=d[0].width<=960?"Small":"Large":"Portrait"!==p&&"DP"!==p||(m=d[0].width<=720?"Small":"Large"),function(){var e=d;for(var t in h&&e.push(h),l)l[t](e,p)}(),t&&function(e){for(var t in c)c[t](e,p)}("DL"===p||"DP"===p),i!==m&&function(){for(var e in f)f[e](m)}()}function M(){if("Undefined"===p){var e=window.getWindowSegments?window.getWindowSegments():void 0;return!e||e.length<=1?window.innerWidth>window.innerHeight?"Landscape":"Portrait":window.innerWidth>window.innerHeight?"DP":"DL"}return p}function N(){return m}function B(){return h}function j(){return d}function V(){y||("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&(window===top&&(navigator.virtualKeyboard.overlaysContent=!0),navigator.virtualKeyboard.addEventListener("overlaygeometrychange",U)),o(),window.addEventListener("onBoundingWindowRectsChange",F),d&&0!==d.length||F(),y=!0)}function U(e){var t=e.boundingRect,n=t.width,i=t.height,r=t.left;0===n||0===i?(h=void 0,v=-1):((h=e.boundingRect).isOccluded=!0,v=r>0||"DL"===M()?1:0),F()}function H(){if(h)return d[v]}V();var z={Small:{Portrait:720,Landscape:960,DP:1440,DL:1920},Large:{Portrait:721,Landscape:961,DP:1441,DL:1921}}}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={exports:{}};return n[e].call(o.exports,o,o.exports,r),o.exports}r.m=n,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))},r.u=function(e){return"pasLogger.min.js"},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="wacBoot:",r.l=function(n,i,o,a){if(e[n])e[n].push(i);else{var s,u;if(void 0!==o)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==n||f.getAttribute("data-webpack")==t+o){s=f;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+o),s.src=n,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous")),e[n]=[i];var d=function(t,i){s.onerror=s.onload=null,clearTimeout(h);var r=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(e){return e(i)})),t)return t(i)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),u&&document.head.appendChild(s)}},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="",function(){var e={506:0};r.f.j=function(t,n){var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise((function(n,r){i=e[t]=[n,r]}));n.push(i[2]=o);var a=r.p+r.u(t),s=new Error;r.l(a,(function(n){if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,n){var i,o,a=_sliced_to_array(n,3),s=a[0],u=a[1],c=a[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(i in u)r.o(u,i)&&(r.m[i]=u[i]);c&&c(r)}for(t&&t(n);l<s.length;l++)o=s[l],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=globalThis.wacBootChunks=globalThis.wacBootChunks||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o={};!function(){"use strict";r.r(o),r.d(o,{CanvasCacheLoader:function(){return te},CanvasCacheRemover:function(){return ne},CtrlWheelMetrics:function(){return c},DocumentCacheInfo:function(){return K},DocumentCacheItem:function(){return $},DocumentCacheManager:function(){return ee},DocumentCacheResult:function(){return X},DocumentCacheToastManager:function(){return be},FastView:function(){return q},FastViewLogEntry:function(){return G},FastViewSettings:function(){return f},FastViewUtils:function(){return S},LocalStorageDocumentCache:function(){return ge},LocalStorageDocumentCacheTest:function(){return we},ShiftUtils:function(){return B},SkeletalBoot:function(){return N},WacSkeletalBoot:function(){return k},WindowUtil:function(){return e},WindowVisibilityMetrics:function(){return J},WordEditorInstantApp:function(){return Gt},WordEditorInstantAppResult:function(){return zt},bootSettings:function(){return l},cssClass:function(){return R},cssClassAbsolute:function(){return x},cssPositionRewriteClass:function(){return A},dispose:function(){return u},getFastViewCssClasses:function(){return P},getRegion:function(){return s},isTouchSupport:function(){return C},launchFastViewForSkeletalUX:function(){return Ut},makeStyleChangesToHideHeader:function(){return W},removeCanvasSkeletalUX:function(){return E},removeSplashScreen:function(){return O},sendWacBeacon:function(){return _},setFastViewScrollTop:function(){return I},show:function(){return qt},startWacBoot:function(){return Ht}});var e=r(287),t=function(){function t(n){var i=this;_class_call_check(this,t),this.accountForKeyboardRegionElements={Portrait:{Default:[],Small:[],Large:[]},Landscape:{Default:[],Small:[],Large:[]},DP:{Default:[],Small:[],Large:[]},DL:{Default:[],Small:[],Large:[]}},this.regionComposerRootId="regionComposerRoot",this.regionContainers={},this.setOffsetForActiveAccountForKeyboardRegions=function(e){var t=e?void 0:i.getWindowRectForKeyboardSegment(),n="Undefined"===i.windowMode?"Landscape":i.windowMode,r=i.getAffectedAccountForKeyboardRegions(t,n,i.layoutBreakpoint);if(r&&0!==r.length){var o=t?t.top+t.height:0;r.forEach((function(t){if(e)t.style.marginBottom="0px";else{var n=t.getBoundingClientRect(),r=Math.max(0,i.keyboardSegment.height-(o-n.bottom));t.style.marginBottom="".concat(r,"px")}}))}},this.boundingWindowRectsChanged=function(e,t){for(var n=void 0,r=e.length-1;r>=0;r-=1)if(e[r].isOccluded){n=e[r];break}var o=i.windowMode!==t||i.keyboardSegment!==n;i.setOffsetForActiveAccountForKeyboardRegions(!0),i.windowMode=t,i.keyboardSegment=n,i.render(o)},this.layoutBreakpointChanged=function(e){i.layoutBreakpoint=e,i.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(i.keyboardSegment)return(0,e.getBoundingRect)(i.keyboardSegment)},this.props=n,this.windowMode=(0,e.getWindowMode)(),this.layoutBreakpoint=(0,e.getLayoutBreakpoint)(),this.keyboardSegment=(0,e.getKeyboardSegment)(),this.regionComposerRoot=this.getRegionComposer(),this.regionComposerRoot&&(n.container&&n.container.appendChild(this.regionComposerRoot),this.registerAccountForKeyboardRegionElements(),(0,e.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),(0,e.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render())}return _create_class(t,[{key:"render",value:function(e){var t=this;e&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){t.setOffsetForActiveAccountForKeyboardRegions(),i()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),i()))}},{key:"dispose",value:function(){var t=this;Object.keys(this.regionContainers).forEach((function(e){var n=t.regionContainers[e];n&&document.removeChild(n),t.regionContainers[e]=void 0})),(0,e.unregisterBoundingWindowRectsChanged)("regionComposer"),(0,e.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}}},{key:"getRegion",value:function(e){if(this.regionComposerRoot)return this.regionContainers[e]||(this.regionContainers[e]=this.regionComposerRoot.querySelector("[id=".concat(e,"Region]"))),this.regionContainers[e]}},{key:"getRegionComposer",value:function(){return document.getElementById(this.regionComposerRootId)}},{key:"registerAccountForKeyboardRegionElements",value:function(){var e=this,t=this.props.layoutCollection;Object.keys(t).forEach((function(n){var i=t[n];i&&e.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode(i,n)}))}},{key:"registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode",value:function(e,t){var n=this;Object.keys(e).forEach((function(i){var r;null===(r=e[i])||void 0===r||r.forEach((function(e){var r=n.getRegion(e.id);r&&n.accountForKeyboardRegionElements[t][i].push(r)}))}))}},{key:"getAffectedAccountForKeyboardRegions",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Landscape",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Default",r=this.accountForKeyboardRegionElements[n][i]||this.accountForKeyboardRegionElements[n].Default||void 0;return t&&r&&0!==r.length?r.filter((function(n){return(0,e.isRectWithin)(n.getBoundingClientRect(),t)})):r}}]),t}(),n={};function i(){for(var e in n)n[e]()}var a=void 0;function s(e){return a?a.getRegion(e):void 0}function u(){a&&(a.dispose(),a=void 0)}var c=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"initialize",value:function(){e.ctrlWheelOccurred=!1,document.addEventListener("wheel",e.handleWheel)}},{key:"stop",value:function(){document.removeEventListener("wheel",e.handleWheel)}},{key:"handleWheel",value:function(t){t.ctrlKey&&(e.ctrlWheelOccurred=!0)}}]),e}();c.initialize();var l={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_getCellsUuid:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_acquireLockRequestStatus:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getDocumentRequestStatus:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0,g_useLoadAsync:0},f={fastView:void 0,initialParaId:0,fastBootError:void 0},d=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"getElement",value:function(e){if(this.DOMElements.hasOwnProperty(e))return this.DOMElements[e];var t=document.getElementById(e);return t?this.DOMElements[e]=t:null}},{key:"removeElement",value:function(e){e&&this.DOMElements.hasOwnProperty(e.id)&&delete this.DOMElements[e.id],e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"removeElementById",value:function(e){this.removeElement(this.getElement(e))}}]),e}();d.DOMElements={};var h,v=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"initialize",value:function(e,t,n,i,r,o,a,s,u,c,l,f,d,h,v,p,m){this.isViewMode=e&&!v,this.isEmbedMode=t,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=n,this.isOldRibbonCollapsedCookieOn="false"!==S.getCookie(i).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==S.getCookie(r).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=o,this.isTwoPaneNavEnabled=a,this.isCssPositionRewriteEnabled=s,this.hideSkeletalHeader=u,this.hideSkeletalRibbon=c,this.hideSkeletalNavPane=l,this.embedViewer=f,this.isHostRenderingEnabled=d,this.postMessageOrigin=h,this.isOneNoteNavPaneCollapseOnSmallScreenEnabled=p,this.regionComposerIsEnabled=m}}]),e}();!function(e){e[e.HideAnimationTime=256]="HideAnimationTime",e[e.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",e[e.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",e[e.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",e[e.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(h||(h={}));var p,m=0,y=!1,b=!1,g=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"clearAriaLoadingAttributes",value:function(){var e=document.getElementById("applicationOuterContainer");e&&(e.removeAttribute("aria-busy"),e.removeAttribute("aria-hidden"))}},{key:"getFastViewSkeletalClass",value:function(){return v.isCssPositionRewriteEnabled?this.t():this.i()}},{key:"updateRibbonPanel",value:function(){v.regionComposerIsEnabled||(v.isCssPositionRewriteEnabled&&v.isSimplifiedRibbonCookieOn?this.h():this._())}},{key:"updateWacDocumentPanel",value:function(){v.isCssPositionRewriteEnabled&&v.isSimplifiedRibbonCookieOn?this.S():this.C()}},{key:"customizeSkeletalExperience",value:function(){m=document.body.clientWidth,v.isSimplifiedReactRibbonShown?d.removeElementById("SkeletalAdditionOldRibbon"):d.removeElementById("SkeletalNewRibbon"),v.isEmbedMode||v.embedViewer?(d.removeElementById("SkeletalHeader"),d.removeElementById("SkeletalNewHeader")):v.isNewHeaderShown?d.removeElementById("SkeletalHeader"):d.removeElementById("SkeletalNewHeader"),v.hideSkeletalRibbon&&d.removeElementById("SkeletalRibbon"),v.hideSkeletalNavPane&&d.removeElementById("SkeletalNavpane"),this.R()}},{key:"bringFastViewToForegroundOfSkeletalCanvas",value:function(){var e=d.getElement("WACFastView");e&&(e.style.position="initial")}},{key:"removeAllSubunitsFromSkeletalCanvas",value:function(){var e=d.getElement("SkeletalCanvas");if(e)for(var t=e.children.length-1;t>=0;t-=1){var n=e.children.item(t);n&&"WACFastView"!==n.id&&e.removeChild(n)}}},{key:"fadeOutAndRemoveElement",value:function(e,t){var n=d.getElement(e);n&&(n.style.background="transparent",n.style.opacity="0",n.className+=" skeletalCover",window.setTimeout((function(){d.removeElement(n),t&&t()}),h.HideAnimationTime))}},{key:"setMainContentEditable",value:function(){if(!y){y=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");var e=document.getElementById("load_back");e&&(e.style.height="auto")}}}]),e}();function w(){var e=d.getElement("SkeletalExperience");return null!=e&&"rtl"===e.getAttribute("direction")}function _(e,t){window._bB&&window._bB.sendBeacon(e,t)}g.t=function(){return g.i()},g.i=function(){var e="";return w()?e="SkeletalFastViewRtl":(e="SkeletalFastView",v.isTwoPaneNavEnabled&&!v.isEmbedMode?e="SkeletalFastView":v.isEmbedMode||m<=h.MinWidthToShowNavpane?e="SkeletalFastViewNoNavpane":m<=h.MinWidthToShowPageColumnPane&&(e="SkeletalFastViewPageColumnNavpane")),v.isViewModeAndRibbonPanelLarge&&(e+=" SkeletalFastViewViewMode"),v.isEmbedMode&&(e+=" SkeletalFastViewEmbedMode"),e},g.A=function(){v.isCssPositionRewriteEnabled?g.P():g.O()},g.P=function(){g.O()},g.O=function(){var e=d.getElement("SkeletalMainContent");e&&!v.isCssPositionRewriteEnabled&&(e.className+=v.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),d.removeElementById("SkeletalRibbonExtension")},g.h=function(){if(!b)if(v.isViewMode)b=!0;else{document.getElementById("WACRibbonPanel")&&(b=!0);var e=document.getElementsByClassName("WACReadingBarPanel").item(0);e&&(e.style.display="none")}},g._=function(){if(!b){var e=document.getElementsByClassName("WACReadingBarPanel").item(0);if(v.isViewMode&&e)b=!0,v.isViewModeAndRibbonPanelLarge?e.className+=" RibbonPanelMaximizedViewMode":v.isViewModeAndRibbonPanelSmall&&(e.className+=" RibbonPanelMinimized");else{if(!v.regionComposerIsEnabled){var t=document.getElementById("WACRibbonPanel");null!=t&&(b=!0,v.isSimplifiedReactRibbonShown?(t.className+=" RibbonPanelSLRMode",t.className+=" RibbonPanelNewSLRMode"):v.isOldRibbonExpandedAndShown&&!v.isInTouchMode?t.className+=" RibbonPanelMaximized":v.isOldRibbonExpandedAndShown&&v.isInTouchMode?t.className+=" RibbonPanelMaximizedTouchMode":v.isOldRibbonCollapsedAndShown&&(t.className+=" RibbonPanelMinimized"))}e&&(e.style.display="none")}}},g.S=function(){var e=document.getElementById("WACDocumentPanelContent");null!=e&&(e.style.border="unset")},g.C=function(){var e=document.getElementById("WACDocumentPanel"),t=document.getElementById("WACDocumentPanelContent");null!=e&&(e.className+=" skeletalEnabled",v.isViewModeAndRibbonPanelLarge?e.style.top="40px":v.isViewModeAndRibbonPanelSmall?e.style.top="30px":v.isSimplifiedReactRibbonShown?e.style.top="77px":v.isOldRibbonCollapsedCookieOn||v.isInTouchMode||(e.style.top="124px"),w()?e.style.right="0px":v.isTwoPaneNavEnabled&&!v.isEmbedMode?m<h.MinWidthForTwoPaneNav?e.style.left=h.MinWidthToShowNavpane.toFixed()+"px":m<h.MinWidthToResizeTwoPaneNav?e.style.left=m.toFixed()+"px":e.style.left="426px":v.isEmbedMode||m<=h.MinWidthToShowNavpane?e.style.left="0px":m<=h.MinWidthToShowPageColumnPane?e.style.left="198px":v.isSnackbarNavPaneEnabled?e.style.left="426px":e.style.left="393px"),null!=t&&(t.style.border="unset")},g.R=function(){var e=d.getElement("SkeletalMainContent"),t=d.getElement("SkeletalExperience"),n=d.getElement("SkeletalRibbon");if(v.hideSkeletalHeader&&t&&(t.className+=" noHeader"),v.hideSkeletalRibbon&&t&&(t.className+=" noRibbon"),v.hideSkeletalNavPane&&t&&(t.className+=" noNavPane"),v.isViewMode?(t&&v.isCssPositionRewriteEnabled&&t.classList.remove("skeletalSLRGridRows"),n&&(n.innerHTML=""),v.isViewModeAndRibbonPanelSmall?(e&&!v.isCssPositionRewriteEnabled&&(e.style.top=v.isEmbedMode?"30px":"78px"),t&&v.isCssPositionRewriteEnabled&&(t.className+=" skeletalLegacyRibbonGridRows"),n&&!v.isCssPositionRewriteEnabled&&(n.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):v.isViewModeAndRibbonPanelLarge?(n&&!v.isCssPositionRewriteEnabled&&(n.className="skeletalRibbon skeletalRibbonExpandedViewMode"),v.isCssPositionRewriteEnabled&&t?t.className+=" skeletalReadingRibbonGridRows":!v.isCssPositionRewriteEnabled&&e&&(e.style.top=v.isEmbedMode?"40px":"88px")):t&&v.isCssPositionRewriteEnabled&&(t.className+=" skeletalReadingRibbonGridRows")):t&&!v.isSimplifiedReactRibbonShown&&v.isCssPositionRewriteEnabled&&(v.isOldRibbonExpandedAndShown&&!v.isInTouchMode?t.className+=" skeletalLegacyRibbonMaximizedGridRows":v.isOldRibbonExpandedAndShown&&v.isInTouchMode?t.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":v.isOldRibbonCollapsedAndShown&&(t.className+=" skeletalLegacyRibbonGridRows")),v.isSimplifiedReactRibbonShown?n&&(n.className=v.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):n&&v.isCssPositionRewriteEnabled&&(n.className="skeletalPositionRewriteRibbon",v.isViewMode&&(n.className+=" viewMode")),v.isEmbedMode){n&&(v.isCssPositionRewriteEnabled||(n.style.top="0px"));var i=d.getElement("SkeletalAdditionOldRibbon");i&&!v.isCssPositionRewriteEnabled&&(i.style.top="0px")}if(w()&&g.I(),v.isOldRibbonCollapsedAndShown?g.A():v.isOldRibbonExpandedAndShown&&v.isEmbedMode&&e&&!v.isCssPositionRewriteEnabled&&(e.style.top="125px"),v.isTwoPaneNavEnabled&&!v.isEmbedMode&&(m>h.MinWidthToShowNavpane||!v.isOneNoteNavPaneCollapseOnSmallScreenEnabled)){var r=d.getElement("SkeletalNavpane"),o=d.getElement("SkeletalNavpaneSectionColumn"),a=d.getElement("SkeletalNavpanePageColumn"),s=d.getElement("SkeletalCanvas"),u=d.getElement("SkeletalExperience");if(null!=r&&null!=o&&null!=a&&null!=s&&null!=u)if(m<=h.MinWidthForTwoPaneNav)v.isCssPositionRewriteEnabled?u.className+=" skeletalOreoTwopaneShrunkGridColumns":(r.style.width="300px",s.style.left="299px"),o.style.width="124px",a.style.width="124px";else if(m<=h.MinWidthToResizeTwoPaneNav){v.isCssPositionRewriteEnabled?u.style.gridTemplateColumns=m.toFixed()+"px 100%":(r.style.width=m.toFixed()+"px",s.style.left=m-1+"px");var c=.5*m-24;o.style.width=c.toFixed()+"px",a.style.width=c.toFixed()+"px"}}else if(v.isEmbedMode||m<=h.MinWidthToShowNavpane){d.removeElementById("SkeletalNavpane");var l=d.getElement("SkeletalCanvas"),f=d.getElement("SkeletalExperience");v.isCssPositionRewriteEnabled&&f&&!v.hideSkeletalNavPane?v.isTwoPaneNavEnabled?f.className+=" skeletalNoTwopaneGridColumns":f.className+=" skeletalNoNavpaneGridColumns":!v.isCssPositionRewriteEnabled&&l&&(l.style.left="0px")}else if(m<=h.MinWidthToShowPageColumnPane){var p=d.getElement("SkeletalNavpane"),y=d.getElement("SkeletalNotebookName"),b=d.getElement("SkeletalCanvas"),_=d.getElement("SkeletalExperience");d.removeElementById("SkeletalNavpaneSectionColumn"),d.removeElementById("skeletalNavpaneTab"),v.isCssPositionRewriteEnabled&&_?_.className+=" skeletalLegacyNavpanePageOnlyGridColumns":v.isCssPositionRewriteEnabled&&null!=p&&null!=b&&(p.style.width="201px",b.style.left="200px"),y&&(y.style.right="42px")}if(v.isSimplifiedReactRibbonShown&&null!=e)v.isCssPositionRewriteEnabled||(e.style.paddingTop=v.isEmbedMode?"74px":"126px",e.style.top="0px");else if(v.isOldRibbonCollapsedAndShown){var k=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),S=d.getElement("SkeletalRibbonBar");null!=e&&null!=S&&null!=k&&(d.removeElement(k),S.style.height="29px",S.style.borderBottom="1px solid #d2d2d2",v.isCssPositionRewriteEnabled||(e.style.top="0px"))}else if(v.isOldRibbonExpandedAndShown&&v.isInTouchMode){var C=d.getElement("SkeletalRibbonExtension");null==e||null==C||v.isCssPositionRewriteEnabled||(C.style.height="108px",e.style.top="187px")}},g.I=function(){var e=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(var t in e){var n=d.getElement(e[t]);n&&(n.className+=" skeletalRTL")}var i=d.getElement("SkeletalCanvas");i&&(i.className+=" skeletalCanvasRtl")},(0,e.objectAssignPolyfill)();var k=function(){function t(){_class_call_check(this,t)}return _create_class(t,null,[{key:"initialize",value:function(e,t){p.W=e,p.L||(t?(p.D=document.getElementById("SkeletalContainer"),p.L=!0):(p.L=!0,p.D=document.createElement("div"),p.D.setAttribute("unselectable","on"),Object.assign(p.D.style,{pointerEvents:"none",width:"100%",height:"100%",zIndex:"1000",position:"absolute",visibility:"hidden",transition:"opacity "+p.T+"ms"}),p.D.id=p.F,p.D.className=p.D.id))}},{key:"launchExperience",value:function(e,t,n){var i="applicationOuterContainer";e&&(i=e),t&&(p.M=t);var r=document.getElementById(i);n||r.appendChild(p.D),p.N(),window.setTimeout((function(){return p.dismissSkeletalBootUx()}),p.M)}},{key:"setComponentReady",value:function(e){var t=p.B(e);!p.V&&t&&(t.isReady=!0,p.U()||p.fadeOutAndRemove(e))}},{key:"dismissSkeletalBootUx",value:function(){if(p.V)return!1;for(var e in p.fadeOutAndRemove(p.F),p.H)p.fadeOutAndRemove(e);return p.H={},p.V=!0,self.dispatchEvent(new CustomEvent("RibbonVisible")),!0}},{key:"getSkeletalComponentColor",value:function(e,t){return e?t?"#3D3D3D":"#323130":t?"#EBEBEB":p.G}},{key:"getSkeletalBackgroundColor",value:function(e,t){return e?t?"#141414":"#252423":t?"#F5F5F5":p.q}},{key:"addComponent",value:function(e){p.H[e.element.id]=e,e.element.style.transition="opacity "+p.T+"ms",p.D.appendChild(e.element),this.J.push(e.element.id)}},{key:"addComponentOutsideSkeletalContainer",value:function(e){p.H[e.element.id]=e,e.element.style.transition="opacity "+p.T+"ms"}},{key:"addShimmerToElement",value:function(t){if(!(0,e.isReducedAnimations)()){var n=document.getElementById(t);if(n){this.K();var i=document.createElement("div");i.id=t+"_Shimmer",Object.assign(i.style,{height:"200px",top:"-200px",width:"100000%",left:"-99900%",backgroundColor:"linear-gradient(rgba(255,255,255, 0), rgba(255,255,255,.4), rgba(255,255,255,.8), rgba(255,255,255,.4), rgba(255,255,255,0))",position:"absolute",transformOrigin:"left",zIndex:"1000",animation:"SkeletalShimmer 3s infinite linear"}),n.appendChild(i)}}}},{key:"fadeOutAndRemove",value:function(e,t){var n=void 0,i=void 0;e===p.F?n=p.D:(i=p.B(e))&&(n=i.element),n&&(n.style.opacity="0",window.setTimeout((function(){p.X(n),i&&(p.Y(e),i.onRemoval&&i.onRemoval()),t&&t()}),p.T))}},{key:"isSkeletalDeepLink",value:function(){return p.W}},{key:"skeletalBootLoggingData",value:function(){return"isSkeletalBootShown: ".concat(this.Z,", skeletalComponentsAdded: ").concat(this.J)}}]),t}();p=k,k.L=!1,k.V=!1,k.M=3e4,k.F="SkeletalContainer",k.T=(0,e.isReducedAnimations)()?.001:200,k.H={},k.G="#EDEBE9",k.q="#F3F2F1",k.W=!1,k.$=!1,k.Z=!1,k.J=[],k.N=function(){p.D&&(p.D.style.visibility="visible",p.D.style.opacity="1",p.Z=!0)},k.ee=function(){for(var e in p.H)if(!p.H[e].isReady)return!1;return!0},k.U=function(){return!!p.ee()&&p.dismissSkeletalBootUx()},k.K=function(){if(!p.$){var e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode("@keyframes SkeletalShimmer {       100% { -webkit-transform: rotate(0.06deg); transform: rotate(0.06deg); }      }")),document.getElementsByTagName("head")[0].appendChild(e),p.$=!0}},k.B=function(e){return p.H[e]},k.Y=function(e){delete p.H[e]},k.X=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)};var S=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"ensureCookieCompliance",value:function(e,t){if(e){var n=[];t&&(n=JSON.parse(t)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(n))}}},{key:"getCookie",value:function(e){if(!e)return"";if(e.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]}},{key:"isDocumentEmpty",value:function(e){function t(e,t){return-1===(" "+e.className+" ").indexOf(" "+t+" ")}var n=e.querySelectorAll(".Paragraph");return!(!n||1!==n.length||2!==n[0].childElementCount||t(n[0].children[0],"TextRun")||t(n[0].children[1],"EOP")||""!==n[0].children[0].innerText)}}]),e}();function C(){function e(){return navigator.maxTouchPoints>0}return navigator.userAgent.indexOf("Android")>=0||navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&e()&&!(navigator.userAgent.indexOf("iPhone")>=0)||e()}var x="WACFastViewAbsolute",R="WACFastView",A="WACFastViewPositionRewrite";function P(e,t,n,i){var r;if(r=e.cssPositionRewriteIsEnabled&&!i?A:e.isRegionComposerShown&&!i?"".concat(R," regionComposer"):R,e.wordIsSkeletalDeepLinkOn&&e.isDeepLinkScenario&&(r+=" Deeplink"),e.showRibbon||(r+=" HideRibbon"),e.showNavPane||(r+=" HideNavPane"),e.isOneNoteMobileViewerNavigationEnabled&&(r+=" ShowMobileViewerNavigation"),e.positionAbsolute){if(r+=" "+x,e.showRibbon?e.showRibbonHeader||(r+=" HeaderHidden"):r+=" HeaderAndRibbonHidden",e.showNavPane?e.showNavSections||(r+=" SectionsHidden"):r+=" NavHidden",e.simplifiedReactRibbonUxIsEnabled)r+=" OneLineRibbon",r+=" OneLineRibbonWithTabHeaderRefresh",e.bootToTabsOnly&&(r+=" TabsOnly");else{var o=t(e.ribbonPreferenceCookieName);(!e.ribbonExpandedByDefault&&"false"===o||e.ribbonExpandedByDefault&&"true"!==o)&&(r+=" RibbonPinned",n&&(r+=" Touch"))}e.skeletalBootUXIsEnabled&&(r+=" "+g.getFastViewSkeletalClass()),e.snackbarNavPaneIsEnabled&&(r+=" Snackbar"),e.twoPaneNavIsEnabled&&(r+=" TwoPaneNav")}return r}function O(){var e=document.getElementById("load_img");e&&(e.style.opacity="0",e.style.height="1px");var t=document.getElementById("load_back");t&&(t.style.opacity="0",t.style.height="1px"),function(){var e,t=window.performance&&window.performance.now?window.performance.now():0;if(t>0&&window.g_splashScreenShownHighResTime>0){var n=t-window.g_splashScreenShownHighResTime;e="{'k':[{'e': 3,'n':'BBISS', 'd': ".concat(n,", 'p':{'DismissedFrom':'FastView'}}]}")}else e="{'k':[{'e': 3,'n':'BBISS', 'p':{'DismissedFrom':'FastView'}}]}";_(e,"Kpi")}()}function E(){var e=document.getElementById("SkeletalPage");e&&(e.style.display="none",k.setComponentReady("SkeletalPage"))}function I(e,t){if(!(t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario||0===f.initialParaId)){var n=document.querySelector("p[paraid='"+f.initialParaId+"']");if(!n||!n.getBoundingClientRect)return;var i=n.getBoundingClientRect().bottom,r=e.getBoundingClientRect().bottom;e.firstElementChild&&(e.firstElementChild.scrollTop=i-r+70)}}function W(){var e=document.getElementById("application");e&&(e.style.top="0")}var L,D=function(e,t){return t};function T(e){L=e;try{JSON.parse(M("DisabledChangeGates","{}"))}catch(e){}}function F(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!L&&!!L[e]&&"true"===L[e].toLowerCase()||function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t}(e,t)}function M(e,t){return L&&L[e]?L[e]:t}var N=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"launchExperience",value:function(t){v.initialize("false"===t.IsEditMode,"true"===t.IsEmbedMode,"true"===t.SimplifiedReactRibbonUxIsEnabled,t.RibbonPreferenceCookieNameHint,t.IsSimplifiedRibbonOnCookieName,"true"===t.SnackbarNavPaneIsEnabled,"true"===t.OneNoteTwoPaneNavPaneIsEnabled,"true"===t.OneNoteCssPositionRewriteIsEnabled,"true"===t.HideHeaderEmbedded,"true"===t.HideRibbonEmbedded||"true"===t.IsQuickNote,"true"===t.ONHideNavEmbedded,"true"===t.MobileEmbedViewer,"true"===t.PageSSRHostRenderingIsEnabled,t.PostMessageOrigin,"true"===t.OneNoteModeSwitcherIsEnabled,"true"===t.OneNoteNavPaneCollapseOnSmallScreenIsEnabled,"true"===t.RegionComposerIsEnabled),g.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((function(){e.dismissSkeletalBootUx(!0)}),this.FORCE_DISMISS_AFTER)}},{key:"showSkeletalUx",value:function(){var e=d.getElement("SkeletalExperience");if(e){var t=d.getElement("SkeletalCanvas");"true"===M("MobileEmbedViewerIsEnabled","false")&&t&&(t.style.left="-28px"),e.style.opacity="1",e.className+=" skeletalShow"}}},{key:"setRibbonReady",value:function(){this.V||(this.te=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.ne&&g.fadeOutAndRemoveElement("SkeletalRibbon",(function(){self.dispatchEvent(new CustomEvent("RibbonVisible"))})))}},{key:"setPageReady",value:function(){this.V||(g.updateRibbonPanel(),g.updateWacDocumentPanel(),this.ne=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())}},{key:"setNavpaneReady",value:function(){this.V||(g.updateRibbonPanel(),this.ie=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.ne&&g.fadeOutAndRemoveElement("SkeletalNavpane",(function(){g.setMainContentEditable()})))}},{key:"sendPostMessageToHostWindowRendering",value:function(){var e=this;window.requestAnimationFrame((function(){window.requestAnimationFrame((function(){if(!e.re){var t=window.parent,n={MessageId:"App_SwitchToWacFrame",SendTime:(new Date).getTime(),CorrelationId:"",Values:{entryPoint:"FastView"}};""!==v.postMessageOrigin&&t.postMessage(JSON.stringify(n),v.postMessageOrigin),e.re=!0}}))}))}},{key:"setFastViewReady",value:function(){this.V||(v.isHostRenderingEnabled?this.dismissSkeletalCanvas(this.sendPostMessageToHostWindowRendering.bind(this)):this.dismissSkeletalCanvas())}},{key:"showFastViewOnSkeletalCanvas",value:function(){var e=this;if(g.bringFastViewToForegroundOfSkeletalCanvas(),g.removeAllSubunitsFromSkeletalCanvas(),v.isHostRenderingEnabled){var t=document.querySelector(".skeletalShow");t&&t.addEventListener("animationend",(function(){e.sendPostMessageToHostWindowRendering()})),window.setTimeout((function(){e.sendPostMessageToHostWindowRendering()}),this.POST_MESSAGE_FOR_HOST_RENDERING)}}},{key:"tryDismissSkeletalBootUxIfAllComponentsReady",value:function(){return!!(this.ne&&this.ie&&this.te)&&this.dismissSkeletalBootUx()}},{key:"dismissSkeletalBootUx",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.V)return!1;var n=document.getElementById("load_back"),i=document.getElementById("WACDocumentPanel"),r=document.getElementById("WACRibbonPanel");return n&&i&&r?(e.removeSkeletalExperience(),e.adjustElementsAfterSkeletalDismissal(n,i,r),this.V=!0,!0):(t&&e.removeSkeletalExperience(),!1)}},{key:"removeSkeletalExperience",value:function(){var e=d.getElement("SkeletalExperience");e&&d.removeElement(e)}},{key:"adjustWacRibbonAfterDismissSkeletal",value:function(e){v.regionComposerIsEnabled?e.style.height="100%":v.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(e):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(e)}},{key:"adjustPositionRewriteWacRibbonAfterDismissSkeletal",value:function(e){e.style.height="auto"}},{key:"adjustAbsoluteWacRibbonAfterDismissSkeletal",value:function(e){v.isSimplifiedReactRibbonShown?e.style.height="77px":e.style.height="auto"}},{key:"adjustWacCanvasAfterDismissSkeletal",value:function(e){v.isCssPositionRewriteEnabled&&v.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(e)}},{key:"adjustAbsoluteWacCanvasAfterDismissSkeletal",value:function(e){e.className="SkeletalWacDocumentPanel skeletalEnabled "+e.className}},{key:"dismissSkeletalCanvas",value:function(e){var t=this,n=document.getElementById("WACFastView");if(!this.V||n&&n.parentElement&&"SkeletalCanvas"===n.parentElement.id){this.ne=!0;var i=document.getElementById("load_back");null!=i&&(this.preDismissSkeletalCanvas(i),g.fadeOutAndRemoveElement("SkeletalCanvas",(function(){e&&e(),t.ie&&g.setMainContentEditable()})))}}},{key:"preDismissSkeletalCanvas",value:function(e){v.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(e):this.preDismissAbsoluteSkeletalCanvas(e)}},{key:"preDismissPositionRewriteSkeletalCanvas",value:function(e){this.preDismissAbsoluteSkeletalCanvas(e)}},{key:"preDismissAbsoluteSkeletalCanvas",value:function(e){var t=document.getElementById("WACRibbonPlaceholder"),n=d.getElement("SkeletalRibbonExtension");if(null!=t&&null!=n&&(t.style.height="124px"),e.style.background="transparent",w()){var i=document.getElementById("application");i&&(i.style.minWidth="0px")}if(!v.isEmbedMode){var r=document.getElementById("AppHeaderPanel");r&&(r.style.height="48px")}}},{key:"adjustElementsAfterSkeletalDismissal",value:function(e,t,n){e&&(e.style.display="none",e.style.height="1px",e.style.opacity="0",e.setAttribute("aria-hidden","true"),g.clearAriaLoadingAttributes()),t&&this.adjustWacCanvasAfterDismissSkeletal(t),n&&this.adjustWacRibbonAfterDismissSkeletal(n)}}]),e}();N.te=!1,N.ne=!1,N.ie=!1,N.V=!1,N.re=!1,N.FORCE_DISMISS_AFTER=2e4,N.POST_MESSAGE_FOR_HOST_RENDERING=500;var B=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"getFloatingObjectsContainerWidth",value:function(){return this.canvasAndFcOuterSurfaceOffset+this.floatingContainersOuterSurfaceWidth}},{key:"shouldShiftFastView",value:function(t,n,i){return e.shouldShiftBasedOnScreenSize(i)&&e.shouldShiftBasedOnNumSections(n)&&t}},{key:"shouldShiftRealCanvas",value:function(t,n,i,r,o){if(!e.shouldShiftBasedOnScreenSize(t))return!1;var a=n(i);return!!e.shouldShiftBasedOnNumSections(a)&&r(o)}},{key:"shouldShiftBasedOnScreenSize",value:function(e){return"Small"!==e}},{key:"shouldShiftBasedOnNumSections",value:function(e){return 1===e}}]),e}();B.canvasAndFcOuterSurfaceOffset=30,B.floatingContainersOuterSurfaceWidth=240;var j=function(){return!!window&&!!window.performance&&!!window.performance.mark};function V(){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver}function U(e){return V()&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}var H=function(e){if(j())try{window.performance.mark(e)}catch(e){}};function z(e,t,n){if(j()&&window.performance.measure)try{window.performance.measure(e,t,n)}catch(e){}}var G=function e(t,n){_class_call_check(this,e),this.eventName=t,this.timeStamp=(new Date).getTime()-n},q=function(){function t(e,n,i,r){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Default",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:S.getCookie,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:function(e){};_class_call_check(this,t),this.getTopbarContainerFunc=e,this.getRibbonContainerFunc=n,this.getDocumentContainerFunc=i,this.appearance=r,this.entry=a,this.getCookieFunc=s,this.fastViewOnSkeletal=u,this.hasUnresolvedComments=c,this.numSections=l,this.displayToastFunc=f,this.oe=C(),this.ae=function(e){"Shift"!==e.key&&"Control"!==e.key&&"Alt"!==e.key&&(o.se(),o.ue(e.type))},this.ce=function(e){(13===e.keyCode||e.ctrlKey&&(66===e.keyCode||73===e.keyCode||85===e.keyCode))&&(e.preventDefault(),o.se(),o.ue(e.key))},this.le=function(e){if(void 0!==o.isEditable&&void 0!==o.htmlElement&&void 0!==o.fe&&o.isEditable&&o.appearance.pasteLoadingUI&&!o.isPasteLoading&&o.htmlElement.parentElement){o.isPasteLoading=!0;var t=function(e){var t=document.createElement("div");t.id="WACLoadingPasteUI";var n=document.createElement("div");n.className="WACFastLoadingBoxUI";var i,r=document.createElement("img");return r.src=e,r.className="WACProgressIcon",n.appendChild(r),t.appendChild(n),t.appendChild(((i=document.createElement("div")).className="WACFastLoadingOverlay WACDialogOverlay",i)),t.setAttribute("aria-busy","true"),t.setAttribute("role","progressbar"),t}(o.appearance.loadingUIGif);o.htmlElement.parentElement.appendChild(t),o.pasteData=function(e){var t={};if(null!=e&&null!=e.types){var n=e.types[0];t.type=n,t.data=e.getData(n)}else{var i=window.clipboardData,r=i.getData("text");null!==r?(t.type="text/plain",t.data=r):i.files.length>0&&(t.type="image/png",t.data=i.files[0])}return t}(e.clipboardData),o.fe.removeAttribute("contentEditable"),e.preventDefault()}else o.de(e);o.se()},this.de=function(e){o.ue(e.type),e.preventDefault()},this.ue=function(e){o.eventLogs&&o.openTime&&o.eventLogs.push(new G(e,o.openTime))},this.se=function(){o.appearance.isBrowserSideCacheEnabled&&(o.displayToastFunc(o.appearance.isRtl),o.ue("Toast shown"))},this.he=function(e){if(o.se(),o.ue(e.type),o.fe&&e.target!==o.fe){if(o.fe.focus(),window.getSelection){var t=window.getSelection();t&&t.collapseToEnd()}e.preventDefault()}},this.ve=function(e){var t=e.querySelector(".PageContentContainer");t&&(t.className+=" WACFastViewEditor",t.addEventListener("mousedown",(function(e){o.he(e)}))),o.fe=e.querySelector(".NormalTextRun"),o.fe&&(o.fe.contentEditable="true",o.fe.style.outline="0px",o.fe.spellcheck=!1,o.fe.setAttribute("aria-hidden","true"),o.fe.focus(),o.fe.addEventListener("paste",(function(e){o.le(e)})),o.fe.addEventListener("keydown",(function(e){o.ce(e)})))},this.pe=function(e){_(e,"BootPhaseCompleted")},this.me=function(e){if(null!=e){var t=e.querySelector(".OutlineContainer"),n=e.querySelector(".PageContentContainer");if(null!=t&&null!=n){var i=document.createElement("div"),r=B.getFloatingObjectsContainerWidth()+"px";o.appearance.isRtl?i.style.paddingLeft=r:i.style.paddingRight=r,n.appendChild(i),i.appendChild(t)}}},this.ye=function(){o.appearance.positionAbsolute&&o.appearance.showRibbon&&!o.be&&!o.appearance.skeletalBootUXIsEnabled&&(o.showRibbonPlaceholder(),o.be=!0)},this.eventLogs=[],this.openTime=0,this.hasShifted=!1}return _create_class(t,[{key:"removeKeypressEventListener",value:function(){this.appearance.fixRemoveKeypressEventListenerInFastView?document.removeEventListener("keydown",this.ae):this.ge&&document.removeEventListener("keydown",this.ge)}},{key:"showRibbonPlaceholder",value:function(){var e=this;function t(e,t){var n=document.createElement("div");return n.className="ribbonBar",n.setAttribute("unselectable","on"),n.appendChild(e),t&&n.appendChild(t),n}if(!document.getElementById("ExternalHeaderFullTopBars")){var n=this.getTopbarContainerFunc(),i=this.appearance.showHeaderPlaceholder?document.getElementById("HeaderPlaceholder"):void 0;if(n&&this.appearance.showRibbonHeader)if(i)this.topbarPlaceholderElement=i;else{var r=document.createElement("div");r.className="cui-topBar2",this.appearance.darkModeEnabled&&(r.className+=" SharedUXDarkModeFastViewHeader"),r.setAttribute("unselectable","on");var o=document.createElement("div");o.id="WACTopbarPlaceholder";var a=function(){var t=document.createElement("div");t.className="cui-topBar1",e.appearance.reactSharedHeaderIsEnabled?t.className+=" cui-topBar1-transitionalReactHeaderUI":t.className+=" cui-topBar1-transistionalHeaderUI",e.appearance.darkModeEnabled&&(t.className+=" SharedUXDarkModeFastViewHeader"),t.setAttribute("unselectable","on");var n="",i="";e.appearance.headerBackgroundColorOverride&&(n="background-color:".concat(e.appearance.headerBackgroundColorOverride,";")),e.appearance.headerTextColorOverride&&(i="color:".concat(e.appearance.headerTextColorOverride,";")),e.appearance.reactSharedHeaderIsEnabled&&(n||i)&&t.setAttribute("style","".concat(n).concat(i));var r=document.createElement("span");r.className="cui-QATRowLeft BreadcrumbContainer";var o=document.createElement("span");o.className="AppAndBrandContainer",e.appearance.reactSharedHeaderIsEnabled&&n&&o.setAttribute("style",n);var a=document.createElement("div");a.className="WACFastBootLoader";var s=document.createElement("span");s.className="BreadcrumbItem";var u=e.appearance.reactSharedHeaderIsEnabled&&e.appearance.headerAppLauncherIsHidden;u?s.setAttribute("style","width:8px;height:48px;display:inline-block;"):s.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";var c=document.createElement("span");return c.className="headBrand",e.appearance.reactSharedHeaderIsEnabled?c.setAttribute("style","line-height:48px;margin-left:2px;"):c.setAttribute("style","line-height:48px;"),c.appendChild(document.createTextNode(e.appearance.appBrandedName)),o.appendChild(s),o.appendChild(c),u||o.appendChild(a),r.appendChild(o),t.appendChild(r),e.appearance.appColorUpdateIsEnabled&&(t.className+=" cui-color-update",o.className+=" cui-color-update"),t}();o.appendChild(a),o.appendChild(r),n.appendChild(o),this.topbarPlaceholderElement=o}var s,u,c,l,f,d=this.getRibbonContainerFunc();if(d&&0===d.children.length){var h=document.createElement("div");if(h.id="WACRibbonPlaceholder",h.className=h.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled){var v=(s=this.appearance.simplifiedReactRibbonAnimationIsEnabled,u=this.appearance.reactMultiLineRibbonIsVisible,c=this.appearance.bootToTabsOnly,(f=document.createElement("div")).className=s?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",f.className+=" oneLineRibbonUpperWithTabHeaderRefresh",c||((l=document.createElement("div")).className=s?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower"),e.appearance.darkModeEnabled&&(f.className+=" SharedUXDarkModeFastViewRibbon",l&&(l.className+=" SharedUXDarkModeFastViewRibbon")),u&&l&&(l.style.height="90px"),t(f,l));v.addEventListener("click",(function(){e.se(),e.ue("ribbonClick")})),h.appendChild(v)}else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){var p=function(e,n){var i=document.createElement("div");i.className="ribbonUpper";var r=document.createElement("div");r.className="ribbonLower";var o=document.createElement("div");o.className="ribbonLeft";var a=function(e,t){var n=t;return e&&(n=t.replace("bgapp_word_topleft","bgapp_word_topleft_touch")),n}(e,n);return o.style.backgroundImage="url('".concat(a,"')"),e&&(r.className+=" ribbonTouch",o.className+=" ribbonTouch"),i.appendChild(o),t(i,r)}(this.oe,this.appearance.ribbonImageBase);p.addEventListener("click",(function(){e.se(),e.ue("ribbonClick")})),h.appendChild(p)}else h.style.height="30px";else h.className="cui-exth";d.appendChild(h),this.ribbonPlaceholderElement=h}}}},{key:"open",value:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.appearance.showRibbonHeader||W(),this.ye();var r=this.getDocumentContainerFunc();if(!r||!t)return!1;var o="canvasWrap"===r.id,a=document.createElement("div"),s=P(this.appearance,this.getCookieFunc,this.oe,o);this.appearance.isRegionComposerShown&&(s+=" WACFastViewRegionComposer"),this.appearance.reactMultiLineRibbonIsVisible&&(s+=" WACFastViewMLRVisible"),a.className=s,a.id="WACFastView";var u=document.getElementById("CachedViewThemedCanvasBackgroundContainer");if(this.appearance.isBrowserSideCacheEnabled&&u?(r.removeChild(u),a.appendChild(u),u.innerHTML=t):a.innerHTML=t,this.appearance.isOneNoteCanvasZoomEnabled&&this.appearance.currentZoomLevel&&1!==this.appearance.currentZoomLevel){var c=a.querySelector(".PageContentOrigin");null!==c&&(c.style.transform="scale(".concat(this.appearance.currentZoomLevel,")"))}if(this.htmlElement=a,this.appearance.editable&&(this.isEditable=S.isDocumentEmpty(a)),i)a.style.visibility="hidden";else{this.appearance.fixRemoveKeypressEventListenerInFastView?document.addEventListener("keydown",this.ae):(this.ge=this.ae,document.addEventListener("keydown",(function(e){n.ge&&n.ge(e)})));var f=function(e){n.ue(e.type),n.se()};a.firstChild&&(a.firstChild.addEventListener("scroll",f),a.firstChild.addEventListener("click",f),a.firstChild.addEventListener("dblclick",f),a.firstChild.addEventListener("contextmenu",(function(e){n.se(),n.de(e)})),o&&a.firstChild.classList.add("WACFastViewNavOreoGrid")),B.shouldShiftFastView(this.hasUnresolvedComments,this.numSections,e.getLayoutBreakpoint())?(this.ue("Shifting Fast View"),this.appearance.isBrowserSideCacheEnabled||this.me(a),this.hasShifted=!0):this.ue("Not shifting Fast View"),this.ue("HasUnresolvedComments: "+this.hasUnresolvedComments+", NumSections == 1: "+(1===this.numSections)+", ScreenSize == Small: "+("Small"===e.getLayoutBreakpoint())),r.appendChild(a),navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?N.showFastViewOnSkeletalCanvas():l.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?N.setFastViewReady():(O(),this.appearance.isNewSkeletalUXExperienceEnabled&&E())),I(a,this.appearance),this.pe("RecordContentDisplayed"),this.isEditable&&(a.className+=" WACFastViewEditable",this.ve(a),this.pe("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),H("ViewableEnd"),z("Viewable","StartWacBoot","ViewableEnd"),!0}},{key:"isOpen",value:function(){return!(!this.htmlElement||!this.htmlElement.parentNode)}}]),t}();q.cssClass=R,q.cssPositionRewriteClass=A,q.cssClassAbsolute=x;var J=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"initialize",value:function(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",e.handleVisibilityChange)}},{key:"stop",value:function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)}},{key:"handleVisibilityChange",value:function(){var t={visibility:document.visibilityState,time:new Date};e.metrics.events.push(t)}}]),e}();J.initialize();var K,X=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";_class_call_check(this,e),this.we=t,this._e=n,this.ke=i}return _create_class(e,[{key:"result",get:function(){return this.we}},{key:"isSuccess",get:function(){return this._e}},{key:"errorMessage",get:function(){return this.ke}}]),e}();!function(e){e.DocumentCacheItemCacheMiss="CacheMiss",e.DocumentCacheItemInvalidSchemaVersion="InvalidSchemaVersion",e.DocumentCacheItemExpired="CacheExpired",e.DocumentCacheItemInvalidColorViewMode="InvalidColorView",e.DocumentCacheItemInvalidCanvasViewMode="InvalidCanvasView",e.DocumentCacheItemValid="CacheValid"}(K||(K={}));var Q=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"validateDocumentCacheItem",value:function(t,n){return t?Date.now()-t.timeStamp>=e.TIMEOUT_IN_MILLISECONDS?K.DocumentCacheItemExpired:t.schemaVersion!==n?K.DocumentCacheItemInvalidSchemaVersion:K.DocumentCacheItemValid:K.DocumentCacheItemCacheMiss}},{key:"validateDocumentCacheItemViewMode",value:function(e,t,n){return e?e.isPaginatedView!==t?K.DocumentCacheItemInvalidCanvasViewMode:e.isDarkCachedView!==n?K.DocumentCacheItemInvalidColorViewMode:K.DocumentCacheItemValid:K.DocumentCacheItemCacheMiss}},{key:"validateDocumentCacheItemColorViewModeOnly",value:function(e,t){return e?e.isDarkCachedView!==t?K.DocumentCacheItemInvalidColorViewMode:K.DocumentCacheItemValid:K.DocumentCacheItemCacheMiss}}]),e}();Q.MILLISECONDS_IN_A_DAY=864e5,Q.TIMEOUT_IN_DAYS=30,Q.TIMEOUT_IN_MILLISECONDS=Q.TIMEOUT_IN_DAYS*Q.MILLISECONDS_IN_A_DAY,Q.LOG_CATEGORY="DocumentCacheUtilsLogs";var Y=r(830),Z=r.n(Y),$=function e(t,n,i,r,o,a,s,u){_class_call_check(this,e),this.documentViewport=t,this.timeStamp=n,this.schemaVersion=i,this.isPaginatedView=r,this.documentItemSize=o,this.hasUnresolvedComments=a,this.numSections=s,this.isDarkCachedView=u},ee=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"executeStorageAction",value:function(e,t,n){try{return e()}catch(e){return new X(n,!1,"Unexpected error in "+t+": "+(e.message||"Unknown"))}}},{key:"getAndLoadDocumentCache",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.executeStorageAction((function(){return t.loadDocumentCache(n)}),this.LOAD_LOG_CATEGORY,e.defaultDocumentCacheItem)}},{key:"getLoadedDocumentCacheItem",value:function(t){if(!t.getDocumentBrowserCache().isSupported())return _("Cache is not supported",e.LOAD_LOG_CATEGORY),null;var n=null;try{n=t.getDocumentCacheItemFromStorage(),_("getDocumentCacheItemFromStorage result: ".concat(n),e.LOAD_LOG_CATEGORY)}catch(t){_("Exception in DocumentCacheLoader: "+t.message,e.LOAD_LOG_CATEGORY)}return n}},{key:"saveDocument",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return this.executeStorageAction((function(){return e.saveDocument(t,n,i,r,o,a,s)}),this.SAVE_LOG_CATEGORY,"")}},{key:"evictInvalidCacheEntries",value:function(t){try{var n=t.evictInvalidCacheItems();_("DocumentCacheRemover.evictInvalidCacheEntries result: ".concat(n),e.REMOVE_LOG_CATEGORY)}catch(t){_("Exception in DocumentCacheRemover.evictInvalidCacheEntries: "+t.message,e.REMOVE_LOG_CATEGORY)}}},{key:"evictSpecifiedCacheItem",value:function(t,n){try{var i=t.evictSpecifiedCacheItem(n);_("DocumentCacheRemover.evictSpecifiedCacheItem result: ".concat(i),e.REMOVE_LOG_CATEGORY)}catch(t){_("Exception in DocumentCacheRemover.evictSpecifiedCacheItem: "+t.message,e.REMOVE_LOG_CATEGORY)}}},{key:"evictAllCacheItems",value:function(t){try{var n=t.evictAllCacheItems();_("DocumentCacheRemover.evcitAllCacheItem result: ".concat(n),e.REMOVE_LOG_CATEGORY)}catch(t){_("Exception in DocumentCacheRemover.evictAllCacheItems: "+t.message,e.REMOVE_LOG_CATEGORY)}}}]),e}();ee.LOAD_LOG_CATEGORY="GetAndLoadDocumentCache",ee.SAVE_LOG_CATEGORY="SaveDocument",ee.REMOVE_LOG_CATEGORY="RemoveInvalidDocumentCacheItem",ee.defaultDocumentCacheItem=new $("",0,"",!1,0,!1,0,!1);var te=function(){function e(t,n,i,r,o,a,s){_class_call_check(this,e),this.documentCacheItem=null,this.documentBrowserCache=t,this.documentId=n,this.currentSchemaVersion=i,this.isPaginatedMode=r,this.isDarkCanvasBackground=o,this.createDarkModeThemeContainer=a,this.toastMessage=s}return _create_class(e,[{key:"getDocumentBrowserCache",value:function(){return this.documentBrowserCache}},{key:"loadDocumentCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getDocumentCacheItemFromStorage(),n=Q.validateDocumentCacheItem(t,this.currentSchemaVersion);if(n===K.DocumentCacheItemValid&&(n=e?Q.validateDocumentCacheItemColorViewModeOnly(t,this.isDarkCanvasBackground):Q.validateDocumentCacheItemViewMode(t,this.isPaginatedMode,this.isDarkCanvasBackground)),n!==K.DocumentCacheItemValid)return new X(ee.defaultDocumentCacheItem,!1,n);if((null==t?void 0:t.isDarkCachedView)&&!this.createDarkModeThemeContainer())throw"DarkModeThemeContainer creation failed";var i=window.self.g_instantApp;if(!i||!t)throw"Instant app is null";var r=Z().sanitize(t.documentViewport);return i.launchFastView(r,!1,t.hasUnresolvedComments,t.numSections,this.toastMessage),new X(t,!0)}},{key:"getDocumentCacheItemFromStorage",value:function(){if(this.documentCacheItem)return this.documentCacheItem;var e=this.documentBrowserCache.getCacheKey(this.documentId);return this.documentCacheItem=this.documentBrowserCache.getDocumentCacheItem(e),this.documentCacheItem}}]),e}();te.MILLISECONDS_IN_A_DAY=864e5,te.TIMEOUT_IN_DAYS=30,te.LOG_CATEGORY="CanvasLoaderLogs";var ne=function(){function e(t,n){_class_call_check(this,e),this.documentBrowserCache=t,this.currentSchemaVersion=n}return _create_class(e,[{key:"evictInvalidCacheItems",value:function(){for(var e=this.documentBrowserCache.getKeysInCache(),t=0,n=0;n<e.length;n++){var i=e[n],r=this.documentBrowserCache.getDocumentCacheItem(i);Q.validateDocumentCacheItem(r,this.currentSchemaVersion)!==K.DocumentCacheItemValid&&(this.documentBrowserCache.removeDocumentCacheItem(i),t++)}return t}},{key:"evictSpecifiedCacheItem",value:function(e){var t=this.documentBrowserCache.getCacheKey(e);return!!this.documentBrowserCache.getDocumentCacheItem(t)&&(this.documentBrowserCache.removeDocumentCacheItem(t),!0)}},{key:"evictAllCacheItems",value:function(){return this.documentBrowserCache.clearBrowserCache()}}]),e}(),ie="UnavailabilityToast",re=function(){function e(t,n,i,r,o,a){_class_call_check(this,e),this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=null!=a&&a,this.isRTL=r,this.elementsMargin=r?"margin-left: 8px;":"margin-right: 8px;",this.toastIconElement=this.createToastIcon(o),this.toastElement=this.createToastContainer(),this.setTitle(n),this.setMessage(i),t.appendChild(this.toastElement)}return _create_class(e,[{key:"setVisibility",value:function(e){this.toastElement.style.visibility=e?"visible":"hidden"}},{key:"dispose",value:function(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)}},{key:"setTitle",value:function(e){e?this.toastTitleElement?this.toastTitleElement.innerText=e:(this.toastTitleElement=this.createToastTitle(e),this.toastElement.appendChild(this.toastTitleElement)):this.toastTitleElement&&(this.toastElement.removeChild(this.toastTitleElement),this.toastTitleElement=void 0)}},{key:"setMessage",value:function(e){e?this.toastMessageElement?this.toastMessageElement.innerText=e:(this.toastMessageElement=this.createToastMessage(e),this.toastElement.appendChild(this.toastMessageElement)):this.toastMessageElement&&(this.toastElement.removeChild(this.toastMessageElement),this.toastMessageElement=void 0)}},{key:"setIcon",value:function(e,t){this.hasSpinner=!!t,this.toastElement.removeChild(this.toastIconElement),this.toastIconElement=this.createToastIcon(e),this.toastElement.insertBefore(this.toastIconElement,this.toastElement.firstChild)}},{key:"createToastContainer",value:function(){var e=document.createElement("div");return e.id=ie,e.setAttribute("role","alert"),e.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;\n      border: 2px solid transparent;'),e.appendChild(this.toastIconElement),e}},{key:"createToastIcon",value:function(e){var t=document.createElement("span");if(t.id="UnavailabilityToastIcon",this.hasSpinner)!function(e,t){var n=document.createElement("div");n.id="UnavailbilitySpinner",n.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),t?n.style.marginLeft="7px":n.style.marginRight="7px";var i=document.createElement("style");i.type="text/css";var r=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");i.appendChild(r),n.appendChild(i),e.appendChild(n)}(t,this.isRTL);else{var n=null!=e?e:this.OpenWorkbookIcon;t.setAttribute("style",'display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,'.concat(n,'");')+this.elementsMargin)}return t}},{key:"createToastTitle",value:function(e){var t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t}},{key:"createToastMessage",value:function(e){var t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t}}]),e}(),oe=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"createInstance",value:function(e,t,n,i,r,o){return new re(e,t,n,i,r,o)}}]),e}(),ae=r(108),se=r(591),ue=r(284);function ce(e,t){return e?t(e)?e:ce(e.parentElement,t):null}var le,fe=r(936),de={},he=function(e){var t,n;return n=function(){return t=M(e,""),new Set(t.toLowerCase().trim().split(",").map((function(e){return e.trim()})).filter((function(e){return Boolean(e)})));var t},de[t=e]&&de[t].size||(de[t]=n()),de[t]},ve=function(e,t){return"string"==typeof t?function(e,t){return e.indexOf(t)>-1}(e,t):function(e,t){return t.filter((function(t){return ve(e,t)})).length>0}(e,t)},pe=["SharedOnline.","WordOnline.","ExcelOnline.","PowerPointOnline.","OneNoteOnline.","VisioOnline."],me=function(e){!function(e){if(!function(e){return function(e){return pe.filter((function(t){return 0===e.indexOf(t)&&e.length>t.length})).length>0}(e)&&ve(e,".ChangeGate.")}(e)){var t="Change Gate Name validation failed: ".concat(e," should follow change gate naming convention.");throw ae.Hv.shipAssertTag(538972812,se.n.msoulscat_Wac_Ribbon,!1,t),Error(t)}}(e);var t=e.toLowerCase();return!!D(0,"").toLowerCase().includes(t)||!D(0,"").toLowerCase().includes(t)&&!he("SharedUxSafeVelocityStoppedGates").has(t)&&(0,fe.isChangeGateEnabled)(e)},ye=function(){function e(){_class_call_check(this,e),this.toast=void 0,this.isVisible=!1}return _create_class(e,[{key:"showToast",value:function(e,t,n,i,r,o,a,s){if(!this.isToastVisible()||s){if(this.toast)this.toast.setIcon(i,r),this.toast.setTitle(e),this.toast.setMessage(t);else{var u=document.createElement("div");u.setAttribute("style",function(e){return"position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: ".concat(e?"40px":"8px",";\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;")}(o)),document.body.appendChild(u),this.toast=oe.createInstance(u,e,t,n,i,r),requestAnimationFrame((function(){u.style.opacity="1"}))}this.isToastVisible()||(this.toast.setVisibility(!0),this.isVisible=!0),this.logToastVisibilityChange(!0,a),this.displayTime=window.performance.now()}}},{key:"dismissToast",value:function(e){var t;this.isToastVisible()&&(null===(t=this.toast)||void 0===t||t.setVisibility(!1),this.isVisible=!1,this.logToastVisibilityChange(!1,e),this.displayTime=void 0)}},{key:"isToastVisible",value:function(){var e,t;return me("SharedOnline.ChangeGate.IsToastVisibleModified")?this.isVisible||"visible"===(null===(t=document.getElementById(ie))||void 0===t?void 0:t.style.visibility)&&!ce(document.getElementById(ie),(function(e){return"none"===getComputedStyle(e).display})):this.isVisible||"visible"===(null===(e=document.getElementById(ie))||void 0===e?void 0:e.style.visibility)}},{key:"logToastVisibilityChange",value:function(e,t){var n="Unavailability Toast Visibility Changed: ".concat(e?"Shown":"Dismissed");!e&&this.displayTime&&(n+=", Duration Visible: ".concat(Math.trunc(window.performance.now()-this.displayTime))),t&&(n+=", Kind: ".concat(t)),ae.Hv.sendTraceTag(537249949,se.n.msoulscat_Wac_Telemetry,ue.k.Info,n)}}],[{key:"getInstance",value:function(){return le||(le=new e),le}}]),e}(),be=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"showToast",value:function(e,t){this.toastDismissed||ye.getInstance().showToast(t,"",e,void 0,void 0,!0,"DocumentCache")}},{key:"dismissToast",value:function(){this.toastDismissed=!0,ye.getInstance().dismissToast("DocumentCache"),_("dismissToastTriggered",e.DOCUMENTCACHETOASTMANAGER_LOG_CATEGORY)}}]),e}();be.toastDismissed=!1,be.DOCUMENTCACHETOASTMANAGER_LOG_CATEGORY="DocumentCacheToast";var ge=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"isSupported",value:function(){try{var e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return _instanceof(e,DOMException)&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&localStorage&&0!==localStorage.length}}},{key:"getDocumentCacheItem",value:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null}},{key:"saveDocumentCacheItem",value:function(e,t){if(!t)return!1;var n=JSON.stringify(t);return localStorage.setItem(e,n),!0}},{key:"removeDocumentCacheItem",value:function(e){localStorage.removeItem(e)}},{key:"clearBrowserCache",value:function(){for(var t=0,n=Object.keys(localStorage),i=0;i<n.length;i++){var r=n[i];r.startsWith(e.KEY_PREFIX)&&(localStorage.removeItem(r),t++)}return t}},{key:"getItemsInCache",value:function(){for(var t=[],n=Object.keys(localStorage),i=0;i<n.length;i++){var r=n[i];if(r.startsWith(e.KEY_PREFIX)){var o=this.getDocumentCacheItem(r);o&&t.push({key:r,item:o})}}return t}},{key:"getKeysInCache",value:function(){for(var t=[],n=Object.keys(localStorage),i=0;i<n.length;i++){var r=n[i];r.startsWith(e.KEY_PREFIX)&&t.push(r)}return t}},{key:"getCacheKey",value:function(t){if(!t)throw new Error("documentId is an empty string");return e.KEY_PREFIX+t}}]),e}();ge.KEY_PREFIX="WordCachedDoc_";var we=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"isSupported",value:function(){return!0}},{key:"getDocumentCacheItem",value:function(e){var t=localStorage.getItem(e);return JSON.parse(t)}},{key:"saveDocumentCacheItem",value:function(e,t){var n=new $("test",1633560587,"1.0",!1,5,!1,0,!1),i=JSON.stringify(n);return localStorage.setItem(e,i),!0}},{key:"removeDocumentCacheItem",value:function(e){localStorage.removeItem(e)}},{key:"clearBrowserCache",value:function(){return 0}},{key:"getItemsInCache",value:function(){return[]}},{key:"getKeysInCache",value:function(){return[]}},{key:"getCacheKey",value:function(e){return"WordCachedDoc_"+e}}]),e}(),_e=function(){function e(t,n,i,o,a,s){_class_call_check(this,e),T(a);var u=function(e){return"true"===a[e]},c=(F("AppChromeOverrideEnabled")?M("AppChromeBaseScriptUrlOverride",""):M("StaticContentUrl",""))+(u("IsWebpack5RibbonEnabled")?"wp5/":"");r.p=c,this.fastBootEnabled=u("FastBoot"),e.slice0Name=a.Slice0Name,this.appearance={positionAbsolute:!u("OneNoteCssPositionRewriteIsEnabled"),showRibbon:!u("HideRibbonEmbedded"),ribbonExpandedByDefault:t,ribbonPreferenceCookieName:a.RibbonPreferenceCookieNameHint,showRibbonImage:n,ribbonImageBase:a.RibbonImageBase,shouldStretchPageToBottom:i,appBrandedName:a.BrandedWebAppName,showRibbonHeader:!u("HideHeaderEmbedded"),showNavPane:o&&!u("ONHideNavEmbedded"),showNavSections:!u("ONHideSectionsEmbedded"),editable:!1,pasteLoadingUI:u("PasteInBootLoadingUIIsEnabled"),loadingUIGif:a.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:!0,simplifiedReactRibbonAnimationIsEnabled:ke(a),skeletalBootUXIsEnabled:u("OneNoteSkeletalBootUXIsEnabled"),snackbarNavPaneIsEnabled:u("SnackbarNavPaneIsEnabled"),twoPaneNavIsEnabled:u("OneNoteTwoPaneNavPaneIsEnabled"),reactSharedHeaderIsEnabled:u("ReactSharedHeaderIsEnabled"),headerAppLauncherIsHidden:u("AppLauncherIsHidden"),headerBackgroundColorOverride:decodeURIComponent(S.getCookie("ThemedHeaderBackgroundColor")),headerTextColorOverride:decodeURIComponent(S.getCookie("ThemedHeaderTextColor")),cssPositionRewriteIsEnabled:u("OneNoteCssPositionRewriteIsEnabled"),wordIsSkeletalDeepLinkOn:u("WordIsSkeletalDeepLinkOn"),isDeepLinkScenario:u("IsDeepLinkScenario"),reactMultiLineRibbonIsVisible:e.isReactMultilineRibbonVisible(a),renderFastViewOnSkeletalUXIsEnabled:u("OneNoteRenderFastViewOnSkeletalIsEnabled"),isRegionComposerShown:!!s,appColorUpdateIsEnabled:u("AppColorUpdateIsEnabled"),isRtl:u("Rtl"),showHeaderPlaceholder:u("ShowHeaderPlaceholder"),darkModeEnabled:e.isDarkModePreferenceOn(a),isOneNoteCanvasZoomEnabled:!1,currentZoomLevel:1,isOneNoteMobileViewerNavigationEnabled:u("OneNoteMobileViewerNavigationIsEnabled"),isBrowserSideCacheEnabled:u("IsBrowserSideCacheEnabled"),fixRemoveKeypressEventListenerInFastView:u("FixRemoveKeypressEventListenerInFastView"),fluent2StylesEnabled:u("Fluent2StyleIsEnabled"),bootToTabsOnly:e.isBootingToTabsOnly(a),isNewSkeletalUXExperienceEnabled:u("NewSkeletalUXExperienceEnabled")}}return _create_class(e,[{key:"launchFastView",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(e){};if(_("Launching FastView from entry point "+t,"BootLogs"),this.appearance.editable=n,this.fastBootEnabled&&!f.fastView&&!document.getElementById("PageContentContainer")){var s,u=document.getElementById("canvasWrap");if(null!=u&&this.appearance.cssPositionRewriteIsEnabled)s=u;else{var c=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&i?"SkeletalCanvas":"WACInnerFrame";s=document.getElementById(c)}f.fastView=new q((function(){return document.getElementById("AppHeaderPanel")}),(function(){return document.getElementById("WACRibbonPanel")}),(function(){return s}),this.appearance,t,S.getCookie,i,r,o,a);try{return f.fastView.open(e)}catch(e){return f.fastBootError="FastView open failed: "+e.message+"\r\n"+e.stack,!1}}return!1}}],[{key:"getSlice0",value:function(){if(null!=e.slice0Name&&e.slice0Name.length>0){var t=document.createElement("script");t.type="text/javascript",t.src=e.slice0Name,document.getElementsByTagName("head")[0].appendChild(t)}}},{key:"isReactMultilineRibbonVisible",value:function(t){var n=e.userHasMLRPreference(t);return"true"===t.ReactMultilineRibbonIsEnabled&&("true"===n||"false"===S.getCookie(t.IsSimplifiedRibbonOnCookieName).toLowerCase()||e.defaultMLRIsEnabled(t))}},{key:"isBootingToTabsOnly",value:function(t){var n=S.getCookie(t.ReactShyRibbonPreferenceCookieName).toLowerCase(),i="true"===t.ResponsiveUxIsEnabled,r="true"===t.NewSkeletalUXExperienceEnabled;if(i&&r)return window.ShouldHideBottomBarAtBoot;var o=i&&(window.ShouldHideBottomBarAtBoot||"true"===n||(""===n||"undefined"===n)&&e.getIsDocumentBelowTabsOnlyThreshold(t));return window.ShouldHideBottomBarAtBoot=o,o}},{key:"getIsDocumentBelowTabsOnlyThreshold",value:function(t){var n=window.innerHeight,i=window.innerWidth,r=n*i,o=r-("true"===t.HideHeaderEmbedded?0:48*i)-24*i-(36+(e.isReactMultilineRibbonVisible(t)?100:40))*i,a=parseFloat(t.ResponsiveUxBreakpoint);return o/r<(isNaN(a)?.67:a)}},{key:"isDarkModePreferenceOn",value:function(e){return"true"===e.WordDarkModeIsEnabled&&"true"===e.DarkModeIsOn}},{key:"defaultMLRIsEnabled",value:function(e){return"true"===M("IsO365ConsumerHost","")&&""===S.getCookie(e.ReactRibbonMLRPreferenceCookieName).toLowerCase()&&window.innerWidth>=1024&&window.innerHeight>=600}},{key:"userHasMLRPreference",value:function(e){return S.getCookie(e.ReactRibbonMLRPreferenceCookieName).toLowerCase()}}]),e}();function ke(e){return"true"===e.OneLineRibbonAnimationIsEnabled}var Se=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;_class_call_check(this,e),this.pageHtml=t,this.editable=n,this.hasUnresolvedComments=i,this.numSections=r};function Ce(e,t,n,i){var r;return{baseDocId:e.BaseDocId,documentCacheItemSchemaVersion:e.DocumentCacheItemSchemaVersion,fastBootEnabled:"true"===e.FastBoot,getCachedSSR:"true"===e.GetCachedSSR,indexedDBPageTargetKey:"",initParagraphId:parseInt(e.InitialParaId,16),isIndexedDBEnabled:"true"===e.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===e.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===e.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===e.CreateNew,isOneNoteHierarchySyncOnBootEnabled:"true"===e.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===e.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===e.OneNoteSyncHeartBeatIsEnabled,isOneNoteSyncHeartBeatNoShutdownEnabled:"true"===e.OneNoteSyncHeartBeatNoShutdownEnabled,isOneNoteAddUUIDForGetCellsEnabled:"true"===e.OneNoteAddUUIDForGetCellsIsEnabled,isOneNoteConvergedStackParsingEnabled:"true"===e.OneNoteConvergedStackParsing,isUserCreatingPersonalNotebookFirstTime:"true"===e.IsUserCreatingPersonalNotebookFirstTime,isRemoveSsrEnabled:"true"===e.IsRemoveSsrEnabled,IsBrowserSideCacheEnabled:"true"===e.IsBrowserSideCacheEnabled,isRemoveSsrEnabledForDarkMode:_e.isDarkModePreferenceOn(e),oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===e.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(e.OneNoteContentSyncVersion,10),optimizedForNewFile:n,pageTarget:e.PageTarget,pageTargetHtml:e.PageTargetHtml,requestOptions:xe(e,t,i),sessionStartJson:null!==(r=e.SessionStartInfoJson)&&void 0!==r?r:"UNKNOWN",skipPageHtmlInGetCellsResponse:"true"===e.SkipPageHtmlInGetCellsResponse,slice0Name:e.Slice0Name,syncHeartBeatSendInterval:parseInt(e.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(e.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(e.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:e.UserId,useLoadAsync:parseInt(e.UseLoadAsync,10),oneNoteMergeSyncFlightData:e.OneNoteMergeSyncFlightData}}function xe(e,t,n){return{accessToken:n?n.AccessToken:e.AccessToken,accessTokenTtl:n?n.AccessTokenTtl:"",applicationModeExtended:e.SessionStartInfoJson?JSON.parse(e.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:e.BuildVersion,canary:e.Canary,feMachineId:e.FEMachineId,onenoteSyncEndpoint:e.ONOnlineSyncEndpoint,pageTarget:e.PageTarget,renderingMode:e.AddServerSideRenderingHeader,requestHeadMode:t,rootQuerySignature:e.RootQuerySignature,sessionOrigin:e.SessionOrigin?e.SessionOrigin:"UNKNOWN",url:e.WebServiceBase,userSessionId:e.SessionId,userType:e.UserType,wacCluster:e.WacCluster,wacUserAgent:e.WacUserAgent}}var Re,Ae="InitialRequestEnd",Pe="InitialResponseProcessStart",Oe="InitialResponseProcessEnd";!function(e){e.GetCells="GetCells",e.RenderPage="RenderPage",e.SessionStart="SessionStart"}(Re||(Re={}));var Ee=function(){function e(t,n){var i,o,a=this;_class_call_check(this,e),this.enableMetricLoggingCookieName="EnableMetricLogging",this.onGetCellsRequestCompleted=function(e){if(_("Get cells response received:"+e.status,"BootLogs"),!l.g_initialRequestCompleted){if(De(e.responseText,!1),!f.fastView&&!a.shouldDisableSSR()){var t=function(e){if(e&&e.Responses[0]&&e.Responses[0][1]&&e.Responses[0][1].Cells)for(var t=e.Responses[0][1].Cells,n=0;n<t.length;n+=1){var i=t[n];if(i&&i.PageHtml)return new Se(i.PageHtml,!!i.IsPageHtmlEditable,!!i.HasUnresolvedComments,i.NumSections)}}(l.g_initialRequestResponseObject);t&&t.pageHtml&&a.Se&&a.Se.launchFastView(t.pageHtml,"WacBootGetCells",t.editable,!1,t.hasUnresolvedComments,t.numSections)}l.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=function(){l.g_onInitialResponseReady&&l.g_onInitialResponseReady()},this.Ce=function(e){var t=e.responseText;if(!f.fastView){var n=function(e){var t=Te(e);if(t&&t.Responses[0]&&t.Responses[0][1]&&t.Responses[0][1].Html)return t.Responses[0][1].Html}(t);n&&a.Se&&a.Se.launchFastView(n,"WacBootRenderPage")}},this.Se=t,this.xe=n,l.g_useLoadAsync=this.xe.useLoadAsync,((null===(o=window.location)||void 0===o||null===(i=o.search)||void 0===i?void 0:i.match(/wdpa=1/gi))||"1"===S.getCookie(this.enableMetricLoggingCookieName))&&r.e(585).then(r.bind(r,160)).then((function(e){a.Re=e.subscribeToMetricLogging(),e.subscribeToInteractivityMetricsLogging()}),(function(){}))}return _create_class(e,[{key:"dispose",value:function(){var e;null===(e=this.Re)||void 0===e||e.call(this)}},{key:"shouldDisableSSR",value:function(){return this.xe.isRemoveSsrEnabled||this.xe.isRemoveSsrEnabledForDarkMode||this.xe.IsBrowserSideCacheEnabled}},{key:"makeGetCellsRequest",value:function(e,t){_("Making GetCells Request","BootLogs"),f.initialParaId=this.xe.initParagraphId||0;var n=JSON.stringify(window.location.href),i=',"SearchQuery":null,"IsNewFile":'+(this.xe.isNewFile&&this.xe.optimizedForNewFile).toString()+',"InitialParaId":'+f.initialParaId+',"RequestUrl":'+n+',"SkipPageHtmlInResponse":'+this.xe.skipPageHtmlInGetCellsResponse.toString();this.xe.sessionStartJson&&(i=i+',"SessionStartInfoJson":'+JSON.stringify(this.xe.sessionStartJson));var r=Ie(1,i,this.xe.requestOptions,{IsRemoveSsrEnabled:this.shouldDisableSSR(),UseNativeJsonTypes:20===this.xe.useLoadAsync});return We(this.xe.requestOptions.url+"OneNote.ashx"+(t?"?perfTag=GetCells_1&GetCellsBootstrapper=1":""),r,this.xe,e,Le,Re.GetCells)}},{key:"makeRenderPageRequest",value:function(e){if(!this.xe.isNewFile||!this.xe.optimizedForNewFile){var t=Ie(46,"",this.xe.requestOptions,e);We(this.xe.requestOptions.url+"OneNote.ashx?IsRenderPage=1",t,this.xe,this.Ce,(function(){}),Re.RenderPage)}}},{key:"makeStartSessionRequest",value:function(e,t){We(this.xe.requestOptions.url+e,"",this.xe,t,(function(){}),Re.SessionStart)}}]),e}();function Ie(e,t,n,i){var r=JSON.stringify(n.rootQuerySignature);r&&(r=r.substring(1,r.length-1));var o=JSON.stringify(n.pageTarget);o&&(o=o.substring(1,o.length-1));var a='{"Mode":'+n.requestHeadMode+',"srs":[[',s=',{"FileId":"'+r+'","PageTarget":"'+o+'","OperationId":1';for(var u in i)s+=',"'+u+'":'+i[u];return a+e+s+t+"}]]}"}function We(e,t,n,i,r,o){var a=new XMLHttpRequest,s={};for(var u in a.onreadystatechange=function(){if(a&&4===a.readyState){if(void 0===a.status||0===a.status)try{_(o+" response status is empty or undefined","BootLogs")}finally{return}try{i&&i(a)}finally{null!=a&&(a.onreadystatechange=function(){},a=void 0)}}},a.open("Post",e,!0),function(e,t){var n=t.requestOptions;if(e["X-xhr"]="1",n.userSessionId&&(e["X-UserSessionId"]=n.userSessionId),n.buildVersion&&(e["X-OfficeVersion"]=n.buildVersion),e["Content-Type"]="application/json; charset=utf-8",n.canary&&(e["X-Key"]=n.canary),n.accessToken&&(e["X-AccessToken"]=n.accessToken),n.accessTokenTtl&&(e["X-AccessTokenTtl"]=n.accessTokenTtl),n.userType&&(e["X-UserType"]=n.userType),n.wacCluster&&(e["X-WacCluster"]=n.wacCluster),n.wacUserAgent&&(e["X-WacUserAgent"]=n.wacUserAgent),n.renderingMode&&(e["X-ServerSideRendering"]=n.renderingMode),n.feMachineId&&(e["X-FEMachineId"]=n.feMachineId),t.sessionStartJson&&(e["X-SessionStartDimensions"]=function(e){if(!e||"UNKNOWN"===e)return e;var t={},n=JSON.parse(e);return t.Application=n.Application,t.ApplicationVersion=n.ApplicationVersion,t.Browser=n.Browser,t.BrowserMajorVersion=n.BrowserMajorVersion,t.BrowserVersion=n.BrowserVersion,t.Host=n.Host,t.IsSynthetic=n.IsSynthetic,t.Os=n.Os,t.Ring=n.Ring,t.RoutedVia=n.RoutedVia,t.SessionOrigin=n.SessionOrigin,t.UiHost=n.UiHost,t.UserSessionApplicationMode=n.UserSessionApplicationMode,t.WACDatacenter=n.WACDatacenter,JSON.stringify(t)}(t.sessionStartJson)),t.isOneNoteAddUUIDForGetCellsEnabled){var i="".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}));l.g_getCellsUuid=i,e["X-GetCellsUUID"]=i}e["X-Requested-With"]="XMLHttpRequest",window.location.href.indexOf("wdkestrelrouting=true")>-1?e["X-KestrelRouting"]="true":window.location.href.indexOf("wdkestrelrouting=false")>-1&&(e["X-KestrelRouting"]="false")}(s,n),s)a.setRequestHeader(u,s[u]);var c=t;return t||(c=""),r(),a.send(c),a}function Le(){l.g_initialRequestInvokedTime=new Date,l.g_initialRequestMade=!0,H("InitialRequestStart")}function De(e,t){l.g_getCellsFromFrameRequest=t,l.g_initialRequestCompleted=!0,l.g_initialResponseTime=new Date,H(Ae),H(Pe),z("InitialRequest","InitialRequestStart",Ae);var n=Te(e);if(l.g_initialRequestResponseObject=n,n&&n.Responses&&n.Responses[0]&&n.Responses[0][1]){var i=n.Responses[0][1];l.g_acquireLockStartTime=i.AcquireLockStartTime,l.g_acquireLockEndTime=i.AcquireLockEndTime,l.g_acquireLockRequestStatus=i.AcquireLockRequestStatus,l.g_getDocumentStartTime=i.GetDocumentStartTime,l.g_getDocumentEndTime=i.GetDocumentEndTime,l.g_getDocumentRequestStatus=i.GetDocumentrequestStatus,l.g_getCellsStartTime=i.GetCellsStartTime,l.g_getCellsEndTime=i.GetCellsEndTime,l.g_getInitializeLocalCobaltStartTime=i.InitializeLocalCobaltStartTime,l.g_getInitializeLocalCobaltEndTime=i.InitializeLocalCobaltEndTime}l.g_initialResponseReadyTime=new Date,H(Oe),z("InitialResponseProcess",Pe,Oe)}function Te(e){try{return JSON.parse(e)}catch(e){f.fastBootError="JSON.parse failed: "+e.message+"\r\n"+e.stack}}function Fe(){var e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function Me(){var e=window.performance;return e&&e.now?e.now():(new Date).getDate()-Fe()}function Ne(){var e=window.performance;return e&&e.now?Fe()+e.now():(new Date).getDate()}function Be(e){return Fe()+e}Ee.getCellsFromFrameRequest=function(e){l.g_initialRequestCompleted||(De(e,!0),l.g_fastViewOpenTime=new Date)};var je="wacPerfObserver";function Ve(e,t){void 0===window[je]&&(window[je]={}),window[je][e]=t}function Ue(e){e.disconnect(),Ve("timeOrigin",Fe()),"function"==typeof window.CustomEvent&&window.dispatchEvent(new CustomEvent("WacStableInteractive",window[je]))}function He(e){var t=document.getElementById("WACFastView"),n=t.querySelector(".WACViewPanel"),i=t.querySelector(".PaginatedContentContainer"),r=t.querySelector(".PagesContainer");i&&(i.style.minHeight="0",i.style.left="-140px"),n&&(n.style.overflow="hidden");var o=document.createElement("div");return o.id="SkeletalPage",o.className=o.id,o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.left="0px",o.style.right="0",o.style.top="19px",o.style.zIndex="1",o.appendChild(function(e){var t=document.createElement("div");t.id="SkeletalCanvas",t.className=t.id,t.style.width="auto",t.style.height="100%",t.style.overflow="hidden",t.style.position="relative",t.style.padding="96px";var n=document.getElementById("WACFastView").querySelector(".OutlineContent"),i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.boxSizing="border-box",n&&(i.style.paddingLeft=n.style.paddingLeft,i.style.paddingRight=n.style.paddingRight,i.style.paddingTop=n.style.paddingTop);for(var r=[],o=0;o<2;o+=1)r[o]=document.createElement("div"),r[o].style.backgroundColor=e,r[o].style.height="18px",r[o].style.marginBottom="16px";r[0].style.width="150px",r[1].style.width="220px";for(var a=[],s=0;s<21;s+=1)a[s]=document.createElement("div"),a[s].style.backgroundColor=e,a[s].style.height="14px",a[s].style.marginBottom="6px";a[0].style.width="92%",a[1].style.width="100%",a[2].style.width="93%",a[3].style.width="80%",a[3].style.marginBottom="16px",a[4].style.width="92%",a[5].style.width="100%",a[6].style.width="55%",a[6].style.marginBottom="16px",a[7].style.width="95%",a[8].style.width="38%",a[8].style.marginBottom="26px",a[9].style.width="90%",a[10].style.width="100%",a[11].style.width="98%",a[12].style.width="100%",a[13].style.width="33%",a[13].style.marginBottom="16px",a[14].style.width="91%",a[15].style.width="90%",a[16].style.width="100%",a[17].style.width="85%",a[17].style.marginBottom="40px",a[18].style.width="92%",a[19].style.width="100%",a[20].style.width="93%",i.appendChild(r[0]);for(var u=0;u<=17;u+=1)i.appendChild(a[u]);i.appendChild(r[1]);for(var c=18;c<=19;c+=1)i.appendChild(a[c]);return t.appendChild(i),t}(e)),r&&(r.style.overflow="visible",r.appendChild(o)),{isReady:!1,element:o}}var ze="stable-interactivity",Ge="first-input",qe="first-interaction",Je="first-idle",Ke="visually-ready",Xe="functionally-ready",Qe="visually-perceived";function Ye(e){return e===Ke||e===Xe||e===Qe}function Ze(e,t){for(var n in e){var i;if(!(null===(i=e[n].states[t])||void 0===i?void 0:i.final))return!1}return!0}function $e(e,t){return t&&e&&Ye(t)&&e.states[t]}var et="Wac-SubComponentsInit",tt="Wac-SubComponentSetLoadState",nt="Wac-AppLoadTrace",it=function(e,t){try{var n=new CustomEvent(e,{detail:t});self.dispatchEvent(n)}catch(e){ot(ue.k.Error,"dispatchRumShepherdEvent failed with exception:",e)}},rt=[];function ot(e,t,n,i){var r,o=Number(Me().toFixed()),a="[rum:".concat(o,"]").concat(t," ").concat(n?JSON.stringify(n):"");rt.push({level:e,message:a}),i&&(r={traces:_to_consumable_array(rt)},rt=[],it(nt,r))}function at(e){return e?_object_spread({},e):{}}function st(e){var t=[];for(var n in e){var i,r=e[n];t.push((_define_property(i={},"id",r.id),_define_property(i,"rootElementId",r.rootElementId),_define_property(i,"subComponents",ut(r.subComponents)),i))}return t}function ut(e){var t=[];for(var n in e){var i,r=e[n];r.nonReporting||t.push((_define_property(i={},"id",r.id),_define_property(i,"initTime",Be(r.initTime)),_define_property(i,"optional",r.optional),_define_property(i,"unused",r.unused),_define_property(i,"nonReporting",r.nonReporting),_define_property(i,"states",lt(r.states)),i))}return t}function ct(e){var t=[];for(var n in e){var i,r=e[n];r.nonReporting&&t.push((_define_property(i={},"id",r.id),_define_property(i,"initTime",Be(r.initTime)),_define_property(i,"optional",r.optional),_define_property(i,"unused",r.unused),_define_property(i,"nonReporting",r.nonReporting),_define_property(i,"states",lt(r.states)),i))}return t}function lt(e){var t={};for(var n in e){var i=e[n];(null==i?void 0:i.time)&&(t[n]=Be(i.time))}return t}function ft(e,t){var n=e.subComponents;for(var i in n){var r=n[i];if(!(r.states[t]||r.unused||r.nonReporting))return!1}return!0}function dt(e){var t=Number.POSITIVE_INFINITY;for(var n in e.subComponents){var i=e.subComponents[n];t=Math.min(t,i.initTime)}return t}function ht(e,t){if(!e||!t)return!1;var n=e.subComponents;for(var i in n)if(!vt(n[i],t))return!1;return!0}function vt(e,t){if(!e)return!1;var n=e.states[t];return e.optional||(null==n?void 0:n.time)&&n.promotedFromPreviousState}function pt(e,t){return t===Ke&&$e(e,Qe)}function mt(e,t){return{start:e.start,time:null!=t?t:e.time,error:e.error,monitor:e.monitor,measures:at(e.measures),data:at(e.data)}}function yt(e,t,n,i){"then"in e?e.then((function(e){i(e)})).catch((function(e){var r="Error in invokeMonitor [".concat(n,"}]");ot(ue.k.Error,r,e),i({start:t,time:t,monitor:"",error:"".concat(r,": ").concat(e)})})):i(e)}var bt=function(){function e(t){_class_call_check(this,e),this.Ae=null!=t?t:{}}return _create_class(e,[{key:"getBooleanSetting",value:function(e,t){var n=this.Ae[e];if(!n)return t;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return t}}},{key:"getStringSetting",value:function(e,t){return this.Ae[e]||t}}]),e}(),gt=function(){function e(t){var n=this;_class_call_check(this,e),this.timeoutInMs=t,this.Pe="",this.Oe=function(e){n.Pe||(n.Pe=e?"timeout":"cancelled",n.Ee&&n.Ee())},this.cancel=function(){n.Oe(!1)},t>0&&window.setTimeout((function(){return n.Oe(!0)}),t)}return _create_class(e,[{key:"timeout",get:function(){return this.timeoutInMs}},{key:"reason",get:function(){return this.Pe}},{key:"onCancelled",set:function(e){this.Ee=e}}]),e}();function wt(e){return new gt(null!=e?e:0)}var _t=function(){function e(t){var n,i,r=this;_class_call_check(this,e),this.Ie={},this.We={},this.Le=0,this.De=t,n=function(e){return r.Le=e},i="hidden"===document.visibilityState?0:1/0,n(i),document.addEventListener("visibilitychange",(function(e){i=Math.min(i,e.timeStamp),n(i)}),{once:!0})}return _create_class(e,[{key:"tabHideTime",get:function(){return this.Le}},{key:"metrics",get:function(){return this.Ie}},{key:"startMonitors",value:function(e,t){var n=this;ot(ue.k.Verbose,"startMonitors",{appState:e});var i=function(e,i){if(ot(ue.k.Verbose,"onCompleteWithInputCheck",{metric:e}),i){if(!i.error){var r=n.Ie[Ge]?n.Ie[Ge].time:0,o=n.Ie[qe]?n.Ie[qe].time:0;r>0&&r<i.time&&(0===o||r<=o)&&(i.error="first-input"),o>0&&o<i.time&&(i.error="first-interaction")}t(e,i)}};e===Ke&&(this.monitorMetric(Ge,t),this.monitorMetric(qe,t),this.monitorMetric(Je,i),this.monitorMetric(ze,i,12e4))}},{key:"cancelMonitors",value:function(e){var t=this;if(e===Ke){ot(ue.k.Info,"cancelAppStateMonitors",e);var n=function(e){var n;null===(n=t.We[e])||void 0===n||n.cancel(),t.We[e]=void 0,t.Ie[e]=void 0};n(ze),n(Je)}}},{key:"monitorMetric",value:function(e,t,n){if(ot(ue.k.Verbose,"monitorMetric",e),this.We[e])ot(ue.k.Verbose,"monitorMetric:already-running",e);else{var i=wt(n);this.We[e]=i;var r=Me();yt((0,this.De.monitors[e])(r,i),r,e,(function(n){ot(ue.k.Verbose,"monitorMetric:complete",e),t(e,n)}))}}}]),e}();function kt(e,t,n,i,r){r&&t.nonReporting||(e.states[n]={result:mt(i),monitoring:void 0,final:ft(e,n)})}var St=function(){function e(t){var n=this;_class_call_check(this,e),this.Te={},this.Fe={},this.Me=function(e){if(n.Fe[e])return!1;var t=Ze(n.Te,e);return ot(ue.k.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:e,isFinal:t}),t},this.Ne=function(e){if(e===ze||e===Je){var t=n.Be.metrics[e],i=Ze(n.Te,Ke);return ot(ue.k.Verbose,"canMonitorMetricBeReported:si-error:",{metric:e,error:null==t?void 0:t.error,vrStateFinal:i}),!!t&&"cancelled"!==t.error&&i}return!0},this.je=function(e){var t=n.Fe[e],i=n.Ne(e);!t&&i?n.Ve(e):ot(ue.k.Info,"reportMonitorMetricIfReady:not-ready",{metric:e,isReported:t,canMetricBeReported:i})},this.Ue=function(e){n.Me(e)&&n.Ve(e)},this.Ve=function(e){try{var t,i=n.Be.metrics[e],r=(_define_property(t={},"metric",e),_define_property(t,"timeOrigin",n.He),_define_property(t,"time",i.time),_define_property(t,"error",i.error||(n.Be.tabHideTime<i.time?"tab-switch":void 0)),_define_property(t,"monitor",i.monitor),_define_property(t,"measures",at(i.measures)),_define_property(t,"data",at(i.data)),_define_property(t,"auxMetrics",[]),_define_property(t,"componentsData",st(n.Te)),_define_property(t,"nonReportingComponentData",function(e){var t=[];for(var n in e){var i,r=e[n];t.push((_define_property(i={},"id",r.id),_define_property(i,"rootElementId",r.rootElementId),_define_property(i,"subComponents",ct(r.subComponents)),i))}return t}(n.Te)),t),o=r.measures;if(o.tabsSwitch=n.Be.tabHideTime<i.time?n.Be.tabHideTime:0,o.start=i.start,o.reportedTime=Me(),e===ze){var a=n.Be.metrics[Ke];o[Ke]=a?a.time:0;var s=n.Be.metrics[Xe];o[Xe]=s?s.time:0}if(Ye(e)){for(var u in n.Te){var c=n.Te[u];if(c){var l=c.states[e].result;if(l){var f;o[u]=l.time,r.error=r.error||l.error;var d=(_define_property(f={},"metric","".concat(e,"-").concat(u)),_define_property(f,"time",l.time),_define_property(f,"monitor",l.monitor),_define_property(f,"error",l.error),_define_property(f,"measures",at(l.measures)),f);d.measures.start=l.start,d.measures.init=dt(c),r.auxMetrics.push(d)}}}var h=n.Be.metrics[ze];h&&h.error&&"cancelled"!==h.error&&!r.error&&(r.error="si-error")}n.De.appLoadMetricReportCallback&&(n.Fe[e]=!0,ot(ue.k.Info,"reportMetric:reporting",e,!0),n.De.appLoadMetricReportCallback(r))}catch(e){ot(ue.k.Error,"reportMetric:error",e)}},this.ze=function(){var e,t,i=(_define_property(e={},"time",Ne()),_define_property(e,"allMetricsReported",!!((t=n.Fe)[Ke]&&t[Xe]&&t[ze]&&t[Ge]&&t[qe]&&t[Je])),_define_property(e,"metrics",n.Be.metrics),_define_property(e,"components",st(n.Te)),_define_property(e,"timeOrigin",Fe()),e);n.De.appLoadStateLoggingCallback(i)},this.Ge=function(e,t,i,r,o){if($e(t,o)){var a=t.states[o];t.states[i]={time:a.time,promotedFromPreviousState:!0}}else t.states[i]={time:r,promotedFromPreviousState:!1};if(ot(ue.k.Verbose,"processSubComponentState",{component:e.id,subComponent:t.id,state:i}),function(e,t){var n=e.subComponents;for(var i in n){var r=n[i].states[t];if(!((null==r?void 0:r.time)||n[i].optional||pt(n[i],t)))return!1}return!0}(e,i)){var s=function(e,t){t&&(ot(ue.k.Info,"processSubComponentState:complete-monitor-metric",e),n.metrics[e]=mt(t),n.je(e))},u=function(e,t){var i=function(e,t){var n=0;for(var i in e){var r,o,a=null===(o=e[i].states[t])||void 0===o||null===(r=o.result)||void 0===r?void 0:r.time,s=e[i].allSubComponentsUnused;if(!a&&!s)return;a&&(n=Math.max(n,a))}return n}(n.Te,e);ot(ue.k.Verbose,"processSubComponentState:appStateTime",{time:i,state:e}),i&&(function(e,t,i){t&&(ot(ue.k.Info,"processSubComponentState:complete-appstate-metric",e),n.metrics[e]=mt(t,i),n.Ue(e))}(e,t,i),n.Be.startMonitors(e,s))};n.Be.cancelMonitors(i);var c=n.qe.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1),l=$e(t,o),f=function(e,t){if(t&&e&&e.states[t]){var n=e.states[t];return(null==n?void 0:n.result)&&(null==n?void 0:n.final)}return!1}(e,o);if(l){var d=e.states[o];return f?ht(e,i)?(kt(e,t,i,d.result,c),void u(i,d.result)):void 0:void(ht(e,i)&&d.monitoring&&(ot(ue.k.Verbose,"processSubComponentState: detected promotion while previous state is monitoring, marking state to promote later.",{component:e.id,state:i,promotedFromState:o}),d.stateToPromoteWhenFinal=i))}if(e.allSubComponentsUnused){var h={start:0,time:0,monitor:""};return e.states[i]={result:mt(h),final:!0},ot(ue.k.Verbose,"processSubComponentState:setting component's state timings to 0 since all subComponents are unused",{component:e.id,state:i}),void u(i,h)}void 0!==o&&ot(ue.k.Verbose,"processSubComponentState:starting monitor although we are promoting",{component:e.id,subComponent:t.id,promotedFromState:o,state:i,isPromotingAndPromotedStateExists:l,isPreviousStateHasAFinalResult:f});var v=n.De.monitors[i];ot(ue.k.Verbose,"processSubComponentState:start-monitor",{state:i}),function(e,t,n,i){var r=e.states[t];if(!(null==r?void 0:r.final)){(null==r?void 0:r.monitoring)&&(null==r||r.monitoring.cancel());var o=Me(),a=wt(5e3);e.states[t]={monitoring:a,final:ft(e,t)},yt(n(o,a,e),o,t,i)}}(e,i,v,(function(n){ot(ue.k.Verbose,"processSubComponentState:monitor-complete",{state:i});var r=e.states[i].stateToPromoteWhenFinal;kt(e,t,i,n,c),r&&(ot(ue.k.Verbose,"processSubComponentState: promotion callback detected state to promote.",{component:e.id,state:i,stateToPromote:r}),kt(e,t,r,n,c)),u(i,n)}))}else ot(ue.k.Verbose,"processSubComponentState:component-not-ready",{component:e.id,state:i})},this.Je=function(e,t){ot(ue.k.Verbose,"processSubComponentUnused",{subComponent:t.id}),t.unused=!0;var i=e.subComponents,r=!0;for(var o in i)i[o].unused||(r=!1);r?(e.allSubComponentsUnused=!0,n.Ge(e,t,Qe,0),ot(ue.k.Verbose,"processSubComponentUnused:vp-final",{component:e.id,VISUALLY_PERCEIVED:Qe}),e.states[Qe].final=!0,n.Ue(Qe),n.Ge(e,t,Ke,0),ot(ue.k.Verbose,"processSubComponentUnused:vr-final",{component:e.id,VISUALLY_READY:Ke}),e.states[Ke].final=!0,n.Ue(Ke),n.Ge(e,t,Xe,0),ot(ue.k.Verbose,"processSubComponentUnused:fr-final",{component:e.id,FUNCTIONALLY_READY:Xe}),e.states[Xe].final=!0,n.Ue(Xe)):n.ProcessUnusedComponentFinal(e),n.je(ze),n.je(Je)},this.Ke=function(e,t,n,i,r){n?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:Me(),optional:i,unused:!1,nonReporting:r,states:{}})},ot(ue.k.Info,"initialize"),this.He=Number(Number(Fe()).toFixed()),this.De=_object_spread({},t),this.Be=new _t(this.De),this.qe=new bt(this.De.appSettings);var i=!0,r=!1,o=void 0;try{for(var a,s=t.components[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;this.Te[u.id]={id:u.id,rootElementId:u.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}window.setTimeout((function(){return n.ze()}),12e4)}return _create_class(e,[{key:"ProcessUnusedComponentFinal",value:function(e){for(var t in e.states){var n=t,i=e.states[n];!i.final&&ft(e,n)&&(ot(ue.k.Verbose,"processSubComponentUnused:unused-final",{component:e.id,state:n}),i.final=!0,this.Ue(n))}}},{key:"addSubComponents",value:function(e){if(e&&e.component&&e.subComponents){var t=this.Te[e.component];if(t){var n=t.ignoreNewSubComponents;if(function(e){for(var t in e.states)if(e.states[t].final)return!1;return!0}(t)||n){ot(ue.k.Verbose,"addSubComponents",{ignore:n,data:e});try{for(var i=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents],r=0;r<i.length;r+=1)this.Ke(t,i[r],n,!1,!1);if(e.optionalSubComponents)for(var o=0;o<e.optionalSubComponents.length;o+=1)this.Ke(t,e.optionalSubComponents[o],n,!0,!1);if(e.nonReportingSubComponents)for(var a=0;a<e.nonReportingSubComponents.length;a+=1)this.Ke(t,e.nonReportingSubComponents[a],n,!0,!0)}catch(e){ot(ue.k.Error,"addSubComponents",e)}}else ot(ue.k.Error,"Component cannot be modified",e)}else ot(ue.k.Error,"Invalid component",e)}else ot(ue.k.Error,"Invalid data",e)}},{key:"setSubComponentState",value:function(e){var t,n=Me();if(e&&e.subComponent&&e.component&&e.state){var i=this.Te[e.component];if(i){if(!i.ignoredSubComponents[e.subComponent]){i.ignoreNewSubComponents=i.ignoreNewSubComponents||!!e.ignoreNewSubComponents;var r=i.subComponents[e.subComponent];if(r)if("unused"!==e.state){var o=e.state;if(Ye(o))if(null===(t=i.states[o])||void 0===t?void 0:t.final)ot(ue.k.Error,"Component state final. Can't set",e);else if(r.unused||r.states[o])ot(ue.k.Error,"SubComponent unused or set",e);else{var a=e.promoteStateFrom;a?this.Ge(i,r,o,n,a):this.Ge(i,r,o,n)}else ot(ue.k.Error,"Unknown state reported",e)}else this.Je(i,r);else ot(ue.k.Error,"Unexpected sub-component",e)}}else ot(ue.k.Error,"Invalid component",e)}else ot(ue.k.Error,"Invalid data",e)}},{key:"components",get:function(){return this.Te}},{key:"metrics",get:function(){return this.Be.metrics}}]),e}();function Ct(e,t){return window.requestAnimationFrame?new Promise((function(n){var i,r=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;cancelAnimationFrame(i),n({start:e,time:r,monitor:"rAF",error:t.reason})};t.onCancelled=r,i=requestAnimationFrame((function(){r(Me())}))})):Promise.resolve({start:e,time:0,monitor:"",error:"rAF Unsupported"})}function xt(e,t){return new Promise((function(n){var i,r,o=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;cancelAnimationFrame(i),clearTimeout(r),n({start:e,time:o,monitor:"rAF-setTimeout",error:t.reason})};t.onCancelled=function(){return o()},i=requestAnimationFrame((function(){r=window.setTimeout((function(){o(Me())}),0)}))}))}var Rt="StableInteractivityDetected";function At(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=t||wt(12e3);if(!U("longtask"))return function(e,t){var n=Me();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});var i=Me(),r=0,o=i,a=0,s=0,u=i;return new Promise((function(i){var c,l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;cancelAnimationFrame(c);var o={start:n,time:t,monitor:"long-frames",error:e.reason,measures:{longTasksCount:r,longestTaskDuration:s,longTasksDuration:a}};i(o)};e.onCancelled=l;var f=function(e){var n=e-o,i=e-u;if(u=e,i>=50&&(n=0,a+=i,r+=1,o=e,s=Math.max(s,i)),n>=t)return l(o),void Pt();c=window.requestAnimationFrame(f)};c=window.requestAnimationFrame(f)}))}(i,n);var r=performance.now(),o=0,a=r,s=0,u=0;return new Promise((function(t){var r,c=function(){clearTimeout(r),l&&l.disconnect();var n=Me()-e,c={start:e,time:a,monitor:"longtask-api",error:i.reason,measures:{longTasksDuration:s,longTasksCount:o,longestTaskDuration:u,monitoredTime:n}};t(c)};i.onCancelled=c;var l=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){o+=1,s+=e.duration;var t=e.startTime+e.duration;a=Math.max(t,a),u=Math.max(u,e.duration)}))}));l.observe({entryTypes:["longtask"]});var f=function(){var e=performance.now()-a;if(e>=n)c(),Pt();else{var t=n-e;r=window.setTimeout(f,t)}};r=window.setTimeout(f,n)}))}function Pt(){try{self.dispatchEvent(new CustomEvent(Rt))}catch(e){ot(ue.k.Error,"".concat(Rt," failed with exception: ").concat(e))}}function Ot(e,t){return U("first-input")?new Promise((function(n){var i,r=function(t,r,o){i&&i.disconnect(),n({start:e,time:t,monitor:"first-input-api",error:o,measures:{fid:r}})};try{t.onCancelled=function(){return r(0,0,t.reason)},(i=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){return function(e){var t=e.processingStart,n=t-e.startTime;r(t,n)}(e)}))}))).observe({type:"first-input",buffered:!0})}catch(e){r(0,0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"FID unsupported"})}function Et(e,t){var n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],i={passive:!0,capture:!0},r=Ne();return new Promise((function(o){var a=function(n,i,r){u(removeEventListener);var a={start:e,time:n,monitor:"first-interaction",error:t.reason,data:{eventName:i},measures:{delay:r}};o(a)};t.onCancelled=function(){return a(0,"",0)};var s=function(e){if(e.cancelable){var t=Ne(),n=e.timeStamp>1e12,i=(n?Ne():performance.now())-e.timeStamp;(i<0||i>t-r)&&(i=0),a(n?e.timeStamp-Fe():e.timeStamp,e.type,i)}},u=function(e){n.forEach((function(t){e(t,s,i)}))};u(addEventListener)}))}function It(e,t){return window.requestIdleCallback?new Promise((function(n){var i,r=function(t,r){window.cancelIdleCallback(i),n({start:e,time:t,monitor:"first-idle",error:r})};try{i=window.requestIdleCallback((function(e){return r(Me(),e.didTimeout?"timeout":"")}),{timeout:t.timeout}),t.onCancelled=function(){return r(0,t.reason)}}catch(e){r(0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"requestIdleCallback unsupported"})}var Wt=0,Lt=function(e){var t="report ".concat(e.metric,":").concat(e.time,"ms");ot(ue.k.Info,t,e);var n=new CustomEvent("Wac-AppLoadMetricReport",{detail:e});self.dispatchEvent(n)},Dt=function(e){ot(ue.k.Info,"reporting the application load state at epoch time: ".concat(e.time,"; with the status of all metrics reported as ").concat(e.allMetricsReported),e);var t=new CustomEvent("Wac-AppLoadStateReport",{detail:e});self.dispatchEvent(t)},Tt=function(e,t,n){if(n){var i="vr-".concat(n.id,"-").concat(Wt);Wt+=1;var r=document.documentElement;return function(e,t,n,i){var r=i?function(e,t,n,i){if(U("element")){var r="testimg-"+n,o=function(e){var t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.ariaHidden="true",t}(r);if(o){var a=null!=i?i:document.documentElement;return new Promise((function(n){var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;s&&s.disconnect(),n({start:e,time:t,monitor:"image-paint-api",error:i})},s=new PerformanceObserver((function(e){var t=e.getEntries(),n=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var f=c.value;if(f.identifier===r){try{o.hidden=!0,a.removeChild(o)}catch(e){ot(ue.k.Error,"measureImagePaintTime",e)}return void i(f.renderTime)}}}catch(e){s=!0,u=e}finally{try{n||null==l.return||l.return()}finally{if(s)throw u}}}));t.onCancelled=function(){return i(0,t.reason)},s.observe({type:"element",buffered:!0}),a.appendChild(o)}))}}}(e,t,n,i):void 0;return r||(r=Ct(e,t)),r}(e,t,i,null!=r?r:void 0)}return Ct(e,t)};var Ft,Mt,Nt,Bt,jt,Vt="header";function Ut(){Ft&&!Mt&&Bt&&(Ft.launchFastView('<div class="Ltr SingleOutlineLayout WACViewPanel CssCenteredSection" style="--pageBackgroundSolidFill:#ffffff; --pageEndMarkerColor:WindowText;"><div class="PageContentOrigin"><div class="PageContentContainer" id="PageContentContainer"><div class="PaginatedContentContainer" style="width: 816px; margin-left: auto; margin-right: auto;"><div class="PaginatedContentContainerDisplayWrapper" style="width: 816px;"><div class="PagesContainer" id="PagesContainer"><div class="Page" aria-label="Page 1" style="width: 816px; height: 1056px; background-color: var(--pageBackgroundSolidFill); z-index: 1;"></div></div></div></div></div></div></div>',"skeletalUX")&&k.addComponentOutsideSkeletalContainer(He(k.getSkeletalComponentColor(Mt,Nt))),k.addShimmerToElement("SkeletalCanvas"))}function Ht(e,t){if(t){"true"===e.WacPerfObserverEntriesIsEnabled&&(V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("paint")&&new PerformanceObserver((function(e){e.getEntries().forEach((function(e){"first-paint"===e.name?Ve("firstPaint",e.startTime):"first-contentful-paint"===e.name&&Ve("firstContentfulPaint",e.startTime)}))})).observe({type:"paint",buffered:!0}),V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("largest-contentful-paint")&&new PerformanceObserver((function(e){var t=e.getEntries();Ve("largestContentfulPaint",t[t.length-1].startTime)})).observe({type:"largest-contentful-paint",buffered:!0}),function(){if(V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("element"))var e=new PerformanceObserver((function(t){t.getEntries().forEach((function(e){Ve("elementPaint_".concat(e.id),e.startTime)})),e.observe({type:"element",buffered:!0})}))}(),window.addEventListener("WacAppInteractive",(function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[5e3],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12e4;if(V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("longtask")&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("first-input")&&0!==e.length){var n=performance.now(),i=0,r=n,o=0,a=void 0,s=void 0,u=0,c=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){if("longtask"===e.entryType){i+=1,o+=e.duration;var t=e.startTime+e.duration;r=t>r?t:r}else"first-input"===e.entryType&&(a=e.processingStart,s=a-e.startTime)}))}));c.observe({entryTypes:["longtask","first-input"]});var l=function(){var f=performance.now(),d=f-r;if(s)Ve("firstInputProcessingStart",a),Ve("FID",s),Ue(c);else{for(;u<e.length;u+=1){var h=e[u];if(!(d>=h-10))break;Ve("TTSI_".concat(h),r),Ve("longTaskCount_".concat(h),i),Ve("totalLongTasksDuration_".concat(h),o)}var v=f-n;if(u<e.length&&v<t){var p=e[u]-d;setTimeout(l,p)}else Ue(c)}};e.sort((function(e,t){return e-t})),setTimeout(l,e[0])}}([500,1e3,2e3,3e3,5e3])})));var n="true"===e.HideHeaderEmbedded;if("true"===e.RumShepherdIsEnabled){var i=[{id:"ribbon",rootElementId:"WACRibbonPanel"},{id:"canvas"}];n||i.push({id:Vt,rootElementId:"AppHeaderPanel"}),function(e,t){var n=new St({appLoadMetricReportCallback:Lt,appLoadStateLoggingCallback:Dt,appSettings:t,monitors:{"visually-ready":Tt,"visually-perceived":Tt,"functionally-ready":xt,"stable-interactivity":At,"first-input":Ot,"first-interaction":Et,"first-idle":It},components:e});window.addEventListener(et,(function(e){var t=e.detail;n.addSubComponents(t)})),window.addEventListener(tt,(function(e){var t=e.detail;n.setSubComponentState(t)}))}(i,function(e){return{RumShepherdRemoteTelemetryLoggingIsEnabled:e.RumShepherdRemoteTelemetryLoggingIsEnabled,RumShepherdStagePromotionIsEnabled:e.RumShepherdStagePromotionIsEnabled,RemoteTelemetryUrl:e.RemoteTelemetryUrl,SessionId:e.SessionId}}(e))}var o="true"===e.IsRegionComposerEnabled;if(o){var a=r(48);a.initializeWindowUtil(o),o=a.shouldUseRegionComposer()}S.ensureCookieCompliance("true"===e.MSCCEnabled,e.MSCCCookies);var s=Ce(e,2,!0);Ft=new _e("true"!==e.BootReadOnlyUx,!0,!0,!1,e,o);var u=new Ee(Ft,s),c=u.makeGetCellsRequest((function(e){u.onGetCellsRequestCompleted(e),u.onInitialResponseReady()}),!0);s.getCachedSSR&&!u.shouldDisableSSR()&&u.makeRenderPageRequest({}),"true"===e.ShouldLogWordBootServerKpis&&_("{'k':[{'e': 4,'n':'BBIGC'}]}","Kpi");var l=("true"===e.WordSkeletalRibbonIsEnabled||"earlydismiss"===e.WordIsSkeletalRibbonOn||"latedismiss"===e.WordIsSkeletalRibbonOn)&&"true"!==e.StaticRibbonIsEnabled,f="true"===e.WordIsSkeletalDeepLinkOn&&"true"===e.IsDeepLinkScenario,d="true"===e.NewSkeletalUXExperienceEnabled;if((l||f||d)&&k.initialize(f,d),Mt=_e.isDarkModePreferenceOn(e),Bt="false"===_e.userHasMLRPreference(e),d)k.addComponent({isReady:!1,element:document.getElementById("SkeletalRibbon")}),k.addComponentOutsideSkeletalContainer({isReady:!1,element:document.getElementById("SkeletalPage")});else if(l&&!_e.isReactMultilineRibbonVisible(e)&&"false"!==S.getCookie("WordIsSimplifiedRibbonOn")){var h="true"===e.Fluent2StyleIsEnabled;k.addComponent(function(e,t,n,i){var r=["40px","60px","60px","60px","60px","55px","90px","80px","100px","10%","17%","21%","21%","6%","6%"],o=window.ShouldHideBottomBarAtBoot,a=document.createElement("div");a.id="SkeletalRibbon",a.className=a.id,a.style.marginTop=n?"0":"48px";var s=document.createElement("div");s.id="ribbonContent",s.className=s.id,s.style.backgroundColor=t,s.style.height=o?"38px":"76px",s.style.transition="opacity 0.1s",s.style.borderBottom="none",s.style.width="100%",s.style.minWidth="640px",s.setAttribute("unselectable","on");var u=document.createElement("div");u.id="topbar",u.className="topbar",u.style.height="38px",u.style.width="100%",u.style.display="flex",u.style.alignItems="center",u.style.justifyContent="space-between";var c=document.createElement("div");c.style.height="16px",c.style.display="flex",c.style.justifyContent="flex-start";for(var l=[],f=0;f<=14;f+=1)l[f]=document.createElement("div"),l[f].style.backgroundColor=e,l[f].style.borderRadius="2px",l[f].style.height="100%",l[f].style.marginLeft="8px",l[f].style.marginRight="8px",l[f].style.outline="transparent",l[f].style.border="1px solid transparent",l[f].style.width=r[f];var d=document.createElement("div");d.style.height="24px",d.style.display="flex";for(var h=[],v=0;v<4;v+=1)h[v]=document.createElement("div"),h[v].style.width="24px",h[v].style.borderRadius="50%",h[v].style.backgroundColor=e,h[v].style.marginLeft="4px",h[v].style.marginRight="4px",h[v].style.outline="transparent",h[v].style.border="1px solid transparent",d.appendChild(h[v]);d.appendChild(l[7]),d.appendChild(l[8]);var p=document.createElement("div");p.id="bottombar",p.className="bottombar",p.style.height="38px",p.style.width="100%",p.style.display="flex",p.style.alignItems="center",i&&Object.keys(i).forEach((function(e){p.style.setProperty(e,i[e])}));var m=document.createElement("div");m.style.height="22px",m.style.display="flex",m.style.width="100%";for(var y=0;y<=6;y+=1)c.appendChild(l[y]);for(var b=9;b<=14;b+=1)m.appendChild(l[b]);var g=[window.matchMedia("(max-width: 700px)"),window.matchMedia("(max-width: 810px)"),window.matchMedia("(max-width: 1116px)")];_();for(var w=0;w<g.length;w+=1)g[w].addListener(_);function _(){g[0].matches?(l[7].style.width="32px",l[8].style.width="32px",l[6].style.display="none",l[5].style.display="none"):g[1].matches?(l[7].style.width="32px",l[8].style.width="32px",l[6].style.display="none"):g[2].matches&&(l[7].style.width="32px",l[8].style.width="32px")}var k=document.createElement("div");return k.id="highContrastCover",k.className=k.id,k.style.height="4px",k.style.backgroundColor="rgba(0, 0, 0, 0)",u.appendChild(c),u.appendChild(d),p.appendChild(m),s.appendChild(u),o||s.appendChild(p),a.appendChild(s),a.appendChild(k),{isReady:!1,element:a,onRemoval:function(){for(var e=0;e<g.length;e+=1)g[e].removeListener(_)}}}(k.getSkeletalComponentColor(Mt,h),k.getSkeletalBackgroundColor(Mt,h),n,h?{"background-color":Mt?"#292929":"#FFFFFF","border-radius":"8px",margin:"0 8px",width:"calc(100% - 16px)"}:void 0))}return(l||f||d)&&k.launchExperience(void 0,void 0,d),c}}var zt=function(){function e(t,n,i){_class_call_check(this,e),this.success=t,this.errorCode=n,this.extraErrorInfo=i}return _create_class(e,null,[{key:"createSuccess",value:function(){return new e(!0)}},{key:"createFailure",value:function(t,n){return new e(!1,t,n)}}]),e}(),Gt=function(){function e(t){_class_call_check(this,e),this.wacInitializeReadyRetryCount=0,this.wacInitializeReadyAckReceived=!1,this.wopiStartSessionCompleteReceived=!1,this.wopiPendingSessionCompleteReceived=!1,this.wopiStartSessionSentFromWacFrame=!1,this.instantBootPltDiagnostics={},this.instantAppSettings=t,this.isTwoStepCreateNew="true"===t.IsTwoStepCreateNew,this.shouldLogWordBootServerKpis="true"===t.ShouldLogWordBootServerKpis,this.logs=[],this.postMessageOrigin=this.instantAppSettings.PostMessageOrigin,this.acceptStartSessionComplete="true"===this.instantAppSettings.AcceptStartSessionComplete}return _create_class(e,[{key:"launchFastView",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";e.getWindow().g_liveBooksAppConstructed&&this.log("App constructed before launching FastView"),f.fastView&&f.fastView.isOpen()&&this.log("FastView was already opened");var s,u="true"===this.instantAppSettings.IsRegionComposerEnabled;u&&(u=r(48).shouldUseRegionComposer()),s=function(e){be.showToast(e,a)};var c=new _e(!0,!0,!0,!1,this.instantAppSettings,u).launchFastView(t,"WordEditorInstantApp",n,!1,i,o,s);this.log(k.skeletalBootLoggingData());var l="true"===this.instantAppSettings.WordIsSkeletalDeepLinkOn&&"true"===this.instantAppSettings.IsDeepLinkScenario,d=_e.isDarkModePreferenceOn(this.instantAppSettings),h="true"===this.instantAppSettings.Fluent2StyleIsEnabled;if(l&&c)return k.addComponentOutsideSkeletalContainer(He(k.getSkeletalComponentColor(d,h))),void k.addShimmerToElement("SkeletalCanvas");"true"===this.instantAppSettings.SkeletalParagraphIsEnabled&&c&&this.addSkeletalParagraph(d,h)}},{key:"trackOfficeServerDiagnostics",value:function(e){this.officeFrameDocumentFlushTime=Date.now(),this.serverDiagnostics=e}},{key:"sendAppFailedMessage",value:function(t){this.sendPostMessageToParentWindow(e.toJsApiAppFailed,{Error:{errorType:t}},"*")}},{key:"signalReady",value:function(){var e=this;window.addEventListener("message",(function(t){e.receivePostMessage(t)}),!1),this.sendReadyMessage();var t=Number(this.instantAppSettings.WopiPendingSessionMessageTimeoutInMs);t||(t=1e4),window.setTimeout((function(){return e.timeoutWopiPendingSessionMessage()}),t)}},{key:"startWacBoot",value:function(t){this.sendBeacon("WordEditorInstantApp.StartWacBoot","BootLogs"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,e.bBNSW,"WordEditorInstantApp.StartWacBoot");var n=t||this.instantAppSettings;this.getCellsConnection=Ht(n,!0)}},{key:"displayCacheViewBeforeCFI",value:function(){var e=this.instantAppSettings.browserCacheIdV2,t=this.instantAppSettings.DocumentCacheItemSchemaVersion;if(void 0!==e&&void 0!==t){var n=new ge,i=new te(n,e,t,!0,_e.isDarkModePreferenceOn(this.instantAppSettings),(function(){return!0}),"Loading...");ee.getAndLoadDocumentCache(i,!0)}}},{key:"abortGetCellsConnection",value:function(){this.getCellsConnection&&this.getCellsConnection.abort()}},{key:"getCellsFromFrameRequest",value:function(e){Ee.getCellsFromFrameRequest(e),this.abortGetCellsConnection()}},{key:"addSkeletalParagraph",value:function(e,t){try{var n=document.getElementById("WACFastView"),i=n.querySelectorAll(".Paragraph").length;if(20!==i&&60!==i)return!1;var r=n.querySelector(".Outline");if(r){var o=function(e,t){var n=document.createElement("div");n.id="SkeletalParagraph",n.style.width="100%",n.style.overflow="hidden",n.style.position="relative";var i=document.createElement("div");i.style.width="100%",i.style.boxSizing="border-box";var r=e.querySelectorAll(".OutlineElement");-1!==r[r.length-1].className.toLowerCase().indexOf("rtl")&&(i.style.direction="rtl");var o=e.querySelector(".OutlineContent");o&&(i.style.paddingLeft=o.style.paddingLeft,i.style.paddingRight=o.style.paddingRight);for(var a=["92%","100%","93%","80%"],s=0;s<a.length;s+=1){var u=document.createElement("div");u.style.backgroundColor=t,u.style.width=a[s],u.style.height="14px",u.style.marginBottom="6px",i.appendChild(u)}return n.appendChild(i),n}(n,k.getSkeletalComponentColor(e,t));r.appendChild(o),k.addShimmerToElement(o.id)}}catch(e){return this.log("failed to add skeletal paragraph: "+e.message+"\r\n"+e.stack),!1}return!0}},{key:"sendPostMessageToParentWindow",value:function(e,t,n){var i={MessageId:e,SendTime:Date.now(),Values:t},r=this.postMessageOrigin;n&&(r=n),window.parent.postMessage(JSON.stringify(i),r),this.log("Sent ".concat(e))}},{key:"receivePostMessage",value:function(t){if(t.origin===this.postMessageOrigin){var n;try{n=JSON.parse(t.data)}catch(e){return}switch(n.MessageId){case e.fromJsApiInitReadyAck:this.log("WacInitialize_Ready_Ack received"),this.wacInitializeReadyAckReceived=!0;break;case e.fromJsApiPendingSessionFail:if(this.log("WopiPendingSession_Fail received"),this.wopiPendingSessionCompleteReceived)return void this.log("WopiPendingSession_Fail received after a Complete/Fail was already received previously.");this.wopiPendingSessionCompleteReceived=!0,this.wopiStartSessionCompleteReceived=!0,this.initializeAppOnFailure(e.bBNWI,"WopiPendingSession_Fail");break;case e.fromJsApiPendingSessionComplete:this.log("WopiPendingSession_Complete received"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,e.bBNWI,"WopiPendingSession_Complete"),this.sendPostMessageToParentWindow(e.toJsApiSessionCompleteAck,{}),this.wopiPendingSessionCompleteReceived&&this.log("WopiPendingSession_Complete received after a Complete/Fail was already received previously."),this.wopiPendingSessionCompleteReceived=!0;var i=n.Values.WopiDetails;this.instantBootPltDiagnostics=n.Values.Diagnostics||{},this.makeStartSessionRequest(i),this.beginStartSessionTimeout(!0);break;case e.fromJsApiStartSessionComplete:if(this.log("WopiStartSession_Complete received"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,e.bBNSC,"WopiStartSession_Complete"),this.sendPostMessageToParentWindow(e.toJsApiSessionCompleteAck,{}),this.wopiStartSessionCompleteReceived)return void this.log("WopiStartSession_Complete received after a Complete/Fail was already received previously.");if(!this.acceptStartSessionComplete)return void this.log("WopiStartSession_Complete rejected");if(!n.Values.StartSessionResponse)return void this.log("WopiStartSession_Complete invalid content");this.wopiStartSessionCompleteReceived=!0,this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0);var r=n.Values.StartSessionResponse;this.instantBootPltDiagnostics=n.Values.Diagnostics||{},this.processStartSessionResponse(!1,r.RequestStatus,r.ResponseText);break;case e.fromJsApiPendingAppCompleteReceived:this.log("WopiPendingApplicationComplete_Received received on wac frame"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,e.bBNWI,"WopiPendingApplicationComplete_Received"),this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0),this.beginStartSessionTimeout(!1)}}}},{key:"beginStartSessionTimeout",value:function(e){var t=this,n=Number(this.instantAppSettings.WopiStartSessionTimeoutInMs);n||(n=1e4),e?(this.wopiStartSessionSentFromWacFrame=!0,window.setTimeout((function(){return t.timeoutWopiStartSessionFromWacFrameMessage()}),n)):window.setTimeout((function(){return t.timeoutWopiStartSessionFromJsApiMessage()}),n)}},{key:"sendReadyMessage",value:function(){var t=this;this.sendPostMessageToParentWindow(e.toJsApiInitReady,{CanAcceptStartSessionComplete:this.acceptStartSessionComplete,Diagnostics:{officeSessionId:this.instantAppSettings.SessionId}}),window.setTimeout((function(){return t.timeoutWacInitializeReadyAckMessage()}),e.wacInitializeReadyAckTimeoutInMs)}},{key:"timeoutWacInitializeReadyAckMessage",value:function(){this.wacInitializeReadyAckReceived||this.wopiPendingSessionCompleteReceived||(this.wacInitializeReadyRetryCount+=1,this.wacInitializeReadyRetryCount<e.wacInitializeReadyMaxRetries?(this.sendReadyMessage(),this.log("WacInitializeReadyAckTimeout. [RetriesRemain:".concat(e.wacInitializeReadyMaxRetries-this.wacInitializeReadyRetryCount,"]"))):this.log("WacInitializeReadyAckTimeout. No retries remain"))}},{key:"timeoutWopiPendingSessionMessage",value:function(){this.wopiPendingSessionCompleteReceived||this.initializeAppOnFailure(e.bBNWI,"WopiPendingSession_Timeout")}},{key:"timeoutWopiStartSessionFromJsApiMessage",value:function(){this.wopiStartSessionCompleteReceived||this.wopiStartSessionSentFromWacFrame||this.initializeAppOnFailure(e.bBNSC,"StartSession_Fail","Timeout_FromJsApi")}},{key:"timeoutWopiStartSessionFromWacFrameMessage",value:function(){this.wopiStartSessionCompleteReceived||this.initializeAppOnFailure(e.bBNSC,"StartSession_Fail","Timeout_FromWacFrame")}},{key:"makeStartSessionRequest",value:function(e){var t=this,n=Ce(this.instantAppSettings,0,!0,e),i=new Ee(null,n),r="WOPIsrc=".concat(encodeURIComponent(e.WopiSrc));window.location.search&&(r+="&".concat(window.location.search.substr(1))),"true"===this.instantAppSettings.FileGetUrlPresent&&(r+="&fileGetUrlPresent=1"),this.instantBootPltDiagnostics.startSessionStartTime=Date.now(),i.makeStartSessionRequest("WordEditorStartSession.ashx?".concat(r),(function(e){return t.processStartSessionResponse(!0,e.status,e.responseText)}))}},{key:"getAppSettingsFromResponse",value:function(e){try{return{success:!0,appSettings:JSON.parse(e)}}catch(e){return{success:!1,errorInfo:e.message+"\r\n"+e.stack}}}},{key:"processStartSessionResponse",value:function(t,n,i){var r=this,o=Date.now();if(this.wopiStartSessionCompleteReceived=!0,200===n){var a=this.getAppSettingsFromResponse(i);a.success?(function(e){e&&e.UrlToRedirect&&window.top&&window.top.location.replace(e.UrlToRedirect)}(a.appSettings),this.instantBootPltDiagnostics.isStartSessionFromWac=t,t&&(this.instantBootPltDiagnostics.startSessionCompleteTime=o),this.instantBootPltDiagnostics.appSettingsFetchedTime=Date.now(),jt=a.appSettings,e.instantAppSettingsToPreserve.forEach((function(e){jt&&e in r.instantAppSettings&&(jt[e]=r.instantAppSettings[e])})),e.shipFrom1JSSettings.forEach((function(e){jt&&(e in r.instantAppSettings?jt[e]=r.instantAppSettings[e]:delete jt[e])})),e.getWindow().g_appSettings=jt,e.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(zt.createSuccess())):this.initializeAppOnFailure(e.bBNSC,"StartSession_AppSettingsParseError",a.errorInfo)}else this.initializeAppOnFailure(e.bBNSC,"StartSession_Fail","Status ".concat(n))}},{key:"initializeAppOnFailure",value:function(t,n,i){this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!1,t,n,i),jt=this.instantAppSettings,e.getWindow().g_appSettings=jt,e.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(zt.createFailure(n,i))}},{key:"initializeApp",value:function(t){t.success&&jt?this.startWacBoot(jt):(this.sendBeacon("WordEditorInstantAppBootError",{errorCode:t.errorCode,extraErrorInfo:t.extraErrorInfo}),jt&&t.errorCode&&(jt.InstantBoot_FailureCode=t.errorCode),t.errorCode&&t.extraErrorInfo&&jt&&(jt[t.errorCode]=t.extraErrorInfo)),this.sendBeacon("WordEditorInstantAppLogs",this.logs),e.getWindow().g_livebooksJsDownloaded&&(e.getWindow().Sys.Application.get_isInitialized()?e.getWindow().g_liveBooksAppConstructed||pageInit():(e.getWindow().Sys.Application.add_init(pageInit),e.getWindow().Sys.Application.initialize()))}},{key:"log",value:function(e){this.logs.push({time:Date.now(),message:e})}},{key:"sendBeacon",value:function(t,n){e.getWindow()._bB&&e.getWindow()._bB.sendBeacon(t,n)}},{key:"logKPI",value:function(e,t,n){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=e?3:0;i=e?"{'k':[{'e': ".concat(o,",'n':'").concat(t,"', 'p':{'Status': '").concat(n,"', 'ExtraInfo': '").concat(r,"'}}]}"):"{'k':[{'e': ".concat(o,",'n':'").concat(t,"','k':{'n':'").concat(n,"'+'_'+'").concat(r,"'},'p':{'ErrorLevel':'5'}}]}"),this.sendBeacon(i,"Kpi")}}],[{key:"getWindow",value:function(){return window}}]),e}();Gt.fromJsApiInitReadyAck="WacInitialize_Ready_Ack",Gt.fromJsApiPendingSessionComplete="WopiPendingSession_Complete",Gt.fromJsApiPendingSessionFail="WopiPendingSession_Fail",Gt.fromJsApiPendingAppCompleteReceived="WopiPendingApplicationComplete_Received",Gt.fromJsApiStartSessionComplete="WopiStartSession_Complete",Gt.toJsApiInitReady="WacInitialize_Ready",Gt.toJsApiAppFailed="Wac_AppFailed",Gt.toJsApiSessionCompleteAck="WopiSession_Complete_Ack",Gt.bBNSC="BBNSC",Gt.bBNWI="BBNWI",Gt.bBNSW="BBNSW",Gt.wacInitializeReadyMaxRetries=3,Gt.wacInitializeReadyAckTimeoutInMs=1e3,Gt.instantAppSettingsToPreserve=["MSCCCookies","MSCCEnabled","MSCCMarkup","RibbonImageBase","SharedStaticContentHost","Slice1Name","StaticContentHost","WacRootDomain","WacBootNewJSIsEnabled","jQueryName","signalRName","CollabSliceName","DarkModeIsOn","BuildVersion"],Gt.shipFrom1JSSettings=["HashedResourceClientManifestShippingFrom1JS","HashedStaticContentHostShippingFrom1JS","VersionedStaticContentHostShippingFrom1JS"];var qt=function(e){a||(a=new t({container:e,layoutCollection:{Landscape:{Default:[{id:"KeyboardRegion"}]},Portrait:{Default:[{id:"KeyboardRegion"}],Small:[{id:"KeyboardRegion"}]},DP:{Default:[{id:"FarPane"},{id:"KeyboardRegion"}]},DL:{Default:[{id:"KeyboardRegion"}]}}}))}}(),wacBoot=o}();
//# sourceMappingURL=wacBoot.min.js.map